$.extend($.support,{placeholder:function(){return"placeholder"in document.createElement("input")}(),isMobile:function(){return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase())}()}),$.support.transition||($.fn.transition=$.fn.animate);var mvideo=function(){function a(a){return!!b(a)}function b(a,b,c){var d=a.split(c||"."),e=d.length;a=b||window;for(var f=0;f<e&&void 0!==a;f++)a=a[d[f]];return a}function c(a,b,c,d){for(var e=a.split(d||"."),f=e.length-1,g=c||window,h=null,i=0;i<f;i++)h=g[e[i]],void 0===h&&(h={},g[e[i]]=h),g=h;return g[e[i]]=b,b}function d(b,d){if(a(b))throw"Namespace collision : "+b+" already registered";return d=d||{},c(b,d)}function e(c){if(!a(c))throw"Initialization error : Module "+c+" doesn't exists!";return b(c)}function f(a){return"object"==typeof a?[a]:(a?a.split(","):[]).map(function(a){return a.trim()})}function g(a){return(a?a.split(","):[]).map(function(a){return a.trim()})}function h(a,b,c,d,e,f){if(!mvideo.Module.isExists(b))return console.error("Module "+b+" hasnt been implemented yet");f&&$.isFunction(f.beforeInit)&&f.beforeInit(a,b,c,d,e);var g=mvideo.Module.init(b,c,a);d&&(mvideo.instance[d]=g),e&&mvideo.Module.deviceController(g),f&&$.isFunction(f.afterInit)&&f.afterInit(g,b,c,d,e)}function i(a,b){a=a||$(document.body);var c=$("[data-init]",a);$(a).data("init")&&(c=c.add($(a))),c.each(function(){var a=$(this),c=a.data("instance"),d=a.data("init"),e=a.data("init-param"),i=!!a.data("device"),j=f(e),k=g(a.data("init-additional"));h(this,d,j,c,i,b);for(var l=0;l<k.length;l++)d=k[l],h(this,d,f(a.data("init-param-"+d.toLowerCase())),a.data("instance-"+d.toLowerCase()),a.data("device-"+d.toLowerCase()),b)})}function j(){$(".disabled-until-scripts-loaded").removeClass("disabled-until-scripts-loaded")}function k(a){var b=arguments.length>0?$.makeArray(arguments):[];return a=b.shift(),b.unshift(a.prototype),$.extend.apply(null,b)}function l(a){var b=arguments.length>0?$.makeArray(arguments):[];return $.extend.apply(null,b)}return{define:d,extend:l,include:k,getItem:e,isExists:a,initScripts:i,setObjectPath:c,getNestedName:b,removeDisabledJSClass:j}}();mvideo.define("mvideo.Mixin"),mvideo.define("mvideo.Mixin.container"),mvideo.define("mvideo.Module"),mvideo.define("mvideo.Event"),mvideo.define("mvideo.instance"),mvideo.define("mvideo.template"),mvideo.extend(mvideo.Mixin.container,{_moduleName:function(a){return"mvideo.Mixin."+a},isExists:function(a){return a=this._moduleName(a),mvideo.isExists(a)},getItem:function(a){return a=this._moduleName(a),mvideo.getItem(a)},define:function(a,b){a=this._moduleName(a),mvideo.define(a,b)}}),mvideo.extend(mvideo.instance,mvideo.Mixin.container,{_moduleName:function(a){return"mvideo.instance."+a}}),mvideo.extend(mvideo.template,mvideo.Mixin.container,{_moduleName:function(a){return"mvideo.template."+a},define:function(a,b){a=this._moduleName(a),mvideo.define(a,mvideo.helpers.render(b))}}),mvideo.extend(mvideo.Mixin,mvideo.Mixin.container,{_moduleName:function(a){return"mvideo.Mixin."+a}}),mvideo.extend(mvideo.Module,mvideo.Mixin.container,{_moduleName:function(a){return"mvideo.Module._items."+a},deviceController:function(a,b){a&&(b=b||["mobile","tablet","desktop"],a.__currentState||(a.__currentState=""),$.each(b,function(b,c){var d=$.trim(c);mvideo.Event.subscribe(d,function(){if(!a[d+"Behavior"])return console.error("Method "+d+"Behavior has not been implemented yet");setTimeout(function(){a[d+"Behavior"](d)},0)})}))},init:function(a,b,c){var d=this._moduleName(a);return mvideo.getItem(d).apply(c,b||[])}}),mvideo.device={manager:function(){function a(){var a=f||e.get(0).offsetWidth;return 2===a?"tablet":1===a?"mobile":"desktop"}function b(){return 2==window.devicePixelRatio}function c(b){setTimeout(function(){f=void 0,c.__currentState||(c.__currentState=""),b=b||a(),c.__currentState!==b&&(c.__currentState=b,mvideo.Event.publish("device",b),mvideo.Event.publish(b))})}function d(){return{Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return this.Android()||this.BlackBerry()||this.iOS()||this.Opera()||this.Windows()}}[arguments[0]||"any"]()}var e=function(){return $("<div>",{class:"device-manager"}).appendTo("body")}(),f=e.get(0).offsetWidth;return{block:e,getType:a,changeState:c,isRetinaDisplay:b,isItMobile:d,minScreenSize:320,TYPES:{MOBILE:"mobile",DESKTOP:"desktop",TABLET:"tablet"}}}()},window.mvideo.cacheControl=function(){function a(){return b}var b="true"===$.cookie("CACHE_INDICATOR");return b||$.cookie("CACHE_INDICATOR","true",{path:"/",domain:"."+window.document.domain}),{isPageFromCache:a}}(),function(){var a=$(window),b=a.width();mvideo.observer=function(a){var b=$({});return $.each({on:"subscribe",one:"once",off:"unsubscribe",trigger:"publish"},function(c,d){a[d]=function(){return b[c].apply(b,arguments),a}}),a},mvideo.observer(mvideo.Event);var c=$.throttle(300,function(){mvideo.Event.publish("scroll")}),d=$.throttle(300,function(){a.width()!=b&&(b=a.width(),mvideo.Event.publish("resize"))});a.on("resize",function(){d()}).on("scroll",function(){c()}).on("orientationchange",function(){mvideo.Event.publish("orientationchange")}),$(function(){$.support.transition?mvideo.device.manager.block.on($.support.transition.end,function(){mvideo.device.manager.changeState()}):Modernizr.mediaqueries&&mvideo.Event.subscribe("resize",function(){mvideo.device.manager.changeState()})})}(),window.mvideo.Mixin.define("arrow",{getHTMLArrow:function(a,b,c){var d="next"===a?"next":"previous",e="next"===a?"right":"left";return c&&(e="next"===a?"bottom":"top"),'<button data-role="none" class="'+b+" "+b+"_"+a+" sel-hits-button-"+a+'" aria-label="'+d+'"><i class="font-icon icon-'+e+'-open"></button>'}}),mvideo.Mixin.define("domTraveler",{moveTo:function(a,b,c){return a=$(a),b=b||this.config.defaultMethod,c=c||this.$.holder,a[b](c),this},switchTo:function(a,b){var c,d,e,f=this.config;return c="string"==typeof a&&a in f.routes?f.routes[a]:a,d=c.target,e=c.method||f.defaultMethod,this.moveTo(d,e),"function"==typeof b&&b(),this}}),mvideo.Mixin.define("dynamicElement",{config:{autoInit:!1,method:"append",tpl:"",tplData:[]},show:function(){return this.$.el.show(),this},hide:function(){return this.$.el.hide(),this},remove:function(){return this.$.el.remove(),this},detach:function(){return this.$.el.detach(),this},render:function(a,b){return a=a||this.config.tpl,b=b||this.config.tplData,$(mvideo.helpers.render(a,{data:b}))},insert:function(a){return this.$.el||(this.$.el=this.render()),a=a||this.config.method,this.$.holder[a](this.$.el),this}}),mvideo.Mixin.define("input",{input:{isChecked:function(a){return a.is(":checked")},check:function(a){return a.attr("checked","checked")},unCheck:function(a){return a.removeAttr("checked")},changeState:function(a){return this.isChecked()?this.unCheck():this.check()}}}),mvideo.Mixin.define("itemsContainer",{config:{activeClass:"active"},getActiveItem:function(a){var b="."+this.config.activeClass,c=this.$.items.filter(b);return a&&!c.length&&(c=this.$.items.first()),c},setActiveItem:function(a){return a=a||this.getActiveItem(),this.unsetActiveAll(a),a.addClass(this.config.activeClass)},unsetActiveItem:function(a){return a.removeClass(this.config.activeClass)},unsetActiveAll:function(a){return this.$.items.not(a).removeClass(this.config.activeClass)},isActiveItem:function(a){return a.hasClass(this.config.activeClass)}}),mvideo.Mixin.define("overlay",{overlay:{_create:function(a){var b=$('<div class="ajax-overlay-wrapper"><div class="ajax-overlay">').appendTo($("body"));return this._setPosition(a,b),this.add(a,b)},_createLocal:function(a,b){b.css("position","relative");var c=$("<div class='ajax-overlay'/>").appendTo(b);return this._setPositionLocal(a,c),this.add(a,c)},show:function(a,b,c){var d=null;return c?(c=$(c),d=this.get(a)||this._createLocal(a,c),b&&this._setPositionLocal(a,d)):(d=this.get(a)||this._create(a),b&&this._setPosition(a,d)),d.show()},hide:function(a){a.is("input")&&a.css("opacity","1"),this.get(a).hide()},get:function(a){return $.data(a[0],"overlay")},add:function(a,b){return $.data(a[0],"overlay",b)},_setPosition:function(a,b){var c=a.offset();return $.extend(c,{width:a.outerWidth(),height:a.outerHeight()}),a.is("input")&&(a.css("opacity","0.5"),b.css("background","transparent")),b.find(".ajax-overlay").css(c),b.css({height:c.height+c.top}),this},_setPositionLocal:function(a,b){var c=a.position();return $.extend(c,{width:a.outerWidth(),height:a.outerHeight()}),b.css(c),this}}}),mvideo.Mixin.define("regExp",{escapeStr:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}}),mvideo.Mixin.define("showHide",{config:{activeClass:"active"},show:function(){return this.$.holder.addClass(this.config.activeClass),this},hide:function(){return this.$.holder.removeClass(this.config.activeClass),this},isShown:function(){return this.$.holder.hasClass(this.config.activeClass)}}),mvideo.Mixin.define("state",{config:{affectParent:!1,states:["active","inactive"]},getState:function(){for(var a=this.$.holder,b="",c=this.config.states,d=c.length,e=0;e<d;e++){var f=c[e];if(a.hasClass(f)){b=f;break}}return b},isState:function(a){return this.$.holder.hasClass(a)},setState:function(a){var b=this.$.holder;return this.config.affectParent&&b.parent().removeClass($.map(this.config.states,function(a){return"parent-"+a}).join(" ")).addClass("parent-"+a),b.removeClass(this.config.states.join(" ")),b.addClass(a),this},switchState:function(){var a=this.config.states;return this.isState(a[0])?this.setState(a[1]):this.setState(a[0]),this}}),mvideo.Mixin.define("tab",{config:{autoInit:!1,method:"append",tpl:"",tplData:[]},getItemTarget:function(a){var b=a.find("a");return b.data("target")||b.attr("href").replace("#","")},getActiveTabId:function(){var a=this.getActiveItem();return this.getItemTarget(a)},getItemById:function(a){var b=this;return this.$.items.filter(function(){return b.getItemTarget($(this))===a})},setActiveById:function(a){return this.setActiveItem(this.getItemById(a)),this},unsetActiveById:function(a){return this.unsetActiveItem(this.getItemById(a)),this}}),mvideo.define("mvideo.Mixin.url",{getQueryParamsObject:function(a){var b={};if(0!==a.length)for(var c=a.split("&"),d=0,e=c.length;d<e;d++){var f=c[d].split("=");b[f[0]]=f[1]}return b}}),function(){function a(a){this.config={},$.extend(!0,this.config,a||{}),this.initialize.apply(this,arguments)}var b={extend:function(a,b){var c,d=this;c=a&&a.hasOwnProperty("constructor")?a.constructor:function(){return d.apply(this,arguments)},$.extend(!0,c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&$.extend(!0,c.prototype,a),c.__super__=d.prototype,c},include:function(a){var b=arguments.length>0?$.makeArray(arguments):[];return b.unshift(this.prototype),$.extend.apply(null,b),this},define:function(a,b){a="mvideo.Class."+a,b=b||this,mvideo.define(a,b)}},c={initialize:function(){},loadObjects:function(a,b,c){b=b||this.config.selectors,c=c||this.$;var d=null;for(d in b)c[d]="string"==typeof a?$(a+" "+b[d]):$(b[d],a);return this}};$.extend(!0,a,b),a.include(c),a.define("Class",a)}(),function(){"use strict";function a(a,b,c,d){return d=d||0,c=c||"It took: ",function(){var e=new Date,f=a.apply(b,Array.prototype.slice.call(arguments)),g=new Date-e;return g>d&&console.log([c,": ",g,"ms"].join("")),f}}mvideo.define("mvideo.helpers.render",function(a,b){mvideo.helpers.render.cache||(mvideo.helpers.render.cache={});var c=mvideo.helpers.render.cache;if(void 0!==c[a])return b?c[a](b):c[a];var d=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("{{").join("\t").replace(/((^|}})[^\t]*)'/g,"$1\r").replace(/\t=(.*?)}}/g,"',$1,'").split("\t").join("');").split("}}").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return mvideo.helpers.render.cache[a]=d,b?d(b):d}),mvideo.define("mvideo.helpers.profile",function(b,c,d){return a(b,c,d)}),mvideo.define("mvideo.helpers.profileObj",function(b,c,d){for(var e in b)"function"==typeof b[e]&&(b[e]=a(b[e],b,d||e,c));return b}),mvideo.define("mvideo.helpers.delay",function(a,b){return setTimeout(a,b||0)}),mvideo.define("mvideo.helpers.getUrlParam",function(a){var b,c=a||window.location.search,d={};return b=c.split("?"),b.length>1&&(b=b[1].split("&"),$.each(b,function(a,b){var c=b.split("=");d[c[0]]=c[1]})),d}),mvideo.define("mvideo.helpers.setUrlParam",function(a,b){if(a)return b=$.extend(!0,window.mvideo.helpers.getUrlParam(a),b),a.split("?")[0]+"?"+$.param(b)}),mvideo.define("mvideo.helpers.inViewport",function(a,b){a=a instanceof jQuery?a[0]:a,b=b||0;var c=a.getBoundingClientRect();return c.top+b<=mvideo.helpers.getWindowHeight()&&c.bottom-b>=0}),mvideo.define("mvideo.helpers.camelToLower",function(a,b){if("string"!=typeof a)throw"Expected a string";return a.replace(/([a-z\d])([A-Z])/g,"$1"+(b||"-")+"$2").toLowerCase()}),mvideo.define("mvideo.helpers.getWindowWidth",function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}),mvideo.define("mvideo.helpers.getWindowHeight",function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}),mvideo.define("mvideo.helpers.getLocalStorage",function(){return Modernizr.localstorage?localStorage:{setItem:function(a,b){$.cookie(a,b,{expires:365})},getItem:function(a){var b=$.cookie(a);return void 0===b?null:b},removeItem:function(a){$.cookie(a,null)}}}),mvideo.define("mvideo.helpers.paramParser",function(a,b){if("string"==typeof a){a=a.replace(/\s*=\s*/g,"=");for(var c=a.split(/\s+/),d={},e=0;e<c.length;e++){var f=c[e].split("=");f.length<2?mvideo.setObjectPath(f[0],!0,d):mvideo.setObjectPath(f[0],f[1],d)}return $.extend(!0,{},b,d)}if("object"==typeof a)return $.extend(!0,{},b,a)}),mvideo.define("mvideo.helpers.colorConverter",function(){return{convertRgbToHsl:function(a){var b,c,d=parseInt(a.substring(0,2),16)/255,e=parseInt(a.substring(2,4),16)/255,f=parseInt(a.substring(4,6),16)/255,g=Math.max(d,e,f),h=Math.min(d,e,f),i=(g+h)/2;if(g==h)b=c=0;else{var j=g-h;switch(c=i>.5?j/(2-g-h):j/(g+h),g){case d:b=(e-f)/j+(e<f?6:0);break;case e:b=(f-d)/j+2;break;case f:b=(d-e)/j+4}b/=6}return[b,c,i]},invertColor:function(a){var b=a.sourceColor.substr(1),c=this.convertRgbToHsl(b);return c[0]<.55&&c[2]>=.5||c[0]>=.55&&c[2]>=.75?a.darkColor:a.lightColor}}}),mvideo.define("mvideo.helpers.getFileInfo",function(a){function b(a){var b=a.lastIndexOf("."),c=a.lastIndexOf("\\");return-1!=b&&(a=a.substr(0,b)),-1!=c&&(a=a.substr(c+1)),a}function c(a){var b=a.lastIndexOf(".");return-1===b?"":a.substr(b+1)}var d={};if(!a.files)d.size=null,d.type=c(a.value),d.name=b(a.value),d.byteSize=0;else{var e=a.files[0],f=function(a){var b=+(a/1024).toFixed(1),c=+(b/1024).toFixed(1);return b<102.4?{value:a,valueTyped:b+"Кб"}:{value:a,valueTyped:c+"Мб"}}(e.size);d.size=f.valueTyped,d.type=c(e.name),d.name=b(e.name),d.byteSize=f.value}return d}),mvideo.define("mvideo.helpers.price",function(){return{spaceCorrectPrice:function(a){for(var b=a.toString(),c=/(\d+)(\d{3})/;c.test(b);)b=b.replace(c,"$1 $2");return b},getDefaultValue:function(a){return a.toString().replace(/\D/g,"")}}}),window.mvideo.define("mvideo.helpers.checkOrientationChange",function(){function a(){var b=d.width();e!=b?(window.mvideo.Event.publish("orientationchange-end"),e=b):setTimeout(a,50)}function b(){f=!0,d=$("body"),e=d.width(),window.mvideo.Event.subscribe("orientationchange",function(){a()})}function c(){!f&&b()}var d,e,f=!1;return{init:c}}()),window.mvideo.define("mvideo.helpers.mutationObserver",function(){function a(a,b){a.addedNodes.length>0&&b(a.addedNodes)}function b(b,c){var d=document.querySelector(b),f=$.extend({childList:!0,attributes:!1,characterData:!1,subtree:!1,attributeOldValue:!1,characterDataOldValue:!1},c.config);if(null===d)return void window.console.warn("mutation holder is not defined in 'helpers.mutationObserver'");e=new window.MutationObserver(function(b){b.forEach(function(b){a(b,c.addingCallback)})}),e.observe(d,f)}function c(){e&&e.disconnect()}function d(){return!!window.MutationObserver}var e;return{start:b,stop:c,isAvailable:d}}()),window.mvideo.define("mvideo.helpers.form",function(){function a(a){d=a}function b(a,b){if(!d.length)return void console.warn('In "mvideo.helpers.form" $form is not defined');b||(e={label:"u-error-text",input:"u-error"});for(var f=0;f<a.length;f++)c(a[f])}function c(a){var b,c,f=a.id;b=d.find("#"+f),c=b.next("."+e.label+'[for="'+f+'"]'),c.length||(c=$('<label for="'+f+'" class="'+e.label+'"></label>'),b.after(c)),c.html(a.text),c.css("display","block"),b.addClass(e.input)}var d,e={label:"text-error",input:"text-error"};return{showErrors:b,setForm:a}}()),window.mvideo.define("mvideo.helpers.inputs",function(){function a(a){var b=$(a),c=b.find("input, textarea"),d={};return $.each(c,function(a,b){var c=$(b);d[c.attr("name")]=c.val()}),d}return{getData:a}}()),window.mvideo.define("mvideo.helpers.timeParser",function(){function a(a){return a<10?"0"+a:a}function b(b,c){var d,e,f,g=b;return c.minutes&&(d=parseInt(g/60,10),g%=60),c.hours&&(e=parseInt(d/60,10),d%=60),c.days&&(f=parseInt(e/24,10),e%=24),{days:f,hours:a(e),minutes:a(d),seconds:a(g)}}return{parseTime:b}}()),window.mvideo.define("mvideo.helpers.prepareDataSend",function(){function a(a,b,c){var g=new FormData,h=e($(f,b),c),i=e($('input[type="radio"]:checked',b),c);if(h.each(function(){var a=$(this);"file"!=a.attr("type")?g.append(a.attr("name"),a.val()):a[0].files[0]&&g.append(a.attr("name"),a[0].files[0],a[0].files[0].name)}),i.each(function(){var a=$(this);g.append(a.attr("name"),a.val())}),a){var j=d(a);j&&g.append(j.attr("name"),j.val())}return{formData:g}}function b(a){var b={};return $(f,a).each(function(){var a=$(this);b[a.attr("name")]=a.val()}),JSON.stringify(b)}function c(a,b,c,f){var g,h=$(b||"input",a),i=e(h,f).serializeArray();return c&&(g=d(c))&&i.push({name:g.attr("name"),value:g.val()}),i}function d(a){var b=$(a.target),c=b.attr('[type="submit"]')?b:b.closest('[type="submit"]');if(0!=c.length&&c.attr("name")&&c.val())return c}function e(a,b){return a.filter(function(){var a=$(this);return!a.hasClass("c-pseudo-form_ignore")&&("hidden"===a.attr("type")||(!b||a.data("dirty")))})}var f='input:not([type="submit"]):not([type="radio"]), textarea';return{getData:a,getJsonData:b,getSerializedData:c}}()),window.mvideo.define("mvideo.helpers.isIE",function(){var a=!!~window.navigator.userAgent.indexOf("Trident/");return function(){return a}}()),window.mvideo.define("mvideo.helpers.throttle",function(){return function(a,b){var c=!1;return function(){c||(a.apply(this,arguments),c=!0,setTimeout(function(){c=!1},b))}}}())}(),function(){"use strict";var a={},b="",c=[],d={};mvideo.define("mvideo.helpers.checkout",{getData:function(e,f,g){var h,i,j=$.Deferred();f&&a[f]&&(console.log("abort"),a[f].abort()),$.isPlainObject(e.data)&&(e.data=JSON.stringify(e.data)),d[e.url]=!0,g||(b!=e.url&&(c=[],b=e.url),h=e.data,i=!1,c[h]&&(c[h].debug&&(console.info("==============================================================="),console.log("Cache: ",c[h])),i=c[h])),console.time("Request to "+e.url);var k=$.post({url:e.url,data:e.data,contentType:"application/json"});return k.fail(function(a){if(delete d[e.url],"abort"!=a.statusText){if(a.responseJSON&&a.responseJSON.stacktrace){var b="";for(var c in a.responseJSON)a.responseJSON[c]&&(b+="<h2 class='e-h2 u-mt-16'>"+c+":</h2>"+a.responseJSON[c]);a.responseJSON.redirectTo&&(b="<a href='"+a.responseJSON.redirectTo+"' class='c-btn c-btn_text'>Выполнить редирект</a>"+b);new mvideo.Class.Popup(!1,{classes:["full-screen"],contentAsHTML:!0,title:b}).show()}else if(a.responseJSON&&a.responseJSON.redirectTo)return void(location.href=a.responseJSON.redirectTo);mvideo.Event.publish("checkout.add-notification",{htmlContent:"Произошла ошибка на сервере: "+a.statusText}),j.reject(a)}}).then(function(a){if(delete d[e.url],a.debug&&(g||(c[h]?JSON.stringify(c[h])!=JSON.stringify(a)&&console.warn("Cache not equal server response"):console.info("===============================================================")),console.timeEnd("Request to "+e.url),console.log("Server response: ",a)),!g){if(c[h]&&JSON.stringify(c[h])==JSON.stringify(a))return void j.resolve(a,!0);c[h]=a}j.resolve(a,!1)}).always(function(){delete d[e.url],delete a[f]}),f&&(a[f]=k),g?j.promise():{promise:j.promise(),cache:i}},getGroups:function(){return d}})}(),function(a){"use strict";window.mvideo.define("mvideo.helpers.gtmMutationFunctions",{wizard:function(a){var b=$(a.form),c=$(":radio[name="+a.radioName+"]:checked + label",b)[0];return a.eventContext=$(c).text(),delete a.form,delete a.radioName,a},changeCheckbox:function(a){var b=$(a.holder),c=$(a.elem,b);return a=$.extend(!0,{},a),c.prop("checked")||(a.eventLabel="cancelDiscount"),delete a.holder,delete a.elem,a},changeStateCheckbox:function(a){var b=$(a.elem);return a=$.extend(!0,{},a),a.eventContent=b.prop("checked")?"check":"uncheck",delete a.elem,a},notification:function(a){var b=$(a.holder),c=$(a.element+a.type,b);return a=$.extend(!0,{},a),a.part?a[a.part]=c.text():a.eventContent=c.text(),a.ignore=0===c.length,delete a.holder,delete a.element,delete a.type,delete a.part,a},selectedRadioButton:function(a){var b=$(a.element+'[name="'+a.name+'"]:checked');return a=$.extend(!0,{},a),a.eventContent=b.data("ga_content"),delete a.element,delete a.name,a},hasSelectedRadioButton:function(a){var b=$(a.holder),c=$(a.element+'[name="'+a.name+'"]:checked',b);return a=$.extend(!0,{},a),a.eventContent=c.length>0?"yes":"no",delete a.holder,delete a.element,delete a.name,a},getCheckedRadioButton:function(a){var b=$(a.holder),c=$("input[type=radio]:checked",b);return a=$.extend(!0,{},a),$.each(a.itemsMap,function(b,d){b==c.val()&&(a.eventContent=d)}),delete a.holder,delete a.itemsMap,a},checkoutOrder:function(a){var b,c=$("#checkout_main"),d=$(a.discountHolder),e=$("input:checked",d),f=[],g=$(".o-delivery-email"),h=$(a.bonusRoublesHolder),i=g.length>0?g:$('input[name="'+a.deliveryRadio+'"]:checked'),j=$('input[name="'+a.paymentRadio+'"]:checked'),k=!1;return c.find("form").each(function(a,b){k=k||!$(b).valid()}),k?(a=$.extend(!0,{},a),a.ignore=!0):(e.each(function(b,c){var d=$(c),e=d.data("ga_field");f.push(d.data("ga_content")),e&&(a.eventField=e)}),a=$.extend(!0,{},a),a.eventContent=f.join("/"),a.eventLocation=i.data("ga_content"),a.eventContext=j.data("ga_content"),h&&h.length&&(b=parseInt(h.text().match(/\d/g).join("")),a.eventContent+=(a.eventContent?",":"")+b),delete a.bonusRoublesHolder,delete a.discountHolder,delete a.deliveryRadio,delete a.paymentRadio),a},clickHeaderDetails:function(a){var b=$(a.holder),c=$(a.element,b);return a=$.extend(!0,{},a),c.hasClass("collapsed")||(a.eventLabel="collapseOrderDetails"),delete a.holder,delete a.element,a},checkoutPopupType:function(a){var b=$(a.form),c=$(a.holder,b),d=$("input:checked",c).val(),e=$(a.element,b);return a=$.extend(!0,{},a),a.eventContent=d,"checkbox"===e.attr("type")?e.prop("checked")?a.eventLocation="checked":a.eventLocation="unchecked":a.eventLocation=e.val(),delete a.holder,delete a.form,delete a.element,a},dropdown:function(a){var b=$(a.select),c=b.siblings(".select-area");return a=$.extend(!0,{},a),c.hasClass("cs-opened")||(a.ignore=!0),delete a.select,a},dropdownSelectedDate:function(a){var b=$(a.select),c=window.moment(b.val(),"DD.MM.YYYY"),d=window.moment(),e=c.diff(d,"days")+1;return a=$.extend(!0,{},a),a.eventContent=e,delete a.select,a},dropdownSelected:function(a){var b=$(a.select),c=b.find("option:selected");return a=$.extend(!0,{},a),a.eventContent=c.text(),delete a.select,a},enterSeveral:function(a,b){var c=$(b.currentTarget),d=$(b.target),e=$('input[data-ga-action-part="true"]',c),f=0;return a=$.extend(!0,{},a),d.data("ga-changed",!0),e.each(function(a,b){$(b).data("ga-changed")&&f++}),f!==e.length&&(a.ignore=!0),a},getTileBundleInfo:function(a,b){var c=$(b.target).closest(a.element),d=c.data("ga-content");return a=$.extend(!0,{},a),d&&(a.eventValue=d.value,a.eventProductId=d.id,a.eventProductCategoryId=d.category),delete a.element,a},collapsedLink:function(a){return a.eventContext=$(a.link).hasClass("collapsed")?"open":"close",a},checkForm:function(a,b){return a.length&&!a.validate().checkForm()&&(b.ignore=!0),b},getValueFromForm:function(a){var b=$(a.form),c=b.find(a.element),d=c.val();return a=$.extend(!0,{},a),b.validate().checkForm()?(a.addToEventValue?(a.eventValue=d,a.eventContent=d,delete a.addToEventValue):a.eventContext=d,delete a.form,delete a.element,a):(a.ignore=!0,a)},getOrderStatus:function(a,b){var c=$(b.target).closest("form"),d=$(a.elementRadio+":checked",c).val(),e=c.find(a.elementOnline).val(),f=c.find(a.elementOffline).val();return a=$.extend(!0,{},a),c.validate().checkForm()?("offline"===d?(a.eventField="Other",a.eventContext=f+"_"+c.find(a.elementStore).val()):(a.eventField="OnStore",a.eventContext=e),delete a.elementOnline,delete a.elementOffline,delete a.elementStore,delete a.elementRadio,a):(a.ignore=!0,a)},getFieldNames:function(a,b){var c,d=$(b.currentTarget),e=$.extend(!0,{},a);return e.dirtyInputs?c=d.find("[data-dirty]").filter(function(){var a=$(this);return!0===a.data("dirty")||"password"===a.attr("type")}).map(function(){return $(this).data("ga-field")}).toArray():(c=d.serializeArray().filter(function(a){var b=d.find('[name="'+a.name+'"]'),c=b.val(),f=b.data("backwardsInputPrev");return e.fieldMapping[a.name]&&c!==f}).map(function(a){return e.fieldMapping[a.name]}),delete e.fieldMapping),e.eventContent=c.filter(function(a,b){return c.indexOf(a)===b}).join(","),delete e.dirtyInputs,e},getRecoveryErrors:function(a,b){var c=$(b.currentTarget),d=c.find(".u-error-text"),e=c.find("input").attr("type"),f={tel:"phone",email:"email"};return a.eventContent=f[e],a.eventContext=d.text(),a},getAccountErrors:function(a,b){var c=$(b.currentTarget),d=c.find(".u-error-text").text(),e=c.closest(".c-accordion__item").find(".c-accordion__header").text();return a.eventContext=d,a.eventLocation=e,a},getAuthError:function(a,b){var c=$(b.currentTarget),d=c.data("ga-field");return a.ignore=!1,"recaptcha"===d&&!1===c.prop("checked")?(a.eventContent="timeout",a.eventContext="Время истекло"):"recaptcha"!==d?(a.eventContent=d,a.eventContext=c.find(".u-error-text:visible").text()):a.ignore=!0,a},gtmTypInfo:function(a){var b=new window.mvideo.Class.GTMforTYP;return a.eventContext=b.findActiveOrder(),a.eventValue=b.getAmount(),a},cancelOrderAnswer:function(a){var b=$(a.form),c=$("input:checked",b);return a.eventContent=c.siblings("label").find("span[data-sel]").text().trim(),delete a.form,a},getRegisterSuccess:function(a,b){var c="formValid"===b.type;return a.eventContent=c&&"success"||"unsuccess",a},getReferrerAfterAuth:function(a){var b,c,d,e={facebook:"facebook",google:"google",vkontakte:"vk",odnoklassniki:"ok",mailru:"mailru",twitter:"twitter",yandex:"yandex"},f="("+Object.keys(e).join("|")+")",g=document.referrer,h=g.split("/");return a=$.extend(!0,{cookieName:"mvid_d4gtm",bonusCard:"bc"},a),a.eventFromBackContent&&(d=a.eventFromBackContent,delete a.eventFromBackContent),d||(b=$.grep(h,function(a){return a.match("^(login|authentication)")}),1===b.length?$.cookie(a.cookieName)&&$.cookie(a.cookieName)===a.bonusCard?(d="bonusCard",$.removeCookie(a.cookieName)):d="signin":(b=$.grep(h,function(a){return a.match("^social_login")}),1===b.length&&(c=b[0].match(f))&&c.length>0&&(d=e[c[0]]))),d||(d="other"),a.eventField="sms"===d?"new":"old",a.eventContent=d,delete a.cookieName,delete a.bonusCard,a},getOrderRating:function(a){var b=$(a.elem);if(b.valid()){var c=b.find('input[name="rating"]').val();a.eventContent=c,delete a.elem,delete a.ignore}else a.ignore=!0;return a},getValueInput:function(a){return a[a.nameValueUpdate||"eventContent"]=$(a.selectInput).val(),delete a.selectInput,delete a.nameValueUpdate,a},changeDeliveryDate:function(a){return a=this.getLocationDeliveryDate(a),a.eventAmount=this.getDiffDay(window.moment().format(),a.eventField),a.eventField=a.eventField=window.moment(a.eventField).format("YYYY-MM-DD")+" | "+a.timeslot,delete a.timeslot,a},getLocationDeliveryDate:function(a){var b;return a.elem&&(b=$(a.elem),a.eventLocation=b.data("ga-order-manager")&&b.data("ga-order-manager").eventLocation),a},changeDeliveryDateSubmit:function(a){var b=$(".js_change-date__startDate").val(),c=$(".js_change-date__endDate").val();return a=this.getLocationDeliveryDate(a),a.eventValue=$(".js_change-date__price").val(),a.eventContent=this.getDiffDay(a.eventField,b),a.eventField=b,a.eventAmount=this.getDiffDay(window.moment().format(),a.eventField),a.eventField=window.moment(a.eventField).format("YYYY-MM-DD")+" | "+window.moment.parseZone(b).format("HH:mm")+"-"+window.moment.parseZone(c).format("HH:mm"),a},getTradeInState:function(a,b){var c=$(b.currentTarget),d=c.find('[data-id="trade-in"]'),e=d.prop("checked"),f=$.extend(!0,{},a),g=c.find(".c-pdp-price__current:visible").text().match(/\d+/g).join("");return"show"===f.eventAction?f.eventLabel="TradeInAvailable":f.eventLabel=e?"activateDiscount":"deactivateDiscount",f.eventValue=g,f},getDiffDay:function(a,b){var c={hour:0,minute:0,second:0,millisecond:0},d=window.moment(a).utcOffset(b).set(c);return window.moment(b).utcOffset(b).set(c).diff(d,"days")},mergeAttrs:function(a){var b;return a.elem&&(b=$(a.elem),a=$.extend(!0,a,b.data("ga-attr")||{})),a},getPromocode:function(a){var b,c=$(a.selecInput),d=c.parent().find('[data-id="'+c.val()+'"]');return d.length?(a.eventContent=d.data("promo-id"),a.eventLocation=d.index()+1):(b=$(a.checkboxInput),a.eventContent=b.length?b.data("ga_field"):""),delete a.mutable,delete a.mutationFunction,delete a.selecInput,delete a.checkboxInput,a},promocodeNotification:function(b){return b=a.helpers.gtmMutationFunctions.notification(b),b=a.helpers.gtmMutationFunctions.getPromocode(b)},getContent:function(a,b){var c=$(b.currentTarget),d=a.field||"eventContent";return a=$.extend(!0,{},a),a[d]=c.data("ga-content"),delete a.elem,delete a.field,a},promocodeRecalculate:function(b){if(b=a.helpers.gtmMutationFunctions.getLocationDeliveryDate(b),b.selected){var c=$(b.selected);b.eventField=c.length&&c.val()?"FromList":"Manually"}return delete b.selected,b},getCountFileLoader:function(b,c){b=$.extend(!0,{},b);var d;try{d=b.form?$(b.form):$(c.currentTarget).closest("form"),b=a.helpers.gtmMutationFunctions.checkForm(d,b)}catch(a){window.console.warn("form - undefined or ev undefined"),b.ignore=!0}if(b.ignore)return b;if(b.paramMutationFunction){var e=$(b.paramMutationFunction.selectModuleFile,d);e.length&&(b.eventField=e.data(b.paramMutationFunction.nameInstace)&&e.data(b.paramMutationFunction.nameInstace).getCountFiles().toString())}return delete b.paramMutationFunction,b},setCounterInputData:function(a,b){var c=$(b.currentTarget);return a.eventContent=c.data("ga-content"),a.eventAmount=c.parent().find(".c-counter-input__input").val(),a},getCarouselId:function(a,b){return a.eventContent=$(b.currentTarget).data("block-id"),a},getCarouselDirection:function(a,b){var c="prev"===b.namespace?"left":"right";return a.eventContext=c+"Scroll",a.eventContent=$(b.currentTarget).parents(".gallery-content.accessories-new").data("block-id"),a},wishlistCheckCommentAction:function(a,b,c){return a.eventLabel=c.clickType,a}})}(window.mvideo),
mvideo.template.define("popup",'\t\t<div class="c-popup"> \t\t\t<div class="c-popup__block"> \t\t\t\t{{ if(affix === true){ }}\t\t\t\t\t<div data-init="affix" data-init-param="{&quot;targetSelector&quot;: &quot;{{=selector}}&quot;, &quot;topAffixOffset&quot;: &quot;-0.05&quot;}" class="c-popup__close"> \t\t\t\t{{ } else { }}\t\t\t\t\t<div data-init="sticky" data-init-param="{&quot;targetSelector&quot;: &quot;{{=selector}}&quot;, &quot;topAffixOffset&quot;: 0, &quot;fnTop&quot;: true,  &quot;selectorAffix&quot;: &quot;.c-btn_close&quot; }" class="c-popup__close u-sticky"> \t\t\t\t{{ } }}\t\t\t\t\t<span class="c-btn_close font-icon icon-delete"  data-close="true"></span>\t\t\t\t</div>\t\t\t\t<div class="c-popup__content"> \t\t\t\t</div> \t\t\t</div>\t\t</div>'),mvideo.template.define("autocompleteItems",'{{for (var i = 0; i < categories.length; i++) { }}\t\t{{var rows = categories[i].items;}}\t\t{{if(rows.length) { }}\t\t\t<li>\t\t\t\t{{if (categories[i].subtitle) { }}\t\t\t\t\t<strong class="search-list-title">{{=categories[i].subtitle}}</strong>\t\t\t\t{{ } }}\t\t\t\t<div class="suggested-search-holder">\t\t\t\t\t<ul class="suggested-search-list">\t\t\t\t\t\t{{for (var j = 0; j < rows.length; j++) { }}\t\t\t\t\t\t\t<li data-input-value="{{=rows[j].inputValue}}">\t\t\t\t\t\t\t\t<a href="{{=rows[j].url}}" class="suggested-search-link">\t\t\t\t\t\t\t\t\t{{if (rows[j].img) { }}\t\t\t\t\t\t\t\t\t\t<figure class="suggested-search-image">\t\t\t\t\t\t\t\t\t\t\t<img src="{{=rows[j].img}}"/>\t\t\t\t\t\t\t\t\t\t</figure>\t\t\t\t\t\t\t\t\t{{ } }}\t\t\t\t\t\t\t\t\t<span class="suggested-search-text {{=seleniumClasses.item}}">{{=rows[j].text}}</span>\t\t\t\t\t\t\t\t\t{{if (rows[j].price) { }}\t\t\t\t\t\t\t\t\t\t<strong class="suggested-search-price">{{=rows[j].price}}</strong>\t\t\t\t\t\t\t\t\t{{ } }}\t\t\t\t\t\t\t\t</a>\t\t\t\t\t\t\t</li>\t\t\t\t\t\t{{ } }}\t\t\t\t\t</ul>\t\t\t\t</div>\t\t\t</li>\t\t{{ } }}\t{{ } }}'),mvideo.template.define("detectumSearchAutocomplete",'<div class="autocomplete {{=classes}}"\tdata-init="autocompleteHandler"\tdata-init-param="{&#34;element&#34;: &#34;#alt-search-input&#34;,\t&#34;submitAfterFormInHeader&#34;: true,\t&#34;placement&#34;:&#34;append&#34;,\t&#34;timeout&#34;: 0,\t&#34;controller&#34;:&#34;DetectumAjaxController&#34;,\t&#34;autoCompleteControllerClass&#34;:&#34;DetectumAutocompleteController&#34;,\t&#34;defaultImgSrc&#34;:&#34;{{=defaultImgSrc}}&#34;,\t&#34;no-empty-submit&#34;:true}">\t\t<form action="/action/search" id="alt-search-form" class="header-search-form-section">\t\t\t<div class="header-search-form">\t\t\t\t<input id="alt-search-input" class="header-search-input" name="Ntt" type="text"/>\t\t\t\t<span class="font-icon icon-zoom header-search-icon">\t\t\t\t\t<input class="header-search-btn" type="submit" value="Поиск" />\t\t\t\t</span>\t\t\t</div>\t\t</form>\t</div>'),mvideo.template.define("mapProductTemplate",'<div class="infoWindow">\t\t<span class="c-btn_close close с-btn_white font-icon icon-delete"></span>\t\t{{if(data.id) { }}\t\t\t<strong class="storeId">{{=data.id}}</strong>\t\t{{ } }}\t\t{{ if(data.isMobileStore){ }}\t\t\t<strong class="m_mobile">m_mobile+</strong>\t\t{{ } }}\t\t<div class="infowindow-holder">\t\t\t{{if(data.name){ }}\t\t\t\t<div class="infowindow-row">\t\t\t\t\t<p class="storeName">{{=data.name}}</p>\t\t\t\t</div>\t\t\t{{ } }}\t\t\t{{if(data.undergroundStationName){ }}\t\t\t\t<div class="infowindow-row">\t\t\t\t\t<p class="metroStation">м. {{=data.undergroundStationName}}</p>\t\t\t\t</div>\t\t\t{{ } }}\t\t\t{{if(data.workingHours){ }}\t\t\t\t<div class="infowindow-row">\t\t\t\t\t<p>{{=data.workingHours}}</p>\t\t\t\t</div>\t\t\t{{ } }}\t\t\t{{if(data.skuId && data.stock && data.leadtime){ }}\t\t\t\t<div class="infowindow-row">\t\t\t\t\t<strong>Наличие: </strong>\t\t\t\t\t<i data-init="tooltip" class="ico {{=data.stock}}" data-toggle="tooltip" data-title="{{=data.stockText}}" data-trigger="hover"></i>\t\t\t\t</div>\t\t\t{{ } }}\t\t\t{{if(data.skuId && data.leadtime){ }}\t\t\t\t<div class="infowindow-row">\t\t\t\t\t<strong>Забрать в магазине: </strong>\t\t\t\t\t{{=data.leadtime}}\t\t\t\t\t{{if(data.hasPickupText){ }}\t\t\t\t\t\t<p class="store-pickup-text">Обязательна оплата онлайн</p>\t\t\t\t\t{{ } }}\t\t\t\t</div>\t\t\t{{ } }}\t\t\t{{if(data.sibIcon){}}\t\t\t\t<div class="infowindow-row">\t\t\t\t\t<p>Возможности</p>\t\t\t\t\t<span class="facilities">\t\t\t\t\t\t{{for (var i in data.sibIcon) {}}\t\t\t\t\t\t\t{{if (data.sibIcon[i]["urlImg"]){ }}\t\t\t\t\t\t\t<img class="icon-img" src="{{=data.sibIcon[i]["urlImg"]}}" {{if(data.sibIcon[i]["title"]){ }} data-init="tooltip" data-init-param=",top,true" data-title="{{=data.sibIcon[i]["title"]}}" {{ } }}>\t\t\t\t\t\t\t{{ } }}\t\t\t\t\t\t{{ } }}\t\t\t\t\t</span>\t\t\t\t</div>\t\t\t{{ } }}\t\t</div>\t\t{{if (!data.hideBtn) { }}\t\t\t{{if (data.collect) { }}\t\t\t\t<a href="#" class="btn" onclick="$(&#39;.o-pay:first #js-store-id&#39;).val(&#39;{{=data.id}}&#39;);$(&#39;.o-pay:first .o-pay__btn&#39;).trigger(&#39;click&#39;);return false;">{{=data.btnLabel}}</a>\t\t\t{{ } else if (data.submitLink) { }}\t\t\t\t<a href="#" data-store-id="{{=data.id}}" class="btn js-store-select">{{=data.btnLabel}}</a>\t\t\t{{ } else { }}\t\t\t\t<a href="{{=data.btnLink}}" class="btn" {{if(data.checkLeadtime && !data.leadtime){ }} disabled {{ } }}>{{=data.btnLabel}}</a>\t\t\t{{ } }}\t\t\t{{if (data.showBeside) { }}\t\t\t\t<a href="#" class="btn btn-invers-deep-grey" onclick="$(&#39;#frm-search-store&#39;).val(&#39;{{=data.undergroundStationName}}&#39;).closest(&#39;form&#39;).submit();$(&#39;#store-locator-list-input&#39;).prop(&#39;checked&#39;,true).change();return false;">{{=data.showBeside}}</a>\t\t\t{{ } }}\t\t{{ } }}\t</div>'),mvideo.template.define("mapStoreTemplate",'<div class="infoWindow o-info-window">\t\t<div class="o-info-window__close close"><span class="c-btn_close font-icon icon-delete"></span></div>\t\t<div class="c-line-img o-info-window__item {{ if(data.isMobileStore){ }} u-mb-0 {{ } }} ">\t\t\t{{if(data.markerType == "myStore"){ }}\t\t\t\t<i class="c-line-img__icon i-icon-heart c-line-img_red"></i>\t\t\t{{ } }}\t\t\t{{if(data.markerType != "myStore"){ }}\t\t\t\t<i class="c-line-img__icon i-icon-pin-with-dot"></i>\t\t\t{{ } }}\t\t\t{{ if(data.markerType == "pochta") { }}\t\t\t\t{{=data.pickupTexts.pochta + " " + data.address}}\t\t\t{{ } else if(data.markerType == "marker5Ka") { }}\t\t\t\t{{ if (data.pickupPointType == "pickup-point") { }}\t\t\t\t\t{{=data.pickupTexts["5kaPickupPoint"] + " " + data.address}}\t\t\t\t{{ } else { }}\t\t\t\t\t{{=data.pickupTexts["5kaPostamat"] + " " + data.address}}\t\t\t\t{{ } }}\t\t\t{{ } else{ }}\t\t\t\t{{=data.address}}\t\t\t{{ } }}\t\t</div>\t\t{{ if(data.isMobileStore){ }}\t\t\t<div class="c-line-img o-info-window__item u-color-gray60">{{=data.mMobile.title}}</div>\t\t{{ } }}\t\t{{if(data.undergroundStationName){ }}\t\t\t<div class="c-line-img o-info-window__item"><i class="c-line-img__icon i-icon-moscow-metro-logo"></i>{{=data.undergroundStationName}}</div>\t\t{{ } }}\t\t<div class="c-line-img o-info-window__item"><i class="c-line-img__icon i-icon-clock"></i>{{=data.workingHours}}</div>\t\t{{if (data.showCaseStatus) { }}\t\t\t<div class="c-line-img o-info-window__item u-mb-12"><i class="c-line-img__icon i-icon-info c-line-img_orange"></i>{{=data.showCaseStatus}}</div>\t\t{{ } }}\t\t{{if (data.leadimeMsg) { }}\t\t\t<div class="c-line-img o-info-window__item u-mb-12"><i class="c-line-img__icon i-icon-info c-line-img_green"></i>{{=data.leadimeMsg}}</div>\t\t{{ } }}\t\t{{if (data.presell) { }}\t\t\t<div class="c-line-img u-mt-8 o-info-window__item u-mb-12"><i class="c-line-img__icon i-icon-info c-line-img_orange"></i>{{=data.prepaymentText}}</div>\t\t{{ } }}\t\t{{if (data.exchangeRules) { }}\t\t\t<ol class="e-ol u-mt-20 u-ml-4 e-ol_pl_12">\t\t\t\t{{for (var i = 0; i < data.exchangeRules.length; i++) { }}\t\t\t\t\t<li>{{=data.exchangeRules[i]}}</li>\t\t\t\t{{ } }}\t\t\t</ol>\t\t{{ } else { }}\t\t\t<div><a onclick="$(&#39;.js-store-id&#39;).val(&#39;{{=data.id}}&#39;);$(&#39;.js-is-pvz&#39;).val(&#39;{{=data.isPVZ}}&#39;);$(&#39;.js-store-id&#39;).trigger(&#39;change_store&#39;);return false;" href="" class="btn" data-pushable="true" data-action="click" data-holder="#chooseShopMap">{{=data.btnLabel}}</a></div>\t\t{{ } }}\t</div>'),mvideo.template.define("iframeModal",'\t\t<div id="modal" tabindex="-1" role="dialog" aria-labelledby="Promotional modal" aria-hidden="false" class="gallery-modal modal container fade" style="margin-top: -285px;"> \t\t\t<div class="modal-content"> \t\t\t\t<div class="modal-header"> \t\t\t\t\t<button type="button" data-dismiss="modal" aria-hidden="true" class="close ico-close">&nbsp;</button> \t\t\t\t</div> \t\t\t\t<div class="modal-body"> \t\t\t\t\t<div class="video-content" data-init="add-youtube-video-statistic" data-init-param="{&#34;videoIframeId&#34;:&#34;{{=data.id}}&#34;}"> \t\t\t\t\t\t<div id="{{=data.id}}" frameborder="0" data-src="{{=data.src}}"></div> \t\t\t\t\t</div> \t\t\t\t</div> \t\t\t</div> \t\t</div>'),mvideo.template.define("multiskuDropdownTemplate",'\t<div class="c-multisku__group u-mr-16">\t\t<div class="c-multisku__control c-multisku__select">\t\t\t<div class="c-form-element">\t\t\t\t<label class="c-form-element__label">{{=title}}</label>\t\t\t\t<select class="c-dropdown c-custom-scroll u-mt-4 outta-here" data-redirectable="true" data-sel="pdp-dropdown-multisku_{{=type}}-select" data-select-btn-attrs="{&#34;data-sel&#34;: &#34;pdp-dropdown-multisku_{{=type}}-select-btn&#34;}">\t\t\t\t\t{{for(var i=0, len = elements.length; i < len; i++) { }}\t\t\t\t\t\t<option data-pushable="{{=elements[i].gaPushable}}" data-action="{{=elements[i].gaAction}}" data-holder="{{=elements[i].gaHolder}}" data-href="{{=elements[i].href}}" data-inner-html="<span class=&#34;c-multusku__select-price u-font-small&#34;>{{=elements[i].price}}</span>" value="{{=elements[i].value}}" {{if(elements[i].selected){ }} selected {{ } }} {{if(elements[i].disabled){ }} disabled {{ } }}>\t\t\t\t\t\t\t{{=elements[i].text}}\t\t\t\t\t\t</option>\t\t\t\t\t{{ } }}\t\t\t\t</select>\t\t\t</div>\t\t</div>\t</div>'),mvideo.template.define("popupEnergyTemplate",'\t<div class="c-popup-energy">\t\t<h4 class="e-h4 u-mb-12">{{=data.title}}</h2>\t\t<ul class="c-popup-energy__labels-list">\t\t\t{{for(var i=0, len = data.classes.length; i < len; i++) { }}\t\t\t\t<li class="c-popup-energy__labels-list-item">\t\t\t\t\t<span class="c-arrow-label c-arrow-label_narrow c-arrow-label_{{=data.classes[i].name === data.activeClass ? data.classes[i].color : "gray80"}}">{{=data.classes[i].name}}</span>\t\t\t\t</li>\t\t\t{{ } }}\t\t</ul>\t\t<ul class="c-popup-energy__characteristics-list">\t\t\t{{for(var i=0, len = data.characteristics.length; i < len; i++) { }}\t\t\t\t<li class="c-popup-energy__characteristics-list-item u-clearfix">\t\t\t\t\t<span class="c-popup-energy_characteristic-name">{{=data.characteristics[i].name}}</span>\t\t\t\t\t<span class="c-popup-energy_characteristic-value">{{=data.characteristics[i].value}}</span>\t\t\t\t</li>\t\t\t{{ } }}\t\t</ul>\t\t<a class="c-link" href="{{=data.link.href}}">{{=data.link.title}}</a>\t</div>'),mvideo.template.define("popupError",'\t{{ if (data.title) { }}\t\t<div class="c-popup__title">{{=data.title}}</div>\t{{ } }}\t<div>{{=data.message}}</div>\t{{ if (data.buttonText) { }}\t\t<button data-init="close-popup" class="c-btn c-btn_text c-btn_white c-btn_full-size u_close_popup u-mt-24">{{=data.buttonText}}</button>\t{{ } }}'),mvideo.template.define("reviewOpinions",'<div class="o-review-opinions-wrapper c-custom-scroll c-custom-scroll_relative c-custom-scroll_mini" style="overflow: hidden" data-init="custom-scroll-browser">\t\t<div class="c-custom-scroll__scroller o-review-opinions">\t\t\t<span class="u-font-small u-color-gray60" data-sel="pdp-text-cluster_opinions_count">{{=count}}</span>\t\t\t<div class="c-review-opinions u-mt-16" data-sel="pdp-div-cluster_opinions">\t\t\t\t<div data-init="load-content"\t\t\t\tdata-init-param="{&#34;method&#34;: &#34;{{=params.method}}&#34;,\t\t\t\t&#34;action&#34;: &#34;{{=params.url}}&#34;,\t\t\t\t&#34;dataSend&#34;: {&#34;clusterId&#34;:&#34;{{=params.data}}&#34;},\t\t\t\t&#34;ev&#34;: &#34;load&#34;,\t\t\t\t&#34;selectElm&#34;: &#34;.c-review-opinions&#34;,\t\t\t\t&#34;cached&#34;: true,\t\t\t\t&#34;overlayInBlock&#34;: true\t\t\t\t}">\t\t\t\t</div>\t\t\t</div>\t\t</div>\t</div>'),mvideo.template.define("reviewTile",'<li class="gallery-list-item">\t\t<div class="o-review-tile">\t\t\t{{ for(var i = 0; i < clusters.length; i++) { }}\t\t\t\t<div class="o-review-cluster" data-cluster-id="{{=clusters[i].id}}">\t\t\t\t\t{{ var negativeClass = clusters[i].type === negType ? " c-review_cluster-bad" : "";}}\t\t\t\t\t<div class="c-review c-review_cluster{{=negativeClass}}" data-pushable="true" data-action="click" data-holder="#keyphaseCluster" data-ga-content="{{=clusters[i].count}}" data-sel="pdp-div-cluster-{{=clusters[i].id}}">\t\t\t\t\t\t<div class="c-review__title">\t\t\t\t\t\t\t{{ if(clusters[i].link) { }}\t\t\t\t\t\t\t\t<a class="c-link c-link_gray20" target="_blank" href="{{=clusters[i].link}}" data-pushable="true" data-action="click" data-holder="#keyphaseReviewFull" data-ga-content="{{=clusters[i].reviewId}}" data-sel="pdp-link-open_cluster_review-{{=clusters[i].id}}">{{=clusters[i].title}}</a>\t\t\t\t\t\t\t{{ } else { }}\t\t\t\t\t\t\t\t<span data-sel="pdp-link-open_cluster_review-{{=clusters[i].id}}">{{=clusters[i].title}}</span>\t\t\t\t\t\t\t{{ } }}\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="c-review__author" data-sel="pdp-text-cluster_author-{{=clusters[i].id}}">{{=clusters[i].authorName}}</div>\t\t\t\t\t\t<a class="c-link c-link_gray60 c-link_pseudo c-review__link" href="#" data-sel="pdp-link-cluster_opinions_count-{{=clusters[i].id}}">{{=clusters[i].similarCount}}</a>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t{{ } }}\t\t</div>\t</li>'),mvideo.template.define("searchAutocomplete",'<div class="autocomplete {{=classes}}"\t\tdata-init="autocompleteHandler"\t\tdata-init-param="{\t\t&#34;element&#34;: &#34;#alt-search-input&#34;,\t\t&#34;submitAfter&#34;: true,\t\t&#34;placement&#34;:&#34;append&#34;,\t\t&#34;timeout&#34;: 0,\t\t&#34;defaultImgSrc&#34;:&#34;{{=defaultImgSrc}}&#34;\t\t}">\t\t<form action="/action/search?_DARGS=/sitebuilder/blocks/search/search.jsp" id="alt-search-form" class="header-search-form-section">\t\t\t<div class="header-search-form" data-init="validationHandler" data-init-param=".autocomplete .header-search-form-section" >\t\t\t\t<input id="alt-search-input" class="header-search-input {{=seleniumClasses.searchInput}}" name="Ntt" type="text" data-rule-minlength="2" data-msg-minlength="Введено менее 2 символов" data-rule-required="true" data-msg-required="Введено менее 2 символов" data-ignore-change="true" data-validate-keyup="true" />\t\t\t\t<span class="font-icon icon-zoom header-search-icon">\t\t\t\t\t<input class="header-search-btn" type="submit" value="Поиск" />\t\t\t\t</span>\t\t\t</div>\t\t</form>\t</div>'),mvideo.template.define("subwayMapStoreTemplate",'<div class="tooltipster-base tooltipster-sidetip tooltipster-top c-tooltip_map c-tooltip_subway">\t\t<div class="tooltipster-box">\t\t\t<span class="tooltipster-close c-btn_close с-btn_white font-icon icon-delete" onclick="$(&#39;.c-tooltip_subway&#39;).hide().trigger(&#39;closeStoreInfo&#39;); return false;"></span>\t\t\t<div class="tooltipster-content">\t\t\t\t<div class="o-info-window">\t\t\t\t\t<div class="c-line-img o-info-window__item{{ if(data.isMobileStore){ }} u-mb-0 {{ } }}">\t\t\t\t\t{{if(data.markerType == "myStore"){ }}\t\t\t\t\t<i class="c-line-img__icon i-icon-heart c-line-img_red"></i>\t\t\t\t\t\t\t\t\t\t{{ } }}\t\t\t\t\t{{if(data.markerType != "myStore"){ }}\t\t\t\t\t<i class="c-line-img__icon i-icon-pin-with-dot"></i>\t\t\t\t\t\t\t\t\t\t{{ } }}\t\t\t\t\t{{=data.address}}\t\t\t\t\t</div>\t\t\t\t\t{{ if(data.isMobileStore){ }}\t\t\t\t\t<div class="c-line-img o-info-window__item u-color-gray60">{{=data.mMobile.title}}</div>\t\t\t\t\t{{ } }}\t\t\t\t\t{{if(data.undergroundStationName){ }}\t\t\t\t\t<div class="c-line-img o-info-window__item"><i class="c-line-img__icon i-icon-moscow-metro-logo"></i>{{=data.undergroundStationName}}</div>\t\t\t\t\t\t\t\t\t{{ } }}\t\t\t\t\t<div class="c-line-img o-info-window__item"><i class="c-line-img__icon i-icon-clock"></i>{{=data.workingHours}}</div>\t\t\t\t\t{{if (data.showCaseStatus) { }}\t\t\t\t\t\t<div class="c-line-img o-info-window__item u-mb-12"><i class="c-line-img__icon i-icon-info c-line-img_orange"></i>{{=data.showCaseStatus}}</div>\t\t\t\t\t{{ } }}\t\t\t\t\t{{if (data.leadimeMsg) { }}\t\t\t\t\t\t<div class="c-line-img o-info-window__item u-mb-12"><i class="c-line-img__icon i-icon-info c-line-img_green"></i>{{=data.leadimeMsg}}</div>\t\t\t\t\t{{ } }}\t\t\t\t\t{{if (data.presell) { }}\t\t\t\t\t\t<div class="c-line-img u-mt-8 o-info-window__item u-mb-12"><i class="c-line-img__icon i-icon-info c-line-img_orange"></i>{{=data.prepaymentText}}</div>\t\t\t\t\t{{ } }}\t\t\t\t\t{{if (data.exchangeRules) {}}\t\t\t\t\t\t<ol class="e-ol u-mt-20 u-ml-4 e-ol_pl_12">\t\t\t\t\t\t\t{{for (var i = 0; i < data.exchangeRules.length; i++) { }}\t\t\t\t\t\t\t\t<li>{{=data.exchangeRules[i]}}</li>\t\t\t\t\t\t\t{{ } }}\t\t\t\t\t\t</ol>\t\t\t\t\t{{ } else { }}\t\t\t\t\t\t<div><a onclick="$(&#39;.js-store-id&#39;).val(&#39;{{=data.id}}&#39;);$(&#39;.js-store-id&#39;).trigger(&#39;change_store&#39;);return false;" href="" class="btn" data-pushable="true" data-action="click" data-holder="#chooseShopSubway">{{=data.btnLabel}}</a></div>\t\t\t\t\t{{ } }}\t\t\t\t\t{{if (data.showBeside) { }}\t\t\t\t\t\t<div class="u-mt-16">\t\t\t\t\t\t\t<a class="c-link c-link_gray20 c-link_pseudo" href="#" onclick="$(&#39;#frm-store-subway&#39;).val(&#39;{{=data.undergroundStationId}}&#39;);$(&#39;#store-locator-list-input&#39;).prop(&#39;checked&#39;,true).change();$(&#39;#frm-search-store&#39;).val(&#39;{{=data.undergroundStationName}}&#39;);return false;" data-pushable="true" data-action="click" data-holder="#stationShopsOnList">{{=data.showBeside}}</a>\t\t\t\t\t\t</div>\t\t\t\t\t{{ } }}\t\t\t\t</div>\t\t\t</div>\t\t</div>\t\t<div class="tooltipster-arrow">\t\t\t<div class="tooltipster-arrow-uncropped">\t\t\t\t<div class="tooltipster-arrow-border"></div>\t\t\t\t<div class="tooltipster-arrow-background"></div>\t\t\t</div>\t\t</div>\t</div>'),mvideo.template.define("tabsetTpl",'<div class="tabset hidden-phone">\t\t<div class="tabset-container">\t\t\t<ul class="tabset-list">\t\t\t\t{{for(var i=0, len = obj.length; i < len; i++) { }}\t\t\t\t\t<li class="tabset-item {{=obj[i].className}}">\t\t\t\t\t\t{{if(obj[i].gtmId) { }}\t\t\t\t\t\t\t<a data-holder="{{=obj[i].gtmId}}" data-action="click" data-pushable="true" data-target="{{=obj[i].id}}" href="{{=obj[i].href}}" class="tabset-item-link">\t\t\t\t\t\t\t\t{{=obj[i].text}}\t\t\t\t\t\t\t</a>\t\t\t\t\t\t{{ } else { }}\t\t\t\t\t\t\t<a data-target="{{=obj[i].id}}" href="{{=obj[i].href}}" class="tabset-item-link">\t\t\t\t\t\t\t\t{{=obj[i].text}}\t\t\t\t\t\t\t</a>\t\t\t\t\t\t{{ } }}\t\t\t\t\t</li>\t\t\t\t{{ } }}\t\t\t</ul>\t\t</div>\t</div>'),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function a(){if(a.instance)return a.instance;a.instance=this,this.config={container:".main-section",showOverlay:!0},this.modules=[],this.adaptersList=[],this.initialize()},initialize:function(){var a=this;mvideo.observer(this),this.addOverlayFunctionality(),Modernizr.history&&History.Adapter.bind(window,"statechange",function(){var b=History.getState();b&&b.data&&a.lastHistoryStateId!==b.data.lastHistoryStateId&&a.load(b.data)})},addModule:function(a){if(a.moduleName){if(this.hasModule(a.moduleName))return;a.unshiftModule?this.modules.unshift(a.moduleName):this.modules.push(a.moduleName)}$.isFunction(a.dataAdapter)&&this.adaptersList.push(a.dataAdapter),$.isFunction(a.onDataHandler)&&this.subscribe("loaded",function(){var b=Array.prototype.slice.call(arguments,1);a.onDataHandler.apply(this,b)}),$.isFunction(a.beforeRequest)&&this.subscribe("before-request",a.beforeRequest),$.isFunction(a.afterRequest)&&this.subscribe("after-request",a.afterRequest),$.isFunction(a.onError)&&this.subscribe("load-data-error",a.onError)},hasModule:function(a){return $.inArray(a,this.modules)>=0},addOverlayFunctionality:function(){if(this.config.showOverlay&&this.config.container){var a=this,b=this.config.container instanceof jQuery?this.config.container:$(this.config.container);b.length&&this.subscribe("before-request",function(){a.config.showOverlay&&a.overlay.show(b,!0)}).subscribe("after-request",function(){a.config.showOverlay&&a.overlay.get(b).hide()})}},createId:function(){return Date.now()},filterData:function(a){var b,c={ignoreHistory:null};try{b=JSON.parse(a)}catch(a){return JSON.stringify({error:"Invalid response. Need JSON",name:a.name,message:a.message})}for(var d=0,e=this.adaptersList.length;d<e;d++)try{c=$.extend(c,this.adaptersList[d](b))}catch(a){console.error("Error while executing adapter ",this.adaptersList[d])}for(var f=0,g=b.length;f<g;f++)if(b[f].currentURL){c=$.extend(c,{currentURL:b[f].currentURL});break}return c=$.extend(c,this.checkUseHistory(b)),JSON.stringify(c)},checkUseHistory:function(a){var b=null;try{b=a.find(function(a){return a.hasOwnProperty("ignoreHistory")})}catch(a){window.console.error(a)}if(b)return $.extend({},b)},load:function(a,b){var c=this;if(a.notUseHistory?b&&b.preventDefault&&b.preventDefault():Modernizr.history?b&&b.preventDefault&&b.preventDefault():document.location=a.url,!this.dfd||"pending"!==this.dfd.state())return this.dfd=$.ajax({url:a.url,cache:!1,dataType:"json",dataFilter:this.filterData.bind(this),data:a.getParams||"",method:a.method||"GET",beforeSend:function(a){c.publish("before-request",arguments)}}).fail(function(a,b,d){c.publish("load-data-error",arguments)}).done(function(b,d,e){if(b.error)console.error(b.error),c.publish("load-data-error",arguments);else{if(!a.notUseHistory&&!b.ignoreHistory&&Modernizr.history){b.currentURL&&(a.url=document.location.protocol+"//"+document.location.host+b.currentURL),a.lastHistoryStateId=c.lastHistoryStateId=c.createId();try{History.pushState(a,document.title,a.url)}catch(a){window.console.warn(a)}}c.publish("loaded",arguments)}}).always(function(){c.publish("after-request",arguments)}),this.dfd},updateData:function(a){try{a=this.filterData(JSON.stringify(a)),this.publish("loaded",[JSON.parse(a)])}catch(a){window.console.warn(a)}},cancel:function(){this.dfd&&this.dfd.abort()},clear:function(){this.adaptersList=[],this.modules=[],this.unsubscribe("loaded"),this.unsubscribe("before-request"),this.unsubscribe("after-request"),this.unsubscribe("load-data-error"),this.cancel()}});a.include(mvideo.Mixin.overlay),a.define("AsyncDataLoader",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){var c;this.tplPath="common/jade/tpls/select/",this.config=$.extend(!0,{disableCustomClass:".disable-customize",tplDropBox:this.tplPath+"drop-box-newsg.tpl",tplDropBoxItems:this.tplPath+"drop-box-items.tpl",dropBox:".drop-box",maxDropElement:7,ajaxUrl:"/myaccount/gadgets/city.json.jsp",isEmptyResponse:function(){return!0},transformResponseToItems:function(a){return[]},preventEnter:!1,defaultLength:2,stopPropagation:!0,minLengthShow:2},b),a.data("ajax-url")&&(this.config.ajaxUrl=a.data("ajax-url")),this.$={},this.$.holder=a.find("input").not("[type=hidden]"),this.$.hidden=a.find("input[type=hidden]"),this.$.suggestInput=$("<input type='text' disabled class='u-disabled'/>"),this.$.suggestInput.addClass(this.$.holder.attr("class")),this.$.suggestInput.addClass(this.$.holder.data("suggest-input-class")||""),this.$.suggestInput.css({position:"absolute","border-color":"transparent"}),this.$.holder.css({position:"relative","background-color":"transparent"}),this.$.holder.data("verified",!0),this.$.holder.attr("autocomplete","off"),this.$.holder.before(this.$.suggestInput),this.cache={},(c=JST&&JST[this.config.tplDropBox]?JST[this.config.tplDropBox]({}):"")&&(this.$.drop=$(c),this.$.drop.addClass("drop-sg c-custom-scroll"),this.bindEvents())},bindEvents:function(){var a=this,b=this.$.drop;b.data("$search");this.$.holder.focusin(function(){a.$.drop.find(".csbody li").length>=a.config.minLengthShow&&a.showDrop()}).focusout(function(b,c){if(!c||!c.fakeEvent)if(!b||b.originalEvent&&b.originalEvent.relatedTarget&&$(b.originalEvent.relatedTarget).parents(".csbody").length)b.preventDefault(),b.stopPropagation();else{if(a.$.holder.trigger("change",{needChange:!0}),!a.$.holder.hasClass("cs-opened"))return void(a.config.stopPropagation&&(b.preventDefault(),b.stopPropagation()));var d=a.$.drop.find("li.selected a");d.length&&d.data("drop-item-name").toLowerCase()==a.$.holder.val().toLowerCase()&&a.setHiddenValue(d),a.hideDrop()}}),this.$.holder.change(function(b,c){if(a.$.holder.data("prevVal.autocomplete")==a.$.holder.val()||!c||!c.needChange)return!1;a.$.holder.data("prevVal.autocomplete",a.$.holder.val())}),this.inputHandler=$.debounce(250,this.inputHandler.bind(this)),this.$.holder.on("input",function(b,c){if(a.$.suggestInput.val(""),!c||!c.fakeEvent){if(a.$.hidden.data("prevVal",a.$.hidden.val()),a.$.hidden.val(""),a.$.holder.data("verified",!1),a.$.holder.val().length<a.config.defaultLength)return a.clearDrop(),a.hideDrop(),a.request&&a.request.abort(),void a.$.holder.removeClass("u-load");a.config.withoutLoader||a.$.holder.addClass("u-load"),a.inputHandler(b),a.$.holder.data("prevVal",""),a.$.holder.removeClass("u-error"),a.$.holder.parent().find(".u-error-text").hide()}}),this.$.holder.off("keydown.select").on("keydown.select",this.keyboardControl.bind(this)),mvideo.Event.subscribe("resize",this.hideDrop.bind(this))},inputHandler:function(a){var b=this,c=b.config.getRequestData(b.$.holder);if(!b.isDataEmpty(c))return b.loadOptions(b.config.ajaxUrl,b.config.method||"get",c).done(function(a){if(b.config.isEmptyResponse(a))return b.clearDrop(),void b.hideDrop();if(b.buildDrop(a),b.$.holder.is(":focus"))b.showDrop();else if(1===b.$.drop.find("li").length){var c=b.$.drop.find("li.selected a");b.$.hidden.data("prevVal")!=c.data("drop-item-id")?c.length&&c.data("drop-item-name").toLowerCase()==b.$.holder.val().toLowerCase()&&(b.setHiddenValue(c),b.$.holder.blur()):b.setValue(b.$.hidden.data("prevVal"),c)}else b.$.holder.blur()}).always(function(){b.$.holder.removeClass("u-load")}),!1},clearDrop:function(){this.$.drop.find(".csbody").html("")},loadOptions:function(a,b,c){var d=this,e=$.Deferred();return this.request&&this.request.abort(),this.cache[JSON.stringify(c)]?(e.resolve(this.cache[JSON.stringify(c)]),e.promise()):(this.request=$.ajax({url:a,type:b||"POST",dataType:"json",data:c||""}),this.request.then(function(a){d.request=!1,d.cache[JSON.stringify(c)]=a,e.resolve(a)}).fail(function(a){"abort"!=a.statusText&&e.reject(a)}),e.promise())},buildDrop:function(a){var b,c=this,d=this.config.transformResponseToItems(a),e="ontouchstart"in document.documentElement?"touchstart":"click";return d[0].isSelected=!0,b=JST&&JST[this.config.tplDropBoxItems]?JST[this.config.tplDropBoxItems]({items:d}):"",this.$.drop.find(".csbody").html(b),c.$.drop.find(".csbody a").bind(e,function(){var a=$(this);return c.setHiddenValue(a),!1}),this},showDrop:function(){if(this.$.drop.find(".csbody li").length&&this.$.holder.is(":focus")&&(this.setSuggestValue(),!this.$.holder.hasClass("cs-opened"))){var a,b,c,d,e,f,g,h=$(this.$.holder.data("cs-container")||"body"),i=this.$.drop,j=this.$.holder.data("width")||this.config.dropWidth||this.$.holder.outerWidth();a=this.$.holder.offset(),b=a&&a.top||0,c=a&&a.left||0,a=h.offset(),d=a&&a.top||0,e=a&&a.left||0,this.$.holder.addClass("cs-opened"),f={top:b+this.$.holder.innerHeight()-d,left:c-e,width:j,zIndex:this.getMaxIndex()},h.find(i).length?i.css(f):(i.css(f).hide().find(".csbody").css({overflow:"hidden"}),h.append(i)),i.show(),g=this.config.maxDropElement*this.$.drop.find("li").height(),g&&(i.css({overflow:"",visibility:"hidden"}),i.defHeight||(i.defHeight=i.find(".csbody").height()),i.find(".csbody").css({maxHeight:g,overflow:"auto"}),i.css({visibility:"visible"})),this.initCustomScroll(),this.scrollUpdateTop()}},hideDrop:function(){this.$.holder.hasClass("cs-opened")&&(this.$.suggestInput.val(""),this.$.drop.hide(),this.$.holder.removeClass("cs-opened"))},keyboardControl:function(a){a||(a=window.event);var b,c=a.keyCode;switch(c){case 9:case 27:this.hideDrop();break;case 13:this.$.holder.hasClass("u-load")||(this.config.preventEnter&&this.$.holder.hasClass("cs-opened")&&a.preventDefault(),this.setHiddenValue(),this.$.holder.trigger("focusout",{fakeEvent:!0}));break;case 39:if(this.$.holder[0].selectionStart!=this.$.holder.val().length||!this.$.suggestInput.val())return;a.preventDefault(),this.$.holder.val(this.$.suggestInput.val()).trigger("input"),this.$.suggestInput.val("");break;case 40:case 38:a.preventDefault();var d=this.$.drop.find("li");b=d.index(d.filter(".selected")),40==c?b===d.length-1?b=0:b++:0===b?b=d.length-1:b--,d.removeClass("selected"),d.eq(b).addClass("selected"),this.scrollUpdateTop(),this.setSuggestValue()}},setHiddenValue:function(a){a&&a.length||(a=this.$.drop.find("li.selected a")),this.config.allowEmptySending&&""===this.$.holder.val()&&(this.setValue(""),this.$.holder.trigger("input",{fakeEvent:!0}),this.$.holder.trigger("change",{needChange:!0}),this.$.holder.trigger("focusout",{fakeEvent:!0}),this.$.hidden.change()),a&&a.length&&(this.setValue(a.data("drop-item-id"),a),this.$.holder.trigger("input",{fakeEvent:!0}),this.$.holder.trigger("change",{needChange:!0}),this.$.holder.trigger("focusout",{fakeEvent:!0}),this.$.holder.trigger("chose-item"),this.$.hidden.change()),this.hideDrop(),a.parents("li").hasClass("selected")||(this.$.drop.find("li").removeClass("selected"),a.parents("li").addClass("selected"))},setValue:function(a,b){var c,d;this.$.holder.data("verified",!0),b&&(c=b.data("drop-item-name"),d=b.data("drop-item-info")||{},c&&this.$.holder.val(c),this.$.hidden.data("info",d)),this.$.holder.data("prevVal",""),this.$.hidden.val(a)},setSuggestValue:function(){var a=this.$.drop.find("li.selected a"),b=a.data("drop-item-name");0===b.toLowerCase().indexOf(this.$.holder.val().toLowerCase())?this.$.suggestInput.val(this.$.holder.val()+b.substr(this.$.holder.val().length)):this.$.suggestInput.val("")},initCustomScroll:function(){this.customScroll||(this.customScroll=new mvideo.Class.ScrollCrossBrowser({holder:this.$.drop,settings:{scroller:".csbody"}}))},scrollUpdateTop:function(){var a=this.$.drop.find(".csbody"),b=a.height(),c=a.find(".selected"),d=c[0].offsetTop,e=c.height();d+e-b>a.scrollTop()?(a.find("a").css("transition","none"),a.scrollTop(d+e-b)):d<a.scrollTop()&&(a.find("a").css("transition","none"),a.scrollTop(d)),a.find("a").css("transition","")},getMaxIndex:function(){return parseInt($(".c-popup_active").css("zIndex")||1,10)+1},isDataEmpty:function(a){var b,c=!a;if(!c){b=Object.values(a),c=0===b.length;for(var d=0;d<b.length&&!(c=!b[d]||"object"==typeof b[d]&&0===Object.values(b[d]).length);d++);}return c}});a.define("AutocompleteSG",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function a(b,c){if(a.instance)return a.instance;a.instance=this,this.tplPath="common/jade/tpls/select/",this.config=$.extend(!0,{disableCustomClass:".disable-customize",tplSelect:this.tplPath+"select-area.tpl",tplOptions:this.tplPath+"options.tpl",tplDropBox:this.tplPath+"drop-box.tpl",tplDropBoxItems:this.tplPath+"drop-box-items.tpl",notFoundText:"Ничего не найдено.",selectDisabled:".disable-overlay",ajaxOverlay:"box-overlay",selectText:".center",selectBtn:".select-button",dropBox:".drop-box",maxDropHeight:275,maxDropElement:7,dropWidth:!1,mobileDevice:window.mvideo.device.manager.isItMobile()||!1},c||{}),this.$={},this.$.elements=this.add(b),this.initialize()},initialize:function(){var a=!!this.$.elements.length;return a&&($("body").addClass("custom-dropdown-inited"),this.initSelects(this.$.elements)),a},
reinit:function(a){var b=this;return this.removeDropdown(),a.each(function(){b.initSelect(b.destroySelect(this)),mvideo.Class.ReinitContent.gtmTracking($(this).next())}),this.active=null,this},removeDropdown:function(){$(this.config.dropBox).not(".drop-sg").each(function(){var a=$(this),b=a.attr("dropdown-id");$(".select-"+b).length||a.remove()})},destroy:function(a){var b=this;return a?a.each(function(){b.destroySelect(this)}):this.removeDropdown(),this},destroySelect:function(a){var b=$(a),c=b.attr("select-id");return b.removeClass("outta-here").removeClass("select-outta-here").removeClass("select-"+c).removeAttr("select-id"),b.parent().find(".custom-select-"+c).remove(),$(".drop-"+c).remove(),a},add:function(a){return $(a).filter("select").not(".outta-here").not(this.config.disableCustomClass)},initSelects:function(a){var b=this;return a.each(function(){b.initSelect(this)})},getDropHtml:function(a){var b={search:a.data("search")};return a.data("tplDropBox")&&(this.config.tplDropBox=this.tplPath+a.data("tplDropBox")+".tpl"),JST&&JST[this.config.tplDropBox]?JST[this.config.tplDropBox](b):""},initSelect:function(a){var b=$(a),c=Math.random().toString(10).substr(2,5),d=b.data("additional-classes"),e=b.data("btn-selector"),f=$.extend({htmlItem:b.data("html-item")},d),g=e?$(e):$(JST&&JST[this.config.tplSelect]?JST[this.config.tplSelect](f):""),h=g.find(this.config.selectBtn),i=g.find(this.config.selectText),j=g.find(this.config.selectDisabled),k=$(this.getDropHtml(b)),l=b.data("ga-btn-attr")||{},m=b.data("select-btn-attrs")||{};e||g.addClass(b.attr("class")),g.addClass("custom-select-"+c).data("$sText",i).data("$opener",h),h.attr(Object.assign(l,m)),j.hide(),k.addClass("drop-"+b.attr("class")).addClass("drop-"+c).attr("dropdown-id",c).data("$optList",k.find(".csbody")).data("$search",k.find(".cs-search")),b.attr("disabled")&&(g.hasClass("c-dropdown")?g.addClass("u-disabled"):g.addClass("disabled"),j.show()),b.data("$btn",g).data("$drop",k),this.bindEvents(a),b.addClass("outta-here").addClass("select-"+c).attr("select-id",c),e||b.after(g),this.renderLabel(b)},bindEvents:function(a){var b=this,c=$(a),d=c.data("$btn"),e=c.data("$drop"),f=e.data("$search"),g=d.data("$opener"),h=$(document),i=$("label[for="+c.attr("id")+"]"),j=$(".header-nav-list");i.off("click"),d.hover(d.addClass.bind(d,"cs-hover"),d.removeClass.bind(d,"cs-hover")),g.add(i).on("click",function(){return!c.attr("disabled")&&(d.hasClass("cs-opened")?b.hideDrop():(c.data("ajaxUrl")&&!c.data("loaded")?b.loadOptions(c.data("ajaxUrl"),"POST",null,c.parent(".select")).done(function(d){var e;d&&(e=JST&&JST[b.config.tplOptions]?JST[b.config.tplOptions](d):"",c.html(e),b.buildDrop(c)),b.showDrop(a),c.data("loaded",!0)}):b.showDrop(a),$.support.isMobile||c.focus()),!1)}),c.on("focus.select",function(){b.focused=this,d.addClass("cf-focus")}).on("change.select",function(a,c){a.originalEvent?(a.stopImmediatePropagation(),b.selectItem(this,$(this).data("selectedIndex"))):"renderLabel"===c&&b.renderLabel($(this))}).on("refresh.select",function(){b.buildDrop(this).selectItem(this,$(this).data("selectedIndex"))}).on("blur.select",function(){b.focused=null,d.removeClass("cf-focus"),h.off("keydown.select")}).off("keydown.select").on("keydown.select",this.keyboardControl.bind(this)),h.on("click.hide-drop",function(a){b.active&&!$(a.target).closest(".c-custom-scroll__track").length&&b.hideDrop()}).scroll(function(){if(b.active){if(b.config.mobileDevice&&document.activeElement.classList.contains("c-text-field__input"))return;b.hideDrop()}}),j.mouseenter(function(){b.active&&b.hideDrop()}),f&&f.on("click",function(a){a.stopPropagation()}).on("focus","input",function(){$(this).closest(".cs-search-body").addClass("focus")}).on("blur","input",function(){$(this).closest(".cs-search-body").removeClass("focus")}).on("submit",function(a){var d=$(a.currentTarget);return b.loadOptions(d.attr("action"),d.attr("method"),d.serialize(),f.find(".cs-search-body")).done(function(a){var d,e;a&&(d=c.find(":selected"),d.addClass("cs-ignore"),e=JST&&JST[b.config.tplOptions]?JST[b.config.tplOptions](a):"",c.html(e),c.append(d),b.buildDrop(c))}),!1}),mvideo.Event.subscribe("resize",this.hideDrop.bind(this)),mvideo.Event.subscribe("hide-drop",function(){b.active&&b.hideDrop()}),e.on("click","li",function(){var d=$(this),e=d.hasClass("selected");if(d.hasClass("disabled")||d.hasClass("cs-info")||e||(c.prop("multiple")?b.selectItem(a,d.data("index"),!1,!0):(b.selectItem(a,d.data("index")),b.hideDrop()),c.trigger("change")),d.hasClass("selected")&&b.hideDrop(),!c.data("redirectable")||d.hasClass("disabled")||e)return!1})},loadOptions:function(a,b,c,d){var e=d instanceof jQuery?d:$(d);return $.ajax({url:a,type:b||"POST",dataType:"json",data:c||"",beforeSend:function(){e.addClass(this.config.ajaxOverlay)}.bind(this),complete:function(){e.removeClass(this.config.ajaxOverlay)}.bind(this)})},buildDrop:function(a){var b,c=$(a),d=c.find('option:not(".cs-ignore")'),e=$.extend({htmlItem:c.data("html-item"),items:d.map(function(){var a=$(this);return{class:a.attr("class"),icon:a.data("icon"),innerHtml:a.data("innerHtml"),href:a.data("href"),text:a.text(),isSelected:!!a.prop("selected"),isDisabled:!!a.prop("disabled")}}),notFoundText:c.data("notFoundText")||this.config.notFoundText},c.data("additional-classes"));return b=JST&&JST[this.config.tplDropBoxItems]?JST[this.config.tplDropBoxItems](e):"",c.data("$drop").find(".csbody").html(b),this},selectItem:function(a,b,c,d){var e,f=$(a),g=f.find("option"),h=f.data("$drop").find("li"),i=this.skipDisabled(h,b,c);return f.data("selectedIndex",i),d||g.prop("selected",!1),e=g.eq(i),e.prop("selected",!e.prop("selected")),this.renderLabel(f)},skipDisabled:function(a,b,c){var d=a.eq(b),e=d.hasClass("disabled");return+(e?c?d.prev("li").not(".disabled").last().data("index")||a.not(".disabled").last().data("index"):d.next("li").not(".disabled").first().data("index")||a.not(".disabled").first().data("index"):b)},initCustomScroll:function(a,b){a.closest(".c-custom-scroll").length>0&&(this.customScroll=new mvideo.Class.ScrollCrossBrowser({holder:b,settings:{scroller:".csbody"}}))},showDrop:function(a){var b,c,d,e,f,g,h,i=$(a),j=$(i.data("cs-container")||"body"),k=i.data("$btn"),l=i.data("$drop"),m=i.data("cs-not-set-top"),n=i.data("with-top-offset"),o=i.data("position"),p=i.data("min-width")||"",q=i.data("width")||this.config.dropWidth||k.outerWidth();if(b=k.offset(),c=b&&b.top||0,d=b&&b.left||0,b=j.offset(),e=b&&b.top||0,f=b&&b.left||0,"right"===o&&(d+=k.innerWidth()-q),this.renderLabel(i),this.hideDrop(),this.active=a,k.addClass("cs-opened"),m&&(m=m.split(","),m=m.indexOf(mvideo.device.manager.getType())>-1),g={top:!m&&c+k.innerHeight()-e+(n?8:0),left:d-f,width:q,zIndex:i.parents(".c-popup").length?10000003:"","min-width":p},j.find(l).length?l.css(g):(this.buildDrop(a),l.css(g).hide().find(".csbody").css({overflow:"hidden"}),j.append(l),this.initCustomScroll(i,l)),"center"===o&&(b=k.offset(),d=b&&b.left||0,d+=k.innerWidth()/2-l.width()/2,l.css({left:d})),l.css({overflow:"",visibility:"hidden"}).show(),h=i.data("max-height")||i.hasClass("c-dropdown")&&this.config.maxDropElement*l.find("li").height()||this.config.maxDropHeight,l.defHeight||(l.defHeight=l.find(".csbody").height()),(l.defHeight>h||"auto"==h)&&l.find(".csbody").css({maxHeight:h,overflow:"auto"}),l.css({visibility:"visible"}),this.scrollUpdateTop(l.find(".csbody")),this.customScroll&&(this.customScroll.checkScroll(),this.customScroll.disablePageScroll()),i.data("sel")){var r=l.find("li > a");r.each(function(a){r.eq(a).attr("data-sel",i.data("sel")+"-"+a)})}},hideDrop:function(){var a;this.active&&(a=$(this.active),a.data("$drop").hide(),a.data("$btn").removeClass("cs-opened"),this.active=null)},keyboardControl:function(a){a||(a=window.event);var b,c,d=this.active||this.focused,e=$(d),f=a.keyCode;switch(f){case 9:case 27:case 16:this.hideDrop();break;case 13:a.preventDefault(),this.active?(this.selectItem(d,e.data("selectedIndex")),e.attr("multiple")||this.hideDrop(),e.trigger("change")):this.showDrop(d);break;case 40:case 38:a.preventDefault(),b=e.find("option"),c=b.index(b.filter(":checked").first()),40==f?(c===b.length-1?c=0:c++,this.selectItem(d,c,!1)):(0===c?c=b.length-1:c--,this.selectItem(d,c,!0)),this.updateDrop(e),this.scrollUpdateTop(e.data("$drop").find(".csbody"));break;default:this.showDrop(d)}},scrollUpdateTop:function(a){var b=a.height(),c=a.find(".selected"),d=c.length?c[0].offsetTop:0;a.scrollTop(d+44-b)},updateDrop:function(a){var b=a.data("$btn"),c=a.data("$drop"),d=a.data("width")||this.config.dropWidth||b.outerWidth();c.css("width",d),this.customScroll&&this.customScroll.resize()},renderLabel:function(a){var b,c,d,e=a.data("$btn").data("$sText"),f=a.data("$drop").find("li"),g=a.find("option"),h=g.filter(":checked");return f.removeClass("selected"),h.each(function(){f.eq(g.index(this)).addClass("selected")}),a.attr("multiple")?(b=a.data("label")||"",h.length&&(b+=" ("+h.length+")")):h.length?(c=h.data("icon")||"",d=h.data("innerHtml")||"",c&&(c='<i class="'+c+'"></i>'),b=c+h.text()+d):b=a.data("label")||"",e.html(b),this}});a.define("CustomSelect",a)}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function a(){if(a.instance)return a.instance;a.instance=this,mvideo.observer(this),this.config={threshold:-30,attr:"data-original",placeholder:"/assets/img/fancybox/blank.gif",wrapper:'<div class="lazy-load-image-holder"/>',altMessageTpl:'<span class="lazy-image-alt"><span class="lazy-image-alt-text">{{=alt}}<span><span>',selectors:{images:".lazy:not(.lazy-manual)"},srcsetAttr:"srcset"},this.$={},this.$.holder=$(window),this.loadObjects(),this.initialize(),this.renderAltMessage=mvideo.helpers.render(this.config.altMessageTpl),this.bindEvents()},add:function(a){a=$(a);var b=this.$.images;return this.loadObjects(a),this.$.images=this.$.images.add(b),this},initialize:function(){var a=this.config.placeholder,b=this.config.wrapper;return this.$.images.each(function(c,d){d=$(d);var e=d.attr("src");e&&e!==a||(d.parent(".lazy-load-image-holder").length||d.wrap(b),d.attr("src",a))}),this},handleSrc:function(a){a=$(a);var b=this,c=a.attr(this.config.attr),d=a.parent(".lazy-load-image-holder").removeClass("lazy-loaded"),e=a.data(this.config.srcsetAttr);if(""===a.attr("data-original")){var f=b.renderAltMessage({alt:a.attr("alt")});d.addClass("lazy-load-error").append(f)}if(e)return a.attr(this.config.srcsetAttr,e),this.loadImage(a,c,d),this;if(c){var g=new Image;$(g).one("load",function(){b.loadImage(a,c,d)}).one("error",function(){var c=b.renderAltMessage({alt:a.attr("alt")});d.addClass("lazy-load-error").append(c),a.trigger("error")}),g.src=c}return this},loadImage:function(a,b,c){a.attr("src",b),c.addClass("lazy-loaded"),a.trigger("loaded")},update:function(){var a=this,b=this.$.images.filter(":visible").filter(function(){var b=mvideo.helpers.inViewport(this,a.config.threshold);return b&&a.handleSrc(this),b});return a.$.images=a.$.images.not(b),this},bindEvents:function(){mvideo.Event.subscribe("scroll device updateImages",this.update.bind(this))}}).define("LazyLoad")}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function a(b){if(a.instance)return a.instance;a.instance=this,this.config={selectors:{blocks:".lazy-content"},cookie:{value:"deviceType",expires:365,path:"/"}},$.extend(!0,this.config,b||{}),this.$={},this.loadObjects(),this.initialize()},initialize:function(){this.bindEvents()},add:function(a){var b,c=this.$.blocks;return this.loadObjects(a),b=this.$.blocks.length,this.$.blocks=this.$.blocks.add(c),b},loadContent:function(a,b){if(!b.url)return void console.log("LazyLoadContent ERROR: require url");$.ajax({type:b.method||"GET",url:b.url,dataType:"html",xhrFields:{withCredentials:!0},data:b.data||null,success:function(c){"string"==typeof c&&c.trim().length?(a.append(c),mvideo.Class.ReinitContent.reinit(a),a.trigger("LazyLoadContent",{status:"success"})):(console.log("LazyLoadContent ERROR: received data is empty",b.url),a.hide(),a.trigger("LazyLoadContent",{status:"error"}))}.bind(this),error:function(){console.log("LazyLoadContent ERROR: data load error"),a.trigger("LazyLoadContent",{status:"error"})}})},updateBlocks:function(){this.$.blocks=this.$.blocks.filter(function(a,b){var c,d=$(b);return!(d.is(":empty:visible")&&(c=d.data("loadParams"),"load"===c.event||"show"===c.event&&mvideo.helpers.inViewport(d)))||(c.sentCookies&&c.sentCookies.length&&(c.data=this.getCookies(c.sentCookies)),this.loadContent(d,c),!1)}.bind(this))},updateCookieValue:function(a){$.cookie(this.config.cookie.value,a,{expires:this.config.cookie.expires,path:this.config.cookie.path})},bindEvents:function(){mvideo.Event.subscribe("device",function(a,b){this.updateCookieValue(b),this.updateBlocks()}.bind(this)),mvideo.Event.subscribe("scroll",this.updateBlocks.bind(this))},getCookies:function(a){var b={};return a.forEach(function(a){b[a]=$.cookie(a)}),b}}).define("LazyLoadContent")}(),function(){"use strict";var a=null,b=null,c=!1;mvideo.Class.Class.extend({constructor:function(a){this.config={holder:".lazy-wrapper",css_to_trig:".lazy-content:nth-last-child(2)",limit:4,offset:0,its_a_last:"js-lazy-last",url_to_load:null,method:"GET",server_keys:{offset:"lazy_offset",limit:"lazy_limit"}},$.extend(!0,this.config,a||{}),this.$={},this.$.holder=$(this.config.holder),this.initialize()},initialize:function(){return a=this.update.bind(this),b=this.config.offset,this.bindEvents(),this.update(),this},isVisible:function(){var a=$(this.config.css_to_trig,this.$.holder);return a.is(":visible")&&mvideo.helpers.inViewport(a)},isLast:function(){return this.$.holder.children().hasClass(this.config.its_a_last)},stopHandling:function(){mvideo.Event.unsubscribe("scroll device",a)},addContent:function(a){return $(a).appendTo(this.$.holder)},loadContent:function(a,d){if(c)return!1;var e=this;if(!a)return console.log("ERROR: url is empty"),this;var f={};return f[this.config.server_keys.offset]=b,f[this.config.server_keys.limit]=this.config.limit,c=!0,$.ajax({type:d,url:a,dataType:"HTML",data:f,success:function(a){if(a){var d=e.addContent(a);mvideo.Class.ReinitContent.reinit($(d)),e.isLast()?e.stopHandling():(b+=e.config.limit,c=!1)}else a="",console.log("ERROR: received data is empty"),e.stopHandling()},error:function(){console.log("ERROR: data load error")}}),this},update:function(){return this.isVisible()?this.loadContent(this.config.url_to_load,this.config.method):this},bindEvents:function(){mvideo.Event.subscribe("scroll device",a)}}).define("LoadMoreContent")}(),function(){"use strict";function a(a){return{module:a,handler:function(){var b=arguments.length>0?Array.prototype.slice.call(arguments):[],c=b.shift();if(c&&a[c])return a[c].apply(a,b)}}}var b=mvideo.Class.Class.extend({constructor:function(){this.config={locked:!1,disabled:!1},this.modules=[],this._callbacks=$.Callbacks()},add:function(b){if(this.locked())return this;var c=a(b);return this._callbacks.add(c.handler),this.modules.push(c),this},remove:function(a){if(this.locked())return this;var b=this.modules,c=this._callbacks;return $.each(this.modules,function(d,e){e.module==a&&(b.splice(d,1),c.remove(e.handler))}),this},has:function(a){var b=!1;return $.each(this.modules,function(c,d){d.module==a&&(b=!0)}),b},run:function(){return this.disabled()?this:(this._callbacks.fire.apply(null,arguments),this)},callWith:function(a){return this.disabled()?this:(this._callbacks.fireWith.apply(a,arguments),this)},enable:function(){return this.config.disabled=!1,this},disable:function(){return this.config.disabled=!0,this},disabled:function(){return!!this.config.disabled},empty:function(){return this.locked()?this:(this._callbacks.empty(),this.modules=[],this)},lock:function(){return this.config.lock=!0,this},unlock:function(){return this.config.lock=!1,this},locked:function(){return!!this.config.locked}});b.define("ModulesCollection",b)}(),function(a){"use strict";var b=a.Class.Class.extend({constructor:function(a,b){this.config=$.extend(!0,{notificationParams:{closed:!1,smallText:!1},tpl:"common/jade/tpls/notifications.tpl",successParams:{iconStyle:"ok",iconColor:"green",textColor:"green"},errorParams:{iconStyle:"error",iconColor:"red",textColor:"red"},infoParams:{iconStyle:"info"},initClearHolder:!1},b||{}),this.$={},this.$.holder=a instanceof jQuery?a:$(a),this.config.initClearHolder&&this.$.holder.html("")},_create:function(a){var b,c=this.config[a.type+"Params"];if(!(a.text&&a.type&&c))return window.console.warn("Notification: check type and text"),null;b=$.extend(!0,this.config.notificationParams,{notificationMessages:[{title:a.text}]},c,a.newParams),this.$.el=$(JST[this.config.tpl]({params:b}))},generate:function(a){if(null!==this._create(a))return this.$.el[0].outerHTML},add:function(b){null!==this._create(b)&&(this.$.holder.append(this.$.el),a.Class.ReinitContent.reinit(this.$.holder))},close:function(){this.$.el&&this.$.el.remove(),this.$.holder.trigger("notification-toggled")},replace:function(b){null!==this._create(b)&&(this.$.holder.html(this.$.el),a.Class.ReinitContent.reinit(this.$.holder),this.$.holder.trigger("notification-toggled"))}});b.define("Notification",b)}(window.mvideo),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={selectors:{opener:".opener",closer:".closer",opencloseBlock:".open-close-block"},onOpen:null,onClose:null,doCloserNeed:!1,isAnimated:!0,changeText:"",classCollapsed:"closed",classExpanded:"active",preventDefault:!0},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.loadObjects(a)},initialize:function(){this.lazyLoad=new mvideo.Class.LazyLoad,this.isState(this.config.classExpanded)||this.addCollapsedClass(),this.bindEvents()},destroy:function(){this.removeCollapsedClass(),this.unbindEvents()},addCollapsedClass:function(){this.$.holder.addClass(this.config.classCollapsed)},removeCollapsedClass:function(){this.$.holder.removeClass(this.config.classCollapsed)},changeTxt:function(){if(0!==this.config.changeText.length){var a=this.$.opener.eq(0).html(),b=this;b.$.opener.each(function(){$(this).html(b.config.changeText)}),b.config.changeText=a}},openBlock:function(){this.changeTxt(),this.config.isAnimated&&this.animation("slideDown",this.$.holder),this.removeCollapsedClass(),$.isFunction(this.config.onOpen)&&this.config.onOpen()},closeBlock:function(){this.changeTxt(),this.config.isAnimated&&this.animation("slideUp",this.$.holder),this.addCollapsedClass(),$.isFunction(this.config.onClose)&&this.config.onClose()},animation:function(a,b){this.$.opencloseBlock[a](function(){mvideo.Event.publish("openClose."+a,b)})},bindEvents:function(){this.unbindEvents();var a=this,b=a.config;this.$.holder.on("click",this.config.selectors.opener+", "+this.config.selectors.closer,function(c){a.config.preventDefault&&c.preventDefault(),a.isState(b.classCollapsed)?(a.openBlock(),a.lazyLoad.update(),b.doCloserNeed&&(a.$.holder.find(b.selectors.opener).hide(),a.$.holder.find(b.selectors.closer).show())):(a.closeBlock(),b.doCloserNeed&&(a.$.holder.find(b.selectors.opener).show(),a.$.holder.find(b.selectors.closer).hide()))})},unbindEvents:function(){this.$.holder.off("click",this.config.selectors.opener+", "+this.config.selectors.closer),this.$.opencloseBlock.removeAttr("style")}});a.include(mvideo.Mixin.state),a.define("OpenClose",a)}(),function(){"use strict";var a=mvideo.Class.OpenClose.extend({initialize:function(){this.lazyLoad=new mvideo.Class.LazyLoadContent,this.lazyLoad.update=this.lazyLoad.updateBlocks,this.isState(this.config.classExpanded)||this.addCollapsedClass(),this.bindEvents()}});a.define("OpenCloseContent",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b,c){var d={};"object"!=typeof a||a instanceof jQuery||a instanceof HTMLElement||(d=a,a=d.holder||this),this.config=$.extend(!0,{holder:a,holderOpacity:b||!1,overlayClasses:c||"",hideText:!1,target:"[data-overlay-target]"},d),this.$={},this.$.holder=$(this.config.holder)},_create:function(a,b){var c=$('<div class="ajax-overlay '+this.config.overlayClasses+'">');return this.config.holderOpacity&&c.css("background","none"),b?c.appendTo(a):c.appendTo($("body")),this.add(a,c)},show:function(a,b,c){a=a||this.$.holder;var d=this.getOrCreate(a,b);return this._setPosition(a,d,b),d.show(),this.config.holderOpacity&&a.css("opacity",.5),c&&d.addClass("ajax-overlay_show ajax-overlay_without-animate"),this.config.hideText?a.find(this.config.target).addClass("u-color-transparent"):setTimeout(function(){d.addClass("ajax-overlay_show")}),d},hide:function(a){a=a||this.$.holder;var b=this.get(a);this.config.holderOpacity&&a.css("opacity",1),b&&(a.is("input")&&a.css("opacity","1"),this.config.hideText&&a.find(this.config.target).removeClass("u-color-transparent"),b.removeClass("ajax-overlay_show").hide())},getOrCreate:function(a,b){var c=this.get(a);return c&&c.parent().length||(c=this._create(a,b)),c},get:function(a){return $.data(a[0],"overlay")},add:function(a,b){return $.data(a[0],"overlay",b)},_setPosition:function(a,b,c){var d;return c?(a.css("position","relative"),d={top:0,left:0,right:0,bottom:0}):(d=a.offset(),$.extend(d,{width:a.outerWidth(),height:a.outerHeight()})),a.is("input")&&(a.css("opacity","0.5"),b.css("background","transparent")),b.css(d),this}});a.define("Overlay",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={},mvideo.observer(this),this.$={},this.$.holder=$(a),this.$.pageSlider=$("html,body"),this.initialize(),this.bindEvents()},initialize:function(){this.lazyLoad=new mvideo.Class.LazyLoad,this.lazyLoadContent=new mvideo.Class.LazyLoadContent,this.sidebar=new mvideo.Class.BarHandler(this.$.holder,{param:"left",selectors:{bar:".sidebar"}}),this.topbar=new mvideo.Class.BarHandler(this.$.holder,{param:"padding-top",selectors:{bar:".header-top-info"}});var a=new mvideo.Class.BarItem(".header-slideup");this.message=new mvideo.Class.BarMessage(a),this.topbar.controller.register(a),this.sidebar.controller.register(a),this.validationForms={}},goTo:function(a,b){if(a=a||0,$(window).scrollTop()===a&&window.pageYOffset===a)return this;this.$.pageSlider.animate({scrollTop:a},b)},goToBlock:function(a,b,c){if(b=void 0!==b?b:0,a=a instanceof jQuery?a:$(a),!a.length)return this;var d=a.offset().top,e=mvideo.instance.stickyHeader,f=e?e.item.getHeight():0;return this.goTo(d+b-f,c)},bindEvents:function(){var a=this;a.message.subscribe("remove",function(b,c){a.sidebar.hide(c.bar),a.topbar.hide(c.bar)})}});a.define("Page",a)}(),function(a){"use strict";var b=a.Class.Class.extend({constructor:function(b,c){this.config={activeClass:"c-popup_active",template:a.template.popup({affix:!1,selector:".c-popup"}),contentClass:"c-popup__content",closeBtnClass:"c-popup__close",additionalCloseButton:"",bodyNoScrollClass:"u-no-scroll",removeTimeout:300,contentAsHTML:!1,color:!1,title:"",functionFormat:!1,ajaxUrl:!1,ajaxForForm:!1,classes:[],backgroundColor:"",fontColor:"",namespace:"c-popup",seleniumAttribute:"",seleniumAttributeClose:"",needShow:!1,useDefaultContent:!1,selectContent:null,trigger:"click",functionClose:!1,hideParent:!1,clearContentBeforeHide:!1},this.$={},b&&(this.$.holder=b instanceof jQuery?b:$(b),this.config.title=this.$.holder.attr("title")||this.$.holder.data("title"),this.$.holder.attr("title",null)),$.extend(!0,this.config,c||{}),this.$.template=$(this.config.template),this.hasContent=this.config.title||this.config.functionFormat||this.config.ajaxUrl||this.config.ajaxForForm||this.config.useDefaultContent,(this.config.ajaxUrl||this.config.ajaxForForm)&&(this.config.clearContentBeforeHide=!0),this.colorConverter=a.helpers.colorConverter(),this.wasMouseDown=!1,this.popupManager=new a.Class.PopupManager,this.initialize()},initialize:function(){if(this.hasContent){if(this.overlay=new a.Class.Overlay(this.$.template.find("."+this.config.contentClass)),this.$.holder){var b=this;this.config.trigger&&this.$.holder.on(this.config.trigger+".popup",function(){return b.show(),!1})}if(this.config.color&&this.$.template.addClass("c-popup_"+this.config.color),this.config.classes)for(var c in this.config.classes)this.$.template.addClass("c-popup_"+this.config.classes[c]);this.config.title&&this._setContent(this.config.title),this.config.seleniumAttribute&&this.$.template.find("."+this.config.contentClass).attr("data-sel",this.config.seleniumAttribute),this.config.seleniumAttributeClose&&this.$.template.find("."+this.config.closeBtnClass).attr("data-sel",this.config.seleniumAttributeClose),this._setBackground(),this._setFontColor(),this.$.holder&&this.$.holder.data("popupGa")&&this.setGA(this.$.holder.data("popupGa")),this.config.needShow&&this.show()}},_setContent:function(b,c){var d="."+this.config.contentClass;this.config.contentAsHTML?(this.$.template.find(d).html(b),c&&a.Class.ReinitContent.reinit(this.$.template)):this.$.template.find(d).text(b)},_setBackground:function(){this.config.backgroundColor&&this.$.template.find(".c-popup__block").css("background-color",this.config.backgroundColor)},getContentCurrentPopup:function(){return this.$.template},_setFontColor:function(){if(this.config.fontColor){var a=this.colorConverter.invertColor({sourceColor:this.config.backgroundColor,lightColor:"c-btn_close-invert",darkColor:"c-btn_close"});this.$.template.find(".c-popup__content").css("color",this.config.fontColor).find("a").css("color",this.config.fontColor).addClass("c-link_hover-red"),this.$.template.find(".c-btn_close").addClass(a)}},_show:function(b){this.popupParent=this.popupManager.showPopup(this),this.$.template.appendTo("body"),this.$.template.data("popup-instance",this);var c=this;this.bindEvents(),setTimeout(function(){c.$.template.addClass(c.config.activeClass),c.$.template.find('[data-action="popup-show"]').trigger("popup-show")}),b&&c.config.contentAsHTML&&a.Class.ReinitContent.reinit(c.$.template)},bindEvents:function(){var b=this;this.$.template.on("mousedown",function(a){b.wasMouseDown=a.target==b.$.template[0]}),this.$.template.on("click",function(a){a.target==b.$.template[0]&&b.wasMouseDown&&b.hide(a),b.wasMouseDown=!1}),this.$.template.find('[data-close="true"]').on("click",function(a){a.preventDefault(),b.hide(a)}),this.config.additionalCloseButton&&this.$.template.on("click.additional-close-popup",this.config.additionalCloseButton,this.hide.bind(this)),this.$.template.on("scroll",function(){a.Class.LazyLoad().update()})},findSelectContent:function(){var a=this.config.selectContent?document.querySelector(this.config.selectContent):this.$.holder&&this.$.holder[0]&&this.$.holder[0].querySelector(".c-popup-content");if(this.contentCache=!this.config.clearContentBeforeHide,null===a)return window.console.warn("element "+this.config.selectContent+" not found"),this.hide(),void(this.hasContent=!1);this._setContent(a.innerHTML)},show:function(){if(this.hasContent){var b=this;if(this.config.useDefaultContent&&!this.contentCache&&this.findSelectContent(),this.config.functionFormat&&this._setContent(this.config.functionFormat(this.config.title,this)),this.config.ajaxUrl)b._setContent(this.config.title||""),b._show(),this.overlay.show(),$.get(this.config.ajaxUrl).then(function(a){setTimeout(function(){b.isShown()&&b.overlay.hide(),b._setContent(a,!0)})});else if(this.config.ajaxForForm){var c=this.$.holder.parents("form");b._setContent(this.config.title||""),b._show(),this.overlay.show(),$.ajax({type:c.attr("method")||"post",url:c.attr("action"),dataType:"html",data:c.serialize(),success:function(c){setTimeout(function(){b.isShown()&&b.overlay.hide();var d=null;try{d=JSON.parse(c)}catch(a){}b._setContent(d&&d.htmlContent?d.htmlContent:c,!0),a.Event.publish(b.config.namespace+".ajaxForForm")})},error:function(){setTimeout(function(){b.isShown()&&b.overlay.hide(),b._setContent("Произошла ошибка, повторите запрос позже"),a.Event.publish(b.config.namespace+".ajaxForForm.error"),b.$.holder.trigger(b.config.namespace+".ajaxForForm.error")})}})}else this._show(!0);return this.config.functionReady&&this.config.functionReady(this.config.title),this}},hide:function(b){if(this.hasContent){this.popupManager.hidePopup(this.popupParent),this.$.template.removeClass(this.config.activeClass);var c=this;return this.config.removeTimeout>-1&&setTimeout(function(){c.config.clearContentBeforeHide&&(c.$.template.find("."+c.config.contentClass).empty(),c.overlay.hide(),c.config.title&&c._setContent(c.config.title)),c.$.template.remove()},c.config.removeTimeout),this.$.template.find('[data-action="popup-hide"]').trigger("popup-hide"),a.Event.publish("close."+c.config.namespace),this.unbindEvents(),this.config.functionClose&&this.config.functionClose(b),this.config.hideParent&&null!==this.popupParent&&this.popupParent.hide(),this}},unbindEvents:function(){this.$.template.off("click.additional-close-popup")},isShown:function(){return this.$.template.hasClass(this.config.activeClass)},goTo:function(a,b){var c=a||"."+this.config.contentClass,d=$(c).offset().top,e=b||0;$("."+this.config.namespace).animate({scrollTop:d+e})},setGA:function(a){"object"==typeof a?a.btnClose&&this.$.template.find(".c-btn_close").attr(a.btnClose):window.console.log("Html element popup data-popup-Ga must have object")},destroy:function(){this.$.holder&&this.$.holder.off(this.config.trigger+".popup"),this.isShown()&&this.hide()},overlayShow:function(a){a&&this.overlay.show()||this.overlay.hide()}});b.define("Popup",b)}(window.mvideo),function(a){"use strict";var b=a.Class.Popup.extend({constructor:function(a,b){this.config={popupConfig:{ajaxUrl:null,contentAsHTML:!0,title:"Пожалуйста, повторите попытку позже",classes:["tooltip","title-relative","pr-32"],additionalCloseButton:".u_close_popup",trigger:null}},$.extend(!0,this.config,b||{}),this.$={},this.$.holder=a instanceof jQuery?a:$(a),this.template=window.mvideo.template.popupError,this.constructor.__super__.constructor.call(this,this.$.holder,this.config.popupConfig)},prepareContent:function(a){return this.template({data:a})},setContent:function(a,b){var c=this.prepareContent(a);this._setContent(c,b)}});b.define("ErrorPopup",b)}(window.mvideo),function(a){"use strict";a.Class.Class.extend({constructor:function(){var b=this;b.initialize(),a.Class.PopupManager=function(){return b},b.constructor=a.Class.PopupManager},initialize:function(){this.$={},this.$.body=$("body"),this.noScrollClass="u-no-scroll",this.countOfOpenPopups=0,this.isIOS=window.mvideo.device.manager.isItMobile("iOS"),this.topPopup=null},showPopup:function(a,b){var c=this.topPopup;return this.topPopup=a,0===this.countOfOpenPopups&&(b=b||this.noScrollClass,this.isIOS&&this._setStyleForIOS(b),this.$.body.addClass(b),this.bindEvents()),this.countOfOpenPopups+=1,c},_setStyleForIOS:function(a){this.prevPageYOffset=window.pageYOffset,this.prevPagePosition=this.$.body.css("position")||"",this.$.body.css({position:"fixed",marginTop:-this.prevPageYOffset,height:"calc(100% + "+this.prevPageYOffset+"px)",bottom:0,left:0,right:0}),this.$.sidebar=this.$.body.find(".navigation"),this.$.sidebar.addClass(a)},hidePopup:function(a,b){this.topPopup=a,this.countOfOpenPopups-=1,this.countOfOpenPopups<=0&&(this.countOfOpenPopups=0,b=b||this.noScrollClass,this.$.body.removeClass(b),this.isIOS&&this._resetStyleForIOS(b),this.unbindEvents())},_resetStyleForIOS:function(a){this.$.sidebar&&this.$.sidebar.removeClass(a),this.$.body.css({position:this.prevPagePosition,marginTop:"",height:"",bottom:"",left:"",right:""}),$(document).scrollTop(this.prevPageYOffset)},bindEvents:function(){var a=this;$(window).on("keydown.popup-manager",function(b){27===b.keyCode&&a.topPopup.hide()})},unbindEvents:function(){$(window).off("keydown.popup-manager")}}).define("PopupManager")}(window.mvideo),function(){"use strict";mvideo.Class.Class.extend({},{reinit:function(a){return a=a instanceof jQuery?a:$(a),$.each(a,function(){var a=$(this);mvideo.Class.ReinitContent.customSelect(a),mvideo.Class.ReinitContent.lazyLoad(a),mvideo.Class.ReinitContent.lazyLoadContent(a),mvideo.Class.ReinitContent.scripts(a),
mvideo.Class.ReinitContent.gtmTracking(a)}),a.find(".disabled-until-scripts-loaded").addBack().removeClass("disabled-until-scripts-loaded"),a},customSelect:function(a){var b=new mvideo.Class.CustomSelect;b.destroy(a.find("select")),b.initSelects(a.find("select"))},lazyLoad:function(a){var b=new mvideo.Class.LazyLoad;b.add(a),b.update()},lazyLoadContent:function(a){var b=new mvideo.Class.LazyLoadContent;b.add(a)&&b.updateBlocks()},gtmTracking:function(a){a.find("[data-pushable='true']").each(function(){var a=$(this);mvideo.Module._items.GTMEventsEnableTracking(a),"load"===a.data("action")&&a.trigger("load")})},scripts:function(a){mvideo.initScripts(a,{afterInit:function(a,b,c,d,e){if(e&&!a)return void window.console.warn("module = undefined in ReinitContent");if(e){var f=mvideo.device.manager.getType();a[f+"Behavior"]&&a[f+"Behavior"](f)}}})}}).define("ReinitContent")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={holder:this,scrollbarTopPad:4,templateScrollBar:'<div class="c-custom-scroll__track"><div class="c-custom-scroll__control c-custom-scroll__up">▲</div><div class="c-custom-scroll__free"><div class="c-custom-scroll__bar"></div></div><div class="c-custom-scroll__control c-custom-scroll__down">▼</div></div>',settings:{scroller:".c-custom-scroll__scroller",bar:".c-custom-scroll__bar",track:".c-custom-scroll__track"}},$.extend(!0,this.config,a||{}),this.$={},this.$.holder=$(this.config.holder),this.$.scrollBar=$(this.config.templateScrollBar),this.$.holder.append(this.$.scrollBar),this.$.scroller=this.$.holder.find(this.config.settings.scroller),this.$.scrollerAPI=this.$.holder.baron(this.config.settings),this.$.holder.on("scroll-destroy",this.destroy.bind(this))},checkScroll:function(){this.$.scrollBar.css({top:this.$.scroller.length?this.$.scroller.position().top+this.config.scrollbarTopPad:0})},disablePageScroll:function(){var a=this.$.holder,b=this.$.holder.find(this.config.settings.bar),c=this.$.holder.find(this.config.settings.track);a.bind("mousewheel",function(a){var d=a.deltaY||a.originalEvent.wheelDelta||a.originalEvent.detail,e=b.innerHeight()+b.position().top;return 0!==b.innerHeight()&&(!(d>0&&0===b.position().top)&&!(d<0&&c.height()-e<=0))})},resize:function(){this.$.scroller.trigger("resize")},destroy:function(){this.$.scrollerAPI.dispose(),this.$.scrollBar.remove(),this.$.holder.off("scroll-destroy")}});a.define("ScrollCrossBrowser",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={visible:!1,param:"left",selectors:{bar:".sidebar"},overlayClass:"sidebar-page-overlay",noScrollClass:"u-no-scroll_sidebar"},mvideo.observer(this),$.extend(!0,this.config,b),this.$={},this.$.holder=$(a),this.loadObjects(this.$.holder),this.$.body=$("body"),this.initialize()},initialize:function(){this.controller=new mvideo.Class.InfoAreaController(this.config.selectors.bar),this.initOverlay(),this.bindEvents()},initOverlay:function(){var a;this.$.overlay=this.$.holder.find("."+this.config.overlayClass),0===this.$.overlay.length&&(a='<div class="'+this.config.overlayClass+'"></div>',this.$.overlay=$(a),this.$.holder.append(this.$.overlay))},bindEvents:function(){this.$.bar.swipe({swipeLeft:function(a){mvideo.Event.publish("sidebar-close",a)}}),this.$.overlay.swipe({swipeLeft:function(a){mvideo.Event.publish("sidebar-close",a)}}),this.$.overlay.off("click").on("click",function(a){mvideo.Event.publish("sidebar-close",a)}),window.mvideo.device.manager.isItMobile("iOS")&&this.$.overlay.off("touchmove").on("touchmove",function(a){a.preventDefault()})},getWidth:function(a){return a?this.$.bar.width()/this.$.bar.parent().width()*100:this.$.bar.width()},getHeight:function(a){return a?this.$.bar.height()/this.$.bar.parent().height()*100:this.$.bar.height()},updateWidth:function(a){return a?(this.$.bar.width(a).css({left:-a}),this.jump(this.isVisible()?a:0),this):this},updateHeight:function(a){return a?(this.$.bar.height(a).css({top:-a}),this.jump(this.isVisible()?a:0),this):this},show:function(a){var b=this["left"===this.config.param?"getWidth":"getHeight"](!1);return this.controller.show(a),this.showOverlay(),this._animate(b)},hide:function(a){var b=this;return a.isVisible()?(mvideo.Event.publish("hide-drop"),this._animate(0).done(function(){b.hideOverlay(),b.controller.hide(a)})):jQuery.Deferred().resolve()},hideOverlay:function(){this.$.overlay.hide(),this.$.body.removeClass(this.config.noScrollClass)},showOverlay:function(){this.$.overlay.show(),this.$.body.addClass(this.config.noScrollClass)},isVisible:function(){return this.config.visible},jump:function(a){return this._go(a,"css")},_go:function(a,b,c){c=c||this.config.param,a=a||0;var d,e=this,f={};return f[c]=a,d=this.$.holder[b](f).promise(),d.done(function(){e.config.visible=parseFloat(a)>0})},_animate:function(a,b){return this._go(a,"transition",b)}});a.define("BarHandler",a)}(),function(){"use strict";var a=mvideo.Class.ModulesCollection,b=a.extend({constructor:function(a,b){this.config={clone:!1},$.extend(!0,this.config,b||{}),this.$={},a=$(a),this.$.holder=this.config.clone?a.clone():a},isVisible:function(){return this.$.holder.is(":visible")},show:function(){return this.$.holder.show(),this},hide:function(){return this.$.holder.hide(),this}});b.define("BarItem",b)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={hidden:!1,defaultMethod:"prepend",routes:{desktop:{target:".header-top-info"},tablet:{target:".sidebar"},mobile:{target:".sidebar"}}},mvideo.observer(this),$.extend(!0,this.config,b||{}),this.$={},this.bar=a,this.$.holder=a.$.holder,this.bindEvents()},isAvailable:function(){return!this.config.hidden&&this.$.holder.length},remove:function(){return this.config.hidden=!0,this.publish("remove",this),this},bindEvents:function(){var a=this;a.$.holder.one("click",".btn-close-message",function(b){b.preventDefault(),a.remove()})}});a.include(mvideo.Mixin.domTraveler),a.define("BarMessage",a)}(),function(){"use strict";var a=mvideo.Class.ModulesCollection,b=a.prototype,c=a.extend({constructor:function(b,c){this.config={initScripts:!1},$.extend(!0,this.config,c||{}),mvideo.observer(this),a.apply(this,arguments),this.$={},this.$.holder=$(b)},_insert:function(a,b){b=b||"append",this.$.holder[b](a.$.holder)},register:function(a,c){return c=c||this.config.initScripts,b.add.call(this,a),mvideo.removeDisabledJSClass(),c&&mvideo.initScripts(a.$.holder),this},unregister:function(a){return b.remove.call(this,a),a.$.remove(),this},isVisible:function(a){return a.isVisible()},show:function(a){return this.hideAll(),a.$.holder.appendTo(this.$.holder),a.show(),this},hide:function(a){return a.hide(),this},hideAll:function(){return this.run("hide"),this}});c.define("InfoAreaController",c)}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function a(b){if(a.instance)return a.instance;a.instance=this,this.config={desktopOffset:b&&b.desktopOffset||-200,tabletOffset:b&&b.tabletOffset||-110,mobileOffset:b&&b.mobileOffset||-65}},getOffset:function(){var a,b=mvideo.instance.stickyHeader,c=b?b.item.getHeight():0;switch(mvideo.device.manager.getType()){case"desktop":a=this.config.desktopOffset;break;case"tablet":a=this.config.tabletOffset;break;case"mobile":a=this.config.mobileOffset}return a+c},scrollToBlock:function(a){mvideo.instance.page.page.goToBlock(a,this.getOffset())},focusIn:function(a){a.focus()},focusBlock:function(a,b){var c=$(a),d="input:first"===b?c.find("input:first"):$(b);c&&c.length&&c.is(":visible")&&this.scrollToBlock(c),d&&d.length&&d.is(":visible")&&this.focusIn(d)}}).define("SmartFocus")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={activeClass:"active",states:["state-active","state-inactive"]},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){}});a.include(mvideo.Mixin.showHide,mvideo.Mixin.state),a.define("StateContainer",a)}(),function(){var a=mvideo.Class.Class.extend({constructor:function(a,b){b=void 0!==b?b:{},this.config={selectors:{transformer:b.transformer,svg:b.svgSelector,controllerHolder:b.controllerHolder,controller:b.controller}},this.settings={scale:null,translate:null},this.$={},this.$.holder=$(a),mvideo.observer(this),this.loadObjects(a),this.init(b)},setScale:function(a){return this.settings.scale.value=Math.max(Math.min(a,this.settings.scale.max),this.settings.scale.min),this.updateTransform(),this._publishEvent("scale",{value:a}),this},changeScale:function(a){return this.setScale(this.settings.scale.value+this.settings.scale.step*(a?1:-1)),this},changeTranslate:function(a,b,c,d){return c?(this.settings.translate.values[0]=a/this.settings.scale.value,this.settings.translate.values[1]=b/this.settings.scale.value):(this.settings.translate.values[0]+=a/this.settings.scale.value,this.settings.translate.values[1]+=b/this.settings.scale.value),this.updateTransform(),d?this:(this._publishEvent("move",{dx:a,dy:b,isAbsolute:!!c}),this)},changeTransform:function(a){var b,c;return a.scale&&this.setScale(a.scale.value),a.translate&&(b=+a.translate[0]||0,c=+a.translate[1]||0,this.changeTranslate(b,c,!0)),this},updateTransform:function(){var a=this.$.holder[0].getBoundingClientRect(),b=["translate("+a.width/2+" "+a.height/2+")","scale("+this.settings.scale.value+")","translate("+-a.width/2+" "+-a.height/2+")","translate("+this.settings.translate.values.join(" ")+")"].join(" ");return this.$.transformer.attr("transform",b),this},init:function(a){return a=a||{},a.scale=a.scale||{},a.translate=a.translate||[],this.settings.scale={step:a.scale.step||.05,min:a.scale.min||.5,max:a.scale.max||1.5,value:a.scale.value||1},this.settings.translate={values:[a.translate[0]||0,a.translate[1]||0]},this.bindEvents(),this.updateTransform()},bindEvents:function(){function a(){$(this).off("mousemove touchmove")}var b=this;return this.$.svg.on("mousedown touchstart",function(a){var c,d,e,f="touchstart"===a.type,g=!0,h=0;f?(c=a.originalEvent.changedTouches[0],g=1===a.originalEvent.touches.length):c=a,d=c.clientX,e=c.clientY,g?$(this).on(f?"touchmove":"mousemove",function(a){a.preventDefault();var c;c=f?a.originalEvent.changedTouches[0]:a,b.changeTranslate(c.clientX-d,c.clientY-e),d=c.clientX,e=c.clientY}):(a.preventDefault(),$(this).off("touchmove"),h=b._calculateDistance(a.originalEvent.touches[0],a.originalEvent.touches[1]),$(this).on("touchmove",function(a){var c=b._calculateDistance(a.originalEvent.touches[0],a.originalEvent.touches[1]);Math.abs(c-h)>50&&(b.changeScale(c>h),h=c)}))}).on("mouseup",a).on("touchend",a).on("mouseleave",a).on("mousewheel",function(a){a.preventDefault(),b.changeScale(a.deltaY>0)}),this.$.controllerHolder.on("click",this.config.selectors.controller,function(a){a.preventDefault(),b.changeScale($(this).hasClass("controllers-plus"))}),this},_publishEvent:function(a,b){return this.publish("changeTransform",{settings:this.settings,name:a,attr:b}),this},_calculateDistance:function(a,b){var c=a.clientX,d=a.clientY,e=b.clientX,f=b.clientY;return Math.sqrt(Math.pow(e-c,2)+Math.pow(f-d,2))}});a.define("svgScaleAndMove",a)}(),function(){"use strict";function a(b,c){var d=b.cloneNode(!0),e=0,f=document.createDocumentFragment(),g=b.childNodes,h=g.length,i=0;for("number"!=typeof c&&(c=parseFloat(c));i<h;i++){var j=g[i],k=3===j.nodeType?$(document.createTextNode(j.nodeValue)):$(j),l=k.text().trim().length;if(c<=e)break;if(c>=e+l)f.appendChild(k.clone()[0]),e+=l;else{if(!k.children().length){var m=k[0].cloneNode(!0),n=k.text().trim().split(/\s+/),o=k.text().trim().slice(0,c-e).trim().split(/\s+/),p=o.slice(0,o.length-1).join(" "),q=n[o.length-1],r=/[;:\/.,!?-]+$/g,s=q.match(r);p=p+" "+q.split(s)[0],3===m.nodeType?m.nodeValue=p:m.innerHTML=p,f.appendChild(m),e+=p.length;break}f.appendChild(a(k[0],c-e))}}return d.innerHTML="",d.appendChild(f),d}var b=mvideo.Class.Class.extend({constructor:function(a,b){this.config={maxLength:400,wrapper:{className:"text-cutter-wrapper"}},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){this._wrapText(),this.$element=this.$.holder.find("."+this.config.wrapper.className),this.data=this.$element.html(),this.text=this.$element.text().trim(),this.config.showLengthTablet?this.dataToShowTablet=this.getDataToShow(this.config.showLengthTablet):(this.dataToShow=this.getDataToShow(),this.hideText())},isTextHidden:function(){return this.data.length>this.$element.html().length},getTextLengthWithoutLastWord:function(){return this.text.length-this.text.split(" ").pop().length},hasExtraText:function(){var a;return a="mobile"==mvideo.device.manager.getType()?this.config.maxLength:this.config.maxLengthTablet,this.getTextLengthWithoutLastWord()>a},hideText:function(){return this.hasExtraText()?(this.$element.html(this.dataToShow),this):this},showText:function(){return this.hasExtraText()?(this.$element.html(this.data),this):this},toggleText:function(){return this.isTextHidden()?this.showText():this.hideText()},getDataToShow:function(b){return a(this.$element[0],b||this.config.maxLength).innerHTML},enable:function(){return this.hideText(),this},disable:function(){return this.showText(),this},_wrapText:function(){var a=$("<span>",{class:this.config.wrapper.className});return this.$.holder.wrapInner(a),this}});b.define("BasicTextCutter",b)}(),function(){"use strict";var a=mvideo.Class.BasicTextCutter.extend({constructor:function(a,b){this.constructor.__super__.constructor.apply(this,arguments)},initialize:function(){if(this.constructor.__super__.initialize.call(this),!this.hasExtraText())return this;this.ellipsis=new mvideo.Class.DynamicTextElement(this.$.holder,"append",{attributes:{html:"…"}})},enable:function(){return this.hideText(),this.ellipsis&&this.ellipsis.show(),this},disable:function(){return this.showText(),this.ellipsis&&this.ellipsis.hide(),this}});mvideo.Class.Class.define("TextCutterEllipsis",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({makeTextCutter:function(a){var b;switch($.trim(a)){case"link":b=mvideo.Class.TextCutterWithLink;break;case"ellipsis":b=mvideo.Class.TextCutterEllipsis;break;default:b=mvideo.Class.BasicTextCutter}return b}});a.define("TextCutterFactory",a)}(),function(){"use strict";var a=mvideo.Class.BasicTextCutter.extend({constructor:function(a,b){b.titleWithLink=b.titleWithLink||"читать далее",this.constructor.__super__.constructor.apply(this,arguments)},initialize:function(){if(this.constructor.__super__.initialize.call(this),!this.hasExtraText())return this;this.initializeReloadlink()},initializeReloadlink:function(){this.link=new mvideo.Class.DynamicTextElement(this.$.holder,"append",{tag:"a",attributes:{class:"text-cutter-link",href:"#"},text:{show:this.config.titleWithLink,hide:"Скрыть"}}),this.link.changeText("show"),this._bindEvents()},isTextHidden:function(){return this.text.length>this.$element.text().trim().replace("…","").length},toggleText:function(){return this.isTextHidden()?(this.link&&this.link.changeText("hide"),this.showText()):(this.link&&this.link.changeText("show"),this.hideText()),this},enable:function(){return this.hideText(),this.link&&(this.link.changeText("show"),this.link.show()),this},reloadlink:function(){if(this.config.maxLengthTablet&&this.config.showLengthTablet){var a='<span class="text-cutter-with-link-ellipsis">… </span>',b=this.getTextLengthWithoutLastWord();"mobile"!=mvideo.device.manager.getType()?(this.dataToShow=this.dataToShowTablet,b>this.config.maxLengthTablet&&(this.dataToShow+=a),this.config.maxLengthTablet>b&&this.$.holder.find(this.config.selectorWithLink).length>0&&(this.$.holder.find(this.config.selectorWithLink).remove(),this.link="")):(this.dataToShow=this.getDataToShow(this.config.maxLength),b>this.config.maxLength&&(this.$.holder.find(".text-cutter-with-link-ellipsis").remove(),this.dataToShow+=a),b>this.config.maxLength&&!this.$.holder.find(this.config.selectorWithLink).length&&this.initializeReloadlink())}},disable:function(){return this.showText(),this.link&&(this.link.changeText("hide"),this.link.hide()),this},_bindEvents:function(){var a=this;this.link.$.el.on("click",function(b){b.preventDefault(),a.toggleText()})}});mvideo.Class.Class.define("TextCutterWithLink",a)}(),function(a){"use strict";$.tooltipster._env.hasTouchCapability=!1;var b=a.Class.Class.extend({constructor:function(a,b){this.config={trigger:"hover",side:"top",contentAsHTML:!1,large:!1,color:!1,title:"",functionFormat:!1,functionReady:!1,classes:[],triggerOpen:!1,triggerClose:!1,withoutMobilePopup:!1,backgroundColor:"",backgroundImage:"",fontColor:"",parent:".page-content",closable:!0,withMobileTooltip:!1,zIndex:1e3,arrow:!0,topOffset:-2,popupConfig:{classes:["tooltip"]},useDefaultContent:null,hardReposition:!1,touchstartClose:!0,clearContentBeforeHide:!1},$.extend(!0,this.config,b||{}),this.$={},this.$.holder=a instanceof jQuery?a:$(a),this.config.useDefaultContent?this.config.title=$(".c-content-tooltip",this.$.holder).html():this.$.holder.data("title")?this.config.title=this.$.holder.data("title"):this.$.holder.attr("title")&&(this.config.title=this.$.holder.attr("title"),this.$.holder.attr("data-title",this.config.title)),this.onDevice=this._changeDevice.bind(this),this.initialize(),this.bindEvents()},initialize:function(){if(this.config.title||this.config.functionFormat){this.colorConverter=a.helpers.colorConverter();var b=this;if(this.device=a.device.manager.getType(),this.config.withoutMobilePopup||this.device!==a.device.manager.TYPES.MOBILE){("click"==this.config.trigger||this.config.triggerOpen&&this.config.triggerOpen.click)&&this.$.holder.on("click.tooltip",function(a){a.preventDefault(),a.stopPropagation(),$(".tooltipstered").tooltipster("close")});var c=[];if(this.config.classes)for(var d in this.config.classes)c.push("tooltipster-sidetip-"+this.config.classes[d]);this.config.color&&c.push("tooltipster-sidetip-"+this.config.color),this.config.large&&c.push("tooltipster-sidetip-large");var e=$(this.config.parent);if(e.length&&this.$.holder.parents(e).length||(e=$("body"),this.config.parent="body"),this.config.prepend){var f=$("<div></div>");e.prepend(f),e=f}new a.Class.TooltipHandler(e),this.tooltip=this.$.holder.tooltipster({debug:!1,trackOrigin:!0,parent:e,content:this.config.title,contentAsHTML:this.config.contentAsHTML,interactive:!0,side:this.config.side||"top",trigger:this.config.trigger||"hover",triggerOpen:this.config.triggerOpen,triggerClose:this.config.triggerClose,distance:0,delay:this.device===a.device.manager.TYPES.DESKTOP?300:100,theme:c,zIndex:this.config.zIndex,arrow:this.config.arrow,functionPosition:function(a,c,d){var e=b.config.topOffset,f=$(b.config.parent);return f.length&&(e-=f.offset().top),b.config.hardReposition&&d.coord.top<f.offset().top&&"bottom"!==d.side?(d.coord.top+=b.config.topOffset+d.size.height+b.$.holder.outerHeight()-f.offset().top,d.side="bottom"):d.coord.top+=e,b.config.functionPosition&&b.config.functionPosition(a,c,d),d},functionAfter:this.config.functionAfter,functionFormat:function(a,c){var d=b.config.sel&&b.config.sel.closeBtn?'data-sel="'+b.config.sel.closeBtn+'"':"",e=b.config.sel&&b.config.sel.box?b.config.sel.box:"",f=$('<span class="tooltipster-close c-btn_close с-btn_white font-icon icon-delete" data-close="true" '+d+"></span>");return b.config.closable||f.addClass("hidden"),e&&a._$tooltip.find(".tooltipster-box").attr("data-sel",e),a._$tooltip.find(".tooltipster-box").prepend(f),b.config.backgroundImage&&a._$tooltip.find(".tooltipster-box").prepend($('<img class="tooltipster-bg-img" src="'+b.config.backgroundImage+'"></div>')),b.config.backgroundColor&&a._$tooltip.find(".tooltipster-box").css("background-color",b.config.backgroundColor),b.config.functionFormat?b.config.functionFormat(b.config.title):a.__Content},functionReady:function(c){if(b.config.backgroundColor&&c._$tooltip.find(".tooltipster-arrow-background, .tooltipster-arrow-border").css("border-"+c.__lastPosition.side+"-color",b.config.backgroundColor),b.config.fontColor){var d=b.colorConverter.invertColor({sourceColor:b.config.backgroundColor,lightColor:"c-btn_close-invert",darkColor:"c-btn_close"});c._$tooltip.find(".tooltipster-content").css("color",b.config.fontColor).find("a").css("color",b.config.fontColor).addClass("c-link_hover-red"),c._$tooltip.find(".tooltipster-close").addClass(d)}return c._$tooltip.find('[data-close="true"]').on("click",function(a){a.preventDefault(),c._close()}),c._$tooltip.off("tooltip-reposition").on("tooltip-reposition",function(){b.reposition()}),a.Class.ReinitContent.reinit(c._$tooltip.find(".tooltipster-content")),b.config.functionReady?b.config.functionReady(b.config.title):c.__Content}}),a.Event.subscribe("resize."+this.tooltip.__namespace,function(){b.tooltip&&b.$.holder.data("tooltipster-ns")&&!b.$.holder.is(":visible")&&"closed"!=b.tooltip.tooltipster("status").state&&b.tooltip.tooltipster("close")})}else{var g=this.$.holder;"custom"!=this.config.trigger||this.config.triggerOpen||(g=!1),this.config.popupConfig.classes=this.config.classes.concat(this.config.popupConfig.classes),this.config.popupConfig=$.extend(!0,{contentAsHTML:this.config.contentAsHTML,title:this.config.title,functionFormat:this.config.functionFormat,functionReady:this.config.functionReady,backgroundColor:this.config.backgroundColor,fontColor:this.config.fontColor,seleniumAttribute:this.config.sel&&this.config.sel.box?this.config.sel.box:"",seleniumAttributeClose:this.config.sel&&this.config.sel.closeBtn?this.config.sel.closeBtn:"",functionClose:this.config.functionAfter,clearContentBeforeHide:this.config.clearContentBeforeHide},this.config.popupConfig),this.popup=new a.Class.Popup(g,this.config.popupConfig)}}},bindEvents:function(){var b=this;a.Event.subscribe("device",this.onDevice),this.$.holder.on("tooltip-destroy",function(){return b.destroy(),!1})},_changeDevice:function(b,c){this.device==c||this.device!==a.device.manager.TYPES.MOBILE&&c!==a.device.manager.TYPES.MOBILE||this.config.withMobileTooltip||(this.destroy(),this.initialize(),this.bindEvents())},show:function(){this.popup&&this.popup.show(),this.tooltip&&this.tooltip.tooltipster("open")},hide:function(){this.popup&&this.popup.isShown()&&this.popup.hide(),this.tooltip&&this.tooltip.tooltipster("close")},isShown:function(){if(this.popup)return this.$.template.hasClass(this.config.activeClass);if(this.tooltip){return this.tooltip.tooltipster("status").open}},destroy:function(){if(this.$.holder.off("click.tooltip"),this.$.holder.off("tooltip-destroy"),a.Event.unsubscribe("device",this.onDevice),this.popup&&(this.popup.destroy(),this.popup=!1),this.tooltip){if(a.Event.unsubscribe("resize."+this.tooltip.__namespace),this.$.holder.parents("body").length)try{this.tooltip.tooltipster("destroy")}catch(a){}this.tooltip=!1}},reposition:function(){this.tooltip&&this.tooltip.tooltipster("reposition")}});b.define("Tooltip",b)}(window.mvideo),function(){"use strict";window.mvideo.Class.Class.extend({constructor:function a(b){if(a.instance)return a.instance;a.instance=this,this.initialize(b)},initialize:function(a){var b=this;window.mvideo.device.manager.isItMobile("iOS")&&a.on("touchstart",function(a){b.closePopup(a)})},closePopup:function(a){var b=$(".tooltipster-show");if(b.length>0&&0===b.has(a.target).length){$(".tooltipstered").data("tooltip-custom-close")||$(".tooltipstered").tooltipster("close")}}}).define("TooltipHandler")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){"object"==typeof a&&(b=a,a=b.tplName||""),this.config=$.extend(!0,{tplName:a,tplUrl:null,_exampleJavascriptUrl:$('[src*="/mvid.js"]').attr("src")},b||{}),this.config.tplUrl=this._generateUrlToTpl(),this._tplRender=$.noop},load:function(a){return $.getScript(a||this.config.tplUrl).then(this.setRender.bind(this,null))},setRender:function(a){return"function"==typeof a&&(this._tplRender=a),this},render:function(a){return this._tplRender(a)},isLoaded:function(){return this._tplRender!==$.noop},_generateUrlToTpl:function(a){a=a||this.config.tplName;var b=/(?:[^\/]+)$/;return this.config._exampleJavascriptUrl.replace(b,"tpl/"+a+".js")}});a.define("AbstractTplLoader",a)}(),function(){"use strict";var a=mvideo.Class.AbstractTplLoader.extend({setRender:function(a){return this.constructor.__super__.setRender.call(this,a||JST&&JST[this.config.tplName])}});a.define("JadeTplLoader",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={readyClass:"height-ready",needRecalc:!1,allInOneRow:!1,selectors:{items:"",wrapper:""},initialized:!1,alignMax:!1,defaultHeight:"auto"},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{})},initialize:function(a){if(!a&&this.config.initialized)return this;this.loadObjects(this.$.holder);var b=this.getRows(),c=this;return $.each(b,function(a,b){c.storeNormalizedParam(b)}),c.config.initialized=!0,this.$.items.addClass(this.config.readyClass),this},reinit:function(){this.resetParam(),this.initialize(!0),this.setNormalizedParam()},setNormalizedParam:function(){var a=this;return this.$.items.each(function(){var b=$(this),c=$.data(this,"normzlizedParamVal"),d={};if($.data(this,"normalizedCSS")&&!a.config.needRecalc)return b.css($.data(this,"normalizedCSS"));a.config.alignMax?d.height=c:d.height=parseInt(b.height(),10)+c-b.outerHeight(!0),b.css(d),$.data(this,"normalizedCSS",d)}),this},resetParam:function(){var a={};return a.height=this.config.defaultHeight,this.$.items.css(a),this},storeNormalizedParam:function(a){var b=this.getRowParam(a);return a.each(function(){$.data(this,"normzlizedParamVal",b)}),this},getRows:function(){var a,b=[],c=this.$.items,d=c.length,e=this.config.allInOneRow?d:this.getRowsQty(),f=$("");for(a=0;a<d;a++)a>0&&a%e==0&&(b.push(f),f=$("")),f=f.add(c.eq(a));return b.push(f),b},getRowParam:function(a){var b=0;return a.each(function(){var a=$(this),c=a.outerHeight(!0);b<c&&(b=c)}),b},getRowsQty:function(){var a=this,b=this.$.holder.width(),c=this.$.items.eq(0).width();if(a.config.selectors.wrapper){var d=this.$.wrapper.eq(0).outerWidth(!0);b+=d-c,c=d}return Math.floor(b/c)}});a.define("VerticalIndentEqualizer",a)}(),function(a){a.Class.Class.extend({constructor:function(a,b,c){this.functionClose=this.eventPopupClose.bind(this),this.config=$.extend(!0,{eventBus:"update-confirmation",eventDone:"done",eventError:"error",eventCancel:"cancel",popupConfig:{contentAsHTML:!0,title:"...",functionClose:this.functionClose,trigger:"popup-uo",classes:["full-mobile","with-title"]}},b),this.holder=a instanceof jQuery?a:$(a),this.bus=c,this.popup=null;var d=this;this.holder.on(this.config.eventDone,function(a,b){b.savePopup||d.popup.hide(),d.eventPush({status:"success"===b.status?d.config.eventDone:d.config.eventError,notification:b.notification&&b.notification,isSmsConfirmation:b.isSmsConfirmation,state:b.state,fullData:b})})},begin:function(a){this.showPopup('<div data-init="controller-confirmation-additional"><div class="wrapper-form">'+a+"</div></div>")},showPopup:function(b,c){this.popup||(this.popup=new a.Class.Popup(this.holder,this.config.popupConfig)),this.popup._setContent(b,c),!this.popup.isShown()&&this.popup.show()},eventPush:function(a){this.bus(this.config.eventBus,a)},eventPopupClose:function(){this.eventPush({status:this.config.eventCancel})}}).define("ClassConfirmation")}(window.mvideo),function(a){"use strict";a.Class.Class.extend({constructor:function(a,b){this.config=$.extend(!0,{filterTab:".c-pseudo-tabs__item",galleryContent:".gallery-content",gallery:".accessories-carousel-holder",galleryList:".accessories-product-list",opinionsOpener:".c-review_cluster",cluster:".o-review-cluster",opinions:".o-review-opinions",tooltipOffset:-1,data:{clusterId:"cluster-id"},countInTile:2,negativeType:"neg",clustersUrl:"",opinionUrl:""},b),this.$={},this.$.holder=$(a)},_getClusters:function(){$.ajax({url:this.config.clustersUrl,method:"get",dataType:"json",success:this._successClusterHandler.bind(this),error:this._errorClusterHandler.bind(this)})},_successClusterHandler:function(b){b.carouselTpl&&b.clusters&&0!==b.clusters.length||this._errorClusterHandler(),this.carouselTpl=b.carouselTpl,this.clusters=b.clusters,this.$.carouselBlock=$(this.carouselTpl),this.$.galleryContent=this.$.carouselBlock.find(this.config.galleryContent),this.$.gallery=this.$.galleryContent.find(this.config.gallery),this._createCarousel(this.clusters),this._setFilter(),this.$.holder.html(this.$.carouselBlock),a.Class.ReinitContent.reinit(this.$.carouselBlock)},_errorClusterHandler:function(){window.console.warn("ReviewAggregationManager: clusters or template are not loaded"),this.$.holder.hide()},_createCarousel:function(b){for(var c=[],d=0,e=0,f=this.$.gallery.clone(),g=f.find(this.config.galleryList);d<b.length;){e=d+this.config.countInTile;var h=$(a.template.reviewTile({clusters:b.slice(d,e),negType:this.config.negativeType}));c.push(h),d=e}g.append(c),this._bindEvents(g),this.$.galleryContent.html(f)},_setFilter:function(){var b=this,c=this.$.carouselBlock.find(this.config.filterTab);c.length&&c.on("click",function(c){c.preventDefault();var d,e=$(this),f=e.data("type");d=f?$.grep(b.clusters,function(a){return a.type===f}):b.clusters,b._createCarousel(d),a.Class.ReinitContent.reinit(b.$.galleryContent)})},showBlock:function(){this._getClusters()},_bindEvents:function(a){var b=this;a.off("click",this.config.opinionsOpener).on("click",this.config.opinionsOpener,function(a){var c=$(this);a.preventDefault(),b.initTooltip(c.parents(b.config.cluster),c)})},initTooltip:function(b,c){var d,e,f,g=b.is(":first-of-type"),h=$('<div data-sel="pdp-cluster-opened"></div>'),i=b.clone(),j=this,k=["review-cluster","large"],l=b.data(this.config.data.clusterId),m=$.grep(j.clusters,function(a){return a.id===l})[0];g&&k.push("review-cluster_first"),i.find(this.config.opinionsOpener).attr("data-pushable","false"),h.append(i),h.append(a.template.reviewOpinions({params:{method:"GET",url:this.config.opinionUrl,data:l},count:m.similarCount})),d=new a.Class.Tooltip(c,{contentAsHTML:!0,arrow:!1,trigger:"click",large:!0,side:["bottom"],topOffset:0,classes:k,popupConfig:{classes:["large","with-button","affix"],template:a.template.popup({affix:!0,selector:".c-popup"})},functionPosition:function(a,c,d){return d.coord.top-=b.outerHeight(),g&&(d.coord.top+=j.config.tooltipOffset),d.coord.left=b.offset().left+j.config.tooltipOffset,d},functionFormat:function(b,c){var g,i;return f=h.clone(),g=f.find(j.config.cluster),i=f.find(j.config.opinions),i.one("load-content.always",function(){d.reposition()}),c&&g.attr({"data-init":"affix","data-init-param":'{"targetSelector": ".c-popup","topAffixOffset": -0.05,"offsetContentSelector": ".c-popup__content"}'}),a.Event.subscribe("resize",e=function(){g.trigger("resize")}),f},functionReady:function(){var a,b,c,d,e,g,h;a=f.parent(".tooltipster-content"),0!==a.length&&(b=f.find(j.config.cluster),c=f.find(j.config.opinions),d=parseInt(a.css("maxHeight"),10),e=a.outerHeight()-a.height(),g=b.outerHeight(),h=d-e-g,c.css("maxHeight",h))},functionAfter:function(){a.Event.unsubscribe("resize",e)}}),this.tooltip=d,d.show()}}).define("AggregatedReviewsManager")}(window.mvideo),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a){this.config={format:"json",selectors:{}},this.$={},this.process=$.Deferred().resolve(),$.extend(!0,this.config,a||{}),this.loadObjects()},_cachedRequest:function a(b,c,d,e){var f,g=JSON.stringify(Array.prototype.slice.call(arguments,0,3));return a.cache||(a.cache={}),g in a.cache?a.cache[g]:(f=this._request(b,c,d,e),f.done(function(){a.cache[g]=f}),f)},state:function(){return this.process?this.process.state():null},get:function(a,b,c,d){var e,f,g=this._getAdditionalParams();return $.extend(!0,b,g),e=this[d?"_request":"_cachedRequest"]("get",a,b),f=e.abort,e=e.then(c),e.abort=f,e},_request:function(a,b,c,d){var e=$.ajax({url:b,type:a,dataType:this.config.format,data:c}),f=e.abort.bind(e);return d&&(e=e.then(d),e.abort=f),this.process=e,e},
_highlightText:function(a,b){return b=mvideo.Mixin.regExp.escapeStr(b),a.replace(new RegExp("("+b+")","ig"),"<strong>$1</strong>")},_getAdditionalParams:function(){var a={};for(var b in this.$)a[b]=this.$[b].val();return a}}).define("AbstractAjaxController")}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a){this.config={url:"",itemsHolder:"",item:"",activeClass:"",blockHolder:""},$.extend(!0,this.config,a),this.constructor.__super__.constructor.call(this,this.config)},getData:function(a){var b=this.config.url,c={getBlock:a},d=this,e=function(a){d.showBlockContent(a),mvideo.Class.ReinitContent.reinit(d.config.blockHolder)};return $.get(b,c,e)},setActiveItem:function(a){var b=$(this.config.item),c=this.config.activeClass,d=$(a),e=d.closest(b),f=d.attr("href"),g=d.html(),h=$("<span>").html(g).attr("data-url",f);d.after(h),d.remove(),e.addClass(c)},unsetActiveItem:function(){var a=$(this.config.itemsHolder),b=$(this.config.item),c=this.config.activeClass,d=a.find("."+c).find("span"),e=d.data("url"),f=d.html(),g=$("<a>").html(f).attr("href",e);d.after(g),d.remove(),b.removeClass(c),this.bindClick(g)},bindClick:function(a){var b=this;a.on("click",function(){var c=a.attr("href").split("#")[1];b.getData(c),b.unsetActiveItem(),b.setActiveItem(a)})},showBlockContent:function(a){$(this.config.blockHolder).html(a)},init:function(){var a=$(this.config.item).find("a"),b=this;$.each(a,function(){b.bindClick($(this))})}}).define("AjaxLoadedBlocks")}(),function(){"use strict";mvideo.Class.AbstractAjaxController.extend({constructor:function(a){this.config={url:"/myaccount/gadgets/city.json.jsp"},$.extend(!0,this.config,a),this.constructor.__super__.constructor.call(this,this.config)},getData:function(a){a=a.split(",")[0];var b=this,c=this.config.url,d={nameStartsWith:a},e=function(c){return[{subtitle:"Выберите ваш город",items:b._composeItemsList(c&&c.cities||[],a)}]};return this.get(c,d,e)},checkData:function(a){a=a.split(",")[0];var b=this.config.url,c={nameStartsWith:a},d=function(b){var c=b&&b.cities||[],d=[];return!(!c||!c.length)&&(d=$.grep(c,function(b){return b.name.toLowerCase()===a.toLowerCase()}),d.length>0)};return this.get(b,c,d)},getItemId:function(a){var b=this.config.url,c={nameStartsWith:a},d=function(a){return a&&a.cities&&a.cities[0]?a.cities[0].id:null};return this.get(b,c,d)},_composeItemsList:function(a,b){var c=this;return $.map(a,function(a){return{text:c._highlightText(a.label,b),inputValue:a.name,url:a.url}})}}).define("CitiesAjaxController")}(),function(){var a=null;mvideo.Class.AbstractAjaxController.extend({constructor:function(b){a=new mvideo.Class.SearchAjaxController,this.config={url:"/sitebuilder/blocks/search/search.json.jsp",defaultImgSrc:"/assets/img/no_image_auto_suggest.gif"},$.extend(!0,this.config,b||{}),this.constructor.__super__.constructor.call(this,this.config)},getData:function(b){var c=this,d=this.config.url,e={Ntt:b+"*",N:0,Ntk:"All",Nty:1,includePath:"/services/dimensionsearch"},f=function(a){if(null!==a&&void 0!==a)switch(a["@type"]){case"detectum":if($.isArray(a.results))return[{subtitle:"",items:a.results.map(function(a){return{text:c._highlightText(a,b),inputValue:a}})}];break;default:return g(a)}},g=function(c){return!c||c.dimensionSearchResults["@error"]?[]:(c=c.dimensionSearchResults.dimensionSearchGroups,c=$.map(c,function(c){if("product.display"===c.displayName||"category"==c.displayName||"brand"==c.displayName)return{subtitle:a._translate(c.displayName),type:c.displayName.replace(".","-"),items:a._composeItemsList(c.dimensionSearchValues,b,c.displayName)}}))};return this.get(d,e,f)}}).define("DetectumAjaxController")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={selectors:{overlayHolder:"",notificationHolder:""},notificationConfig:{initClearHolder:!0,errorParams:{iconStyle:"error",iconColor:"orange",textColor:""}},defaultError:"Сервис временно недоступен, попробуйте позже",needOverlay:!0,needPopup:!1},this.$={},this.$.holder=a instanceof jQuery?a:$(a),this.$.link=$("<a href='' class='u-hidden'></a>"),this.$.body=$("body"),this.$.form=this.$.holder.is("form")?this.$.holder:this.$.holder.find("form"),$.extend(!0,this.config,b||{}),this.loadObjects(this.$.holder),this.initialize()},initialize:function(){this.config.needOverlay&&(this.config.overlayClasses=this.config.overlayClasses?" "+this.config.overlayClasses:"",this.$.overlayHolder.html(""),this.overlay=new mvideo.Class.Overlay(this.$.overlayHolder,null,"ajax-overlay_transparent ajax-overlay_css "+this.config.overlayClasses)),this.config.needPopup&&(this.errorPopup=new mvideo.Class.ErrorPopup(this.$.body)),this.notification=new mvideo.Class.Notification(this.$.notificationHolder,this.config.notificationConfig),this.fileURL="",this.isLoading=!1,this.bindEvents()},bindEvents:function(){this.$.form.submit(this.sendForm.bind(this))},sendForm:function(){if(!this.isLoading){this.notification.close();var a=new XMLHttpRequest,b=this.$.form.attr("action"),c=this.$.form.attr("method"),d=this.$.form.serialize(),e=this;this.config.needOverlay&&this.overlay.show(null,!0),this.isLoading=!0,a.onreadystatechange=function(){if(4==a.readyState){if(200==a.status){var b=a.getResponseHeader("Content-Type"),c=e.config.fileName||decodeURIComponent(e.getFileName(a.getResponseHeader("Content-Disposition")));e.successHandler(a.response,b,c)}else e.errorHandler(a);e.completeHandler()}else 2==a.readyState&&(200==a.status?a.responseType="blob":a.responseType="text")},a.open(c,b,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(d)}return!1},successHandler:function(a,b,c){var d=new Blob([a],{type:b});if(null!=a&&navigator.msSaveBlob)return navigator.msSaveBlob(d,c);var e=window.URL||window.webkitURL,f=this;this.fileURL=e.createObjectURL(d),this.$.link.attr("href",this.fileURL),this.$.link.attr("download",c),this.$.body.append(this.$.link),this.$.link[0].click(),this.$.link.remove(),setTimeout(function(){e.revokeObjectURL(f.fileURL)},500)},completeHandler:function(){this.config.needOverlay&&this.overlay.hide(),this.isLoading=!1},errorHandler:function(a){var b=a.responseText,c=a.status;this.showError(b&&c<500?b:this.config.defaultError)},showError:function(a){this.config.needPopup?this.showPopupWithError(a):this.showNotification(a)},showNotification:function(a){this.notification.replace({type:"error",text:a}),this.$.notificationHolder.trigger("tooltip-reposition")},showPopupWithError:function(a){var b=this.notification.generate({type:"error",text:a});this.errorPopup.setContent({contentAsHTML:!0,message:b}),this.errorPopup.show()},getFileName:function(a){return a.match(/filename="(.*)"/)[1]}});a.define("DownloadFileAjax",a)}(),function(){"use strict";mvideo.Class.AbstractAjaxController.extend({constructor:function a(b){if(a.instance)return a.instance;a.instance=this,this.constructor.__super__.constructor.call(this,{})},getData:function(a){var b;a=$.extend(!0,{data:"",url:"",beforeSend:"",fail:"",done:"",always:"",noCacheData:""},a),a.beforeSend&&a.beforeSend(),b=function(b){b?a.done&&a.done(b):a.fail&&a.fail(),a.always&&a.always()},this.get(a.url,a.data,b)},clearCache:function(a,b){var c=JSON.stringify(["get",a,b]);delete this._cachedRequest.cache[c]}}).define("LoadCacheController")}(),function(){"use strict";mvideo.Class.AbstractAjaxController.extend({constructor:function(a){this.config={url:"/sitebuilder/blocks/search/search.json.jsp",productUrl:"/products/seo-<subject.repositoryId>/",defaultImgSrc:"/assets/img/no_image_auto_suggest.gif",dictionary:{brand:"Бренды",category:"Категории","product.category":"Категории продуктов","product.display":"Продукты"}},$.extend(!0,this.config,a||{}),this.constructor.__super__.constructor.call(this,this.config)},getData:function(a){var b=this,c=this.config.url,d={N:0,Ntk:"All",Ntt:a+"*",Nty:1,includePath:"/services/dimensionsearch"},e=function(c){return!c||c.dimensionSearchResults["@error"]?[]:(c=c.dimensionSearchResults.dimensionSearchGroups,c=$.map(c,function(c){if("product.display"===c.displayName||"category"==c.displayName||"brand"==c.displayName)return{subtitle:b._translate(c.displayName),type:c.displayName.replace(".","-"),items:b._composeItemsList(c.dimensionSearchValues,a,c.displayName)}}))};return this.get(c,d,e)},_translate:function(a){var b=this.config.dictionary;return a in b?b[a]:a},_buildUrl:function(a){var b=a.properties;return b&&b.repositoryId?this.config.productUrl.replace("<subject.repositoryId>",b.repositoryId):b.itemUrl},_buildImgSrc:function(a){var b=a.properties;return b&&b.img_url_thumbnail?b.img_url_thumbnail:this.config.defaultImgSrc},_buildPrice:function(a){return a.properties&&a.properties.salePrice?+a.properties.salePrice:null},_composeItemsList:function(a,b,c){var d=this;return $.map(a,function(a){var e=d._buildPrice(a),f="product.display"===c;if(!f||null!==e)return{img:f?d._buildImgSrc(a):null,inputValue:a.label,text:d._highlightText(a.label,b),url:d._buildUrl(a),price:f?e:null}})}}).define("SearchAjaxController")}(),function(){"use strict";mvideo.Class.AbstractAjaxController.extend({constructor:function(a){this.config={url:"/myaccount/gadgets/street.json.jsp"},$.extend(!0,this.config,a),this.constructor.__super__.constructor.call(this,this.config)},getData:function(a){var b=this,c=this.config.url,d={nameStartsWith:a},e=function(c){return[{subtitle:"Выберите улицу",items:b._composeItemsList(c&&c.streets||[],a)}]};return this.get(c,d,e)},checkData:function(a){a=a.split(",")[0];var b=this.config.url,c={nameStartsWith:a},d=function(b){var c=b&&b.streets||[],d=[];return!(!c||!c.length)&&(d=$.grep(c,function(b){return b.name.toLowerCase()===a.toLowerCase()}),d.length>0)};return this.get(b,c,d)},getItemId:function(a){var b=this.config.url,c={nameStartsWith:a},d=function(a){return a&&a.streets&&a.streets[0]?a.streets[0].id:null};return this.get(b,c,d)},_composeItemsList:function(a,b){var c=this;return $.map(a,function(a){return{text:c._highlightText(a.name,b),url:a.url}})}}).define("StreetAjaxController")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b,c){this.config={theme:"default",minLength:2,timeout:500,activeClass:"input-autocomplete",scrollAll:!1,behavior:{submit:!1,redirect:!1},acPlacement:"after",handlers:{ajax:mvideo.Class.SearchAjaxController,input:mvideo.Class.InputTextAutocomplete,list:mvideo.Class.ItemsListController,popup:mvideo.Class.PopupContentDynamic},ajaxParams:{},selectors:{input:".header-search-input",preloadedContent:""},showLoading:!1,selectSingleElement:!1,selectFirstElement:!1,seleniumClasses:{}},$.extend(!0,this.config,c||{}),mvideo.observer(this),this.$={},this.$.holder=$(a),this.$.relatedInput=$(b),this.loadObjects(this.$.holder),this.initialize(),this.cacheResponse=null},initialize:function(){var a=this.config.handlers;this.ajax=new a.ajax(this.config.ajaxParams),this._currentAjax=null,this.input=new a.input(this.$.input),this.popup=new a.popup(this.$.holder,{addMethod:this.config.acPlacement,theme:"append"==this.config.acPlacement?this.config.theme+" inline":this.config.theme,parent:this.$.holder}),this.list=new a.list(this.popup.$.content,{preventRedirect:!this.config.behavior.redirect,seleniumClasses:this.config.seleniumClasses}),this.popup.hide(),this.bindEvents()},_submitHandler:function(){var a=this.config,b=this.list.getSelecterItemUrl();return a.behavior.redirect&&b?void(location.href=b):(a.behavior.submit&&(this.$.relatedInput&&this.$.relatedInput.length?this.$.relatedInput.closest("form").submit():this.input.submitForm()),this.popup.isShown()&&this.popup.hide(),this)},_inputHandler:function(a,b){var c=this;this.$.relatedInput&&this.$.relatedInput.val(b),b.length&&b.length>=c.config.minLength?(clearTimeout(c.timeout),c.timeout=setTimeout(function(){c._handleData(b)},c.config.timeout)):c.popup.isShown()&&c.popup.hide()},_traverseHandler:function(a,b){switch(b){case"up":this.list.setPrev();break;case"down":this.list.setNext();break;case"tab":case"escape":this.popup.hide()}Modernizr.cssscrollbar?this._scrollToActiveCSS():this._scrollToActive()},_changeHandler:function(a,b){var c=this.config,d=$.trim($(b).data("input-value")||$(b).text());this.input.setValue(d),c.idStore&&this._setIdField($(b).find("a").attr("href"),$(c.idStore))},_handleData:function(a){var b=this.config,c=this;return this._showSpinner(!0),this._abortCurrentAjax(),this._currentAjax=this.ajax.getData(a),this._currentAjax.done(function(d){var e,f=c.input.$.inputHolder,g=c.input.config;if(!c._isActual(a))return void c._showSpinner(!1);if(!d[0]||!d[0].items||!d[0].items.length)return c.popup.hide(),c._showSpinner(!1),void(c.cacheResponse=null);c.cacheResponse=d,e=!f.hasClass(g.successClass)||f.hasClass(g.activeClass)||f.hasClass("ignore-success");var h={categories:d};c.list.render(h),e&&!c.popup.isShown()&&c.popup.show(),c["desktop"===mvideo.device.manager.changeState.__currentState||b.scrollAll?"_initSroll":"_disableScroll"](),c.config.selectFirstElement?c._setIdField(d[0].items[0].url,$(b.idStore)):b.idStore&&1==d[0].items.length&&c.input.getValue().toLowerCase()==d[0].items[0].inputValue.toLowerCase()&&c._setIdField(d[0].items[0].url,$(b.idStore)),c._showSpinner(!1)}),this._currentAjax.fail(function(){c._showSpinner(!1)}),this._currentAjax},_setIdField:function(a,b){var c;if(this.config.idStoreParamName){c=a.split(this.config.idStoreParamName+"=");var d=c[1].split("&");d[0]&&b.val(d[0])}else c=a.split("="),c.length>1&&b.val(c[1])},_showSpinner:function(a){var b=$(this.config.selectors.input),c=b.closest("div.input"),d=c.length?c:b,e=$.extend(!0,{},mvideo.Mixin.overlay.overlay);this.config.showLoading&&(a?e.show(d):e.hide(d))},_initSroll:function(){Modernizr.cssscrollbar||this.list.$.itemsHolder.customScrollArea({scrollInertia:0})},_disableScroll:function(){if(!Modernizr.cssscrollbar)return this.list.$.itemsHolder.customScrollArea("destroy")},_scrollToActive:function(){if(this.list.$.itemsHolder.is(":visible")&&this.$.input.is(":focus")){var a=this.list.getActiveItem().position().top||$(":focus").position().top,b=this.list.$.itemsHolder.customScrollArea("getPosVisiblePart");(a<b[0]||a>b[1]-10)&&this.list.$.itemsHolder.customScrollArea("scrollTo",a)}},_scrollToActiveCSS:function(){if(this.list.$.itemsHolder.is(":visible")&&this.$.input.is(":focus")){var a,b=this.list.$.itemsHolder.scrollTop(),c=b+this.list.$.itemsHolder.height(),d=[b,c];this.list.$.itemsHolder.css({position:"relative"}),a=(this.list.getActiveItem().position().top||$(":focus").position().top)+b,(a<d[0]||a>d[1]-10)&&this.list.$.itemsHolder.scrollTop(a)}},_isActual:function(a){return $.trim(this.input.getValue())===a},_abortCurrentAjax:function(){this._currentAjax&&"function"==typeof this._currentAjax.abort&&(this._currentAjax.abort(),this._currentAjax=null)},bindEvents:function(){var a=this;a.input.subscribe("input",$.proxy(a._inputHandler,a)),a.input.subscribe("focus",function(){null!==a.cacheResponse&&(a.list.render({categories:a.cacheResponse}),setTimeout(function(){a.popup.show()},200))}),a.input.subscribe("submit",$.proxy(a._submitHandler,a)),a.input.subscribe("traverse",$.proxy(a._traverseHandler,a)),a.list.subscribe("change",$.proxy(a._changeHandler,a)),a.popup.subscribe("show",function(){a.$.preloadedContent&&a.$.preloadedContent.length&&a.$.preloadedContent.hide(),a.$.holder.addClass(a.config.activeClass)}),a.popup.subscribe("hide",function(){(a.config.selectSingleElement||a.config.selectFirstElement)&&1==a.list.$.items.length&&$(a.list.$.items[0]).find("a").trigger("click"),a.$.preloadedContent&&a.$.preloadedContent.length&&a.$.preloadedContent.show(),a.$.holder.removeClass(a.config.activeClass),a.publish("hide")})}});a.define("AutocompleteController",a)}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){var c="o-grid__col-3",d="o-grid_sm-4",e="o-grid__col-6 u-p-0",f="o-grid_sm-8 u-p-0",g="o-grid_sm-4 u-p-0",h="o-grid_sm-12 u-p-0";this.config={layout:"horizontal",rowClassificationOffset:10,rowCalculationGranularity:10,selectors:{layoutContainer:".js-catalog-container",items:".c-catalog-item"},horizontal:{desktop:{css:"o-grid__col-6 o-catalog-item_image-left c-catalog-item_image-left"},tablet:{css:"o-grid_sm-12 o-catalog-item_image-sm-left c-catalog-item_image-sm-left"},mobile:{css:"o-grid_xs-6"}},vertical:{desktop:{css:c},tablet:{css:d},mobile:{css:"o-grid_xs-6"}},mozaic:{desktop:{positions:[["h"],["h","h"],["h","h","h"],["h","h","v","v"],["v","v","h","h","h"],["v","v","h","h","h","h"],["v","v","v","v","h","h","h"],["h","h","v","v","v","v","h","h"],["v","v","v","v","h","h","h","h","h"],["h","h","h","h","v","v","v","v","h","h"],["h","h","h","h","v","v","v","v","h","h","h"],["h","v","v","h","v","v","v","v","h","v","v","h"]],css:{h:"o-grid__col-6 o-catalog-item_image-left c-catalog-item_image-left",v:c},wrapCss:{"o-grid__col-6 u-p-0":{h:"o-grid__col-12 o-catalog-item_image-left c-catalog-item_image-left",v:"o-grid__col-6"}},wraps:{11:[[6,e],[6,e]],3:[[2,e],[2,e]],7:[[4,e],[4,e]]},heightGroups:{4:[4],5:[4],6:[4],7:[4],8:[4,2,2],9:[2,2,4],10:[2,2,4,2],11:[6]}},tablet:{positions:[["h"],["h","h"],["h","h","v"],["h","h","h","v"],["h","h","h","h","v"],["h","h","v","v","v","v"],["h","h","v","v","h","v","v"],["h","h","v","v","h","h","v","v"],["h","h","v","v","v","v","v","h","h"],["h","h","v","v","v","v","v","h","h","v"],["h","h","v","v","v","v","v","h","h","v","v"],["h","h","v","v","v","v","v","h","h","v","v","v"]],css:{h:"o-grid_sm-8 o-catalog-item_image-sm-left c-catalog-item_image-sm-left",v:c},wrapCss:{"o-grid_sm-8 u-p-0":{h:"o-grid_sm-12 o-catalog-item_image-sm-left c-catalog-item_image-sm-left",v:"o-grid_sm-6"},"o-grid_sm-4 u-p-0":{v:"o-grid_sm-12"},"o-grid_sm-12 u-p-0":{h:"o-grid_sm-8 o-catalog-item_image-sm-left c-catalog-item_image-sm-left",v:d}},wraps:{2:[[2,f],[1,g]],3:[[3,f],[1,g]],4:[[4,f],[1,g]],5:[[4,f],[2,g]],6:[[5,f],[2,g]],7:[[6,f],[2,g]],8:[[2,f],[1,g],[6,h]],9:[[2,f],[1,g],[7,h]],10:[[2,f],[1,g],[8,h]],11:[[2,f],[1,g],[9,h]]},heightGroups:{11:[3,3,3,3,1],10:[3,3,3],9:[3,3,3],8:[3,3,3],7:[3,3,1],6:[3,3],5:[3],4:[3,1],3:[3],1:[1]}},mobile:{css:"o-grid_xs-6"}}},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.loadObjects(this.$.holder),this.initialize()},initialize:function(){this._allClasses=this.getLayoutsClassesString(),this._previousTopOffset=0},allocate:function(a){this.allocateInMozaic(this.getMozaicConfigObject(this.config.layout,a,this.$.items.length))},getMozaicConfigObject:function(a,b,c){function d(){g(),l=c-k>j.positions.length?j.positions.length-1:c-k-1,m=0,q++,p=!0}function e(){var a,b;n>-1?n++:j.wraps[l]&&j.wraps[l].length>0&&(n=0),n>-1&&(a=j.wraps[l],b=a[n],!b||b.length<1?(console.warn("mvideo.Class.CatalogAllocator: incorrect layout wrappers configuration,\nlayout: %s, wrap index: %s",l,n),b=[l+1,!1]):b.length<2?"string"===$.type(b[0])?b.unshift(l+1):b.push(!1):0===b[0]&&(b[0]=l-m+1),(o=m+b[0])>l+1&&(o=l+1))}function f(){k=0,l=-1,q=-1,g()}function g(){m=-1,p=!1,h()}function h(){n=-1,o=-1}function i(){k++,m<o||e()}var j,k,l,m,n,o,p,q;return!c&&isNaN(c)&&c<1?null:this.config[a]&&this.config[a][b]?(j=this.config[a][b],j.wraps||(j.wraps={}),j.positions||(j.positions=["h"]),j.css||j.wrapCss||console.warn("mvideo.Class.CatalogAllocator: no styles defined for format %s in config %s! ",b,a),j.css?"string"==$.type(j.css)&&(j.css={h:j.css}):j.css={h:""},j.wrapCss||(j.wrapCss={}),j.heightGroups||(j.heightGroups={}),f(),{prepareNext:function(){return k<c&&(m++,m>l&&d(),i(),!0)},getHeightGroupConfig:function(){var a=0,b=0;return l>-1?(b=1e3*q+100*l,j.heightGroups[l]&&(b++,j.heightGroups[l].some(function(c,d){return m<c+a||(a+=c,b++,!1)})),b):null},prepareNextInLayout:function(){return!(-1===m||m>l)&&(m++,i(),!0)},getCurrentLayout:function(){return l},getCurrentPosition:function(){return l>-1?j.positions[l][m]:""},isLayoutChanged:function(){return!!p&&(p=!1,!0)},layoutInWraps:function(){return n>-1},getCurrentIndex:function(){return k-1},getCurrentIndexInLayout:function(){return m},getCurrentCss:function(){var a,b;return l>-1?(b=j.positions[l][m],n>-1?(a=j.wraps[l][n],a[1]?j.wrapCss[a[1]]&&j.wrapCss[a[1]][b]||"":j.css[b]||""):j.css[b]||""):""},getWrap:function(){if(n>-1)return j.wraps[l][n]},resetAll:function(){f()},getLayoutName:function(){return a}}):null},_storeByGroupHeight:function(a,b,c){var d=c.getCurrentCss(),e=c.getHeightGroupConfig(),f=c.getCurrentPosition(),g=null;b=$(b),b.addClass(d),a[e]||(a[e]={}),g=a[e],g[f]||(g[f]={items:$(),maxHeight:0}),g[f].items=g[f].items.add(b)},_storeByGroup:function(a,b,c,d){var e=null;a[d]||(a[d]={}),e=a[d],e[c]||(e[c]={items:$(),maxHeight:0}),e[c].items=e[c].items.add(b)},_storeByPositionAndRestyle:function(a,b,c,d){a[b]||(a[b]={items:[]}),d=$(d),d.addClass(c),a[b].items.push(d)},_storeByOffset:function(a,b){var c,d,e,f,g=this,h={};for(c in b)b[c].items.forEach(function(a){a=$(a),d=a.offset().top/g.config.rowCalculationGranularity|0,h[d]||(h[d]={}),e=h[d],e[c]||(e[c]={items:[]}),e[c].items.push(a.get(0))});Object.keys(h).sort(function(a,b){return a-b}).forEach(function(b){f=h[b],b>=g._previousTopOffset+g.config.rowClassificationOffset&&(g._previousTopOffset=g._previousTopOffset+g.config.rowClassificationOffset),a[g._previousTopOffset]||(a[g._previousTopOffset]={}),e=a[g._previousTopOffset];for(c in f)e[c]||(e[c]={items:$(),maxHeight:0}),e[c].items=e[c].items.add(f[c].items)})},_storeByLayoutConfig:function(a,b,c){var d,e,f,g={},h=this;c.resetAll();for(d in a)a[d].items.forEach(function(a){a=$(a),e=a.offset(),e.top|=0,e.left|=0,g[e.top]||(g[e.top]={items:[]}),f=g[e.top],f.items.push({item:a.get(0),pos:d,left:e.left})});Object.keys(g).sort(function(a,b){return a-b}).forEach(function(a){f=g[a],f.items.sort(function(a,b){return a.left-b.left}).forEach(function(a){c.prepareNext()&&h._storeByGroup(b,a.item,a.pos,c.getHeightGroupConfig())})})},allocateInMozaic:function(a){var b=null,c=null,d=null,e=null,f={},g={};if(!a)return console.warn("mvideo.Class.CatalogAllocator: no configStateObject given"),!1;if(this.$.layoutContainer.length<1)return console.warn("mvideo.Class.CatalogAllocator: no layout container found"),!1;for(b=this.$.layoutContainer.parent(),c=$(this.$.layoutContainer.get(0).cloneNode()),this.$.layoutContainer.hide(),this.$.items.removeClass(this._allClasses),this.$.items.css("height","");a.prepareNext();)if(a.layoutInWraps()){e=a.getWrap(),0!=e[1]?(d=$("<div class='o-grid'/>"),$("<div class='"+e[1]+"'/>").append(d).appendTo(c)):d=c;for(var h=0,i=!0;h<e[0]&&i;h++,i=h<e[0]&&a.prepareNext())this._storeByPositionAndRestyle(f,a.getCurrentPosition(),a.getCurrentCss(),this.$.items.eq(a.getCurrentIndex())),d.append(this.$.items.eq(a.getCurrentIndex()))}else this._storeByPositionAndRestyle(f,a.getCurrentPosition(),a.getCurrentCss(),this.$.items.eq(a.getCurrentIndex())),c.append(this.$.items.eq(a.getCurrentIndex()));this.$.layoutContainer.remove(),b.append(c),this.$.layoutContainer=c,"mozaic"===a.getLayoutName()?this._storeByLayoutConfig(f,g,a):this._storeByOffset(g,f),this.$.items.height("auto");for(var j in g){var k=g[j];for(var l in k)k[l].items.each(function(a,b){k[l].maxHeight=k[l].maxHeight<$(b).height()?$(b).height():k[l].maxHeight});k.v&&k.h&&(k.v.maxHeight>2*k.h.maxHeight?k.h.maxHeight=k.v.maxHeight/2:k.v.maxHeight=2*k.h.maxHeight);for(l in k)k[l].items.height(k[l].maxHeight)}},getLayoutsClassesString:function(){for(var a,b=null,c={},d="",e=[["mozaic","horizontal","vertical"],["desktop","tablet","mobile"],["css","wrapCss"]].reduce(function(b,c){for(var d=[];a=b.pop();)c.forEach(function(b){a[b]&&d.push(a[b])});return d},[this.config]);a=e.pop();)if("object"===$.type(a))for(var f in a)"string"===$.type(a[f])?d+=" "+a[f]:e.push(a[f]);else d+=" "+a;return b=d.split(/\s+/),d=b.filter(function(a){return!c[a]&&(c[a]=!0,!0)}).join(" ")}}).define("CatalogAllocator")}(),function(){"use strict";var a=!1,b=mvideo.Class.Class.extend({constructor:function(a){this.$={holder:a instanceof jQuery?a:$(a)},this.config={handlers:{operation:mvideo.Class.CheckoutOperations}},this.initialize()},initialize:function(){var b=this;this.operation=new this.config.handlers.operation,this.lastLoaders=!1,this.overlayTimeoutId=!1,this.overlay=new mvideo.Class.Overlay,this.OVERLAY_TIMEOUT_MS=200,this.operation.subscribe("bindEvents",function(a,c){var d=b.$.holder.find('[data-id="'+c+'"]');d.length&&b.bindEvent(d)}),this.bindEvent(this.$.holder),this.$.holder.find(".o-checkout__submit-button").parents("form").submit(function(){var c=this,d=!1;if(b.$.holder.find("form").each(function(a,b){b!=c&&(d=d||!$(b).valid())}),d){var e=b.$.holder.find(".u-error");if(e.length){(new mvideo.Class.SmartFocus).focusBlock(e.eq(0),e.eq(0))}}else Object.keys(b.getWaitingRequests()).length>0?a=!0:(b.overlay.show(b.$.holder),a=!1);return!d&&!a})},isNotValidInput:function(a){var b,c,d=a.data("with");if(d){d=d.split(","),c=a.closest("form");for(var e=0;e<d.length;e++)if(b=$(d[e],c),b.hasClass("u-error")||!b.val()&&b.attr("data-rule-required"))return!0}return a.hasClass("u-error")||!a.val()&&a.attr("data-rule-required")},bindEvent:function(a){var b=a.find("[data-handler][data-url]");b.filter(":input").not(":button").change(this.inputChangeHandler.bind(this)),b.not(":input").add(b.filter(":button")).click(this.inputChangeHandler.bind(this)),b=a.find("[data-popup-handler][data-popup-url]"),b.on("popup-success-close",this.inputChangeHandler.bind(this))},inputChangeHandler:function(b){var c=this,d=$(b.currentTarget);setTimeout(function(){if(!b.isPropagationStopped()&&!c.isNotValidInput(d)){var e=c.sendData(d,!0);e&&e.then(function(a){c.receiveData(a)}).always(function(){a&&c.$.holder.find(".o-checkout__submit-button").trigger("click")})}}),d.is("a")&&b.preventDefault()},receiveData:function(a,b){if(b||this.hideOverlays(),this.runOperations(a.operations,a.debug),a.notifications&&a.notifications.length)for(var c=0;c<a.notifications.length;c++)mvideo.Event.publish("checkout.add-notification",a.notifications[c]);b&&this.showLastOverlays()},getFormData:function(a){var b=a.serializeArray(),c={};return $.map(b,function(a,b){c[a.name]=a.value}),c},runOperations:function(a,b){if(a)for(var c=0,d=a.length;c<d;c++)this.operation.refreshBlock(a[c],b)},sendData:function(a,b){var c=a.parents("form"),d=c.data("url"),e=a.data("url")||a.data("popup-url"),f=a.data("handler")||a.data("popup-handler"),g=this.getFormData(c);return c.length?d?e?(f&&(g.handler=f),a.is("[data-without-loader]")||this.showOverlays(a),mvideo.helpers.checkout.getData({url:d+e,data:g},"checkout-input-change",b)):(console.warn("У инпута должен быть указан атрибут data-[popup-]url(вторая часть url-а).",a[0]),!1):(console.warn("У формы должен быть указан атрибут data-url(первая часть url-а).",c[0]),!1):(console.warn("Изменяемый инпут должен лежать внутри формы.",a[0]),!1)},getWaitingRequests:function(){return mvideo.helpers.checkout.getGroups()},showOverlays:function(a){var b=$("[data-loader]"),c=a.is("[data-self-loader]"),d=this,e=b.index(a.closest("[data-loader]"))-(c?1:0);this.lastLoaders=-1==e?b:b.filter(":gt("+e+")"),this.overlayTimeoutId=setTimeout(function(){d.lastLoaders.each(function(a,b){var c=$(b);d.overlay.show(c,!0),d.setReadOnlyInput(c)})},c?0:this.OVERLAY_TIMEOUT_MS)},setReadOnlyInput:function(a){a.find("input:not([readonly])").addClass("wait-readonly").attr("readonly",!0)},deleteReadOnlyInput:function(a){a.find(".wait-readonly").removeClass("wait-readonly").attr("readonly",!1)},showLastOverlays:function(){var a=this;this.lastLoaders.each(function(b,c){a.overlay.show($(c),!0,!0)})},hideOverlays:function(){var a=this;this.lastLoaders&&(this.lastLoaders.each(function(b,c){var d=$(c);a.overlay.hide(d),a.deleteReadOnlyInput(d)}),clearTimeout(this.overlayTimeoutId))}});b.define("CheckoutController",b)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.$={affixBlock:a instanceof jQuery?a:$(a),simulateBlock:$("<div></div>")},this.$.affixBlockWrapper=this.$.affixBlock.find(".o-checkout__notifications-wrapper"),this.initialize()},initialize:function(){var a=this;this.topOffset=0,this.nowAffix=!1,this.calcOffset(),a.$.affixBlock.on("affix.bs.affix",function(){a.setSimulateBlockHeight(),a.$.affixBlock.addClass("o-container__section"),a.$.affixBlock.after(a.$.simulateBlock),a.nowAffix=!0}),a.$.affixBlock.on("affix-top.bs.affix",function(){a.$.affixBlock.removeClass("o-container__section"),a.$.simulateBlock.remove(),a.nowAffix=!1}),a.$.affixBlock.affix({offset:{top:function(){return a.topOffset}}}),mvideo.Event.subscribe("resize",this.calcOffset.bind(this)),mvideo.Event.subscribe("checkout.add-notification",function(b,c){c.type&&a.checkNotification(c.type)||a.insertNotification(c)}),this.bindNotificationsRemoveEvent()},checkNotification:function(a){return this.$.affixBlockWrapper.find('[data-type="'+a+'"]').length},insertNotification:function(a){var b=$('<div class="o-checkout__notifications-element">'+JST["common/jade/tpls/notifications.tpl"]({params:{closed:"true",background:"gray96",iconStyle:"info",notificationMessages:[{title:a.htmlContent}],notificationAttrs:{"data-type":a.type},shouldEventPrevent:!0}})+"</div>"),c=$("body"),d=c.scrollTop(),e=this;mvideo.Class.ReinitContent.reinit(b),e.$.affixBlockWrapper.prepend(b),e.bindNotificationsRemoveEvent(),e.setSimulateBlockHeight(b.outerHeight(!0)),e.nowAffix&&c.scrollTop(d+b.outerHeight(!0));var f=b.height();b.css({height:0,opacity:.3,position:"relative",top:-.25*f}),b.animate({height:f,opacity:1,top:0},{duration:250,easing:"easeOutCubic",start:function(){b.css({overflow:"visible"})},done:function(){b.css({height:"auto"}),b.trigger("show.notification")}})},setSimulateBlockHeight:function(a){a?this.$.simulateBlock.height(this.$.simulateBlock.height()+a):this.$.simulateBlock.height(this.$.affixBlockWrapper.height()+12)},calcOffset:function(){this.topOffset=(this.nowAffix?this.$.simulateBlock:this.$.affixBlock).offset().top-12},bindNotificationsRemoveEvent:function(){var a=this;this.$.affixBlockWrapper.find("[data-init=notifications]").off("notifications-remove.checkout").on("notifications-remove.checkout",function(){var b=$("body"),c=$(this).parent(),d=b.scrollTop(),e=c.outerHeight(!this.nowAffix),f=c.height(),g=c.parent();c.css({height:f,opacity:1}),c.animate({height:0,opacity:0,"padding-top":0,"padding-bottom":0},200),setTimeout(function(){c.remove(),g.trigger("notification-removed"),a.setSimulateBlockHeight(-e),b.scrollTop(d-e),a.calcOffset()},200)})}});a.define("CheckoutNotifications",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(){mvideo.observer(this)},destroyBlock:function(a){var b,c;b=a.find("select"),b&&b.length&&(c=new mvideo.Class.CustomSelect,c.destroy(b)),a.off().empty()},refreshBlock:function(a,b){var c=$('[data-id="'+a.blockId+'"]');c.length&&(this.publish("unbindEvents",a.blockId),this.destroyBlock(c),c.html(a.htmlContent||""),mvideo.Class.ReinitContent.reinit(c),this.publish("bindEvents",a.blockId),b&&(console.log('refreshBlock for "'+a.blockId+'": ',c[0]),c.removeClass("u-debug-highlight"),setTimeout(function(){c.addClass("u-debug-highlight")})))}});a.define("CheckoutOperations",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config=$.extend(!0,{holder:a,selectBtnRequest:"",selectTimer:"",selectWrapperTimer:"",elementCode:"",timerSeconds:60,handlers:{timer:mvideo.Class.Timer},restApi:{repeatSmsCode:""},limitError:"",errorClass:"u-error",timerTemplate:"#m#:#s#"},b),this.$={},this.$.holder=a instanceof jQuery?a:$(a),this.initialize()},initialize:function(){this.$.timer=new this.config.handlers.timer({selectors:{timer:this.config.selectTimer},seconds:this.config.timerSeconds,template:this.config.timerTemplate}),this.$.selectBtnRequest=$(this.config.selectBtnRequest,this.$.holder),this.$.selectWrapperTimer=$(this.config.selectWrapperTimer,this.$.holder),this.$.elementCode=$(this.config.elementCode,this.$.holder),this.$.labelErr=this.$.elementCode.siblings(".u-error-text"),this.oldCode=this.$.elementCode.val()},open:function(){var a=this
;this.isLimitExceeded=this.$.elementCode.data("limit-exceeded"),this.isInputDisabled=this.$.elementCode.attr("disabled"),this.isLimitExceeded||this.$.elementCode.select(),this.startTimer(),this.isLimitExceeded?this.$.elementCode.attr("readonly",!0).data("msg-required",this.config.limitError||this.$.labelErr.text()):this.$.elementCode.one("blur",function(){a.oldCode&&a.oldCode===a.$.elementCode.val()&&(a.$.elementCode.addClass(a.config.errorClass),a.$.labelErr.show())}).one("input",this.firstInputHandler.bind(this))},firstInputHandler:function(){this.oldCode||this.$.elementCode.val()?(this.$.elementCode.removeClass(this.config.errorClass),this.$.labelErr.hide()):this.$.elementCode.one("input",this.firstInputHandler.bind(this))},startTimer:function(){if(0==this.config.timerSeconds)return this.callbackTimer();var a=this;this.$.timer.start(a.callbackTimer.bind(a)),this.$.selectBtnRequest.hide(),this.$.selectWrapperTimer.show()},callbackTimer:function(){this.$.selectBtnRequest.show(),this.$.selectWrapperTimer.hide()},toggleComponentsDisable:function(a){this.$.elementCode.attr("readonly",a||!!this.isLimitExceeded||!!this.isInputDisabled).attr("disabled",a||!!this.isLimitExceeded||!!this.isInputDisabled),a?this.$.selectBtnRequest.addClass("u-disabled"):this.$.selectBtnRequest.removeClass("u-disabled")}});a.define("CheckoutSmsConfirm",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={eventNamespace:".Checkout.TimeSlot",elementDate:"",timeSlot:"",handlers:{parser:mvideo.Class.ParserLeadTime,customSelect:mvideo.Class.CustomSelect},mDate:{}},this.$={},$.extend(!0,this.config,a||{}),this.initialize()},initialize:function(){this.parser=new this.config.handlers.parser,this.customSelectInstance=new this.config.handlers.customSelect,this.$.elementDate=$(this.config.elementDate),this.$.elementDate.on("change",this.changeDay.bind(this))},setDate:function(a){this.mDate=this.parser.getTimes(a),this.initDate(),this.loaded()},initDate:function(){this.renderSelect(),this.changeDay()},renderSelect:function(){this.$.elementDate.html(this.renderDay());var a=this;setTimeout(function(){a.customSelectInstance.reinit(a.$.elementDate)})},renderDay:function(){var a=[],b=this;return Object.keys(this.mDate).forEach(function(c){a.push("<option "+b.getOptionAttr(b.mDate[c].attr)+' value="'+c+'">'+b.renderDayTitle(c,b.mDate[c].start)+"</option>")}),a.join("")},getOptionAttr:function(a){if(void 0!==a){var b=[];for(var c in a)b.push(c+"="+a[c]);return b.join(" ")}return""},renderDayTitle:function(a,b){var c,d=window.moment.parseZone(b),e={hour:0,minute:0,second:0,millisecond:0},f=window.moment().utcOffset(b).set(e);switch(window.moment(b).utcOffset(b).set(e).diff(f,"days")){case 0:c="Сегодня";break;case 1:c="Завтра";break;default:c=d.format("dddd")}return c+", "+d.format("D MMMM")},changeDay:function(){var a=this.$.elementDate.val();mvideo.Event.publish("update"+this.config.eventNamespace,{mTimeSlot:this.mDate[a].timeSlot||{}})},loading:function(){this.$.elementDate.prop("disabled",!0).addClass("u-load")},loaded:function(){this.$.elementDate.prop("disabled",!1).removeClass("u-load")}});a.define("CheckoutDeliveryDate",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={elementTime:"",handlers:{customSelect:mvideo.Class.CustomSelect},showPrice:!0},this.mTimeSlot={},this.$={},$.extend(!0,this.config,a||{}),this.initialize()},initialize:function(){this.customSelectInstance=new this.config.handlers.customSelect,this.$.elementTime=$(this.config.elementTime),this.firstShown=!1},setTimeSlot:function(a){this.mTimeSlot=a.mTimeSlot,this.renderSelect(),this.loaded()},setDefaultTimeSlot:function(a){this.$.elementTime.find('[value="'+a+'"]').prop("selected",!0)},renderSelect:function(){this.$.elementTime.html(this.renderTimeSlot());var a=this;setTimeout(function(){a.customSelectInstance.reinit(a.$.elementTime)})},renderTimeSlot:function(){var a=[],b=this;return this.mTimeSlot.forEach(function(c){a.push("<option "+b.defaultSelected(b.firstShown?c.defaultSelected:c.selected)+"  "+b.getOptionAttr(c.attr)+' value="'+c.priceGroup.id+'">'+b.renderTitle(c)+"</option>")}),this.firstShown=!0,a.join("")},defaultSelected:function(a){return a&&' selected="selected" '||""},getOptionAttr:function(a){if(void 0!==a){var b=[];for(var c in a)b.push(c+'="'+a[c]+'"');return b.join(" ")}return""},renderTitle:function(a){return this.renderTime(a.start)+"-"+this.renderTime(a.end)+" "+this.renderCost(a.price)},renderTime:function(a){return window.moment.parseZone(a).format("HH:mm")},renderCost:function(a){return this.config.showPrice?!a&&"бесплатно"||"за "+a+"¤":""},loading:function(){this.$.elementTime.prop("disabled",!0).addClass("u-load")},loaded:function(){this.$.elementTime.prop("disabled",!1).removeClass("u-load")}});a.define("CheckoutDeliveryTimeSlot",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={eventNamespace:".Checkout.LeadTime",getTimes:""},$.extend(!0,this.config,a||{}),this.currentIdCity="",this.currentAddress=""},changeAddress:function(a,b){var c={};this.currentAddress==a&&this.currentIdCity==b||(this.currentIdCity=b,this.currentAddress=a,this.currentIdCity&&(c.cityId=b,c.address=a,this.getLeadTime(c)))},getLeadTime:function(a){var b=this,c=mvideo.helpers.checkout.getData({url:this.config.restApi.getTimes,data:a},"checkout-lead-time");this.publishEvent("loading"),c.promise.then(function(a,c){c||b.publishEvent("update",a)}),c.cache&&this.publishEvent("update",c.cache)},publishEvent:function(a,b){mvideo.Event.publish(a+this.config.eventNamespace,{timeSlot:b})}});a.define("CheckoutLeadTime",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(){},getTimes:function(a){var b={};return a instanceof Array==0&&(a=JSON.parse(a)),a.forEach(function(a){var c=window.moment.parseZone(a.start).format("DD.MM.YYYY");b[c]||(b[c]={start:a.start,timeSlot:[]}),a.attr||(a.attr={}),a.attr["data-price"]=a.price,a.attr["data-startdate"]=a.start,a.attr["data-enddate"]=a.end,a.selected&&(b[c].attr||(b[c].attr={}),b[c].attr.selected=a.selected),b[c].timeSlot.push(a)}),b}});a.define("ParserLeadTime",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={tpl:"jade/components/store/tpl-store-page",elements:{btn:"button",inputStore:".js-store-id",inputStorePvz:".js-pvz",currentStoreBtn:".js-current-store-btn"},namespace:{popup:"popup-locator"},restApi:{getStores:""},defaultChecked:"map",popup:mvideo.Class.Popup,apikeyMaps:"",messages:{}},$.extend(!0,this.config,b||{}),this.$={},this.$.holder=$(a),this.initialize()},initialize:function(){this.$btn=$(this.config.elements.btn,this.$.holder),this.$inputStore=$(this.config.elements.inputStore,this.$.holder),this.$inputStorePvz=$(this.config.elements.inputStorePvz,this.$.holder),this.$currentStoreBtn=$(this.config.elements.currentStoreBtn),this.bindEvents()},getContent:function(a){var b=JST[this.config.tpl]({data:$.extend(!0,{},this.config,{urlGetStores:this.config.restApi.getStores,withCurrentStoreBalloon:!!a,eventOverlayClose:"close."+this.config.namespace.popup})});this.getPopup(b)},getPopup:function(a){return this.popup=new this.config.popup("",{title:a,contentAsHTML:!0,namespace:this.config.namespace.popup,classes:["full-height","pr-32","c-popup_with-title","c-popup_store"]}),this.popup.show(),this.setHeight(),this.popup},showPopup:function(a){a.preventDefault(),this.getContent(),this.bindEventsHeight()},showCurrentStorePopup:function(a){a.preventDefault(),this.getContent(!0),this.bindEventsHeight()},hidePopup:function(){this.popup.hide()},bindEvents:function(){var a=this;this.$btn.on("click",this.showPopup.bind(this)),this.$currentStoreBtn.on("click",this.showCurrentStorePopup.bind(this)),this.$inputStore.on("change_store",this.shangeStore.bind(this)),mvideo.Event.subscribe("close."+this.config.namespace.popup,a.unBindEvents.bind(this))},bindEventsHeight:function(){var a=this,b=$.throttle(300,function(){a.setHeight()});mvideo.Event.subscribe("resize.popup",b.bind(a)),$(window).on("resize.popup orientationchange.popup",function(){mvideo.Event.publish("resize.popup")})},shangeStore:function(){this.$inputStore.val()&&(this.hidePopup(),this.$inputStore.trigger("change"),this.$inputStorePvz.trigger("change")),this.unBindEvents()},setHeight:function(){var a=$(".c-popup"),b=$(".c-store__form",a),c=$(".c-store__title",a),d=$(".js-store-locator-content",a),e=$(".c-store__map",a),f=$(".c-store__subway",a),g=mvideo.helpers.getWindowHeight()-b.outerHeight(!0)-c.outerHeight(!0);"mobile"!=mvideo.device.manager.getType()?g-=73:g+=46,d.css("minHeight",g),e.css("minHeight",g),e.css("height",g),f.css("minHeight",g),f.css("height",g),$(".subway-content",f).css("height",g),$("#store-locator-list").css("minHeight",g),mvideo.Event.publish("resize-map")},unBindEvents:function(){$(window).off("resize.popup orientationchange.popup"),mvideo.Event.unsubscribe("resize-map"),mvideo.Event.unsubscribe("resize.popup")}});a.define("PopupStore",a)}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){this.config={selectors:{timerHolder:".c-code-check__resend-status",timer:".c-code-check__resend-timer",input:".c-code-check__input",resendLink:".c-code-check__resend-link",checkCodeTrigger:".c-code-check__input",error:".u-error-text"},recaptcha:{checkbox:"#recaptcha-sms-checkbox",holder:".c-phone-verification__recaptcha",recaptchaInside:!1},holder:".c-phone-verification__sms-check",hiddenClass:"u-hidden",timeInSeconds:59,checkCodeEvent:"input",codeFailedMsg:"Неверно указан код",sendCodeUrl:"",checkCodeUrl:"",needOverlay:!0,bootImmediatelyConfig:null,disabledClass:"disabled",errMsg:"Сервис временно не доступен"},$.extend(!0,this.config,b||{}),mvideo.observer(this),this.$={},this.$.holder=$(this.config.holder,a),this.loadObjects(this.$.holder),this.config.recaptcha.recaptchaInside?(this.$.recaptchaHolder=$(this.config.recaptcha.holder,a),this.$.recaptchaCheckbox=$('[data-recaptcha-checkbox="true"]',this.$.recaptchaHolder)):(this.$.recaptchaCheckbox=$(this.config.recaptcha.checkbox),this.$.recaptchaHolder=this.$.recaptchaCheckbox.parents(this.config.recaptcha.holder)),this.initialize()},initialize:function(){this.timer=new mvideo.Class.Timer({selectors:{timer:this.config.selectors.timer},template:"#s#",seconds:this.config.timeInSeconds}),this.config.needOverlay&&(this.overlay=new mvideo.Class.Overlay(this.$.holder,!0)),this.validator=this.$.input.validate(),this.bindEvents()},bindEvents:function(){var a=this;this.$.resendLink.on("click",function(b){b.preventDefault(),a.sendCodeToUser()}),this.$.checkCodeTrigger.on(this.config.checkCodeEvent,function(b){b.preventDefault(),a.checkUserCode()}),this.$.recaptchaCheckbox.on("change",function(){a.$.recaptchaCheckbox.prop("checked")?(a.$.resendLink.removeClass("u-disabled"),"limit-exceeded"!==a.state&&(a.enableInput(),a.clearError())):(a.$.resendLink.addClass("u-disabled"),a.disableInput())})},initState:function(){this.config.bootImmediatelyConfig&&this.setEntryCodeState(this.config.bootImmediatelyConfig)},sendCodeToUser:function(){var a=this,b=this.getRequestData();return!!a.checkValid()&&($.ajax({url:this.config.sendCodeUrl,type:"post",data:b,dataType:"json",success:a.setEntryCodeState.bind(a),beforeSend:function(){a.showOverlay(),a.clearError(),a.publish("confirmation-code-send-before")},complete:function(){a.hideOverlay()},error:a.serviceError.bind(a)}),!0)},serviceError:function(){this.publish("update-state",{states:"show-notification",notification:{type:"error",text:this.config.errMsg}})},showOverlay:function(){this.config.needOverlay&&this.overlay.show()},hideOverlay:function(){this.config.needOverlay&&this.overlay.hide()},checkUserCode:function(){var a=this,b=$.extend(!0,this.getRequestData(),{code:this.$.input.val()});a.checkValid(!0)&&$.ajax({url:this.config.checkCodeUrl,type:"post",data:b,dataType:"json",beforeSend:function(){a.beforeCheckCode(),a.publish("confirmation-code-check-before")},success:function(b){if("update-state"===b.state)return void a.publish("update-state",b);a.state=b.state,b.success?a.publish("confirmation-code-check-success",b):(a.onCodeCheckFailed(b),a.publish("confirmation-code-check-error",b)),a.toggleRecaptchaBlock(b),a.publish("confirmation-code-check-complete",!a.hasRecaptcha)},error:function(b){a.serviceError(),a.onCodeCheckFailed(b),a.publish("confirmation-code-check-request-error",b)},complete:function(){a.hideOverlay()}})},beforeCheckCode:function(){this.showOverlay(),this.disableInput(),this.validator.resetField(this.$.input)},onCodeCheckFailed:function(a){this.clearCodeInput(),"code-blocked"===a.state?this.disableInput():"limit-exceeded"===a.state||a.showRecaptcha?this.setError(a.error):(this.enableInput(),this.setError(a.error)),this.$.input.parent().removeClass("success").addClass("error"),0!==a.delay&&(this.$.resendLink.addClass(this.config.hiddenClass),this.$.timerHolder.removeClass(this.config.hiddenClass),this.startTimer(a.delay))},clearCodeInput:function(){this.$.input.val("")},startTimer:function(a){var b=this;if(this.timer.reset(a),0===a)return void b.setEntryCodeAgainState();this.timer.start(function(){b.setEntryCodeAgainState()})},enableInput:function(){this.$.input.removeClass(this.config.disabledClass).attr("readonly",!1).attr("disabled",!1).focus()},disableInput:function(){this.$.input.attr("readonly",!0).attr("disabled",!0).addClass(this.config.disabledClass)},clearError:function(){this.$.error.css({display:"none"}).text("")},setError:function(a){this.$.error.css({display:"block"}).text(a||this.config.codeFailedMsg)},setEntryCodeState:function(a){if("update-state"===a.state)return this.publish("update-state",a),void this.toggleRecaptchaBlock(a);this.state=a.state,this.publish("confirmation-code-received",a),a.success?(this.$.input.val(""),0!==a.delay&&(this.$.resendLink.addClass(this.config.hiddenClass),this.$.timerHolder.removeClass(this.config.hiddenClass)),this.startTimer(a.delay),this.enableInput()):(this.disableInput(),this.onCodeCheckFailed(a)),this.toggleRecaptchaBlock(a),0===a.delay&&this.setEntryCodeAgainState(),this.publish("confirmation-code-send-complete",!this.hasRecaptcha)},toogleTimer:function(a){if(a)return this.$.resendLink.removeClass(this.config.hiddenClass),void this.$.timerHolder.addClass(this.config.hiddenClass);this.$.resendLink.addClass(this.config.hiddenClass),this.$.timerHolder.removeClass(this.config.hiddenClass)},setEntryCodeAgainState:function(){this.toogleTimer(!0),this.publish("confirmation-timer-expired")},checkValid:function(a){var b=!0;return a&&(b=this.$.input.valid()),this.$.recaptchaCheckbox.is(":visible")&&(b=this.$.recaptchaCheckbox.valid()&&b),b},toggleRecaptchaBlock:function(a){this.hasRecaptcha=a.showRecaptcha,a.showRecaptcha?(this.$.recaptchaCheckbox.trigger("reinit-recaptcha"),this.$.recaptchaHolder.removeClass(this.config.hiddenClass),this.$.resendLink.addClass("u-disabled"),this.disableInput()):"code-blocked"===a.state?(this.$.recaptchaHolder.addClass(this.config.hiddenClass),this.$.resendLink.removeClass(this.config.hiddenClass).addClass("u-disabled"),this.$.timerHolder.addClass(this.config.hiddenClass)):"limit-exceeded"!==a.state&&(this.$.recaptchaHolder.addClass(this.config.hiddenClass),this.$.resendLink.removeClass("u-disabled"),"success"!==a.status&&this.enableInput())},getRequestData:function(){var a=window.mvideo.helpers.inputs.getData(this.$.recaptchaHolder),b=this.config.getRequestData();return $.extend(!0,b,a)},cancelConfirmation:function(){this.$.recaptchaHolder.addClass(this.config.hiddenClass)}}).define("CodeConfirmation")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){b=void 0!==b?b:{carousel:{}};var c=$('<a class="prev-btn '+(b.carousel.prevClasses||"")+'" href="#"/>'),d=$('<a class="next-btn '+(b.carousel.nextClasses||"")+'" href="#"/>'),e=$('<div class="carousel-paging"/>'),f=this,g=b.carousel.onCreate;b.carousel.scroll&&"object"!=typeof b.carousel.scroll&&(b.carousel.scroll={duration:b.carousel.scroll}),this.config={carousel:{height:"auto",prev:c,next:d,auto:!1,swipe:!0,preLoadLazy:!1,items:{height:"variable"},onWindowResize:"debounce",width:"100%",pagination:e,sel:{paging:null,pagingBtn:null},scroll:{duration:500,onBefore:this.onBeforeScroll.bind(this)}},settings:{recalcWidthByResize:!0}},this.$={},this.$.holder=$(a),this.lazyLoad=new mvideo.Class.LazyLoad;var h=this.$.holder.parent();h.append(c),h.append(d),h.parent().append(e),$.extend(!0,this.config,b),(b.carousel.auto||b.carousel.lazy)&&(this.config.carousel.scroll=$.extend(!0,this.config.carousel.scroll,{pauseOnHover:!0}),b.carousel.lazy&&(this.config.carousel.onCreate=function(){f._lazyLoadImg.apply(f,arguments),"function"==typeof g&&g()})),this.loadObjects(),this.init()},init:function(a,b){return a=a||this.config.carousel,b=b||this.config.settings,this.$.holder.carouFredSel(a,b),"ontouchstart"in window&&this.$.holder.find("input").on("touchstart",function(){event.stopPropagation()}),this.addSelAttrs(),this},onBeforeScroll:function(a){this.$.holder.trigger("beforeScroll."+a.scroll.direction,a),this.config.carousel.lazy&&this._lazyLoadImg(a)},applyConfig:function(a){return this.$.holder.triggerHandler("configuration",a),this},getConfig:function(a){return this.$.holder.triggerHandler("configuration",a)},getVisibleItems:function(){return this.$.holder.triggerHandler("currentVisible")},destroy:function(){return this.$.holder.triggerHandler("destroy",!0),this},reinit:function(a,b){return this.destroy(),this.init(a,b),this.addSelAttrs(),this},updateSize:function(){return this.$.holder.triggerHandler("updateSizes",!0),this},_lazyLoadImg:function(a){var b,c,d,e=a.items.visible||a.items,f=e.find(".lazy-manual"),g=[],h=[];this.config.carousel.preLoadLazy&&(b=e.length,c=$(e.nextAll().splice(b-1,b)),g=c.find(".lazy-manual"),d=e.nextAll().slice(-b),h=d.find(".lazy-manual"),g.length&&(g.removeClass("lazy-manual"),this.lazyLoad.add(c)),h.length&&(h.removeClass("lazy-manual"),this.lazyLoad.add(d))),f.length&&(f.removeClass("lazy-manual"),this.lazyLoad.add(e)),(g.length||h.length||f.length)&&this.lazyLoad.update()},addSelAttrs:function(){var a=this.config.carousel.sel;a&&this.config.carousel.pagination&&(this.config.carousel.pagination.attr("data-sel",a.paging),null!=a.pagingBtn&&this.config.carousel.pagination.find("a").each(function(b){$(this).attr("data-sel",a.pagingBtn+"_"+b)}))}});a.define("CommonCarousel",a)}(),mvideo.Class.Class.extend({constructor:function a(b){if(a.instance)return a.instance;a.instance=this},deleteProduct:function(a){return $.ajax({type:a.method||"POST",url:a.url,dataType:"json",data:a.data}).then(function(b){b.action="ajax"+("comparison"===a.source?"-"+a.source:""),mvideo.Event.publish("comparisonDelete",b)})}}).define("ComparisonManager"),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){this.config={initCollapsed:!0,diffClass:"comparison-nodiff",specialCellClass:"c-compare-cell_btn",dataTarget:"",stateCheckbox:"#checkbox",cells:".c-compare-cell",rows:".c-compare-row",blockOfRows:".c-accordion__item:nth-child(n+2)",collapsed:"[data-toggle=collapse]"},$.extend(!0,this.config,b),this.$={},this.$.holder=$(a),this.config.dataTarget&&(this.config.stateCheckbox+="-"+this.config.dataTarget),this.loadObjects(this.$.holder,{blockOfRows:this.config.blockOfRows,collapsed:this.config.collapsed,stateCheckbox:this.config.stateCheckbox}),this.initialize(),this.bindEvents()},initialize:function(){this.config.initCollapsed&&(this.$.stateCheckbox.prop("checked",!0),this.toggleCollapseItem(),this.hideDiff())},showAll:function(){var a=this;this.$.blockOfRows.removeClass(a.config.diffClass).find(a.config.rows).removeClass(a.config.diffClass)},hideDiff:function(){var a=this;this.$.blockOfRows.removeClass(this.config.diffClass).filter(function(b,c){return c=$(c),0===c.find(a.config.rows).filter(function(b,c){c=$(c);var d=!1,e="";return c.find(a.config.cells).last().each(function(b,c){e=c.classList.contains(a.config.specialCellClass)?c.firstElementChild?c.firstElementChild.className:"":c.innerText}).end().each(function(b,c){if((c.classList.contains(a.config.specialCellClass)?c.firstElementChild?c.firstElementChild.className:"":c.innerText)!==e)return d=!0,!1}),d||c.addClass(a.config.diffClass),d}).length}).addClass(this.config.diffClass)},bindEvents:function(){var a=this;this.$.stateCheckbox.on("change",function(b){b.target.checked?(a.toggleCollapseItem(),a.hideDiff()):(a.showAll(),a.toggleCollapseItem())})},toggleCollapseItem:function(){var a=this;this.$.collapsed&&this.$.collapsed.length>0&&this.$.collapsed.each(function(b,c){c=$(c);var d=c.attr("data-target");d=d?a.$.holder.find(d):c,d.hasClass("in")||(c.removeClass("collapsed"),d.collapse("show"))})}}).define("ComparisonTable")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={animation:!0,step:0,openClass:"open",activeClass:"active"},this.$={},this.$.holder=$(a)},isActive:function(a){return a.hasClass(this.config.activeClass)},canSlide:function(a){return!this.isActive(a)},getWidth:function(){return this.$.holder.width()},getStep:function(){return this.config.step},isAnimating:function(){return this.config.animation},resetState:function(){return this.jump(0)},updateWidth:function(){var a=this.getStep();this.jump(a)},_getStepLenght:function(a){return a>0?this.getWidth()*a:0},_go:function(a,b){var c=this;c.config.animation=!0,c.config.step=a;var d=this._getStepLenght(a),e=this.$.holder[b]({left:-d}).promise();return e.done(function(){c.config.animation=!1}),e},jump:function(a){return this._go(a,"css")},move:function(a){return this._go(a,"transition")},goNext:function(a){return this.move(a||1)},goBack:function(a){return this.move(a||0)}});a.define("ContentSlider",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config=$.extend(!0,{source:"list",receiver:"grid",column:"col",block:"block"},a||{}),this.$={source:$("."+this.config.source),receiver:$("."+this.config.receiver)},this.initialize()},initialize:function(){this.$blocksList=this.$.source.find("."+this.config.block).clone(),this.$.source.empty(),this.$.receiver.empty().removeClass("hide")},render:function(a){var b=0;for(this.$.receiver.empty(),b;b<a.columnCount;b++)$("<div/>",{class:this.config.column}).appendTo(this.$.receiver);return this.$blocksList.each(this.addBlock.bind(this)),this},addBlock:function(a,b){this.getColumnLower().append(b)},getColumnLower:function(){var a,b=this.$.receiver;return this.$.receiver.find("."+this.config.column).each(function(c,d){var e=d.clientHeight||0;(void 0===a||e<a)&&(a=e,b=d)}),$(b)}});a.define("CustomGrid",a)}(),mvideo.Class.Class.extend({constructor:function(a,b){this.config={hasScrollClass:"has-scroll",selectors:{scrolledArea:".js-scrolled-area"},onDestroy:null},this.$={},$.extend(!0,this.config,b||{}),this.$.holder=$(a),this.loadObjects(this.$.holder,this.config.selectors),this.initCustomScroll()},initCustomScroll:function(){Modernizr.cssscrollbar?(this.recalcHasScroll(),this._type=0):(this.$.holder.customScrollArea({scrollInertia:0}),this._type=1)},recalcHasScroll:function(){Modernizr.cssscrollbar&&(this.$.holder.removeClass(this.config.hasScrollClass),this.$.holder.height()<this.$.scrolledArea.outerHeight()&&this.$.holder.addClass(this.config.hasScrollClass))},update:function(){1===this._type?this.$.holder.customScrollArea("update"):this.recalcHasScroll()}}).define("CustomScroll"),function(){"use strict";var a=0,b=mvideo.Class.AutocompleteController;b.extend({constructor:function(){b.apply(this,arguments),$.extend(!0,this.config,{minLength:1,timeout:400})},_submitHandler:function(){try{this.input.el.value.length>0&&b.prototype._submitHandler.apply(this,arguments)}catch(a){console.warn("DetectumAutocompleteController",a)}},_changeHandler:function(b,c){this.constructor.__super__._changeHandler.call(this,b,c),1===a?a=0:this.input.submitForm()},_traverseHandler:function(b,c){a=1,this.constructor.__super__._traverseHandler.call(this,b,c)}}).define("DetectumAutocompleteController")}(),function(){"use strict";function a(){return{base:null,facets:{},sort:null,others:{}}}function b(a,b,c){if(void 0===f.facets[a])f.facets[a]=[b];else{var d=f.facets[a].indexOf(b);d<0?f.facets[a].push(b):c&&(f.facets[a].splice(d,1),f.facets[a].length<1&&delete f.facets[a])}}function c(){void 0!==f.others[j]&&(f.others[j]="0")}function d(a){void 0!==f.facets[a]&&delete f.facets[a]}function e(a){f.sort=a}var f=a(),g=null,h=600,i=null,j="offset";mvideo.Class.Class.extend({constructor:function a(b,c){if(a.instance)return void 0!==b&&b.length>0&&a.instance.buildNavigationState(b),a.instance;a.instance=this,void 0!==c&&(h=c),i=new mvideo.Class.AsyncDataLoader,i.config.showOverlay=!1,this.buildNavigationState(b)},toggleFacet:function(a,d){"string"==typeof d&&(b(a,d,!0),c())},changeSort:function(a){e(a),c()},changePrice:function(a,b){d("price"),this.toggleFacet("price",a+"-"+b),c()},getCurrentPrice:function(){return Array.isArray(f.facets.price)?f.facets.price[0].split("-"):null},invoke:function(a){null!==g&&clearTimeout(g);var b=this.buildQueryString();g=setTimeout(function(){g=null,i.load({url:b},a)},h)},invokeImmediatelly:function(a){null!==i.dfd&&void 0!==i.dfd&&i.dfd.abort(),i.load({url:this.buildQueryString()},a)},buildNavigationState:function(c){f=a();var d=!1,g={},h=0;return d=c.split("?"),d.length>1?(f.base=d[0],d[1].split("&").forEach(function(a){var c=a.split("=");if(c.length>1)if(0===c[0].indexOf("param_"))c[1]=decodeURIComponent(c[1]),h=c[0].slice(6),void 0!==g[h]?(b(c[1],g[h]),delete g[h]):g[h]=c[1];else if(0===c[0].indexOf("value_"))c[1]=decodeURIComponent(c[1]),h=c[0].slice(6),void 0!==g[h]?b(g[h],c[1]):g[h]=c[1];else switch(c[0]){case"params":break;case"sort_order":e(c[1]);break;default:f.others[c[0]]=c[1]}}),!0):(f.base=d[0],!0)},resetState:function(){f.facets={}},_getNavState:function(){return f},buildQueryString:function(){var a=0,b=Object.keys(f.facets).map(function(b){return f.facets[b].map(function(c){return"param_"+ ++a+"="+encodeURIComponent(b)+"&value_"+a+"="+encodeURIComponent(c)}).join("&")});return b=b.concat(Object.keys(f.others).map(function(a){return a+"="+f.others[a]})),null!==f.sort&&b.push("sort_order="+f.sort),f.base+(b.length>0?"?params="+a+"&"+b.join("&"):"")}}).define("DetectumSearchInvoker")}(),function(){"use strict";var a=mvideo.Class.Class.extend({startPayment:function(a){var b=$("#submit-current-order"),c=b.serialize(),d=this;this.config=a||{},$.ajax({url:b.attr("action"),data:c,dataType:"json",type:b.attr("method"),async:!1,success:function(a){a.formError?d.addError(a):(d.saveLogData(a),d.startDirectCreditPayment(a,!0))},error:function(a){d.addError(a)}})},startDirectCreditPayment:function(a,b){var c=String(a.partnerId),d="pilot="+a.pilot,e=this;window.dcOrderIdForCheck=a.orderId,window.DCLoans||this.sendLogNote(!1,this.config.dcFunctionAvailableError),window.DCLoans(c,"delProduct",!1,function(f){!0===f.status?window.DCLoans(c,"addProduct",{products:a.arrProducts},function(f){if(!0===f.status){var g={order:a.orderId,codeTT:a.dcRegionId,promo:a.promo,firstName:a.firstName,lastName:a.lastName,secondName:a.secondName,email:a.email,phone:a.phone,sp:d,pickupDate:a.pickupDate};a.useShortForm||delete g.pickupDate,e.checkWidgetExisting(),window.DCLoans(c,"saveOrder",g,function(a){window.console.log("From DC response: status="+a.status+", error="+a.error),e.sendLogNote(a.status,a.error)},b)}else e.sendLogNote(f.status,f.error)},b):e.sendLogNote(f.status,f.error)},b),this.setHandlerBack()},setHandlerBack:function(){var a=this;$.cookie("press_back","1"),window.onbeforeunload=function(){1==$.cookie("press_back")&&($.ajax({url:$("#commitSuborderErrorURL").attr("redirectURL"),dataType:"json",type:"GET",success:function(a,b,c){}}),a.removeHandlerBack())}},removeHandlerBack:function(){$.cookie("press_back",null)},dcCheckStatus:function(){var a=new mvideo.Class.DirectCreditOld,b=a.getDCOrderStatus(window.dcOrderIdForCheck);a.removeHandlerBack(),document.location.href="success"===b?$("#commitSuborderSuccessURL").attr("redirectURL"):$("#commitSuborderErrorURL").attr("redirectURL")},getDCOrderStatus:function(a){var b=this,c="NotStarted";return $.ajax({url:"/checkout/verificationDCStatus.json.jsp",data:{orderId:a},dataType:"json",type:"GET",async:!1,success:function(a,b,d){"success"!=b?alert(a.error):c=a.status},error:function(a){b.addError(a)}}),c},addError:function(a){$("#page-errors").show().append($("<li>").append(a))},sendLogNote:function(a,b){this.note.error=b,this.note.status=a,this.note.loggingStage="Script is loaded",$.ajax({url:this.config.logUrl,data:this.note,type:"POST",dataType:"text"}).fail(function(a,b,c){window.console.warn("Logging is not available: status = "+b+", msg = "+c)})},saveLogData:function(a){this.note={orderId:a.orderId,arrProducts:JSON.stringify(a.arrProducts)}},checkWidgetExisting:function(){var a,b=this,c=window.mvideo.helpers.mutationObserver;c.isAvailable&&(a={addingCallback:function(a){for(var d=0;d<a.length;d++)"DCFrameBlock"===a[d].id&&(document.cookie="dc_widget_opened=null",b.sendLogNote(!0,""),c.stop())}},c.start("body",a))}});a.define("DirectCreditOld",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({startDirectCreditPayment:function(){var a=this;a.saveLogData(),window.DCLoans||this.sendLogNote(!1,this.config.dcFunctionAvailableError),window.DCLoans(this.config.partnerID,"orderByToken",{token:this.config.guid},function(b){b.status?(window.console.log("From DC response: status="+b.status+", error="+b.error),a.sendLogNote(b.status,b.error)):a.sendLogNote(b.status,b.error)}),this.setHandlerBack()},setHandlerBack:function(){var a=this;$.cookie("press_back","1"),window.onbeforeunload=function(){1==$.cookie("press_back")&&($.ajax({url:a.config.errorURL,dataType:"json",type:"GET",success:function(a,b,c){}}),a.removeHandlerBack())}},removeHandlerBack:function(){$.cookie("press_back",null)},dcCheckStatus:function(){var a,b=this.getDCOrderStatus(this.config.orderId,this.config.guid),c=window.mvideo.helpers.setUrlParam;this.removeHandlerBack(),a="success"===b.status?this.config.successURL:this.config.errorURL,document.location.href=c(a,b.urlParams||{})},getDCOrderStatus:function(a,b){var c=this,d={status:"NotStarted",urlParams:{}},e=window.mvideo.helpers.getUrlParam;return $.ajax({url:"/checkout/verificationDCStatus.json.jsp",data:{orderId:a,guid:b},dataType:"json",type:"GET",async:!1,success:function(a,b,c){if("success"!=b)return void alert(a.error);"string"==typeof a.urlParams&&(a.urlParams=e("?"+a.urlParams)),$.extend(!0,d,a)},error:function(a){c.addError(a)}}),d},addError:function(a){$("#page-errors").show().append($("<li>").append(a))},sendLogNote:function(a,b){this.note.error=b,this.note.status=a,this.note.loggingStage="Script is loaded",$.ajax({url:this.config.logURL,data:this.note,type:"POST",dataType:"text"}).fail(function(a,b,c){window.console.warn("Logging is not available: status = "+b+", msg = "+c)})},saveLogData:function(a){this.note={}}});a.define("DirectCredit",a)}(),function(){var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={autoInit:!1,initScripts:!0,method:"append",tpl:"",tplData:{}},$.extend(!0,this.config,b||{}),this.$={},this.$.holder=$(a),this.initialize()},initialize:function(){return this.config.autoInit&&this.insert(),this},show:function(){return this.$.el.show(),this},hide:function(){return this.$.el.hide(),this},isVisible:function(){return this.$.el.is(":visible")},remove:function(){return this.$.el.remove(),this},detach:function(){return this.$.el.detach(),this},render:function(a,b){return b=b||this.config.tpl,a=a||this.config.tplData,$(b(a))},insert:function(a){return this.$.el?this.$.el:(this.$.el=this.render(),a=a||this.config.method,this.$.holder[a](this.$.el),this.config.initScripts&&this._initScripts(this.$.el),this.$.el)},_initScripts:function(a){return a=a||this.$.el,mvideo.initScripts(a),this}})
;a.define("DynamicElement",a)}(),function(){"use strict";function a(a,b){return $("<"+a+">",b)}var b=mvideo.Class.Class.extend({constructor:function(a,b,c){this.config={method:b||"append",tag:"span",text:{}},this.$={},this.$.holder=$(a),$.extend(!0,this.config,c||{}),this.initialize()},initialize:function(){this.$.el=a(this.config.tag,this.config.attributes),this.$.holder[this.config.method](this.$.el)},changeText:function(a){return a=this.config.text[a]||a,this.$.el.html(a),this},watchFor:function(a,b){this.$.el.on(a,b)},stopWatchFor:function(a,b){this.$.el.off(a,b)}});b.include(mvideo.Mixin.dynamicElement),b.define("DynamicTextElement",b)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={selectors:{items:">li"},states:["collapsed","expanded"],showQty:5,linkConfig:{text:{show:'+ <span class="expandable-list-text">Развернуть</span>',hide:'- <span class="expandable-list-text">Свернуть</span>'},tag:"a",attributes:{href:"#",class:"expandable-list-link pull-right"}},beforeExpand:null,beforeCollapse:null},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.loadObjects(this.$.holder),this.initialize(),this.bindEvents()},initialize:function(){this.link=new mvideo.Class.DynamicTextElement(this.$.holder,"after",this.config.linkConfig),this.link.$.el.before("\x3c!--noindex--\x3e").after("\x3c!--/noindex--\x3e"),this.beforeCollapse=this.config.beforeCollapse,this.beforeExpand=this.config.beforeExpand,this.reinit()},reinit:function(){if(this.hasExtraItems()){this.$.holder.removeClass("transition"),$.data(this.$.holder[0],"collapsed-height",this.getCollapsedHeight()),$.data(this.$.holder[0],"expanded-height",this.getExpandedHeight()),this.collapse();var a=this;setTimeout(function(){a.$.holder.addClass("transition")},0)}else this.link.detach();return this},collapse:function(){this.beforeCollapse&&this.beforeCollapse();var a=$.data(this.$.holder[0],"collapsed-height");this.$.holder.height(a),this.setState("collapsed"),this.link.changeText("show")},expand:function(){this.beforeExpand&&this.beforeExpand();var a=$.data(this.$.holder[0],"expanded-height");this.$.holder.height(a),this.setState("expanded"),this.link.changeText("hide")},getCollapsedHeight:function(){var a=this.$.items.eq(this.config.showQty-1);return a.position().top-a.parent().position().top+a.outerHeight(!0)},getExpandedHeight:function(){var a,b=this.$.holder.height();return this.$.holder.height("auto"),a=this.$.holder.height(),this.$.holder.height(b),a},hasExtraItems:function(){return this.$.items.length>this.config.showQty},bindEvents:function(){var a=this;this.link.watchFor("click",function(b){b.preventDefault(),a.isState("expanded")?a.collapse():a.expand()})}});a.include(mvideo.Mixin.state),a.define("ExpandableList",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){this.form=new mvideo.Class.Form(this.$.holder),this.expandableList=new mvideo.Class.ExpandableList(this.$.holder.find(".facets-list, .facets-colors-list"))},reinit:function(){this.expandableList.reinit()},reset:function(){this.form.reset()}});a.define("FacetForm",a)}(),function(a){"use strict";var b=a.Class.Class.extend({constructor:function(b,c){this.config={selectors:{slider:".facet-price-slider",minPrice:".facet-price-min",maxPrice:".facet-price-max",inputs:".facet-price-range input[type=tel]"},minStep:1,withoutAsyncDataLoader:!1},this.$={},this.$.holder=$(b),this.config.min=this.$.holder.data("min"),this.config.max=this.$.holder.data("max"),this.needCorrection=!0,this.priceCorrector=a.helpers.price(),$.extend(!0,this.config,c||{}),a.observer(this),this.loadObjects(),this.initialize(),this.bindEvents(),this.$.holder.data("facetPrice",this),this.$.holder.trigger("facetPrice:ready")},initialize:function(){var b=this.getInputValues();this.form=new a.Class.Form(this.$.holder),this.slider=new a.Class.RangeSlider(this.$.slider,{range:!0,min:+this.config.min,max:+this.config.max,values:b});var c=this.config.max-this.config.min,d=10*Math.ceil(c/1e4);d=d>90?90:d,this.config.minStep=10*Math.round(c/(10*d)),c||(this.slider.disable(),this.$.minPrice.attr("disabled","disabled"),this.$.maxPrice.attr("disabled","disabled"))},submitRange:function(b){var c,d=document.location.pathname,e=window.location.search?window.location.search:"",f=d.split("/f/")[0],g=this.gerQueryParamsArray(d.split("/f/")[1]),h=this.updateOrAddPriceParams(b,g),i=decodeURIComponent(h.join("/")),j=f+"/f/"+i+e;return this.config.withoutAsyncDataLoader||(c=new a.Class.AsyncDataLoader,c.load({url:j}),"desktop"===a.device.manager.getType()&&a.instance.page.page.goToBlock($(".search-results-container"),-20)),j},submitRangeOld:function(b){var c,d=document.location.pathname,e=this.getQueryParamsObject(window.location.search.substring(1));e.Nf="Price|BTWN+"+b[0]+"+"+b[1],delete e.No;var f=decodeURIComponent(jQuery.param(e)),g=d+"?"+f;return this.config.withoutAsyncDataLoader||(c=new a.Class.AsyncDataLoader,c.load({url:g}),"desktop"===a.device.manager.getType()&&a.instance.page.page.goToBlock($(".search-results-container"),-20)),g},updateOrAddPriceParams:function(a,b){var c=!1,d=-1,e="price=from-"+a[0]+"-to-"+a[1];if(0!==b.length){for(var f=0;f<b.length;f++)-1!==b[f].indexOf("price=")&&(b[f]=e,c=!0);if(!c){for(var g=b.length-1;g>=0;g--)if(b[g].indexOf("category=")||b[g].indexOf("brand=")){d=g;break}-1!==d?b.splice(d+1,0,e):b.unshift(e)}}else b.push(e);return b},gerQueryParamsArray:function(a){var b=[];return void 0!==a&&0!==a.length&&(b=a.split("/")),b},getInputValues:function(){return[this.priceCorrector.getDefaultValue(this.checkInputValues(this.$.minPrice)),this.priceCorrector.getDefaultValue(this.checkInputValues(this.$.maxPrice))]},checkInputValues:function(a){var b=a.val();return $.isNumeric(parseInt(b,10))?b:a[0].defaultValue},setInputValues:function(a){return this.correctValWithSpace(this.$.minPrice,a[0]),this.correctValWithSpace(this.$.maxPrice,a[1]),this},correctValues:function(a){var b=+a[0],c=+a[1],d=+this.config.min,e=+this.config.max;return(!b||b<d)&&(b=d),(!c||c>e)&&(c=e),b>e&&(b=e),c<d&&(c=d),c>e&&(c=e),b>c&&(b=d),[b,c]},reset:function(a){this.form.reset(),this.currentUrl=!1;var b=this.getInputValues();a&&(b=[this.config.min,this.config.max]),this.clearOperationNow=!0,this.slider.setValues(b),this.clearOperationNow=!1},adjustValue:function(a,b){var c,d=jQuery.inArray(b,a);return c=d?Math.ceil:Math.floor,a[d]=c(b/this.config.minStep)*this.config.minStep,a},adjustAndCorrectValues:function(a,b){var c=this.adjustValue(a,b);c=this.correctValues(c),this.setInputValues(c)},blurAction:function(){var a=this;if(a.getInputValues()[0]===this.$.minPrice[0].defaultValue&&a.getInputValues()[1]===this.$.maxPrice[0].defaultValue)return this.$.minPrice.val(this.$.minPrice[0].defaultValue),this.$.maxPrice.val(this.$.maxPrice[0].defaultValue),this;a.needCorrection=!1;var b=a.correctValues(a.getInputValues());a.setInputValues(b),a.slider.setValues(b)},checkEqual:function(a){var b=this.config.minStep;if(a[0]>=a[1])return a[1]=a[0]+b,!1},bindEvents:function(){var a=this;this.$.slider.on("slide",function(b,c){a.checkEqual(c.values),a.adjustAndCorrectValues(c.values,c.value),a.needCorrection=!0}).on("slidechange",function(b,c){var d;a.needCorrection&&(a.checkEqual(c.values),a.adjustAndCorrectValues(c.values,c.value)),a.$.inputs.trigger("change",a.getInputValues()),a.clearOperationNow||(d=!0===$("[data-init=facet]").data("seourlformatrule")?a.submitRange(a.getInputValues()):a.submitRangeOld(a.getInputValues()),a.currentUrl=d,a.publish("changeUrl",d))}).on("slidestop",function(b,c){a.blurAction()}),this.form.watchFor("blur",function(){a.blurAction()}),this.$.inputs.on("keypress",function(b){13==b.which&&a.blurAction()}).on("input",function(){var b=$(this);a.correctValWithSpace(b,b.val())}).on("dblclick",function(a){$(a.target).select()})},unbindEvents:function(){this.$.slider.off("slide").off("slidechange")},reinit:function(){},correctValWithSpace:function(a,b){var c=this.priceCorrector.spaceCorrectPrice(this.priceCorrector.getDefaultValue(b)),d=a.caret();c.length>1&&"0"===c[0]&&(c=c.replace("0","")),a.val(c),d&&(d.end+=c.length-b.length,d.end-=" "===c[d.end-1],d.end=d.end<0?0:d.end,a.caret(d.end,d.end))}});b.include(a.Mixin.url),b.define("FacetPrice",b)}(window.mvideo),function(){"use strict";var a=mvideo.Class.FacetPrice.extend({constructor:function(a,b){this.constructor.__super__.constructor.apply(this,arguments)},initialize:function(){$.isArray(this.config.currentPrices)&&this.setInputValues(this.config.currentPrices),this.constructor.__super__.initialize.apply(this)},submitRange:function(){this.submitRangeDetectum.apply(this,arguments)},submitRangeOld:function(){this.submitRangeDetectum.apply(this,arguments)},submitRangeDetectum:function(a){var b=new mvideo.Class.DetectumSearchInvoker;b.changePrice.apply(b,a),b.invoke()}});a.define("FacetPriceDetectum",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){},reinit:function(){},reset:function(){}});a.define("FacetRating",a)}(),function(){"use strict";var a=null,b=!1,c=mvideo.Class.Class.extend({constructor:function(b,c){a=this,this.config={defaultMethod:"prepend",enableStickyItem:!1,routes:{desktop:{target:".search-results-container"},tablet:{target:".sidebar"},mobile:{target:".sidebar"}}},$.extend(!0,this.config,c),this.$={},this.$.holder=$(b),this.initialize(),this.bindEvents()},initialize:function(){this.page=mvideo.instance.page.page,this.sidebar=new mvideo.Class.BarItem(this.$.holder),this.page.sidebar.controller.register(this.sidebar),this.facets=this.getFacetsCollection(),this.stickyItem=new mvideo.Class.StickyItem(this.$.holder,{enable:this.config.enableStickyItem}),this.subscribeForAsyncUpdate()},getFacets:function(){var a=this.$.holder.find("[data-facet]");return $.map(a,function(a){return{item:a,type:$(a).data("facet")}})},getFacetsCollection:function(a){var b=this;a=a||this.getFacets();var c=new mvideo.Class.ModulesCollection;return $.each(a,function(a,d){switch(d.type){case"form":c.add(new mvideo.Class.FacetForm(d.item));break;case"price":b.priceFacet=new mvideo.Class.FacetPrice(d.item),c.add(b.priceFacet);break;case"rating":c.add(new mvideo.Class.FacetRating(d.item));break;case"dropDown":break;default:throw d.type+" hasn't been implemented"}}),c},bindEvents:function(){var a,c=this,d=c.sidebar,e=c.page.sidebar,f=new mvideo.Class.AsyncDataLoader,g=d.$.holder.find(".facet-section-wrapper"),h=$(".facet-area").find("select"),i=$(".sticky-header");$(".search-results-facet-filter, .close-facet-btn, .c-plp-result-toolbar__filter").off("click").on("click",function(b){var f=$(b.currentTarget),h=e.isVisible();b.preventDefault(),f.hasClass("close-facet-btn")&&!f.hasClass("btn-invers-deep-grey")&&mvideo.instance.page.page.goToBlock($(".search-results-area")),h?c.closeFacetHandler():(g.css("left","0"),e.show(d),a=g.width(),i.css("left",a)),c.facets.run("reinit")}),this.$.holder.off("click",".facets-list-item").on("click",".facets-list-item",function(a){var b=$(this).find("input");b.attr("disabled")||(b.attr("checked",!0),f.load({url:$(this).closest("li").find(".facet-name").attr("href")},a),"desktop"===mvideo.device.manager.getType()&&mvideo.instance.page.page.goToBlock($(".search-results-container"),-20))}),h.off("change").on("change",function(a){f.load({url:$(this).val()},a)}),g.scroll(function(){(new mvideo.Class.CustomSelect).hideDrop(h)}),this.$.holder.off("submit",".facets-holder").on("submit",".facets-holder",function(a){if($(this).find(".btn-secondary.disabled").length>0)return void a.preventDefault();c.priceFacet&&(c.priceFacet.unbindEvents(),c.priceFacet.reset(!0)),$(this).find(".facets-list-item input:checked").not("[disabled]").attr("checked",!1),f.load({url:$(this).find(".facet-reset input:first-child").val()},a),mvideo.instance.page.page.goTo()}),b||(b=!0,mvideo.Event.subscribe("sidebar-close",this.closeFacetHandler.bind(this)))},closeFacetHandler:function(){var a=this.page.sidebar,b=this.sidebar;a&&b&&(this.stickyItem.hide(b),a.hide(b))},hideSidebarOverlay:function(){this.page.sidebar.hideOverlay()},_beforeRequest:function(){"desktop"!==mvideo.device.manager.getType()&&(this.overlay.show($(this.config.routes.mobile.target)),this.stickyItem.disable()),mvideo.Event.unsubscribe("orientationchange",this.updateSidebarAreaSize)},_afterRequest:function(){"desktop"!==mvideo.device.manager.getType()&&this.overlay.get($(this.config.routes.mobile.target)).hide()},subscribeForAsyncUpdate:function(){(new mvideo.Class.AsyncDataLoader).addModule({container:this.$.holder,dataAdapter:function(a){for(var b=0;b<a.length;b++)if(a[b].searchFacets)return{facets:a[b].searchFacets}},onDataHandler:function(a){try{a.facets&&($("#js-facet-section").off().find("*").off().end().replaceWith(a.facets),mvideo.initScripts($(".facet-section")))}catch(a){}},beforeRequest:function(){var a=mvideo.Class.FacetSection.getLatestInstance();a&&a._beforeRequest()},afterRequest:function(){var a=mvideo.Class.FacetSection.getLatestInstance(),b=$(".facet-area");a&&a._afterRequest(),mvideo.Class.ReinitContent.customSelect(b)},moduleName:"facets"})}},{getLatestInstance:function(){return a}});c.include(mvideo.Mixin.showHide,mvideo.Mixin.domTraveler,mvideo.Mixin.overlay),c.define("FacetSection",c)}(),function(){"use strict";var a=null,b=mvideo.Class.FacetSection.extend({constructor:function(b,c){a=new mvideo.Class.DetectumSearchInvoker(location.href,800),this.constructor.__super__.constructor.apply(this,arguments),this.stickyItem=new mvideo.Class.StickyItemDetectum(this.$.holder,this.config.enableDetectumStickyItem),this.updateFacetsElementState()},updateFacetsElementState:function(){function b(a){var b=document.getElementById(g+String.fromCharCode(191)+a);void 0!==b&&null!==b&&$(b).children("input").prop("checked",!0)}var c=a._getNavState(),d=this.$.holder,e=this.$.holder.find(".facet-reset .btn"),f=this.$.holder.find(".js-close-facet .btn");d.find(".facets-list-item > input").prop("checked",!1),Object.keys(c.facets).length>0&&(e.removeClass("disabled"),void 0!==this.config.closeBtnTextOnFilter&&this.config.closeBtnTextOnFilter.length>0&&f.removeClass("btn-invers-deep-grey").text(this.config.closeBtnTextOnFilter),this.stickyItem.initialize(!0));for(var g in c.facets)"price"!==g&&c.facets[g].forEach(b)},enableSwipe:function(){$(".search-results-container").swipe("enable"),this.$.holder.swipe("enable")},disableSwipe:function(){$(".search-results-container").swipe("disable"),this.$.holder.swipe("disable")},bindEvents:function(){var b=this,c=b.sidebar,d=b.page.sidebar,e=c.$.holder.find(".facet-section-wrapper"),f=function(a,f,g,h,i,j){var k=d.isVisible(),l=null;"right"!==f||k||(l="show",window.scrollTo(0,0),e.css("left","0")),null!==l&&d[l](c).done(function(){b.stickyItem.publish("facet:stickyItemUpdate")}),b.facets.run("reinit")};$(".search-results-container").swipe({swipe:f,allowPageScroll:$.fn.swipe.pageScroll.VERTICAL}),this.$.holder.swipe({swipe:f,allowPageScroll:$.fn.swipe.pageScroll.VERTICAL}),this.constructor.__super__.bindEvents.apply(this),this.$.holder.off("submit",".facets-holder"),this.$.holder.off("click",".facets-list-item").on("click",".facets-list-item",function(b){b.preventDefault();try{var c=$(this).find("input");c.prop("checked",!c.prop("checked"));var d=$(this).attr("id").split(String.fromCharCode(191));a.toggleFacet.apply(a,d),a.invokeImmediatelly(b)}catch(a){window.console.warn(a)}}),this.$.holder.off("click",".facet-reset>.btn").on("click",".facet-reset>.btn",function(c){if($(this).hasClass("disabled"))return void c.preventDefault();b.priceFacet&&(b.priceFacet.unbindEvents(),b.priceFacet.reset(!0)),$(b.$.holder).find(".facets-list-item input:checked").not("[disabled]").attr("checked",!1),a.resetState(),a.invokeImmediatelly(c)})},getFacetsCollection:function(b){var c=this;b=b||this.getFacets();var d=new mvideo.Class.ModulesCollection;return $.each(b,function(b,e){switch(e.type){case"form":d.add(new mvideo.Class.FacetForm(e.item));break;case"price":c.priceFacet=new mvideo.Class.FacetPriceDetectum(e.item,{currentPrices:a.getCurrentPrice()}),d.add(c.priceFacet);break;case"rating":d.add(new mvideo.Class.FacetRating(e.item));break;case"dropDown":break;default:throw e.type+" hasn't been implemented"}}),d},_beforeRequest:function(){var a=mvideo.device.manager.getType();this.overlay.show($(".search-results-area")),"desktop"!==a&&this.stickyItem.disable(),mvideo.Event.unsubscribe("orientationchange",this.updateSidebarAreaSize)},_afterRequest:function(){var a=mvideo.device.manager.getType();this.overlay.get($(".search-results-area")).hide(),"desktop"!==a&&this.updateSidebarAreaSize({data:{facetSection:this}})},updateSidebarAreaSize:function(a){}});b.define("FacetSectionDetectum",b)}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){this.config=$.extend(!0,{inputFocus:null,blockElement:null,activeClass:"active"},b),this.$={holder:$(a)}},initialize:function(){var a=this.changeState.bind(this,!1);this.checkSelfAndRemove=this.checkSelf.bind(this,a),this.addState=this.changeState.bind(this,!0),this.bindEvents()},dispose:function(){this.unbindEvents()},bindEvents:function(){this.$.holder.on("focus",this.config.inputFocus,this.addState),$(document.body).on("click",this.checkSelfAndRemove)},checkSelf:function(a,b){$(b.target).parents(this.config.blockElement).length<1&&a()},changeState:function(a){this.$.holder[a?"addClass":"removeClass"](this.config.activeClass)},unbindEvents:function(){this.$.holder.off("focus",this.addState),$(document.body).off("click",this.checkSelfAndRemove)}}).define("FocusBlurState")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={selectors:{items:":input"}},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.loadObjects(this.$.holder),this.initialize()},initialize:function(){this.elements=this.getElementsCollection()},getElementsCollection:function(a){a=a||this.$.items;var b=new mvideo.Class.ModulesCollection,c=new mvideo.Class.InputFactory;return a.each(function(){var a=c.create(this);a&&b.add(a)}),b},reset:function(){this.elements.run("reset")},watchFor:function(a,b){this.$.holder.on(a,this.config.selectors.items,b)},stopWatchFor:function(a,b){this.$.holder.off(a,this.config.selectors.items,b)}});a.define("Form",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={initValue:"init-value",oldValue:"old-value",errorClass:"error",successClass:"success"},this.$={},this.$.el=$(a),this.el=this.$.el[0],$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){return this.$.inputHolder=this.$.el.closest(".input"),this.storeInitValue(),this.storeValue(),this},clear:function(){console.error(this,"Should be implemented in the child class","clear")},getValue:function(){console.error(this,"Should be implemented in the child class","getValue")},setValue:function(){console.error(this,"Should be implemented in the child class","setValue")},storeValue:function(a,b){return a=a||this.getValue(),b=b||this.config.oldValue,$.data(this.el,b,a),this},storeInitValue:function(a){return this.storeValue(a,this.config.initValue),this},getStoredValue:function(a){return a=a||this.config.oldValue,$.data(this.el,a)},wasChanged:function(){var a=this.getValue(),b=this.getStoredValue(),c=a!==b;return c?(this.handleValueChange(),c):c},handleValueChange:function(){return this.storeValue(),this},focus:function(){return this.el.focus(),this},markAsError:function(){this.$.inputHolder.addClass(this.config.errorClass),this.$.inputHolder.removeClass(this.config.successClass)},markAsSuccess:function(){this.$.inputHolder.addClass(this.config.successClass),this.$.inputHolder.removeClass(this.config.errorClass)},markAsDefault:function(){this.$.inputHolder.removeClass(this.config.successClass),this.$.inputHolder.removeClass(this.config.errorClass)},getAttribute:function(a){return this.$.el.attr(a)},setAttribute:function(a,b){return this.$.el.attr(a,b)},getType:function(){return this.getAttribute("type")},reset:function(a){a=a||this.config.initValue;var b=this.getStoredValue(a);this.setValue(b)},submitForm:function(){return this.$.el.closest("form").submit(),this}});a.define("Input",a)}(),function(){"use strict";var a=mvideo.Class.Input.extend({constructor:function(a,b){this.config={initValue:"init-value",oldValue:"old-value"},this.$={},this.$.el=$(a),this.el=this.$.el[0],$.extend(!0,this.config,b||{}),this.initialize()},isChecked:function(){return this.el.checked},check:function(){return this.$.el.attr("checked","checked")},unCheck:function(){return this.$.el.removeAttr("checked")},changeState:function(){return this.isChecked()?this.unCheck():this.check()},setValue:function(a){return a?this.check():this.unCheck()},getValue:function(){return this.isChecked()},clear:function(){this.unCheck()}});a.define("InputCheckbox",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={oldValue:"old-value"},$.extend(!0,this.config,a||{})},create:function(a,b){var c,d=$(a),e=d.attr("type");switch(e){case"checkbox":c=new mvideo.Class.InputCheckbox(d,b);break;case"radio":c=new mvideo.Class.InputRadio(d,b);break;case"text":c=new mvideo.Class.InputText(d,b);break;default:console.warn("Unknown input type "+e)}return c}});a.define("InputFactory",a)}(),function(){"use strict";var a=mvideo.Class.InputCheckbox.extend({constructor:function(a,b){this.config={initValue:"init-value",oldValue:"old-value"},this.$={},this.$.el=$(a),this.el=this.$.el[0],$.extend(!0,this.config,b||{}),this.initialize()}});a.define("InputRadio",a)}(),function(){"use strict";var a=mvideo.Class.Input.extend({constructor:function(a,b){mvideo.Class.Input.apply(this,arguments)},isEmpty:function(){return 0===this.getValue().length},getValue:function(){return this.$.el.val()},setValue:function(a){return this.$.el.val(a)},clear:function(){return this.$.el.val("")}});a.define("InputText",a)}(),function(){"use strict";var a=mvideo.Class.InputText.extend({constructor:function(a,b){this.config={activeClass:"autocomplete",pattern:/^[a-zа-я0-9\.\(\)\-\, ]+$/i,preventSubmit:!0},$.extend(!0,this.config,b||{}),mvideo.Class.InputText.apply(this,[a,this.config]),mvideo.observer(this),this.$.el.attr("autocomplete","off"),this.bindEvents()},isActive:function(){return this.$.el.hasClass(this.config.activeClass)},setActive:function(){return this.$.el.addClass(this.config.activeClass),this},unsetActive:function(){return this.$.el.removeClass(this.config.activeClass),this},bindEvents:function(){var a=this;a.$.el.on("keyup",function(b){var c=a.getValue().trim(),d="";switch(b.keyCode){case 38:d="up";break;case 40:d="down";break;case 13:d="return",a.publish("submit",c);break;case 27:d="escape"}d&&a.publish("traverse",d,c)}),a.$.el.on("input",function(b){var c=a.wasChanged(),d=a.getValue().trim();if(c){var e=a.config.pattern.test(d),f=e?"input":"error";a.publish(f,d)}}),a.$.el.on("focus",function(b){a.publish("focus")}),a.$.el.on("keydown",function(b){9===b.keyCode&&a.publish("traverse","tab")}),this.config.preventSubmit&&a.$.el.on("keypress",function(a){13===a.keyCode&&a.preventDefault()})}});a.define("InputTextAutocomplete",a)}(),function(){"use strict";var a=window.mvideo.Class.Class.extend({constructor:function a(b){if(a.instance)return a.instance;a.instance=this,this.config={element:"#js-product-tabs .c-tabs__menu-list",orders:0},this.$={},this.init()},init:function(){this.$.tabs=$(this.config.element),this.config.orders=this.$.tabs.find(".c-tabs__menu-item").length},findActiveOrder:function(){return window.Number(this.$.tabs.find(".c-tabs__menu-item.active a").data("target").replace(/\D/g,""))},getAmount:function(){return this.config.orders}});a.define("GTMforTYP",a)}(),function(){var a=mvideo.Class.Class.extend({constructor:function(){this.oldvalue={}},getTime:function(){return(new Date).getTime()},updateDataPush:function(a){this.oldvalue=a;try{window.dataLayer.push({event:"OWOX",eventCategory:"Non-Interactions",eventAction:"show",eventLabel:"product",products:this.oldvalue})}catch(a){}},updateDataPushProduct:function(a){try{window.dataLayer.push({event:"OWOX",eventCategory:"Interactions",eventAction:"open",eventLabel:"productPage",eventProductPriceLocal:a.productPriceLocal,eventProductId:a.productId,eventProductName:a.productName,eventProductCategoryId:a.productCategoryId,eventProductCategoryName:a.productCategoryName,eventProductBrandName:a.productVendorName,eventproductGroupId:a.productGroupId,eventLocation:a.Location||"none",eventPosition:a.eventPosition})}catch(a){}},getDataProduct:function(a){if(this.oldvalue.products&&a)for(var b in this.oldvalue.products)if(this.oldvalue.products[b].eventProductId===a)return this.oldvalue.products[b];return""},getIdProduct:function(a){var b=a.match(/.+\-(\d+)/);return b&&b[1]}});a.define("GTMPushOnload",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={activeClass:"active",items:".tab-body"},$.extend(!0,this.config,b||{}),this.$={},this.$.holder=a instanceof jQuery?a:$(a),this.$.items="string"==typeof this.config.items?this.$.holder.find(this.config.items):this.config.items}});a.include(mvideo.Mixin.itemsContainer),a.define("ItemsContainer",a)}(),function(){"use strict";var a=mvideo.Class.ItemsContainer.extend({constructor:function(a){this.constructor.__super__.constructor.call(this,a)},setActiveItem:function(a){return this.constructor.__super__.setActiveItem.call(this,a)},unsetActiveAll:function(a){return this.constructor.__super__.unsetActiveAll.call(this,a)},unsetActiveItem:function(a){return this.constructor.__super__.unsetActiveItem.call(this,a)}});a.define("ItemsContainerAccordion",a)}(),function(){"use strict";var a=mvideo.Class.ItemsContainer.extend({constructor:function(a){this.constructor.__super__.constructor.call(this,a)},setActiveItem:function(a){return this.constructor.__super__.setActiveItem.call(this,a)},unsetActiveAll:function(){return this.constructor.__super__.unsetActiveAll.call(this)},unsetActiveItem:function(a){return this.constructor.__super__.unsetActiveItem.call(this,a)}});a.define("ItemsContainerTabs",a)}(),function(){"use strict";var a=mvideo.Class.ItemsContainer.extend({constructor:function(a,b){this.config={preventRedirect:!1,activeClass:"active",tpl:mvideo.template.autocompleteItems,selectors:{items:".suggested-search-list li",itemsHolder:".suggested-search-holder"},seleniumClasses:{}},mvideo.observer(this),this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.loadObjects(this.$.holder),this.initialize(),this.bindEvents()},initialize:function(){},update:function(a){return a&&this.$.holder.html(a),this.loadObjects(this.$.holder),this},render:function(a){var b=this.config.tpl($.extend({seleniumClasses:this.config.seleniumClasses},a));return this.update(b)},setNext:function(){return this._setActive("next",0)},setPrev:function(){return this._setActive("prev",this.$.items.length-1)},getSelecterItemUrl:function(){return this.getActiveItem().find("a").attr("href")},bindEvents:function(){var a=this;this.$.holder.on("click","a",function(b){a.config.preventRedirect&&b.preventDefault(),a.publish("change",$(this).parent())})},_setActive:function(a,b){var c,d=this.getActiveItem(),e=this.$.items.index(d),f="next"===a?e+1:e-1;return c=!d.length||f<0||f>=this.$.items.length?this.$.items.eq(b):this.$.items.eq(f),this.setActiveItem(c),this.publish("change",c),this}});a.define("ItemsListController",a)}(),function(){"use strict";function a(a,c){return!a.storage.hasOwnProperty(c)&&(Object.defineProperty(a.storage,c,{get:function(){return this["_"+c]},set:function(d){this["_"+c]=d;for(var e=0,f=a.instances.length;e<f;e++){var g=a.instances[e];g.$[c]&&b(c,g.$[c],d,g.config.allowHtml,g.config.doReinitContent,g.config.dataChangeLsnr&&g.config.dataChangeLsnr[c]?g.config.dataChangeLsnr[c]:null,a.changeEventName)}a.changeEventName=null}}),!0)}function b(a,b,c,d,e,f,g){var h=!0;f&&(h=f(b,c,a,g)),!1!==h&&(b[d?"html":"text"](void 0!==h&&!0!==h?h:c),e&&mvideo.Class.ReinitContent.reinit(b))}var c={},d={},e=mvideo.Class.AbstractAjaxController,f=e.extend({constructor:function(a,b){e.call(this,{doParticipateInAjax:!1,doRegisterObserver:!0,doReinitContent:!1,allowHtml:!1,showOverlay:!1,selectors:{},dataChangeLsnr:{},ajaxResponseName:"default"}),this.activeChangeEventName="",$.extend(!0,this.config,b||{}),this.$.holder=$(a),this.loadObjects(a,this.config.selectors),this.registerInstance()&&this.registerNewObserver()},registerNewObserver:function(){if(this.config.doRegisterObserver){var c=null;d[this.config.ajaxResponseName]?(c=d[this.config.ajaxResponseName],c.instances.push(this)):(c={instances:[this],storage:{},changeEventName:""},d[this.config.ajaxResponseName]=c);for(var e in this.config.dataChangeLsnr)this.config.selectors[e]||(this.config.selectors[e]="##",this.$[e]=$());for(var f in this.config.selectors)a(c,f)||b(f,this.$[f],c.storage[f],this.config.allowHtml,this.config.doReinitContent,this.config.dataChangeLsnr&&this.config.dataChangeLsnr[f]?this.config.dataChangeLsnr[f]:null,"registration")}},registerInstance:function(){if(this.config.ajaxResponseName.length<1&&(this.config.ajaxResponseName="_"),c[this.config.ajaxResponseName]){for(var a=0;a<c[this.config.ajaxResponseName].length;a++)if(c[this.config.ajaxResponseName][a]===this)return!1;c[this.config.ajaxResponseName].push(this)}else c[this.config.ajaxResponseName]=[this];return!0},get:function(a,b,c){var d=this;return this._showOverlays(),c||(c="ajax"),this._request("post",a,b,function(a){d._commonHandler.call(d,a,c)})},setData:function(a,b,c){var e=null,f={};d[this.config.ajaxResponseName]&&d[this.config.ajaxResponseName].storage.hasOwnProperty(a)&&(e=d[this.config.ajaxResponseName].storage[a],d[this.config.ajaxResponseName].changeEventName=c||"setData",d[this.config.ajaxResponseName].storage[a]=b,e!==d[this.config.ajaxResponseName].storage[a]&&(f[a]={oldValue:e,newValue:d[this.config.ajaxResponseName].storage[a]},this._emitChangeListEvent(this.config.ajaxResponseName,c,f)))},getData:function(a){if(d[this.config.ajaxResponseName])return d[this.config.ajaxResponseName].storage[a]},ajaxResponseHandler:function(a,b){},_showOverlays:function(){for(var a in c)for(var b=0,d=c[a].length;b<d;b++)c[a][b].config.showOverlay&&this.overlay.show(this.$.holder)},_emitChangeListEvent:function(a,b,c){var d={listName:a,eventName:b,changedData:c,elements:{}};for(var e in c)d.elements[e]=this.$[e];mvideo.Event.publish("listchange",d)},_hideOverlays:function(){for(var a in c)for(var b=0,d=c[a].length;b<d;b++)c[a][b].config.showOverlay&&this.overlay.hide(this.$.holder)},_commonHandler:function(a,b){var e=null,f=null,g={};if(a)for(var h in a)if(c[h]){f=a[h],g={};for(var i=0,j=c[h].length;i<j;i++)c[h][i].config.doParticipateInAjax&&c[h][i].ajaxResponseHandler(f,h);if(d[h]){for(var k in f)e=d[h].storage[k],d[h].storage.hasOwnProperty(k)?(d[h].changeEventName=b||"ajax",d[h].storage[k]=f[k],e!==d[h].storage[k]&&(g[k]={oldValue:e,newValue:d[h].storage[k]})):g[k]={oldValue:e,newValue:f[k]};Object.keys(g).length>0&&this._emitChangeListEvent(h,b,g)}else{for(k in f)g[k]={oldValue:null,newValue:f[k]};this._emitChangeListEvent(h,b,g)}}this.config.showOverlay&&this.overlay.hide(this.$.holder)}});f.include(mvideo.Mixin.overlay),f.define("ListStateManager")}(),function(){"use strict";var a={};mvideo.Class.Class.extend({constructor:function(b,c){var d=this;d.csi=null,d.$={},d.config={},d.dataChangeLsnr={},d.$.holder=$(b),d.defaultOptions={ajaxResponseName:null,onCounterChange:null,reinitContent:!1,dropDownHoverClassName:"hover",timeoutHover:200,addToList:{actionType:"click"}},$.extend(!0,d.config,d.defaultOptions,c),null!==d.config.ajaxResponseName?(d._parseIntegerOptions(),d._configActionForm(),d._configListStateManager({
allowHtml:!0,showOverlay:!1,selectors:$.extend({},d.config.ajaxSelectors),ajaxResponseName:d.config.ajaxResponseName,dataChangeLsnr:d._prepareDataChangeHandlers(),doReinitContent:d.config.reinitContent}),$.isFunction(d.config.configDeleteButtonEventHandlers)?d.config.configDeleteButtonEventHandlers.call(d):d._configDeleteButtonEventHandlers(),d._configCustomScrollBar(),d._configDropDownHover(),a[d.config.ajaxResponseName]||(a[d.config.ajaxResponseName]=!0,d.config.initFromAjax?d.queryState(d.$.actionForm.attr("action"),"fromInit"):d._initCurrentAmount(),d._configActionEventHandler()),d.initDone=!0):console.warn("'ListStateViewController' unconfigured 'ajaxResponseName' option, initialization skipped !")},getCurrentAmount:function(){return this.manager.getData(this.config.counterName)},_parseIntegerOptions:function(){var a=this;["timeoutHover"].forEach(function(b){a.config[b]&&(a.config[b]=parseInt(a.config[b]),isNaN(a.config[b])?console.warn("'ListStateViewController' can't parse given option '"+b+"' resetting to default: "+a.defaultOptions[b]):a.config[b]=a.defaultOptions[b])})},_configActionForm:function(){this.config.actionForm&&(this.$.actionForm=$(this.config.actionForm))},_prepareDataChangeHandlers:function(){var a=this;return a.config.counterName&&(a.dataChangeLsnr[a.config.counterName]=function(b,c,d,e){c>0?(b.show(),a.$.holder.removeClass("default")):(b.hide(),a.$.holder.addClass("default")),null!==a.csi&&setTimeout(a.csi.update.bind(a.csi),0),$.isFunction(a.config.onCounterChange)&&a.config.onCounterChange(b,c,e)}),a.dataChangeLsnr},queryState:function(a,b){return this.manager.get(a,null,b)},_configListStateManager:function(a){this.manager=new mvideo.Class.ListStateManager(this.$.holder,a)},_initCurrentAmount:function(){var a=this;a.config.counterName&&a.manager.setData(a.config.counterName,parseInt(a.manager.$[a.config.counterName].text()))},_configActionEventHandler:function(){var a=this;a.config.addToList.actionElement&&$(document).off(a.config.addToList.actionType).on(a.config.addToList.actionType,a.config.addToList.actionElement,function(b){var c=a.preAjax(b);a.manager.get(c.form.attr("action"),c.form.serialize()).then(function(){a.postAjax(c)})})},_configDeleteButtonEventHandlers:function(){var a=this;a.config.deleteBtn&&(a.config.itemPlate&&a.$.actionForm&&a.$.actionForm.length>0?a.$.holder.on("click",a.config.deleteBtn,function(b){b.preventDefault();var c=a.preAjaxDelete(b);a.manager.get(a.$.actionForm.attr("action"),a.$.actionForm.serialize()).then(function(){a.postAjaxDelete(c)})}):console.warn("'ListStateViewController' you have 'deleteBtn' setting, but 'itemPlate' or 'actionForm' is incorrect"))},_configCustomScrollBar:function(){var a=this;if(a.config.customScrolled){var b=$(a.config.customScrolled,a.$.holder);if(b.length>0){a.csi=new mvideo.Class.CustomScroll(b,{selectors:{scrolledArea:b.children().first()}});var c=b.parentsUntil(".sticky-header");c.length>0&&c.on("sticky-show",function(b){a.csi.update()})}else console.warn("'ListStateViewController' can't find element for 'customScrolled' option",this)}},_configDropDownHover:function(){var a=this;a.config.timeoutHover>0&&a.$.holder.on("mouseleave",function(b){a.$.holder.addClass(a.config.dropDownHoverClassName),setTimeout(a.clearHover.bind(a),a.config.timeoutHover)})},clearHover:function(){this.$.holder.removeClass(this.config.dropDownHoverClassName)},preAjax:function(a){return this.defaultPreAjax(a)},postAjax:function(a){return this.defaultPostAjax(a)},preAjaxDelete:function(a){return this.defaultPreAjaxDelete(a)},postAjaxDelete:function(a){return this.defaultPostAjaxDelete(a)},defaultPreAjax:function(a){var b=$(a.target),c=b.closest("form");return b.attr("disabled","disabled"),{input:b,form:c}},defaultPostAjax:function(a){a.input.removeAttr("disabled")},defaultPreAjaxDelete:function(a){var b=$(a.target).closest(this.config.itemPlate),c=b.data(),d=this.$.actionForm.get(0);this.config.overlayParent&&this.manager.overlay.show(b,!1,$(this.config.overlayParent,this.$.holder));for(var e in c){if(0===e.indexOf("action")){var f=e.substr(6);d.elements.namedItem(f)?d.elements.namedItem(f).value=c[e]:(f=f.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase(),d.elements.namedItem(f)&&(d.elements.namedItem(f).value=c[e]))}}return b},defaultPostAjaxDelete:function(a){var b=a.attr("data-action-productid"),c=$(".add-to-basket-button[data-id='add-button-"+b+"']");try{this.manager.overlay.hide(a)}catch(a){}c.length>0&&c.each(function(){var a=$(this),b=a.attr("data-init-param")||a.attr("data-add-button-classes"),c=JSON.parse(b),d=c.event;a.removeClass(c.successIcon).addClass(c.buttonIcon),a.removeClass(c.successButtonClass),a.val(c.buttonText),d&&d.trigger&&$(d.holder).trigger(d.name,"delete")})}}).define("ListStateViewController")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={selectors:{items:".header-nav-item",subMenuHolder:".header-nav-drop-down-holder",subMenuList:".header-nav-drop-down-list",subMenuColumn:".header-nav-drop-down-column",banner:".drop-down-advert",headerClass:".header-main"},delay:300,bannerGap:20,submenuBottomGap:29,parentActiveClass:"parent-active",headerActiveClass:"header-active",activeClass:"active"},this.$={},this.$.holder=$(a),this.loadObjects(this.$.holder),this.initialize(),this.bindEvents()},initialize:function(){this.lazyLoad=new mvideo.Class.LazyLoad;var a=this,b=a.$.holder.closest(a.config.selectors.headerClass);return $(".header-nav-list").menuAim({triggerEvent:"hover",activateCallback:function(c){var d=$(c);a.checkBannerHeight(d),a.$.holder.addClass(a.config.parentActiveClass),b.addClass(a.config.headerActiveClass),a.setActiveItem(d),d.trigger("shown")},deactivateCallback:function(c){var d=$(c);a.$.holder.removeClass(a.config.parentActiveClass),b.removeClass(a.config.headerActiveClass),a.unsetActiveItem(d)},enter:function(){},exitMenuCallback:function(){return a.unsetActiveItem($(a.config.selectors.items)),a.$.holder.removeClass(a.config.parentActiveClass),!0},submenuDirection:"below",activationDelay:a.config.delay,tolerance:0}),this},checkBannerHeight:function(a){var b=this,c=a.find(b.config.selectors.subMenuList),d=a.find(b.config.selectors.banner);d.length&&"0px"==c.css("height")&&setTimeout(function(){var e=a.find(b.config.selectors.subMenuList).next(),f=e.height()+parseFloat(e.css("margin-bottom")),g=a.find(b.config.selectors.subMenuColumn).eq(3).height(),h=a.find(b.config.selectors.subMenuColumn).eq(4).height(),i=a.find(b.config.selectors.subMenuColumn).eq(5).height(),j=c.height(),k=Math.max(g,h,i),l=a.find(b.config.selectors.subMenuHolder),m=parseFloat(l.css("padding-bottom"))+parseFloat(c.css("padding-bottom"))+parseFloat(c.css("margin-bottom"))+f+b.config.submenuBottomGap,n=d.height()-m,o=j-k;(0===o||o<=n+b.config.bannerGap)&&c.height(k+n+b.config.bannerGap)},10)},bindEvents:function(){var a=this;a.$.items.one("shown",function(){a.lazyLoad.update()})}});a.include(mvideo.Mixin.itemsContainer),a.define("MainNavigation",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={type:"yandex#map",zoom:10,center:[55.76,37.64],zoomSingle:15,controls:[]},this.$={},this.$.holder=a instanceof jQuery?a:$(a),$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){this.map=new window.ymaps.Map(this.$.holder.get(0),{type:this.config.type,zoom:this.config.zoom,center:this.config.center,controls:this.config.controls},{suppressMapOpenBlock:!0}),this.markers=[],this.map.controls.add(new ymaps.control.ZoomControl({options:{layout:new mvideo.Class.SampleZoomLayout({style:this.setCssZoomYandex(this.$.holder.innerHeight())})}}),{float:"none",position:{top:0,right:10}}),this.bindEvents()},bindEvents:function(){var a=this;this.map.events.add("click",function(b){"desktop"!==mvideo.device.manager.getType()&&a.map.balloon.close()})},initMarkersByUrl:function(a){return $.getJSON(encodeURI(a),function(a){return a&&a.stores&&this.initMarkers(a.stores),a}.bind(this))},initMarkers:function(a,b){var c,d,e=this.$.holder.data("mapConfig"),f=ymaps.templateLayoutFactory.createClass('<div style="color: #FFFFFF;">{{ properties.geoObjects.length }}</div>'),g={gridSize:80,zoomMargin:[50,20,0,20],clusterIcons:[{href:e&&e.icons?e.icons.cluster.default:"/assets/img/marker_group.svg",size:[40,40],offset:[-20,-20]}],clusterIconContentLayout:f},h=[],i={},j=this;e&&e.icons||window.console.warn("MVIDEO WARNING  ======>  You must add data-map-config attribute with icons for map (use store  map on checkout page as sample)"),this.destroyMarkers(),this.clusterer=new ymaps.Clusterer(g),this.clustererMyLocation=new ymaps.Clusterer(g),this.markers=[];for(var k=0;k<a.length;k++){var l=a[k];l&&l.markerType&&("myLocation"!=l.markerType?c=new mvideo.Class.Marker(this.clusterer,l,this,e):(c=new mvideo.Class.Marker(this.clustererMyLocation,l,this,e),i=l),(b&&l.isConvenientStore||"myLocation"==c.config.markerType)&&(d=c),this.markers.push(c),l.storeDetails||c.rebindEvents(a),l.viewport&&h.push(l))}if(d||1!=a.length||(d=this.markers[0]),i){var m=!0;a.forEach(function(a){"myLocation"!=a.markerType&&a.latitude===i.latitude&&a.longitude===i.longitude&&(m=!1)}),m&&this.map.geoObjects.add(this.clustererMyLocation)}0!=this.clusterer.getGeoObjects().length&&this.map.geoObjects.add(this.clusterer),d?(this.map.setCenter([d.config.latitude,d.config.longitude],this.config.zoomSingle),d.marker.events.fire("click"),h.length>0&&this.map.setBounds(this.getViewport(h,i),{checkZoomRange:!0})):this.map.setBounds(this.clusterer.getBounds(),{checkZoomRange:!0}),this.clusterer.events.add("click",function(a){"cluster"===a.get("target").options._name&&(j.map.balloon.close(),j.map.balloon.events.fire("userclose"))})},getViewport:function(a,b){var c,d,e=a[0].latitude,f=a[0].longitude,g=a[0].latitude,h=a[0].longitude;return a.forEach(function(a){a.latitude>g&&(g=a.latitude),a.longitude>h&&(h=a.longitude),e>a.latitude&&(e=a.latitude),f>a.longitude&&(f=a.longitude)}),b&&(b.longitude<f?f=2*b.longitude-h:b.longitude>h?h=2*b.longitude-f:(c=b.longitude-f,d=h-b.longitude,c>d?h+=c-d:f-=d-c),b.latitude<e?e=2*b.latitude-g:b.latitude>g?g=2*b.latitude-e:(c=b.latitude-e,d=g-b.latitude,c>d?g+=c-d:e-=d-c)),[[e,f],[g,h]]},destroyMarkers:function(){this.clusterer&&this.clusterer.removeAll(),this.clustererMyLocation&&this.clustererMyLocation.removeAll();var a=this.markers.slice();setTimeout(function(){a.forEach(function(a){a.destroy()})})},destroy:function(){this.destroyMarkers(),this.map.destroy()},setCssZoomYandex:function(a){var b=$(".c-store__map-zoom"),c=a/2;return b.css({top:c}),"top: "+c+"px"}});a.define("Map",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function a(b){if(this.apiMapLoading=!1,this.apiMapLoaded=!1,this.config={url:"//api-maps.yandex.ru/2.1/",urlEnterprise:"//enterprise.api-maps.yandex.ru/2.1/",params:{lang:"ru_RU",onload:"mapLoaded",apikey:""}},$.extend(!0,this.config,b),a.instance)return a.instance;a.instance=this,mvideo.observer(this),this.init()},init:function(){window[this.config.params.onload]=window[this.config.params.onload]||this._mapLoaded.bind(this),this._addScript(),this.apiMapLoading=!0},loadMap:function(a,b){return this.loadScript().then(this._getMap.bind(this,a,b))},loadScript:function(){var a=new $.Deferred;return this.apiMapLoaded&&this.apiMapLoading?a.resolve(window.ymaps):(this.apiMapLoading&&this.subscribe("mapLoaded",function(){a.resolve(window.ymaps)}),a.promise())},_addScript:function(){var a=document.createElement("script"),b=this.config.params.apikey?this.config.urlEnterprise:this.config.url;a.type="text/javascript",a.src=b+"?"+$.param(this.config.params),document.getElementsByTagName("head")[0].appendChild(a)},_getMap:function(a,b){var c=a instanceof jQuery?a:$(a),d=c.data("map");return d||(d=new mvideo.Class.Map(c,b),c.data("map",d)),d},_mapLoaded:function(){this.apiMapLoaded=!0,this.publish("mapLoaded")}});a.define("MapLazy",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b,c,d){this.config={icons:{myStore:{default:"/assets/img/marker_home.svg",hover:"/assets/img/marker_home_hover.svg",active:"/assets/img/marker_home_active.svg"},marker5Ka:{default:"/assets/img/Marker_5ka.svg",hover:"/assets/img/Marker_5ka_hover.svg",active:"/assets/img/marker_blank_active.svg"},pochta:{default:"/assets/img/Marker_Pochta.svg",hover:"/assets/img/Marker_Pochta_hover.svg",active:"/assets/img/marker_blank_active.svg"},h24Store:{default:"/assets/img/marker_24h.svg",hover:"/assets/img/marker_24h_hover.svg",active:"/assets/img/marker_24h_active.svg"},mvideoStore:{default:"/assets/img/marker_mvid.svg",hover:"/assets/img/marker_mvid_hover.svg",active:"/assets/img/marker_mvid_active.svg"},underConstructionStore:{default:"/assets/img/marker_ucs.svg",hover:"/assets/img/marker_ucs_hover.svg",active:"/assets/img/marker_ucs_active.svg"},myLocation:{default:"/assets/img/marker_location.svg"},m_mobile:{default:"/assets/img/marker_m_mobile.svg",hover:"/assets/img/marker_m_mobile_hover.svg",active:"/assets/img/marker_m_mobile_active.svg"}},iconsSize:{height:30,width:40},templates:{productBased:"mapProductTemplate"},btnLabel:"Забрать здесь",prepaymentText:"После предоплаты",clickMarker:!0},this.clusterer=a,this.parent=c,$.extend(!0,this.config,b||{}),d&&$.extend(!0,this.config,d),this.config.templates.productBased=mvideo.template[this.config.templates.productBased],this.initialize(),this.bindEvents()},initialize:function(){var a=this.config;this.marker=new window.ymaps.Placemark([a.latitude,a.longitude],{},{iconLayout:"default#image",iconImageHref:a.icons[a.markerType].default,iconImageSize:[a.iconsSize.height,a.iconsSize.width],iconImageOffset:[-a.iconsSize.height/2,-a.iconsSize.width],balloonPanelMaxMapArea:234e3,openBalloonOnClick:!1,balloonLayout:new mvideo.Class.SampleBalloonLayout,balloonPanelLayout:new mvideo.Class.SampleBalloonLayout({isPanel:!0}),balloonOffset:[-10,0]}),this.clusterer.add(this.marker)},setStoreDetailsUrl:function(a){return this.config.storeDetails=a,this},getStoreDetailsUrl:function(){return this.config.storeDetails?this.config.storeDetails.replace(/&amp;/g,"&"):this.config.id},bindEvents:function(){this.config.clickMarker&&this.marker.events.add(["mouseenter","mouseleave"],function(a){"mobile"!==mvideo.device.manager.getType()&&("mouseenter"===a.get("type")?this.iconReplace.call(this,"hover",a):this.iconReplace.call(this,"default",a))},this).add("click",function(a){this.parent.map.balloon.events.fire("userclose"),"mobile"===mvideo.device.manager.getType()&&this.iconReplace.call(this,"active",a),this.parent.map.balloon.events.once("userclose",function(){this.iconReplace.call(this,"default",a)},this),this.parent.map.events.once("click",function(){this.iconReplace.call(this,"default",a)},this)},this).add("click",this.markerBalloonOpenHandler,this)},iconReplace:function(a,b){b.get("target").options.set("iconImageHref",this.config.icons[this.config.markerType][a]||this.config.icons[this.config.markerType].default)},rebindEvents:function(a){this._rebindEventsData=a,this.unBindEvents(),this.marker.events.add("click",this.markerRebindBalloonOpenHandler,this)},markerBalloonOpenHandler:function(){this.getStoreDetails()},markerRebindBalloonOpenHandler:function(){var a=this.getStoreDetailsUrl();a&&this._rebindEventsData&&this.setStoreDetails(this._rebindEventsData,a)},unBindEvents:function(){this.marker.events.remove("click",this.markerBalloonOpenHandler,this),this.marker.events.remove("click",this.markerRebindBalloonOpenHandler,this)},getStoreDetails:function(a){this._balloonContent?this.marker.balloon.open():$.getJSON(a||this.getStoreDetailsUrl(),function(a){a&&(this._createBalloonContent(a),this.marker.balloon.open())}.bind(this))},setStoreDetails:function(a,b){this._balloonContent?this.marker.balloon.open():(this._createBalloonContent(a.find(function(a){return a&&a.id===b})),this.marker.balloon.open())},_createBalloonContent:function(a){a.btnLabel||(a.btnLabel=this.config.btnLabel),a.prepaymentText||(a.prepaymentText=this.config.prepaymentText),$.extend(!0,a,this.config.markersConfig||{}),this._balloonContent=window.ymaps.templateLayoutFactory.createClass(this.config.templates.productBased({data:a}),{build:function(){this.constructor.superclass.build.call(this),mvideo.Class.ReinitContent.reinit(".infoWindow")},clear:function(){this.constructor.superclass.clear.call(this)}}),this.marker.options.set("balloonContentLayout",this._balloonContent)},_unBindBalloonEvents:function(){this.parent.$.holder.off("click",".infoWindow .btn")},destroy:function(){this.unBindEvents()}});a.define("Marker",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={isPanel:!1},$.extend(!0,this.config,a||{});var b=this,c=ymaps.templateLayoutFactory.createClass('<div class="tooltipster-base tooltipster-sidetip tooltipster-top c-tooltip_map"><div class="tooltipster-box"><div class="tooltipster-content"><div class="o-info-window">$[[options.contentLayout observeSize minWidth=240 maxWidth=auto maxHeight=auto]]</div></div></div><div class="tooltipster-arrow arrow"><div class="tooltipster-arrow-uncropped"><div class="tooltipster-arrow-border"></div><div class="tooltipster-arrow-background"></div></div></div></div>',{build:function(){this.constructor.superclass.build.call(this),this._$element=$(".c-tooltip_map",this.getParentElement()),this.applyElementOffset(),this._$element.find(".close").on("click",$.proxy(this.onCloseClick,this))},clear:function(){this._$element.find(".close").off("click"),this.constructor.superclass.clear.call(this)},onSublayoutSizeChange:function(){c.superclass.onSublayoutSizeChange.apply(this,arguments),this._isElement(this._$element)&&(this.applyElementOffset(),this.events.fire("shapechange"))},applyElementOffset:function(){this._$element.css({left:b.config.isPanel?"calc(46% - 14rem)":-this._$element[0].offsetWidth/2,top:-(this._$element[0].offsetHeight+this._$element.find(".arrow")[0].offsetHeight)})},onCloseClick:function(a){a.preventDefault(),this.events.fire("userclose")},getShape:function(){if(!this._isElement(this._$element))return c.superclass.getShape.call(this);var a=this._$element.position();return new ymaps.shape.Rectangle(new ymaps.geometry.pixel.Rectangle([[a.left,a.top],[a.left+this._$element[0].offsetWidth,a.top+this._$element[0].offsetHeight+this._$element.find(".arrow")[0].offsetHeight]]))},_isElement:function(a){return a&&a[0]&&a.find(".arrow")[0]}});return c}});a.define("SampleBalloonLayout",a)}(),function(){"use strict";var a=window.mvideo.Class.Class.extend({constructor:function(a){var b="js_zoom c-btn c-btn_white c-btn_circle c-btn_icon c-btn_no-border i-icon u-box-shadow-droop",c=window.ymaps.templateLayoutFactory.createClass("<div style='"+a.style+"' class='c-store__map-zoom'><div data-action='zoomIn' class='"+b+" i-icon-plus u-mb-12'></div><div data-action='zoomOut' class='"+b+" i-icon-minus'></div></div>",{build:function(){var a=$(this._parentElement);c.superclass.build.call(this),this.zoomCallback=window.ymaps.util.bind(this.zoomCallback,this),a.find(".js_zoom").bind("click",this.zoomCallback)},clear:function(){$(this._parentElement).find(".js_zoom").unbind("click",this.zoomInCallback),c.superclass.clear.call(this)},zoomCallback:function(a){var b=this.getData().control.getMap(),c=b.getZoom();"zoomIn"===$(a.target).data("action")?c++:c--,b.setZoom(c,{checkZoomRange:!0})}});return c}});a.define("SampleZoomLayout",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={selectors:{primaryList:".navigation-list-primary",lists:".navigation-list",items:".navigation-item",links:".navigation-item-link",navigationBtn:".header-menu-btn",scrollArea:".navigation"}},this.$={},this.$.holder=$(a),this.loadObjects(this.$.holder),this.initialize(),this.bindEvents()},initialize:function(){return this.page=mvideo.instance.page.page,this.heading=new mvideo.Class.ContentSlider($(".navigation-top-holder")),this.content=new mvideo.Class.NavigationContentSlider(this.$.primaryList),this.decorateItems(),this},hasDrop:function(a){return $(a).children().length>1},goToTop:function(){var a=this.config.selectors.scrollArea,b=$(a);return a&&b.length?b.scrollTop(0):this.page.goTo(0),this},decorateItems:function(a){a=a||this.$.items;var b=this;return a.filter(function(){return b.hasDrop(this)}).addClass("has-drop"),this},bindEvents:function(){var a=this;this.$.primaryList.on("click",this.config.selectors.links,function(b){var c=$(this).parent();c.find("[data-post-load-url]").each(function(){var a=$(this);$.ajax({url:a.data("post-load-url"),dataType:"json",type:"GET",cache:!1}).then(function(b){b&&b.htmlContent&&(a.replaceWith(b.htmlContent),mvideo.Class.ReinitContent.reinit(c))})}),a.content.canSlide(c)&&!a.content.isAnimating()&&(b.preventDefault(),a.heading.goNext(),a.content.handleSlide(c).done(function(){a.$.primaryList[a.content.getStep()?"addClass":"removeClass"]("active")}),a.goToTop())}),this.$.holder.on("click",".navigation-back-btn",function(b){b.preventDefault(),a.content.isAnimating()||(a.content.handleSlide(),a.content.getStep()<1&&(a.$.primaryList.removeClass("active"),a.heading.goBack()))}),this.$.holder.on("click",".header-user-info",function(b){b.preventDefault(),a.content.isAnimating()||(a.heading.goNext(),a.content.handleSlide($(".navigation-item-my-account")),a.goToTop())}),this.page.subscribe("updateWidth",function(){a.heading.updateWidth(),a.content.updateWidth()})}});a.define("Navigation",a)}(),function(){"use strict";var a=mvideo.Class.ContentSlider.extend({constructor:function(a){this.config={animation:!1,openClass:"active show-dropdown",activeClass:"active"},this.$={},this.$.holder=$(a),this.itemsStack=[]},hasDrop:function(a){return $(a).children().length>1},canSlide:function(a){return!this.isActive(a)&&this.hasDrop(a)},getStep:function(){return this.itemsStack.length},resetState:function(){var a=this;this.constructor.__super__.resetState.call(this),$.each(this.itemsStack,function(){a._resetStep(this),this.clone.remove()}),this.itemsStack=[]},updateWidth:function(){var a=this.getStep();this.jump(a)},goNext:function(a){var b=this._createStep(a);return this.move(this.getStep()).done(function(){b.after(a)})},goBack:function(){if(this.itemsStack.length){var a=this.itemsStack.pop(),b=this._resetStep(a);return this.move(this.getStep()).done(function(){b.remove()})}},handleSlide:function(a){return a?this.goNext(a):this.goBack()},_resetStep:function(a){var b=a.item,c=a.clone,d=this.config.openClass;return b.removeClass(d),c.before(b).addClass(d)},_createStep:function(a){var b=a.clone(!0);return a.after(b).addClass(this.config.openClass),this.itemsStack.push({item:a,clone:b}),b}});a.define("NavigationContentSlider",a)}(),function(a){var b=a.Class.Class.extend({constructor:function(a,b){this.holder=a,this.config=$.extend(!0,{devices:{modClasseHolder:null}},b);var c=this;window.mvideo.observer(this),this.cb={beforeChange:this.beforeChange.bind(c)},this.initCarousel()},initCarousel:function(){this.config.devices.modClasseHolder&&this.holder.addClass(this.config.devices.modClasseHolder),this.holder.slick(this.getSlickConfig(this.config)),this.holder.on("beforeChange",this.cb.beforeChange)},beforeChange:function(a,b,c,d){this.publish("setslide",{nextSlide:d})},getSlickConfig:function(a){return{swipe:!1,infinite:!0,arrows:!1,slidesToShow:a.devices.desktop,responsive:[{breakpoint:1024,settings:{slidesToShow:a.devices.tablet}},{breakpoint:768,settings:{slidesToShow:a.devices.mobile}}],variableWidth:!0}},slickGoTo:function(a){this.holder.slick("slickGoTo",a)},slickNext:function(){this.holder.slick("slickNext")},slickPrev:function(){this.holder.slick("slickPrev")}});b.define("PdpZoomCarousel",b)}(window.mvideo),function(a){var b=a.Class.Class.extend({constructor:function(a){this.items=a},getInfoCounter:function(a){return{total:this.items.length,number:this.getFind(a)}},getTotal:function(){return this.items.length},getFind:function(a){var b=0;return this.items.find(function(c,d){return c.src===a&&(b=d)}),b+1}});b.define("PdpZoomCounter",b)}(window.mvideo),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={page:".page-content",selectPopup:"zoom-pdp",mediaContainer:".c-media-container",carouselContainer:'[data-init="pdp-carousel-popup"]',selectEvent:{img:".c-media-container__image-wrapper",video:'.c-carousel__item[data-type="video"]',iframeHTML:".c-media-container__iframeHTMl",iframeHTMlLink:".c-media-container__iframeHTMl-link"},namespace:{showClick:"click.ZoomContainer",keydown:"keydown.CloseZoom",popup:"pdp-c-popup",switchTab:"switchTab.CloseZoom"},popup:mvideo.Class.Popup,pdp:mvideo.Class.PdpZoom,zoomCarousel:mvideo.Class.ZoomCarousel},$.extend(!0,this.config,a||{}),this.initialize()},initialize:function(){this.$pageContent=$(this.config.page),this.$pageContent.on("show-popup-zoom",function(){this.showPopup()}),this.$eventImg=$(this.config.selectEvent.img,this.$pageContent),this.$eventVideo=$(this.config.selectEvent.video,this.$pageContent),this.$iframeHTML=$(this.config.selectEvent.iframeHTML,this.$pageContent)},getPopup:function(){var a=this.getContent();return this.popup?(this.popup._setContent(a),this.popup.config.title=a,this.popup):(this.popup=new this.config.popup("",{contentAsHTML:!0,title:a,namespace:this.config.namespace.popup,classes:["full-screen","96rem","100vh",this.config.selectPopup]}),this.popup)},getContent:function(){return this.pdp||(this.pdp=new this.config.zoomCarousel(".o-product-gallary__carousel")),this.pdp.getContent()},showPopup:function(a){if(!this.preventAction(a)){var b=this;this.getPopup().show(),this.$mediaContainer=$(this.config.mediaContainer,".c-popup_"+this.config.selectPopup),this.popupCarousel=$(this.config.carouselContainer,".c-popup_"+this.config.selectPopup),this.eventSubscribe(),setTimeout(function(){var c=$(a.currentTarget);b.popupCarousel.trigger("choose-slide",{url:"iframeHTMl"===c.data("type")?c.data("src-full"):c.data("src")||c.attr("src")})})}},hidePopup:function(){this.popup&&this.popup.hide(),this.eventUnSubscribe()},preventAction:function(a){var b=$(a.currentTarget);return b.hasClass("reel")||b.hasClass("reel-overlay")||"3d"==b.attr("data-type")},bindEvents:function(){this.$iframeHTML.on(this.config.namespace.showClick,this.config.iframeHTMlLink,this.showPopup.bind(this)),this.$eventImg.on(this.config.namespace.showClick,".c-media-container__image",this.showPopup.bind(this)),this.$eventVideo.length>1&&this.$eventVideo.not(".u-hidden").on(this.config.namespace.showClick,this.showPopup.bind(this))},unBindEvents:function(){this.$eventImg.off(this.config.namespace.showClick),this.$eventVideo.not(".u-hidden").off(this.config.namespace.showClick),this.$iframeHTML.off(this.config.namespace.showClick)},desktopBehavior:function(){this.unBindEvents(),this.bindEvents(),this.hidePopup()},mobileBehavior:function(){this.unBindEvents(),this.bindEvents(),this.hidePopup()},eventClosePopup:function(){this.eventUnSubscribe()},keyboardControl:function(a){27===a.keyCode&&this.hidePopup()},handlerPinch:function(a,b){this.popup.$.template.toggleClass("c-popup_padding0","on"===b.type)},eventSubscribe:function(){var a=this;mvideo.Event.subscribe("hide."+this.config.namespace.popup,a.hidePopup.bind(a)),mvideo.Event.subscribe("close."+this.config.namespace.popup,a.eventClosePopup.bind(a)),mvideo.instance.productTabs.tabs.subscribe(this.config.namespace.switchTab,a.hidePopup.bind(a)),$(document).on(this.config.namespace.keydown,a.keyboardControl.bind(a)),this.$mediaContainer&&this.$mediaContainer.length&&this.$mediaContainer.on("touch-zoom",a.handlerPinch.bind(a))},eventUnSubscribe:function(){mvideo.Event.unsubscribe("close."+this.config.namespace.popup),mvideo.Event.unsubscribe("hide."+this.config.namespace.popup),mvideo.instance.productTabs.tabs.unsubscribe(this.config.namespace.switchTab),$(document).off(this.config.namespace.keydown),this.$mediaContainer&&this.$mediaContainer.length&&this.$mediaContainer.off("touch-zoom")}});a.define("PdpZoomEvent",a)}(),function(a){var b=a.Class.Class.extend({constructor:function(b,c){var d;window.mvideo.observer(this);var e=this,f=a.helpers.throttle,g=window.mvideo.Class;this.holder=b,this.counter=new g.PdpZoomCounter(this.getArrayItems()),d=new g.PdpZoomNormalizationSlides(b,{items:this.getItems(),devices:c.devices}),this.slider=new g.PdpZoomCarousel(b,{devices:d.getDevicesConfig()}),this.$currentSlide=null,this.$prevSlide=null,this.cb={prev:f(e.prev.bind(e),500),next:f(e.next.bind(e),500),clickSlide:e.clickSlide.bind(e)},this.setArrows(),this.bindEvents(),this.checkCount()},getArrayItems:function(){return this.getItems().map(function(a){return{src:a.getAttribute("data-src")}})},getItems:function(){return this.holder.find(".c-carousel__item:not(.slick-cloned)").toArray()},bindEvents:function(){this.prevArrow.on("click",this.cb.prev),this.nextArrow.on("click",this.cb.next),this.holder.on("click",".c-carousel__item",this.cb.clickSlide)},setArrows:function(){var a=$(".slick-list",this.holder);this.prevArrow=$(this.getHTMLArrow("prev","c-carousel__arrow")),this.nextArrow=$(this.getHTMLArrow("next","c-carousel__arrow")),a.before(this.prevArrow),a.after(this.nextArrow)},hideArrows:function(){this.prevArrow.hide(),this.nextArrow.hide()},clickSlide:function(a){var b=$(a.currentTarget),c=$(".slick-active",this.holder),d=c.index(b);this.setActiveSlide(b),this.publish("set-slide",{slide:b,counter:this.getCountSlide()}),0===d?this.checkPositionTrackPrev(b):d===c.length-1&&this.checkPositionTrackNext(b)},prev:function(){var a=this.getPrevSlide();a.length||(a=this.getLastSlide()),this.setActiveSlide(a),this.publish("set-slide",{slide:a,counter:this.getCountSlide()}),this.checkPositionTrackPrev(a)},checkPositionTrackPrev:function(a){this.checkPositionTrack(a,this.getPrevSlide)&&(this.slider.slickPrev(),this.checkActiveSlide())},next:function(){var a=this.getNextSlide();a.length||(a=this.getFirstSlide()),this.setActiveSlide(a),this.publish("set-slide",{slide:a,counter:this.getCountSlide()}),this.checkPositionTrackNext(a)},checkPositionTrackNext:function(a){this.checkPositionTrack(a,this.getNextSlide)&&(this.slider.slickNext(),this.checkActiveSlide())},checkActiveSlide:function(){if(!this.$currentSlide.hasClass("slick-active")){var a=this.findUrlSlideActive(this.$currentSlide.data("src"));this.setActiveSlide(a)}},getNextSlide:function(a){return a&&a.next()||this.getCurrentSlide().next()},getPrevSlide:function(a){return a&&a.prev()||this.getCurrentSlide().prev()},getCurrentSlide:function(){return this.$currentSlide},setActiveSlide:function(a){this.$prevSlide=this.$currentSlide,this.clearActiveSlide(),this.$currentSlide=a,this.$currentSlide.addClass("c-carousel__item_active")},clearActiveSlide:function(){this.$prevSlide&&this.$prevSlide.removeClass("c-carousel__item_active")},doFistSlideUrl:function(a){var b=this.findUrlSlide(a);this.$prevSlide=b,this.setActiveSlide(b),this.slider.slickGoTo(b.data("slick-index")),this.publish("set-slide",{slide:b,counter:this.getCountSlide()})},findUrlSlide:function(a){return this.holder.find('[data-src="'+a+'"]').closest(".c-carousel__item:not(.slick-cloned)").eq(0)},findUrlSlideActive:function(a){return this.holder.find('[data-src="'+a+'"]').closest(".c-carousel__item.slick-active").eq(0)},getFirstSlide:function(){return this.holder.find(".c-carousel__item.slick-active").eq(0)},getLastSlide:function(){return this.holder.find(".c-carousel__item.slick-active").last()},checkPositionTrack:function(a,b){return!b(a).hasClass("slick-active")},checkCount:function(){if(1===this.counter.getTotal()){this.hideArrows();var a=this;setTimeout(function(){a.publish("hide-arrows")})}},getCountSlide:function(){var a=this.counter.getInfoCounter(this.getCurrentSlide().data("src"));return{current:a.number,allCount:a.total}}});b.include(a.Mixin.arrow),b.define("PdpZoomManageArrows",b)}(window.mvideo),function(a){var b=a.Class.Class.extend({constructor:function(a){this.holders=a},run:function(a){
switch(this.clearPlaceContainer(),a.data("type")){case"iframeHTMl":this.renderIframe(a);break;case"image":this.renderImg(a);break;case"3d":this.render3d(a);break;case"video":this.renderVideo(a)}},renderImg:function(a){var b=a.data("zoom-img")||a.data("src");this.holders.imgContainer.attr("src",b).show()},render3d:function(a){var b=a.data("images");this.holders.imgContainer.show(),this.holders.imgContainer.attr("src",a.data("src")),this.holders.imgContainer.reel({responsive:1,loops:!0,images:b,speed:.4,width:this.holders.imgContainer[0].width,height:this.holders.imgContainer[0].height,cursor:"../img/cursors/reel.cur"})},renderIframe:function(a){this.holders.iframeContainer.data("init-iframe")||(this.holders.iframeContainer.html(this.holders.iframeContainer.html()+'<iframe src="'+a.data("src")+'">'),this.holders.iframeContainer.data("init-iframe",!0),this.holders.iframeContainer.data("src",a.data("src-full"))),this.holders.iframeContainer.show()},renderVideo:function(a){this.holders.videoContainer.addClass("c-media-container__video_active"),this.holders.videoContainer.trigger("addUrl",{url:a.data("src"),eventLocation:"video"})},clearPlaceContainer:function(){this.holders.iframeContainer.hide(),this.holders.imgContainer.attr("id")&&(this.holders.imgContainer.unreel(),this.holders.imgContainer.removeAttr("id")),this.holders.imgContainer.data("src",""),this.holders.imgContainer.hide(),this.holders.videoContainer.removeClass("c-media-container__video_active").trigger("clear").height("")}});b.define("PdpZoomMediaContainer",b)}(window.mvideo),function(a){var b=a.Class.Class.extend({constructor:function(a,b){this.holder=a,this.config=$.extend({selectCounter:".c-carousel__counter"},b),window.mvideo.observer(this),this.$counter=$(this.config.selectCounter,this.holder),this.setArrows(),this.bindEvents()},publishEvent:function(a){this.publish("swipe",{direction:a.direction})},bindEvents:function(){var a=this;this.prevArrow.on("click",function(){a.publishEvent({direction:"right"})}),this.nextArrow.on("click",function(){a.publishEvent({direction:"left"})}),this.holder.swipe({swipe:function(b,c){a.publishEvent({direction:c})},threshold:15,allowPageScroll:$.fn.swipe.pageScroll.VERTICAL})},setArrows:function(){this.prevArrow=$(this.getHTMLArrow("prev","c-carousel__arrow")),this.nextArrow=$(this.getHTMLArrow("next","c-carousel__arrow")),this.$counter.before(this.prevArrow),this.$counter.after(this.nextArrow)},updateCounter:function(a){this.$counter.html(a.current+"/"+a.allCount)},hideArrows:function(){this.prevArrow.hide(),this.nextArrow.hide()}});b.include(a.Mixin.arrow),b.define("PDPZoomMobileSwipe",b)}(window.mvideo),function(a){var b={7:"c-carousel_items-7",6:"c-carousel_items-6",5:"c-carousel_items-5",4:"c-carousel_items-4",3:"c-carousel_items-3",2:"c-carousel_items-2",1:"c-carousel_items-1"},c=a.Class.Class.extend({constructor:function(a,b){this.devices=$.extend({desktop:null,tablet:null,mobile:null},b.devices),this.devicesConfig=$.extend({modClasseHolder:null},this.devices),this.items=b.items,this.countItems=this.items.length,this.holder=a,this.init()},init:function(){if(1===this.countItems)return void this.setModClasseHolder();this.countItems>this.getMinCount()||(this.htmlInject(),this.getUpdateConfig(),this.setModClasseHolder())},setModClasseHolder:function(){this.devicesConfig.modClasseHolder=b.hasOwnProperty(this.countItems)?b[this.countItems]:null},getUpdateConfig:function(){var a=this;Object.keys(this.devices).forEach(function(b){a.devices[b]>a.countItems&&(a.devicesConfig[b]=a.countItems)})},getDevicesConfig:function(){return this.devicesConfig},getMinCount:function(){return this.devices.desktop},htmlInject:function(){var a=this.holder.html(),b=new RegExp("(c-carousel__item_active)","gm");this.holder.html(a+a.replace(b))}});c.define("PdpZoomNormalizationSlides",c)}(window.mvideo),function(){"use strict";function a(a){switch(a){case"success":return"alert-success";case"info":return"alert-info";case"error":return"alert-error";default:return""}}var b=mvideo.Class.Class.extend({constructor:function(a,b,c){this.config={errorMessage:"Произошла ошибка, повторите позже.",errorContainerClass:"text-error",alertStateClasses:"alert alert-success alert-info alert-error",flagAllowSend:!0,buttonClass:".btn"},this.$={},this.$.form=$(a),this.$.messageContainer=$(b).hide(),this.loadObjects(this.$.form),$.extend(!0,this.config,c||{}),this.initialize()},initialize:function(){this.bindEvents()},bindEvents:function(){var a=this,b=this.$.form,c=b.find(a.config.buttonClass),d=b.find("input[type='text']");c.on("click",function(c){c.preventDefault(),b.valid()&&a.allowSend()&&a.ajaxSubmit()}),d.on("change",function(b){a.allowSend(!0)})},allowSend:function(a){if(void 0===a)return this.config.flagAllowSend;this.config.flagAllowSend=a},showGeneralMessage:function(b){this.clearGeneralMessage();var c=b&&b.message?b.message:this.config.errorMessage,d=b&&b.infoStatus?b.infoStatus:"error",e=a(d);this.$.messageContainer.text(c),this.$.messageContainer.removeClass(this.config.alertStateClasses).addClass("alert "+e),this.$.messageContainer.show()},showInputMessage:function(a){this.clearGeneralMessage();for(var b=this.$.form.find("input[type='text']"),c="",d=0,e=a.errorMessages.length;d<e;d++){c+="<span>"+a.errorMessages[d]+"</span>"}this.$.form.validate(),b.rules("add",{"exception-value":b.val(),messages:{"exception-value":c}}),b.valid()},clearGeneralMessage:function(){this.$.messageContainer.hide(),this.$.messageContainer.text(""),this.$.messageContainer.removeClass(this.config.alertStateClasses)},beforeRequest:function(){this.$.form.addClass("box-overlay"),this.clearGeneralMessage()},afterRequest:function(){this.$.form.removeClass("box-overlay")},ajaxSubmit:function(){var a=this,b=this.$.form,c=b.serialize()||{},d=b.attr("action");return $.ajax({url:d,type:"post",dataType:"json",data:c,beforeSend:function(){a.beforeRequest()},success:function(b){if(b){"true"==b.success?(a.showGeneralMessage(b),a.allowSend(!1)):b.errorMessages?a.showInputMessage(b):a.showGeneralMessage(b)}},error:function(){a.showGeneralMessage()},complete:function(){a.afterRequest()}}),!1}});b.define("SubscribePreorder",b)}(),function(){"use strict";var a=mvideo.Class.SubscribePreorder.extend({beforeRequest:function(){$(this.config.textFieldContainer).addClass(this.config.spinner),this.$.form.find(this.config.buttonClass).attr("disabled","true"),this.clearGeneralMessage()},afterRequest:function(){$(this.config.textFieldContainer).removeClass(this.config.spinner),this.$.form.find(this.config.textFieldInput).attr("readonly","true"),this.$.form.find(this.config.buttonClass).hide()},showGeneralMessage:function(a){var b=a&&a.message?a.message:this.config.errorMessage;this.clearGeneralMessage(),this.$.messageContainer.text(b),this.$.messageContainer.show()}});a.define("SubscribePreoderPDP",a)}(),function(a){var b=a.Class.Class.extend({constructor:function(a,b){this.config={selectors:{carousel:".c-carousel"}},this.items=[],this.$tmp,this.$={},this.loadObjects(a)},getContent:function(){return this.$tmp||(this.build(),this.getTemplate(),this.render()),this.$tmp.html()},render:function(){this.$tmp.find(".c-carousel__images").append(this.items)},getTemplate:function(){this.$tmp=$($('[data-template="zoom"]').html())},build:function(){this.items=Array.prototype.concat(this.getImages(),this.getHTMLiframe(),this.getVideos(),this.get3D())},getImages:function(){return $('[data-type="image"]:not(.slick-cloned)',this.$.carousel).clone().toArray().map(function(a){var b=$(a);return b.removeClass("slick-slide slick-current slick-active c-carousel__item_active").removeAttr("style tabindex data-slick-index"),b})},getVideos:function(){return $('[data-type="video"]',this.$.carousel).clone().toArray().map(function(a){var b=$(a);return b.removeClass("u-hidden"),b})},get3D:function(){return $('[data-type="3d"]',this.$.carousel).clone().toArray()},getHTMLiframe:function(){return $('[data-type="iframeHTMl"]',this.$.carousel).clone().toArray().map(function(a){var b=$(a);return b.attr("data-src",b.data("srcFull")),b})}});b.define("ZoomCarousel",b)}(window.mvideo),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a){this.config={holder:".c-phone-verification",sendCodeUrl:"",getCodeUrl:"",useTooltip:!1,tooltip:{content:"jade/components/phone-verification/tpl-code-check",holder:".c-phone-verification__input",parent:".c-phone-verification__sms-check",page:"page"},formSubmit:!1,submitAccess:!1,state:"",errMsg:"Сервис временно не доступен"},$.extend(!0,this.config,a||{}),mvideo.observer(this),this.$={},this.$.holder=$(this.config.holder),this.initialize()},initialize:function(){var a=this;this.config.useTooltip&&this.initTooltip(),this.phoneInput=new mvideo.Class.PhoneVerificationInput(this.$.holder,this.config.inputConfig),this.confirm=new mvideo.Class.PhoneVerificationConfirm(this.$.holder,this.config.confirmConfig),this.codeCheck=new mvideo.Class.PhoneVerificationCodeCheck(this.$.holder,this.config.codeCheckConfig),this.codeConfirmation=new mvideo.Class.CodeConfirmation(this.$.holder,{sendCodeUrl:this.config.getCodeUrl,checkCodeUrl:this.config.sendCodeUrl,needOverlay:!1,getRequestData:function(){return{phone:a.phoneInput.getValue()}},disabledClass:"u-disabled",bootImmediatelyConfig:this.config.bootImmediatelyConfig,errMsg:this.errMsg,checkCodeEvent:this.config.checkCodeEvent}),this.notification=new mvideo.Class.Notification($(".c-phone-verification__notification",this.$.holder),{errorParams:{textColor:null}}),this.$.form=this.phoneInput.getForm(),this.bindEvents(),this.config.bootImmediatelyConfig&&this.codeConfirmation.initState(),setTimeout(function(){a.phoneInput.isValid()}),this.config.state&&this.setState(this.config.state)},bindEvents:function(){var a=this;this.phoneInput.subscribe("change-valid",function(b,c){a.confirm.changeAccess(!c)}),this.phoneInput.subscribe("enter-input",function(){a.confirm.click()}),this.phoneInput.subscribe("input-access",function(){a.confirm.open(),a.codeCheck.close(),a.codeConfirmation.cancelConfirmation()}),this.confirm.subscribe("confirm-click",function(){a.phoneInput.isValidVal()?(a.phoneInput.hideVerificationError(),a.phoneInput.blockChange(),!a.getSMS(a.phoneInput.getValue())&&a.confirm.hideOverlay(),a.tooltipReposition()):a.confirm.hideOverlay()}),this.$.form.on("submit",function(){a.tooltipReposition()}),mvideo.Event.subscribe("clear-verification",function(b,c){c===a.phoneInput.getId()&&a.setState("initial")}),this.codeConfirmation.subscribe("confirmation-code-send-before",function(b){a.beforeRequest(),a.phoneInput.blockChange()}),this.codeConfirmation.subscribe("confirmation-code-send-complete",function(b,c){a.afterRequest(c)}),this.codeConfirmation.subscribe("confirmation-code-check-before",function(b){a.beforeRequest(),a.phoneInput.blockChange()}),this.codeConfirmation.subscribe("confirmation-code-check-success",function(b,c){if(a.$.holder.trigger("success.verification"),c.urlRedirect)return void window.location.replace(c.urlRedirect);a.phoneVerified(c.title),a.actOnSubmitBtn()}),this.codeConfirmation.subscribe("confirmation-code-check-error",function(b,c){a.tooltipReposition(),!c.delay&&a.phoneInput.allowChange()}),this.codeConfirmation.subscribe("confirmation-code-check-request-error",function(b,c){a.tooltipReposition()}),this.codeConfirmation.subscribe("confirmation-code-check-complete",function(b,c){a.afterRequest(c)}),this.codeConfirmation.subscribe("confirmation-code-received",function(b,c){a.startVerification(),a.confirm.close(),!c.delay&&a.phoneInput.allowChange()}),this.codeConfirmation.subscribe("confirmation-timer-expired",function(b){a.phoneInput.allowChange()}),this.codeConfirmation.subscribe("update-state",function(b,c){c.states&&c.states.split(",").forEach(function(b){a.setState(b.trim(),c)})})},beforeRequest:function(){this.notification.close(),this.codeCheck.closeAccess()},afterRequest:function(a){this.codeCheck.openAccess(a)},startVerification:function(){this.codeCheck.open(),this.tooltipReposition()},getSMS:function(a){return this.codeConfirmation.sendCodeToUser()},phoneVerified:function(a){this.codeCheck.close(),this.confirm.close(),this.phoneInput.setVerified(a),this.publish("phone-verified")},initTooltip:function(){var a=JST[this.config.tooltip.content]({params:{page:this.config.tooltip.page}}),b=$(this.config.tooltip.holder,this.$.holder),c=$(this.config.tooltip.parent,this.$.holder),d=new mvideo.Class.Tooltip(b,{contentAsHTML:!0,trigger:"custom",large:!0,side:"bottom",closable:!1,withoutMobilePopup:!0,withMobileTooltip:!0,title:a,parent:c});this.tooltip=d,d.show()},tooltipReposition:function(){this.tooltip&&this.tooltip.reposition()},actOnSubmitBtn:function(){var a=this.$.form.find('[type="submit"]');this.config.formSubmit&&(a.length>0?a.trigger("click"):this.$.form.trigger("submit")),this.config.submitAccess&&a.length>0&&(a.removeAttr("disabled"),a.removeClass("u-disabled"))},showNotification:function(a){a instanceof Object&&this.notification.replace({type:a.type,text:a.text})},setState:function(a,b){switch(a){case"initial":this.phoneInput.clear(),this.confirm.open(),this.codeCheck.close();break;case"verified":this.phoneVerified();break;case"code-check":this.confirm.close(),this.startVerification();break;case"need-verification":this.phoneInput.setInputNotChange(),this.confirm.changeAccess(!1);break;case"disabled-all":this.confirm.close(),this.codeConfirmation.toogleTimer(!0),this.codeCheck.openAccess(!0),this.codeConfirmation.startTimer(b.delay||0);break;case"open-code":this.codeConfirmation.enableInput(),this.codeCheck.openAccess(!0),this.codeConfirmation.startTimer(b.delay||0),this.codeConfirmation.clearCodeInput();break;case"enabled":this.confirm.changeAccessApply(!1),this.phoneInput.enabledChange(),this.confirm.hideOverlay(),this.codeCheck.openAccess(!0);break;case"show-notification":this.showNotification(b.notification);break;case"phone-error":this.confirm.hideOverlay(),this.phoneInput.isNotValid({error:b.error}),this.confirm.changeAccessApply(!0)}}}).define("PhoneVerification")}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){this.config={selectors:{timerHolder:".c-code-check__resend-status",timer:".c-code-check__resend-timer",input:".c-code-check__input",resendLink:".c-code-check__resend-link"},holder:".c-phone-verification__sms-check",timeInSeconds:59,codeFailedMsg:"Неверный код"},$.extend(!0,this.config,b||{}),mvideo.observer(this),this.$={},this.$.holder=$(this.config.holder,a),this.loadObjects(this.$.holder),this.initialize()},initialize:function(){this.validator=this.$.input.validate()},open:function(){this.$.holder.removeClass("u-hidden")},close:function(){this.$.holder.addClass("u-hidden")},closeAccess:function(){this.disabledResendLink(),this.toggleLoad()},disabledResendLink:function(){this.$.resendLink.addClass("u-disabled")},openAccess:function(a){a&&this.$.resendLink.removeClass("u-disabled"),this.toggleLoad()},toggleLoad:function(a){this.$.input.toggleClass("u-load",a||null)}}).define("PhoneVerificationCodeCheck")}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){this.config={selectors:{btn:".c-phone-verification__confirm-btn"},holder:".c-phone-verification__confirm",alwaysActive:!1},$.extend(!0,this.config,b||{}),mvideo.observer(this),this.$={},this.$.holder=$(this.config.holder,a),this.overlay=new mvideo.Class.Overlay(this.$.holder,!0),this.loadObjects(this.$.holder),this.initialize()},initialize:function(){this.bindEvents()},bindEvents:function(){var a=this;this.$.btn.on("click",function(){a.overlay.show(),a.publish("confirm-click")})},changeAccess:function(a){if(this.config.alwaysActive)return void this.changeAccessApply(!1);this.changeAccessApply(a)},changeAccessApply:function(a){this.$.btn.attr("disabled",a)},click:function(){this.$.btn.trigger("click")},open:function(){this.$.holder.removeClass("u-hidden"),this.changeAccess(!1)},close:function(){this.hideOverlay(),this.$.holder.addClass("u-hidden")},hideOverlay:function(){this.overlay.hide()}}).define("PhoneVerificationConfirm")}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){this.config={selectors:{input:".c-phone-verification__input",changeLink:".c-phone-verification__change-link",flag:".c-phone-verification__verified-flag",icon:".c-phone-verification__icon"},holder:".c-phone-verification__input-block",labelForVerified:"Телефон - подтверждён",label:"Телефон",selectorError:".u-error-text"},$.extend(!0,this.config,b||{}),mvideo.observer(this),this.$={},this.$.holder=$(this.config.holder,a),this.loadObjects(this.$.holder),this.initialize()},initialize:function(){this.validator=this.$.input.validate(),this.prevValidRes=!1,this.$.label=this.$.input.siblings(".c-text-field__label"),this.bindEvents()},bindEvents:function(){var a=this;this.$.input.on("input keyup",function(){a.isValid()}),this.$.input.on("keydown",function(b){if(13===b.keyCode)return a.$.input.trigger("focusout"),a.validator.check(a.$.input)?a.publish("enter-input"):a.$.input.trigger("focus"),!1}),this.$.changeLink.on("click",function(b){b.preventDefault(),a.$.input.attr("readonly",!1).focus(),a.$.changeLink.addClass("u-hidden"),a.hideVerificationError(),a.publish("input-access")})},blockChange:function(){this.$.input.attr("readonly",!0),this.notChange||this.$.changeLink.removeClass("u-hidden").addClass("u-disabled")},enabledChange:function(){this.$.input.attr("readonly",!1),this.$.changeLink.addClass("u-hidden")},allowChange:function(){this.$.changeLink.removeClass("u-disabled")},getValue:function(){return this.$.input.val()},getForm:function(){return $(this.$.input[0].form)},getId:function(){return this.$.input.attr("id")},setInputReady:function(){this.$.input.attr("readonly",!0),this.$.icon.removeClass("u-hidden"),this.$.changeLink.addClass("u-hidden")},setVerified:function(a){a=a||this.config.labelForVerified,a&&this.$.label.text(a).removeClass("u-required"),this.$.flag.prop("checked",!0).change(),this.hideVerificationError(),this.setInputReady()},setInputNotChange:function(){this.notChange=!0,this.setInputReady(),this.$.flag.attr("hidden",!1)},hideVerificationError:function(){this.$.flag.siblings(".u-error-text").css({display:"none"})},clear:function(){this.$.changeLink.addClass("u-hidden"),this.hideVerificationError(),this.$.icon.addClass("u-hidden"),this.$.flag.prop("checked",!1),this.$.label.text(this.config.label),this.$.input.data("rule-required")&&this.$.label.addClass("u-required"),this.$.input.attr("readonly",!1).val("").trigger("input").focus()},isValid:function(){var a=this.validator.check(this.$.input);this.publish("change-valid",a),this.prevValidRes!=a&&(this.prevValidRes=a,this.$.flag.attr("hidden",!a),this.$.input.valid())},isValidVal:function(){return this.$.input.valid()},isNotValid:function(a){this.allowChange(),this.$.input.attr("readonly",!1).addClass("u-error"),this.setError(a.error)},setError:function(a){var b=this.config.selectorError+'[for="'+this.$.input.attr("id")+'"]';$(b,this.$.holder).html(a).show()}}).define("PhoneVerificationInput")}(),function(){"use strict";var a,b=".plp-facet-section",c=$(window),d=null,e=mvideo.Class.Class.extend({constructor:function(a,b,c){if(d){if(!c)return d;d.destroyInstance()}d=this,this.config={selectors:{form:"form.c-plp-facets",brandSection:"#brand-section"}},$.extend(!0,this.config,b),this.$={},this.$.holder=$(a),this.$.body=$("body"),this.$.htmlPage=$("html"),this.expandableLists=[],this.priceChanged=!1,this.clearFacets=!1,this.loadObjects(this.$.holder),this.subscribeForAsyncUpdate(),this.accessories=$(".c-product-accessories-section").length,this.setExpandableLists(),this.bindEvents(),this.holderEvents(),this.additionalModules=[]},holderEvents:function(){var a=this;a.cbDeviceChange=this.deviceChange.bind(a),window.mvideo.Event.subscribe("device",a.cbDeviceChange),this.$.holder.on("load-facets",function(){a.loadNewData()}).one("destroy-instance",function(){a.destroyInstance()}).on("add-module",function(b,c){a.addModule(c)})},addModule:function(a){this.additionalModules.push(a)},setExpandableLists:function(a){var b=this,c=a?" "+b.config.selectors.brandSection:"";b.denyBrandsExpandList&&(c=" .collapse.in:not("+b.config.selectors.brandSection+")"),b.expandableLists=[],$('[data-facet="form"][data-type="checkbox"]'+c+" .c-plp-facets__list").each(function(a,c){var d=$(this).find("li").length-5,e=$(this).find(".c-checkbox__input").first().attr("name").toLowerCase(),f=new mvideo.Class.ExpandableList(c,{showQty:5,linkConfig:{text:{show:'<span data-sel="'+b.config.page+"-link-facets_show_more-"+e+'">Показать еще '+d+"<span>",hide:'<span data-sel="'+b.config.page+"-link-facets_collapse-"+e+'" class="u-inline-block u-mt-12">Свернуть<span>'},tag:"a",attributes:{href:"#",class:"c-link c-link_gray c-link_pseudo u-ml-32 c-plp-facets__show-full-facet"}},beforeExpand:function(){"brand-section"!==this.$.holder.parents(":eq(1)").attr("id").toLowerCase()||b.accessories||(this.$.items.sort(function(a,b){var c=$(a).find("a").text().toLowerCase(),d=$(b).find("a").text().toLowerCase();return c<d?-1:c>d?1:0}),this.$.items.detach().appendTo(this.$.holder))},beforeCollapse:function(){"brand-section"!==this.$.holder.parents(":eq(1)").attr("id").toLowerCase()||b.accessories||(this.$.items.sort(function(a,b){var c=$(a),d=$(b),e=!!c.find("input[type=checkbox]").prop("checked"),f=!!d.find("input[type=checkbox]").prop("checked"),g=parseInt(c.find("span.c-checkbox__addition").text()),h=parseInt(d.find("span.c-checkbox__addition").text());return e&&f||!e&&!f?g>h?-1:g<h?1:0:e?-1:1}),this.$.items.detach().appendTo(this.$.holder))}});b.expandableLists.push(f)})},showPanel:function(){var a=this,b=$(".wrapper");this.$.body.addClass("u-no-scroll"),a.$.holder.addClass("o-plp-container__filters_visible"),setTimeout(function(){var c=$(document).scrollTop();a.$.holder.addClass("o-plp-container__filters_visible-in"),b.css("maxHeight","100vh").css("overflow","hidden"),b.scrollTop(c)}),this.expandableLists.forEach(function(a){a.reinit()}),this.$.holder.find(".c-plp-heading-facets .c-pseudo-tabs").trigger("visible.PseudoTabs"),this.$.holder.swipe("enable"),this.$.holder.swipe({swipeLeft:function(){a.hidePanel(),mvideo.Event.publish("hide-drop")}})},hidePanel:function(){var a=this,b=$(".wrapper"),c=this.$.body.find(".c-popup_add_accessories"),d=this.$.holder.find(".c-plp-facets__title, .c-plp-facets__clear-wrapper"),e=b.scrollTop();b.css("max-height","").css("overflow",""),$(document).scrollTop(e),0===c.length&&this.$.body.removeClass("u-no-scroll"),d.css("transition","left 0.2s ease-in"),a.$.holder.removeClass("o-plp-container__filters_visible-in"),setTimeout(function(){a.$.holder.removeClass("o-plp-container__filters_visible"),d.css("transition","")},300),this.$.holder.swipe("disable")},bindEvents:function(){var a=this,d=this.$.body.find(".c-popup_add_accessories"),e=d.length?d:c;a._checkFacetChanging(),this.$.holder.off("click"+b).on("click"+b,function(b){b.target==a.$.holder[0]&&a.hidePanel()}),$(".c-plp-toolbar__filter, .c-plp-facets__title-close").off("click"+b).on("click"+b,function(){a.$.holder.hasClass("o-plp-container__filters_visible")?a.hidePanel():a.showPanel()}),e.off("scroll"+b).on("scroll"+b,function(){a.scrollHandler()}),this.$.holder.find(".c-plp-facets__area-title").click(function(){if(mvideo.device.manager.getType()==mvideo.device.manager.TYPES.DESKTOP){var b=setInterval(function(){a._updateAffix()},10);a._updateAffix(),setTimeout(function(){clearInterval(b)},300)}}),this.$.form.find("[data-facet-item] a.c-plp-facets__item-link").off("click"+b).on("click"+b,function(){var a=$(this).parent().parent().find("input:checkbox, input:radio");return("radio"!==a.attr("type")||!a.prop("checked")&&!a.prop("disabled"))&&(a.prop("checked",!a.prop("checked")).change(),!1)}),this.$.form.find('[data-facet-item] [type="checkbox"], [data-facet-item] [type="radio"]').off("change"+b).on("change"+b,function(){var b=$(this).parents(".c-plp-facets__area"),c=$(this);a.denyBrandsExpandList||(a.denyBrandsExpandList="brand"==$(this).attr("name")),b.find("input:checked").length?b.find(".c-plp-facets__area-title").addClass("c-plp-facets__area-title_changed"):b.find(".c-plp-facets__area-title").removeClass("c-plp-facets__area-title_changed"),a._checkFacetChanging(),a.addGtmData(c),a.loadNewData()}),this.$.form.find("#store-id").on("change"+b,a.loadNewData.bind(a)),this.$.form.find("#store-id").on("change",function(){var b=$(this);a.addGtmData(b)}),this.$.form.find('[data-facet="dropDown"] select').on("change"+b,function(){var b=$(this).find("option:selected");a.addGtmData(b),a.loadNewData()}),$("#dropdownBrand").on("change"+b,function(a){$("#dropdownModel").val("empty")}),this.$.holder.find("[data-facet=price]").one("facetPrice:ready",function(){a.priceFacet=$(this).data("facetPrice"),a.priceFacet.unsubscribe("changeUrl").subscribe("changeUrl",function(){var b=a.priceFacet.$.holder.parents(".c-plp-facets__area"),c=$("#Price-section input");a.priceChanged=!0,b.find(".c-plp-facets__area-title").addClass("c-plp-facets__area-title_changed"),a._checkFacetChanging(),a.addGtmData(c),a.loadNewData()})}),this.$.holder.find("[data-facet=price]").on("click"+b,function(){var b=$(this);a.addGtmData(b)}),this.$.holder.find(".c-plp-facets__clear").off("click"+b).on("click"+b,function(){var b=$(this);return a.priceFacet&&a.priceFacet.reset(!0),$(".c-collections__top").find(".c-pseudo-tabs__item_active").removeClass("c-pseudo-tabs__item_active"),a.clearFacets=!0,a.$.form.find("[data-facet-item] input:checked").not("[disabled]").attr("checked",!1),a.$.form.find('[data-type="radio"]').each(function(){$(this).find('[type="radio"]:last').prop("checked",!0)}),a.$.form.find(".c-plp-facets__area-title_changed").removeClass("c-plp-facets__area-title_changed"),a._checkFacetChanging(),a.$.form.find(".c-plp-facets__search-store").val(""),a.$.form.find("#store-id").val(""),a.$.form.find('[data-facet="dropDown"] select').not("[disabled]").val("empty"),a.$.form.find(".js_accessories .c-pseudo-tabs__item_active").removeClass("c-pseudo-tabs__item_active"),a.addGtmData(b),a.loadNewData(),a.accessories&&(a.resetExpandableLists=!0),a.denyBrandsExpandList=!1,!1}),this.$.holder.find(".c-plp-facets__show-full-facet").off("click"+b).on("click"+b,function(){if(mvideo.device.manager.getType()==mvideo.device.manager.TYPES.DESKTOP){var b=setInterval(function(){a._updateAffix()},10);a._updateAffix(),setTimeout(function(){clearInterval(b)},300)}});var f=function(a){this.denyBrandsExpandList&&(this.denyBrandsExpandList=!1,this.setExpandableLists(!0))};$(window).off("pageshow.PLPFacets").on("pageshow.PLPFacets",f.bind(this)),$(window).off("popstate.PLPFacets").on("popstate.PLPFacets",f.bind(this))},_updateAffix:function(){this.scrollHandler(),this.accessories||this.$.holder.data("relative-affix-instance").eventsHandler()},_checkFacetChanging:function(){var a=$(".c-plp-facets__area-title_changed"),b=$(".c-plp-result-toolbar__filter");a.length?b.addClass("c-plp-result-toolbar__filter_changed"):b.removeClass("c-plp-result-toolbar__filter_changed")},scrollHandler:function(){if(mvideo.device.manager.getType()==mvideo.device.manager.TYPES.DESKTOP&&!this.accessories){var a=$(".c-plp-facets__clear-wrapper");c.scrollTop()+c.height()>=this.$.holder.offset().top+this.$.holder.outerHeight()?(a.parent().is(".c-plp-facets")||this.$.holder.find(".c-plp-facets").append(a),a.addClass("c-plp-facets__clear-wrapper_embedded")):(a.parent().is(this.$.holder.parent())||this.$.holder.parent().append(a),a.removeClass("c-plp-facets__clear-wrapper_embedded"))}},getStateFacetForm:function(){return this._getUrl(this.$.form,this.$.form.data("base-url"),this.$.form.data("delimiter"))},_getUrl:function(a,b,c){var d,e,f,g=a.find("input:checkbox[name!='pickup'], input:radio").serializeArray(),h={},i=b,j=a.find("input:checkbox[name='pickup']:checked"),k=a.find("#store-id").val(),l=$(".js_accessories .c-pseudo-tabs__item_active a"),m=a.find('[data-facet="dropDown"] select'),n=window.location.pathname.match(/product_collections=[A-Za-z0-9\-]+/g);if(-1!=i.indexOf("?")&&(e=i,f=e.substring(e.indexOf("?")),i=e.substring(0,e.indexOf("?"))),this.priceFacet&&(this.priceFacet.currentUrl||-1!=document.location.href.indexOf("/price=")||this.accessories&&this.priceChanged)){var o=this.priceFacet.getInputValues();o[0]==this.priceFacet.config.min&&o[1]==this.priceFacet.config.max||g.push({name:"price",value:"from-"+o[0]+"-to-"+o[1]})}if(j[0]||k){var p=this._getPickupData(j,k);g.push({name:"pickup",value:[p]})}if(m&&m.each(function(){var a=$(this).val();if(a&&"empty"!=a){var b=a.indexOf("/f/")+3,c=a.indexOf("?"),e=a.indexOf("?")>-1,f=e?a.substr(b,c-b):a.substr(b),h=f.lastIndexOf("/"),i=f.lastIndexOf("/")>-1,j=f.lastIndexOf("="),k=f.substr(i?h+1:0,i?j-(h+1):j),l=f.substr(j+1);d=e?a.substr(c):"",g.push({name:k,value:l})}}),l.length){var q=l.attr("href"),r=q.indexOf("?");d=r>-1?q.substr(r):""}return n&&n.length&&!this.clearFacets&&n.forEach(function(a){var b=a.split("=");g.push({name:b[0],value:b[1]})}),this.clearFacets=!1,this.additionalModules.length&&this.additionalModules.forEach(function(a){try{var b=a.getValue();b&&g.push(b)}catch(a){window.console.warn(a)}}),g.forEach(function(a,b){"discount"===a.name&&"0"===a.value||"stars"===a.name&&"0-0"===a.value||(h[a.name]||(h[a.name]=[]),h[a.name].push(a.value))}),"&"!=c?(Object.keys(h).length&&(i+=c,i+=$.map(h,function(a,b){return b+"="+a.join(",")}).join("/")),i+=f?d||f:d||""):(i+=f?d||f:d||"",Object.keys(h).length&&(i+=c,i+=$.map(h,function(a,b){return b+"="+a.join(",")}).join(c))),location.search&&(i+=location.search),{url:i,stateForm:h}},getUrl:function(){return this._getUrl.apply(this,arguments).url},addGtmData:function(b){var c=b.attr("data-client-prev-action");if(c){var d=$.parseJSON(c),e=[];for(var f in d)e.push(f+"="+d[f]);a=e.join("&")}},_getPickupData:function(a,b){var c="";return b&&(c+=b),a[0]&&(c+=c?",today":"today"),c},getExpandedFacets:function(){var a=$(".c-plp-facets__area"),b={};return a.each(function(a,c){var d=$(c).find(".collapse");b[d.attr("id")]=d.hasClass("in")}),b},loadNewData:function(){var b=this,c=new mvideo.Class.AsyncDataLoader;c.cancel(),clearTimeout(this.loadNewDataTimeout),this.loadNewDataTimeout=setTimeout(function(){var d=b.getStateFacetForm().url,e=b.getExpandedFacets();if(a&&a.length>0){d+=-1!=d.indexOf("?")?"&"+a:"?"+a}d!=document.location.href&&c.load({url:d,getParams:e})},240)},_beforeRequest:function(){$(".o-plp-container__product-listing").css({opacity:"0.5"}),this.$.holder.addClass("o-plp-container__filters_load")},_afterRequest:function(){var a=$(".c-plp-facets__sort");this.$.holder.removeClass("o-plp-container__filters_load"),this.accessories||(this.scrollHandler(),mvideo.device.manager.getType()==mvideo.device.manager.TYPES.DESKTOP&&this.$.holder.data("relativeAffixInstance").eventsHandler()),$(".o-plp-container__product-listing").css({opacity:""}),a.length&&(a.removeClass("disabled-until-scripts-loaded"),mvideo.Class.ReinitContent.customSelect(a)),this.resetExpandableLists&&(this.denyBrandsExpandList?(this.denyBrandsExpandList=!1,this.setExpandableLists()):this.expandableLists.forEach(function(a){a.reinit()}),this.resetExpandableLists=!1)},_sortFacetByAlphabet:function(a,b){b.sort(function(a,b){var c=$(a).find("a").text().toLowerCase(),d=$(b).find("a").text().toLowerCase();return c<d?-1:c>d?1:0}),b.detach().appendTo(a)},sortBrandsByABC:function(){var a=$(this.config.selectors.brandSection),b=a.find("li.c-plp-facets__item"),c=a.find("ul.c-plp-facets__list");this._sortFacetByAlphabet(c,b)},subscribeForAsyncUpdate:function(){var a=this;(new mvideo.Class.AsyncDataLoader).addModule({container:this.$.holder,dataAdapter:function(a){for(var b=0;b<a.length;b++)if(a[b].searchFacets)return{facets:a[b].searchFacets}},onDataHandler:function(b){try{b.facets&&(a.$.holder.trigger("facets-loaded"),$(".c-plp-facets__clear-wrapper").remove(),a.$.form.replaceWith(b.facets),a.loadObjects(a.$.holder),a.bindEvents(),a.setExpandableLists(),mvideo.initScripts($(".c-plp-facets")),
a.expandableLists.forEach(function(a){a.reinit()}),a.denyBrandsExpandList&&a.$.holder.find("#brand-section .c-plp-facets__item").length>5&&a.sortBrandsByABC(),a.$.form.find("[data-facet-item]").removeClass("disabled-until-scripts-loaded"))}catch(a){}},beforeRequest:function(){a._beforeRequest()},afterRequest:function(){var b=$(".c-plp-facets__area-container");a._afterRequest(),mvideo.Class.ReinitContent.customSelect(b)},moduleName:"facets"})},deviceChange:function(a,b){var c=$(".c-plp-facets__clear-wrapper");b!=mvideo.device.manager.TYPES.DESKTOP?c.parent().is(".c-plp-facets")||this.$.holder.find(".c-plp-facets").append(c):(this.hidePanel(),this.scrollHandler())},destroyInstance:function(){this.loadNewDataTimeout&&clearTimeout(this.loadNewDataTimeout),delete this.loadNewDataTimeout,mvideo.Event.unsubscribe("device",this.cbDeviceChange),delete this.cbDeviceChange,(new window.mvideo.Class.AsyncDataLoader).clear(),d=null}});e.define("PLPFacetSection",e)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={setPopupFocus:!1,states:["inactive","active"]},mvideo.observer(this),this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.initialize(),this.$.holder.on("click",function(a){a.stopPropagation()})},initialize:function(){this.controller=new mvideo.Class.PopupController,this.controller.add(this)},isShown:function(){return this.$.holder.is(":visible")},getFirstElement:function(){return this.$.holder.find("input[type=text],textarea,select").filter(":visible:first")},setFocus:function(){this.getFirstElement().focus()},show:function(){return this.$.holder.show(),this.setPosition(),this.open()},hide:function(){return this.$.holder.hide(),this.close()},toggle:function(){this.isShown()?this.hide():this.show()},open:function(){return this.publish("show",this),this.setState("active"),this.config.setPopupFocus&&this.setFocus(),this},close:function(){return this.publish("hide",this),this.setState("inactive"),this},setPosition:function(){}});a.include(mvideo.Mixin.state),a.define("BasicPopupContent",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b,c){this.config={event:"click",isUnique:!1,eventOnParent:!1,affectParent:!0,setPopupFocus:!1,states:["inactive","active"]},$.extend(!0,this.config,c||{}),mvideo.observer(this),this.$={},this.$.holder=$(a),this.$.target=this.config.isUnique?$(b):this.$.holder.parent().find(b),this.loadObjects(),this.initialize(),this.bindEvents()},initialize:function(){this.popup=new mvideo.Class.BasicPopupContent(this.$.target,{setPopupFocus:this.config.setPopupFocus})},isPopupShown:function(){return this.popup.isShown()},showPopup:function(){return this.popup.setPosition(),this.popup.show(),this.setState("active"),this},hidePopup:function(){return this.popup.hide(),this.setState("inactive"),this},togglePopup:function(){return this.isPopupShown()?this.hidePopup():this.showPopup()},bindEvents:function(){var a=this,b=a.$.holder;return(a.config.eventOnParent?b.parent():b).on(a.config.event,function(b){b.preventDefault(),b.stopPropagation(),a.togglePopup()}),this.popup.subscribe("show",function(){a.setState("active")}).subscribe("hide",function(){a.setState("inactive")}),this}});a.include(mvideo.Mixin.state),a.define("BasicPopupLink",a)}(),function(){"use strict";var a=mvideo.Class.BasicPopupContent.extend({constructor:function(a,b){this.config={autoInit:!0,states:["inactive","active"],theme:"default",tpl:'<div class="popup"><ul class="search-list"></ul></div>',parent:"body",addMethod:"append",selectors:{content:".search-list"}},mvideo.observer(this),$.extend(!0,this.config,b||{}),this.$={},this.$.target=$(a),this.$.el=this.render(),this.$.el.addClass(this.config.theme),this.insert(this.config.addMethod,$(this.config.parent)),this.$.holder=this.$.el,this.loadObjects(this.$.holder),this.initialize()},render:function(a,b){return a=a||this.config.tpl,b=b||this.config.tplData,"function"==typeof a?a({data:b}):$(mvideo.helpers.render(a,{data:b}))},insert:function(a,b){return b=b||this.$.holder,this.$.el||(this.$.el=this.render()),a=a||this.config.method,b[a](this.$.el),this},setPosition:function(){var a=this.$.target.position();this.$.holder.css({top:a.top,width:this.$.target.outerWidth(),left:a.left})},updateContent:function(a){return this.$.content.html(a),this}});a.define("PopupContentDynamic",a)}(),function(){"use strict";var a=mvideo.Class.ModulesCollection,b=a.prototype,c=a.extend({constructor:function b(c,d){if(b.instance)return b.instance;b.instance=this,mvideo.observer(this),a.apply(this,arguments)},initialize:function(){},add:function(a){return this.watchModule(a),b.add.call(this,a)},watchModule:function(a){var b=this;return a.subscribe("show",function(a,c){b.handlePopupShow(c)}),this},handlePopupShow:function(a){return $(window).one("resize.PopupController",function(){"desktop"===mvideo.device.manager.getType()&&a.hide(!0)}),$("html").one("click.PopupController",function(){a.hide(!0)}),this}});c.define("PopupController",c)}(),function(){"use strict";var a=mvideo.Class.BasicPopupLink.extend({constructor:function(a,b,c){this.config={event:"click",isUnique:!1,eventOnParent:!1,affectParent:!0,setPopupFocus:!1,states:["inactive","active"]},$.extend(!0,this.config,c||{}),mvideo.observer(this),this.$={},this.$.holder=$(a),this.$.target=b.insert(),this.loadObjects(),this.initialize(),this.bindEvents()}});a.define("PopupLinkDynamic",a)}(),function(){"use strict";var a=mvideo.Class.BasicPopupLink.extend({constructor:function(a,b,c){this.config={event:"click",isUnique:!1,eventOnParent:!1,affectParent:!0,states:["inactive","active"]},$.extend(!0,this.config,c||{}),mvideo.observer(this),this.$={},this.$.holder=$(a),this.$.target=this.config.isUnique?$(b):this.$.holder.parent().find(b),this.loadObjects(),this.initialize(),this.bindEvents()},bindEvents:function(){var a=this,b=a.$.holder,c=a.config.eventOnParent?b.parent():b;return c.on("mouseenter",function(){a.popup.show()}),c.on("mouseleave",function(){a.popup.hide()}),c.on("click",function(a){a.stopPropagation()}),this.popup.subscribe("show",function(){a.setState("active")}).subscribe("hide",function(){a.setState("inactive")}),this}});a.define("PopupLinkHover",a)}(),function(){"use strict";window.mvideo.Class.Class.extend({constructor:function a(b,c,d,e){if(a.instance)return a.instance.selector=b,a.instance.defaultType=c||!1,a.instance.reinit(),a.instance;this.selector=b,this.defaultType=c||!1,this.cookieOff="true"==d,this.plpType=e,this.isChangedType=!1,this.listCollection=new window.mvideo.Class.ModulesCollection,this.lazyLoad=new window.mvideo.Class.LazyLoad,this.initialize(),a.instance=this},initialize:function(){this.initProductLists(),this.subscribe(),this.setDefaultState(),window.mvideo.Event.publish("changeView.ProductList")},setDefaultState:function(){var a=$.cookie("products-view");this.cookieOff||a&&(this.defaultType=a),"grid"===this.defaultType||"grid-view"===this.defaultType?this.initGridView():"list"===this.defaultType||"list-view"===this.defaultType?this.initListView():window.mvideo.Event.publish("productViewSwitcher.update")},initProductLists:function(){var a=this;$(this.selector).each(function(b,c){a.listCollection.add(new window.mvideo.Class.ProductsList({holder:$(c),plpType:a.plpType}))})},subscribe:function(){var a=this;window.mvideo.Event.subscribe("productViewSwitcher.state",function(b,c){if("mobile"===window.mvideo.device.manager.getType())return void a.initGridView();switch(c){case"grid-view":a.initGridView();break;case"list-view":a.initListView()}a.lazyLoad.update()}),window.mvideo.Event.subscribe("changeView.ProductList",a.switchView.bind(a)),window.mvideo.Event.subscribe("device",a.switchView.bind(a))},switchView:function(a,b){var c=b||window.mvideo.device.manager.getType(),d=this.defaultType+"-view";this.cookieOff||(d=$.cookie("products-view")),"mobile"===c?"list-view"===d?(this.initGridView(),this.isChangedType=!0,this.prevType=d):"new"===this.plpType&&this.listCollection.run("reinit"):(this.isChangedType&&"list-view"===this.prevType&&(this.initListView(),this.isChangedType=!1),"list-view"!==d&&this.listCollection.run("reinit"),this.prevType=d)},initGridView:function(){this.listCollection.run("initGridView"),"new"===this.plpType&&this.listCollection.run("reinit")},initListView:function(){this.listCollection.run("initListView")},reinit:function(){this.listCollection.empty(),this.initProductLists(),this.setDefaultState(),window.mvideo.Event.publish("changeView.ProductList"),this.lazyLoad.update()}}).define("ProductListCollection")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config=$.extend(!0,{selectors:{items:".product-tile"},states:["grid-view","list-view"],plpType:"old"},a||{}),this.$={},this.$.holder=$(this.config.holder),this.loadObjects(this.$.holder),this.initialize()},initialize:function(){return this.tiles=new mvideo.Class.ModulesCollection,"old"===this.config.plpType?this.tiles.add(new mvideo.Class.VerticalIndentEqualizer(this.$.holder,{selectors:{items:".product-tile-delivery-options-wrap"},needRecalc:!0,param:"paddingBottom"})).add(new mvideo.Class.VerticalIndentEqualizer(this.$.holder,{selectors:{items:".product-tile-picture"},needRecalc:!0,param:"paddingBottom"})).add(new mvideo.Class.VerticalIndentEqualizer(this.$.holder,{selectors:{items:".product-tile-checkout-section"},needRecalc:!0,param:"paddingBottom"})).add(new mvideo.Class.VerticalIndentEqualizer(this.$.holder,{selectors:{items:".product-tile-sale"},needRecalc:!0,param:"paddingBottom"})):this.tiles.add(new mvideo.Class.VerticalIndentEqualizer(this.$.holder,{selectors:{items:".c-product-tile-picture"},alignMax:!0,needRecalc:!0,param:"paddingBottom"})).add(new mvideo.Class.VerticalIndentEqualizer(this.$.holder,{selectors:{items:".c-product-tile__description"},alignMax:!0,needRecalc:!0,param:"paddingBottom"})).add(new mvideo.Class.VerticalIndentEqualizer(this.$.holder,{selectors:{items:".c-product-tile__checkout-section"},alignMax:!0,needRecalc:!0,param:"paddingBottom"})).add(new mvideo.Class.VerticalIndentEqualizer(this.$.holder,{selectors:{items:".c-product-tile"},alignMax:!0,needRecalc:!0,param:"paddingBottom"})),this},initGridView:function(){return this.setState(this.config.states[0]),this.tiles.run("initialize"),this.tiles.run("setNormalizedParam"),this},initListView:function(){return this.setState(this.config.states[1]),this.tiles.run("resetParam"),this},reinit:function(){return this.tiles.run("resetParam"),this.tiles.run("initialize",!0),this.tiles.run("setNormalizedParam"),this},reset:function(){return this.tiles.run("resetParam"),this}});a.include(mvideo.Mixin.state),a.define("ProductsList",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config=$.extend(!0,{activeClass:"active",selectors:{items:".btn"}},b),this.$={},this.$.holder=$(a),this.loadObjects(this.$.holder),this.initialize(),this.bindEvents()},initialize:function(){var a=this;window.setTimeout(function(){var b=$.cookie("products-view");a.publishState(b)})},publishState:function(a){a=a||this.getState(),this.ensureActiveButton(a),mvideo.Event.publish("productViewSwitcher.state",a)},ensureActiveButton:function(a){var b=this.getActiveItem(!1);b&&b.length>0&&b.attr("href")===a||(this.unsetActiveAll(),this.$.items.filter(function(b,c){return $(c).attr("href")===a}).addClass(this.config.activeClass).tab("show"))},getState:function(a){return a=a||this.getActiveItem(),a.attr("href")},bindEvents:function(){var a=this;this.$.items.on("click",function(b){b.preventDefault();var c=$(this),d=a.getState(c);a.publishState(d),$.cookie("products-view",d,{path:"/"})}),mvideo.Event.subscribe("productViewSwitcher.update",function(){a.publishState()})}});a.include(mvideo.Mixin.itemsContainer),a.define("ProductViewSwitcher",a)}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function a(b){if(this.config={scriptUrl:"https://www.google.com/recaptcha/api.js",scriptUrlParams:{onload:"recaptchaLoaded",render:"explicit"}},$.extend(!0,this.config,b||{}),a.instance)return a.instance;a.instance=this,mvideo.observer(this),this.initialize()},initialize:function(){window.recaptchaLoaded=this._recaptchaLoadedCallback.bind(this),this.recaptchaLoaded=!1,$.getScript(this._getScriptUrl())},onLoad:function(a){if(!$.isFunction(a))return void console.warn("%s should be a callback function",a);this.recaptchaLoaded&&a()||this.subscribe("recaptchaLoaded",a)},_getScriptUrl:function(){return this.config.scriptUrl+"?"+$.param(this.config.scriptUrlParams)},_recaptchaLoadedCallback:function(){this.recaptchaLoaded=!0,this.publish("recaptchaLoaded")}}).define("Recaptcha")}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a){this.lastDistance=0,this.config={power:.7,impulse:150,widthOfOne:0,threshold:.6,maxLeftDistance:0,maxRightDistance:0},$.extend(!0,this.config,a),this.config.widthOfOne&&(this.config.halfOfOne=this.config.widthOfOne/2)},setWidthOfOne:function(a){this.config.widthOfOne=a,this.config.halfOfOne=this.config.widthOfOne/2},setMaxLeftDistance:function(a){this.config.maxLeftDistance=a},startMeasure:function(a){this._startTime=Date.now(),this._startDistance=a},interimMeasure:function(a,b){var c;return this._prevDirection?this._prevDirection!==b&&(this._startTime=Date.now(),this._prevDirection=b):this._prevDirection=b,a=b===$.fn.swipe.directions.LEFT?this._startDistance-a:this._startDistance+a,a>0?a=Math.pow(Math.abs(a),this.config.power):a<this.config.maxLeftDistance&&(c=this.config.maxLeftDistance-a,a=this.config.maxLeftDistance-Math.pow(Math.abs(c),this.config.power)),a},_calculateDistanceToBorder:function(a,b){var c=Math.abs(a%this.config.widthOfOne);return c<this.config.halfOfOne+(b===$.fn.swipe.directions.LEFT?-1:1)*this.config.halfOfOne*this.config.threshold?a+=c:a-=this.config.widthOfOne-c,a},getLastDistance:function(){return this.lastDistance},stopMeasure:function(a,b,c){if(!c)var d=Date.now(),e=d-this._startTime,f=a/e,g=this.config.impulse*f;return b=b||this._prevDirection,a=!c&&isFinite(g)&&g>=a?b===$.fn.swipe.directions.LEFT?this._startDistance-a-g:this._startDistance+a+g:b===$.fn.swipe.directions.LEFT?this._startDistance-a:this._startDistance+a,this.config.widthOfOne&&(a=this._calculateDistanceToBorder(a,b)),a>this.config.maxRightDistance?a=this.config.maxRightDistance:a<this.config.maxLeftDistance&&(a=this.config.maxLeftDistance),this.lastDistance=a,a}}).define("RelativeDistanceCalculator")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function a(b){if(a.instance)return a.instance;a.instance=this,this.config=$.extend(!0,{sidebar:".o-page__sidebar",content:".o-page__sidebar-content",overlay:".o-page__sidebar-overlay",noScroll:"u-no-scroll o-page_sidebar-open"},b),this.$={},this.initialize()},initialize:function(){this.$.sidebar=$(this.config.sidebar),this.$.content=$(this.config.content,this.$.sidebar),this.$.overlay=$(this.config.overlay),this.$.body=$("body"),this.$.html=$("html"),this.bindEvents()},show:function(){this.$.body.addClass(this.config.noScroll),this.$.html.css({overflow:"hidden",maxHeight:"100vh"})},hide:function(){this.$.body.removeClass(this.config.noScroll),this.$.html.css({overflow:"auto",maxHeight:"auto"})},bindEvents:function(){var a=this;this.$.overlay.swipe({swipeLeft:function(b){a.$.sidebar.trigger("swipeLeft")}}),this.$.overlay.on("click",function(){a.$.sidebar.trigger("swipeLeft")}),this.$.sidebar.swipe({swipeLeft:function(b){a.$.sidebar.trigger("swipeLeft")}}),this.$.sidebar.on("swipeLeft",this.hide.bind(this))},setContent:function(a,b){this.$.content.html(a),b&&mvideo.Class.ReinitContent.reinit(this.$.content)}});a.define("SideBar",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function a(b,c){if(a.instance)return $.extend(!0,a.instance.config,c),a.instance.initialize(),a.instance;a.instance=this,this.config={enable:!1,duration:200,selectors:{container:".facet-section-wrapper",stickyItem:".sticky-result-holder",targetItem:".js-close-facet",qtyItem:".c-plp-category-title__amount"}},mvideo.observer(this),$.extend(!0,this.config,c),this.strPattern=$(this.config.selectors.stickyItem).find(".close-facet-btn").text(),this.enabled=!1,this.$={holder:b instanceof jQuery?b:$(b),container:$(this.config.selectors.container)},this.initialize()},initialize:function(){this.qty=+$(this.config.selectors.qtyItem).text().replace(/\D+/g,""),"desktop"!==mvideo.device.manager.getType()&&this.config.enable&&(this.enable(),this.publish("facet:stickyItemUpdate",{stickyItem:this},this._stickyHandler))},enable:function(){this.enabled||(this.config.enable=!0,this._bindEvents(),this._updateUI(),this.enabled=!0)},disable:function(){this.enabled&&(this.config.enable=!1,this._unBindEvents(),this.enabled=!1)},isVisible:function(a){return(a||$(this.config.selectors.stickyItem)).is(":visible")},hide:function(a){var b=$(this.config.selectors.stickyItem);this.isVisible(b)&&b.slideUp(void 0===a?this.config.duration:a)},show:function(a){var b=$(this.config.selectors.stickyItem);this.isVisible(b)||b.slideDown(void 0===a?this.config.duration:a)},_updateUI:function(){var a=this.strPattern.replace(/\{\{qty\}\}/g,this.qty);$(this.config.selectors.stickyItem).css("display","none").removeClass("hidden").find(".close-facet-btn").text(a),$(this.config.selectors.targetItem).find(".close-facet-btn").removeClass("btn-invers-deep-grey").text(a)},_stickyHandler:function(a){var b,c,d=a.data&&a.data.stickyItem?a.data.stickyItem:this,e=$(d.config.selectors.targetItem),f=mvideo.instance.page.page.sidebar.isVisible();b=Array.prototype.some.call(e,mvideo.helpers.inViewport.bind(this)),c=e.last().offset().top<=$(document).scrollTop(),b||c||!f?d.hide():d.show()},_bindEvents:function(){this.enabled||(this.$.container.on("scroll",{stickyItem:this},this._stickyHandler),this.subscribe("facet:stickyItemUpdate",{stickyItem:this},this._stickyHandler),this.$.holder.find(".collapse").on("shown.bs.collapse hidden.bs.collapse",{stickyItem:this},this._stickyHandler))},_unBindEvents:function(){this.enabled&&(this.$.container.off("scroll",this._stickyHandler),this.unsubscribe("facet:stickyItemUpdate",this._stickyHandler),this.$.holder.find(".collapse").off("shown.bs.collapse hidden.bs.collapse",this._stickyHandler))}});a.define("StickyItem",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={enable:!1,duration:200,selectors:{stickyItem:".sticky-result-holder",targetItem:".js-close-facet"}},mvideo.observer(this),$.extend(!0,this.config,b),this.enabled=!1,this.$={holder:a instanceof jQuery?a:$(a)},this.loadObjects(this.$.holder),this._inProgress=!1,this._clearInProgress=$.proxy(this._clearInProgress,this),this.initialize()},initialize:function(a){this.config.enable=!!a,this.enable(),this.publish("facet:stickyItemUpdate",{stickyItem:this},this._stickyHandler)},enable:function(){this.enabled||this.config.enable&&(this._bindEvents(),this._updateUI(),this.enabled=!0)},disable:function(){this.enabled&&(this._unBindEvents(),this.enabled=!1)},hide:function(a){this._inProgress||(this._inProgress=!0,$(this.config.selectors.stickyItem).slideUp(void 0===a?this.config.duration:a,this._clearInProgress))},show:function(a){this._inProgress||(this._inProgress=!0,$(this.config.selectors.stickyItem).slideDown(void 0===a?this.config.duration:a,this._clearInProgress))},_updateUI:function(){$(this.config.selectors.stickyItem).css("display","none").removeClass("hidden")},_clearInProgress:function(){this._inProgress=!1},_stickyHandler:function(a){var b,c=a.data&&a.data.stickyItem?a.data.stickyItem:this;b=Array.prototype.some.call(c.$.targetItem,mvideo.helpers.inViewport.bind(this)),b?c.hide():c.show()},_bindEvents:function(){this.enabled||(mvideo.Event.subscribe("scroll",{stickyItem:this},this._stickyHandler),this.subscribe("facet:stickyItemUpdate",{stickyItem:this},this._stickyHandler),this.$.holder.find(".collapse").on("shown.bs.collapse hidden.bs.collapse",{stickyItem:this},this._stickyHandler))},_unBindEvents:function(){this.enabled&&(mvideo.Event.unsubscribe("scroll",this._stickyHandler),this.unsubscribe("facet:stickyItemUpdate",this._stickyHandler),this.$.holder.find(".collapse").off("shown.bs.collapse hidden.bs.collapse",this._stickyHandler))}});a.define("StickyItemDetectum",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={range:!0,min:0,max:999,values:[0,999]},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){this.initSlider()},initSlider:function(){return this.$.holder.slider(this.config),this},getValues:function(){return this.$.holder.slider("values")},setValues:function(a){return this.$.holder.slider("values",a),this},setValue:function(a){return this.$.holder.slider("value",a),this},disable:function(){this.$.holder.slider("disable")},enable:function(){this.$.holder.slider("enable")}});a.define("RangeSlider",a)}(),function(){"use strict";var a={VK:"vk",FACEBOOK:"facebook",TWITTER:"twitter",OK:"odnoklassniki"};mvideo.Class.Class.extend({constructor:function(a){var b=this;b.config={link:window.location.href},$.extend(!0,b.config,a||{}),b.initialize(),b.config.multiple&&(mvideo.Class.SocialShare=function(){return b},b.constructor=mvideo.Class.SocialShare)},initialize:function(){this.linkEnc=encodeURIComponent(this.config.link),mvideo.Event.subscribe("count-shares",function(a,b){this.getShareCount(b.network,b.accessToken)}.bind(this)),window.VK=window.VK||{},window.VK.Share=window.VK||{},window.VK.Share.count=function(b,c){mvideo.Event.publish("shares-count-updated",{network:a.VK,count:c})},window.ODKL=window.ODKL||{},window.ODKL.updateCount=window.ODKL.updateCountOC=function(b,c){mvideo.Event.publish("shares-count-updated",{network:a.OK,count:c})}},getShareCount:function(b,c,d){var e=this;switch(b){case a.FACEBOOK:$.ajax({url:"https://www.mvideo.ru/fbreviews/?id="+this.linkEnc+"&access_token="+c,method:"get",contentType:"application/json"}).done(function(b){var c=b&&b.share&&b.share.share_count?b.share.share_count:0;e.updateCount(a.FACEBOOK,d,c)}).fail(function(){e.updateCount(a.FACEBOOK,d,0)});break;case a.TWITTER:$.ajax({url:"https://opensharecount.com/count.json?url="+this.linkEnc,method:"get",dataType:"json"}).done(function(b){var c=b.count?b.count:0;e.updateCount(a.TWITTER,d,c)}).fail(function(){e.updateCount(a.TWITTER,d,0)});break;case a.VK:d&&(window.VK.Share.count=function(a,b){d(b)}),$.getJSON("https://vk.com/share.php?act=count&index=1&url="+this.linkEnc+"&format=json&callback=?");break;case a.OK:d&&(window.ODKL.updateCount=window.ODKL.updateCountOC=function(a,b){d(b)}),$.getJSON("https://www.ok.ru/dk?st.cmd=extLike&uid=odklocs0&ref="+this.linkEnc+"&format=json&callback=?")}},updateCount:function(a,b,c){b?b(c):mvideo.Event.publish("shares-count-updated",{network:a,count:c})},getShareLink:function(b){var c="";switch(b){case a.FACEBOOK:c="https://www.facebook.com/share.php?u="+this.linkEnc;break;case a.TWITTER:c="https://twitter.com/intent/tweet?url="+this.linkEnc;break;case a.VK:c="https://vk.com/share.php?url="+this.linkEnc+this.addImage();break;case a.OK:c="https://connect.ok.ru/offer?url="+this.linkEnc}return c},openWindow:function(b,c,d){var e=this.getShareLink(b);if($(window).off("focusin.socialshare"),b===a.TWITTER&&c&&(e+="&text="+c),e){var f=window.open(e,"displayWindow","width=700,height=400,left=200,top=100,location=no, directories=no,status=no,toolbar=no,menubar=no");f&&d&&$(window).on("focusin.socialshare",function(){f.closed&&($(window).off("focusin.socialshare"),d())})}},addImage:function(){var a=$('meta[property="og:image"]').attr("content");return a?"&image="+encodeURIComponent(a):""}}).define("SocialShare")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a){this.config={className:"sticky-header",topOffset:{desktop:-70,tablet:-40,mobile:0},enable:!0,selectors:{target:".header-main-area-sticky",target_handler:".header-main-area",scrollContainer:window}},this.$={},this.$.holder=$(a),this.loadObjects(),this.initialize(),this.bindEvents(),this.update()},initialize:function(){return this.page=mvideo.instance.page.page,this.create(),this.hide(),this},create:function(){var a=new mvideo.Class.LazyLoad;this.item=this.$.target,this.item.attr("class",this.config.className),this.item.appendTo(".page-content"),a.add("."+this.config.className)},disable:function(){return this.config.enable=!1,this.hide(),this},enable:function(){return this.config.enable=!0,this},isEnabled:function(){return!!this.config.enable},isShown:function(){return this.item.is(":visible")},show:function(){return this.isEnabled()&&(this.item.show(),this.item.trigger("sticky-show"),this.updateSearch(!1)),this},hide:function(){return this.updateSearch(!0),this.item.hide(),this},updateSearch:function(a){var b=".header-area .header-search-input",c=".sticky-header .header-search-input";a?$(c).val()&&($(b).val($(c).val()),$(c).val("")):$(b).val()&&($(c).val($(b).val()),$(b).val(""))},getHeight:function(){return this.item.outerHeight()},isTargetVisible:function(a,b){b=b||this.$.target_handler||this.$.target;var c=b.offset(),d=b.height(),e=mvideo.device.manager.getType();return c.top-a+d+this.config.topOffset[e]>0},update:function(){if(!this.isEnabled())return this;var a=this.$.scrollContainer.scrollTop();return this[this.isTargetVisible(a)?"hide":"show"]()},bindEvents:function(){mvideo.Event.subscribe("scroll",$.proxy(this.update,this))}});a.define("StickyHeader",a)}(),function(){"use strict";var a=mvideo.Class.StickyHeader.extend({constructor:function(a){this.config={className:"sticky-header-filter",enable:!1,selectors:{target:".filters-promo-hub",target_handler:".filters-promo-hub-sticky",target_sticky_part:".filters-promo-hub form",sticky_header:".sticky-header",scrollContainer:window}},this.$={},this.$.holder=$(a),this.loadObjects(),this.initialize(),this.bindEvents(),this.updateTopOffset(),this.update()},initialize:function(){this.item=this.$.target},hide:function(){this.updateHeight(0),$(this.config.selectors.target).removeClass(this.config.className)},show:function(){this.updateHeight(this.getHeight()),$(this.config.selectors.target).addClass(this.config.className)},updateHeight:function(a){$(this.config.selectors.target_handler).css("height",a)},updateTopOffset:function(){return this.config.topOffset=-$(this.config.selectors.target_sticky_part).height()-$(this.config.selectors.sticky_header).outerHeight(),this}});a.define("StickyHeaderReplace",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){if(this.$={},this.$.holder=$(a),this.loadObjects(this.$.holder),!this.$.tabs)throw new Error('Subclass should have "tabs" in config.selectors');this.tabs=new mvideo.Class.StoreTabs(this.$.tabs,b.tabsConfig),this._registeredModules={}},bindEvents:function(){this.tabs.subscribe("open-tab",function(a,b){var c=this.getModule(b);c&&!c._rendered&&this.moduleRender(c,{overlayHolder:this.$.content})}.bind(this))},unbindEvents:function(){$.each(this._registeredModules,function(a,b){b.unbindEvents&&b.unbindEvents()}),this.tabs.unbindEvents(),this.tabs.unsubscribe("open-tab")},register:function(a){if(!(a instanceof mvideo.Class.AbstractStoreModule))throw new Error("Module should be inheritor of AbstractStoreModule.");var b=this.tabs.getActiveTabName(),c=a.getName();a._rendered=b===c,this._registeredModules[c]=a},getModule:function(a){return this._registeredModules[a]},moduleRender:function(a,b){var c=b||{},d=$.isFunction(c.beforeRenderThenFn)?c.beforeRenderThenFn:this.beforeRenderThenFn;c.overlayHolder&&this.overlay.show(c.overlayHolder,!0),this.getData().then(d.bind(this,a)).then(function(b,c){return a.render(b,c).done(function(){a._rendered=!0})}).always(function(){b.overlayHolder&&this.overlay.hide(c.overlayHolder)}.bind(this))},beforeRenderThenFn:function(a,b){return"list"!==a.getName()&&b.stores&&0===b.stores.length?(this.tabs.setActiveTab(),$.Deferred().reject().promise()):$.Deferred().resolve(b).promise()},getData:function(){throw new Error('"getData" method should be override in subclass')},resetRender:function(){$.each(this._registeredModules,function(a,b){b._rendered=!1})},overlayHide:function(){this.overlay.hide(this.$.content)}});a.include(mvideo.Mixin.overlay),a.define("AbstractStoreLocator")}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){if(!("name"in b))throw new Error('Subclass should have "name" in config');this.$={},this.$.holder=$(a),this.loadObjects(this.$.holder)},getName:function(){return this.config.name},render:function(a){throw new Error('"render" method should be override in subclass')}}).define("AbstractStoreModule")}(),function(){"use strict";mvideo.Class.AbstractStoreModule.extend({constructor:function(a,b){this.config={name:"list",eventNamespace:".store-list",selectors:{paginationHolder:".pagination-section",pagination:".pagination-section a",listHolder:".store-locator-list",resultHolder:".list-info"}},$.extend(!0,this.config,b||{}),this.constructor.__super__.constructor.call(this,a,this.config),this.initialize()},initialize:function(){this._deferred=(new $.Deferred).resolveWith(this),this.bindEvents()},bindEvents:function(){var a=this;this.$.holder.on("click"+this.config.eventNamespace,this.config.selectors.pagination,function(b){b.preventDefault();var c=$(this),d=c.attr("href");c.hasClass("disabled")||$.getJSON(d,function(b){a.render(b).then(function(){mvideo.instance.page.page.goToBlock(this.$.listHolder)})})})},unbindEvents:function(){this.$.holder.off(this.config.eventNamespace)},render:function(a){return this._deferred.done(function(){mvideo.instance.storeListTooltips&&mvideo.instance.storeListTooltips.items.tooltip("destroy"),this.$.listHolder.html(a.storeList||a.notification),this.$.resultHolder.html(a.pageResults),this.$.paginationHolder.html(a.pagination),mvideo.initScripts(this.$.listHolder)})}}).define("StoreList")}(),function(){"use strict";mvideo.Class.AbstractStoreModule.extend({constructor:function(a,b){this.config={name:"list",tpl:"jade/components/store/tpl-store-list",eventNamespace:".store-list",names:{},hasColumnPickup:!0,isListRowClickable:!0,chunkSize:500},$.extend(!0,this.config,b||{}),this.config.holder=a,this.constructor.__super__.constructor.call(this,a,this.config),this.initialize()},initialize:function(){this._deferred=(new $.Deferred).resolveWith(this),this.bindEvents(),this.chunks=[],this.nextChunk=0,this.timer},bindEvents:function(){},unbindEvents:function(){},render:function(a,b){return this._deferred.done(function(){this.timer&&clearTimeout(this.timer);var c=Math.ceil(a.stores.length/this.config.chunkSize);this.chunks=[],this.nextChunk=0;for(var d=0;d<c;d++)this.chunks[d]=a.stores.slice(d*this.config.chunkSize,d*this.config.chunkSize+this.config.chunkSize);this.renderItems(this.chunks[this.nextChunk++],b,!0)})},renderItems:function(a,b,c){var d=JST[this.config.tpl]({data:{stores:a,names:this.config.names,additionalData:b,columnSubway:this.controlColumnSubway(a),hasColumnPickup:this.config.hasColumnPickup,isListRowClickable:this.config.isListRowClickable,pickupTexts:this.config.pickupTexts,isFirstChunk:c}}),e=$(d),f=this;c?this.$.holder.html(d):this.$.holder.find(".c-store-list").append(d),mvideo.Class.ReinitContent.reinit(e),this.chunks[this.nextChunk]&&(this.timer=setTimeout(function(){f.renderItems(f.chunks[f.nextChunk++],b)},500))},controlColumnSubway:function(a){var b=!1;return a&&a.length>0&&a.forEach(function(a){a&&a.undergroundStationName&&(b=!0)}),b}}).define("StoreList2")}(),function(){"use strict";mvideo.Class.AbstractStoreModule.extend({constructor:function(a,b){this.config={name:"map",selectors:{}},$.extend(!0,this.config,b||{}),this.constructor.__super__.constructor.call(this,a,this.config),this.initialize()},initialize:function(){this.mapLazy=new mvideo.Class.MapLazy(this.$.holder.data("mapParams"))},render:function(a,b){return this.mapLazy.loadMap(this.$.holder).then(function(b){
b.initMarkers(a.stores,this.config.withCurrentStoreBalloon)}.bind(this))},fitToViewport:function(){return this.mapLazy.loadMap(this.$.holder).then(function(a){a.map.container.fitToViewport(),a.setCssZoomYandex(a.map.container._mapSize[1])}.bind(this))}}).define("StoreMap")}(),function(){"use strict";mvideo.Class.AbstractStoreModule.extend({constructor:function(a,b){this.config={name:"subway",mapUrl:null,storesTypesUrl:null,selectors:{},withCurrentStoreBalloon:!1},$.extend(!0,this.config,b||{}),this.constructor.__super__.constructor.call(this,a,this.config),this.initialize()},initialize:function(){this._subwayMapPromise=null,this._storesTypesPromise=null},render:function(a){return this.loadSubwayMap().done(function(b,c){return c&&$.extend(a,c[0]),this.subway.closePopup(),this.subway.setData(a,this.config.withCurrentStoreBalloon),this.subway.setStations(),this}.bind(this))},loadSubwayMap:function(){return this._subwayMapPromise||(this._subwayMapPromise=$.ajax({url:this.config.mapUrl,dataType:"html",cache:!1,success:function(a){this.$.holder.html(a);var b=this.$.holder.find(".subway-content"),c=this.$.holder.data("subwayConfig");this.subway=new mvideo.Class.Subway(".subway-content",b.data("subwayParams"),c)}.bind(this)}).promise()),!this._storesTypesPromise&&this.config.storesTypesUrl?this._storesTypesPromise=$.getJSON(this.config.storesTypesUrl).promise():this._storesTypesPromise=$.Deferred().resolve(),$.when(this._subwayMapPromise,this._storesTypesPromise)}}).define("StoreSubway")}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a){this.config=$.extend(!0,{type:{QUERY_VALIDATION:"",EXTERNAL_API:"",REDIRECT:this.redirect}},a)},controlErrors:function(a){var b={};return a&&a.length>0&&a.forEach(function(a){"function"==typeof this.config.type[a.type]&&(b[a.type]=this.config.type[a.type](a.message))},this),b},redirect:function(a){window.location=a}}).define("StoreErrors")}(),function(){"use strict";mvideo.Class.AbstractStoreLocator.extend({constructor:function(a,b){this.config={eventNamespace:".store-locator",selectors:{form:"#store-locator-form",tabs:".store-locator-links",content:".store-locator-content"}},$.extend(!0,this.config,b||{}),this.constructor.__super__.constructor.call(this,a,this.config),this.initialize()},initialize:function(){this._cache={},this.bindEvents()},bindEvents:function(){this.constructor.__super__.bindEvents.call(this);var a=this.$.holder,b=this.$.form,c=this;b.on("submit"+this.config.eventNamespace,this._submitHandler.bind(this)),a.find("[data-control-param]").each(function(){var d=$(this).data("controlParam");d.event&&d.selector&&a.on(d.event+c.config.eventNamespace,d.selector,function(){b.submit()})})},unbindEvents:function(){this.constructor.__super__.unbindEvents.call(this),this.$.holder.off(this.config.eventNamespace)},_submitHandler:function(a){var b=this.tabs.getActiveTabName(),c=this.getModule(b);return this.resetRender(),this.moduleRender(c,{overlayHolder:this.$.holder}),!1},getData:function(){var a=this.$.form,b={url:a.attr("action"),data:this._trimInputValue(a)&&a.serialize()},c=JSON.stringify(b);return this._cache[c]||(this._cache[c]=$.getJSON(b.url,b.data)),this._cache[c]},_trimInputValue:function(a){return a.find('input[type="text"]').each(function(){var a=$(this);a.val(a.val().trim())}),!0}}).define("StoreLocator")}(),function(){"use strict";mvideo.Class.AbstractStoreLocator.extend({constructor:function(a,b){this.config={eventNamespace:".store-locator",selectors:{form:"#store-locator-form",tabs:".store-locator-links",content:".store-locator-content",inputQuery:"#frm-search-store",inputSubway:"#frm-store-subway",takeToday:"#take-today",partnersPointsCheckbox:"#partners-points-delivery",blockFilter:".c-store-form__filter",blockTakeToday:".c-store-form__filter .c-checkbox",block_mMobile:".c-store-form__filter_m-mobile"},names:{listInRange:"Магазины рядом с",listOutOfRangeFirst:"Магазины дальше",listOutOfRangeSecond:"км от",mMobileContent:"",mMobileStoreTitle:""},storeErrors:mvideo.Class.StoreErrors},$.extend(!0,this.config,b||{}),this.constructor.__super__.constructor.call(this,a,this.config),this.initialize()},initialize:function(){this._cache={},this._immutableCache={},this._ctrRendered,this._cacheKey,this.storeErrors=new this.config.storeErrors({type:{EXTERNAL_API:this.error_EXTERNAL_API}}),this.bindEvents()},bindEvents:function(){this.tabs.subscribe("open-tab",function(a,b){this._testRedraw();var c=this.getModule(b);c&&!c._rendered&&this.moduleRender(c,{overlayHolder:this.$.content})}.bind(this));var a=this.$.holder,b=this.$.form,c=this;b.on("submit"+this.config.eventNamespace,this._submitHandler.bind(this)),a.find("[data-control-param]").each(function(){var d=$(this).data("controlParam");d.event&&d.selector&&a.on(d.event+c.config.eventNamespace,d.selector,function(){b.submit()})}),this.$.inputQuery.on("input",function(){c.$.inputSubway.val(""),c.$.inputQuery.val()||b.submit()}),this.$.inputQuery.on("keypress",function(a){13===a.keyCode&&$(this).blur()}),this.resizeMap()},unbindEvents:function(){this.constructor.__super__.unbindEvents.call(this),this.$.holder.off(this.config.eventNamespace)},_submitHandler:function(a){if(0!=this.$.inputQuery.val()&&this.$.inputQuery.val().length<this.$.inputQuery.attr("minlength"))return void a.preventDefault();var b=this.tabs.getActiveTabName(),c=this.getModule(b);return this.resetRender(),this.moduleRender(c,{overlayHolder:this.$.holder}),!1},getData:function(){var a=this.$.form,b=this;this._trimInputValue(a);var c={url:a.attr("action"),type:"POST",data:JSON.stringify(this.getFormData()),contentType:"application/json",dataType:"json"},d=JSON.stringify(c);return this._cacheKey=d,this._cache[d]||(this._cache[d]=$.ajax(c),this._cache[d].then(function(a){b.beforeGetData(a)})),this._testRedraw(),this._cache[d]},beforeGetData:function(a){if(a.stores&&0!==a.stores.length){var b=this;a.stores.forEach(function(a){a.isMobileStore&&(a.mMobile={title:b.config.names.mMobileStoreTitle,content:b.config.names.mMobileContent})})}},getDataWrapper:function(a,b){this._immutableCache[this._cacheKey]||(this._immutableCache[this._cacheKey]=$.extend(!0,{},a));var c=$.extend(!0,{},this._immutableCache[this._cacheKey]),d=0;this._testVisibleTakeToday(c.stores);var e={takeToday:this.$.takeToday.prop("checked"),PVZ:this.$.partnersPointsCheckbox.prop("checked"),subway:this.$.inputSubway.val()};if(c.stores=this.filterStores(c.stores,e),!this.$.inputSubway.val()&&this.$.inputQuery.val()&&c.stores.length>0&&!b.EXTERNAL_API){var f=[],g={in:[],out:[]};for(d in c.stores)c.stores[d].id&&(c.stores[d].inRange?g.in.push(c.stores[d]):g.out.push(c.stores[d]));g.in.length>0?g.in.forEach(function(a){a.viewport=!0}):g.out.length>0&&(g.out[0].viewport=!0),g.in.length>0&&g.in.splice(0,0,{msg:this.config.names.listInRange+" «"+c.searchPoint.address+"»"}),g.out.length>0&&g.out.splice(0,0,{msg:this.config.names.listOutOfRangeFirst+" "+c.searchPoint.range+" "+this.config.names.listOutOfRangeSecond+"  «"+c.searchPoint.address+"»"}),f=[].concat(g.in,g.out),f.push({latitude:a.searchPoint.latitude,longitude:a.searchPoint.longitude,markerType:"myLocation"}),c.stores=f}return c},filterStores:function(a,b){return a.filter(function(a){var c=b.takeToday&&!a.takeToday,d=!b.PVZ&&a.isPVZ;return!(b.subway&&a.undergroundStationId!=b.subway||c||d)})},beforeRenderThenFn:function(a,b){var c=this.storeErrors.controlErrors(b.errors);return console.log("beforeRenderThenFn"),b=this.getDataWrapper(b,c),"list"!==a.getName()&&b.stores&&0===b.stores.length?(this.tabs.setActiveTab(),$.Deferred().reject().promise()):$.Deferred().resolve(b,c).promise()},error_EXTERNAL_API:function(a){return{errorMsg:a}},getFormData:function(){return{query:this.$.inputSubway.val()?"":this.$.inputQuery.val()}},_testRedraw:function(){var a=this._getFormData(),b=this;this._ctrRendered!=a&&(this._ctrRendered=a,Object.keys(this._registeredModules).forEach(function(a){b._registeredModules[a]._rendered=!1}))},_getFormData:function(){var a={};return this.$.form.find("input").each(function(){var b=$(this);"tab"!=b.attr("name")&&(a[b.attr("name")]=b.val())}),JSON.stringify({data:JSON.stringify(a)})},_testVisibleTakeToday:function(a){var b=!1,c=!1,d=!1,e=!1,f=$(this.$.blockTakeToday[0]),g=$(this.$.blockTakeToday[1]),h=this.$.blockFilter.css("display");a&&a.length>0&&a.forEach(function(a){a&&(a.takeToday&&(b=!0),a.isPVZ&&(d=!0),a.isMobileStore&&(c=!0))}),(c||b||d)&&(e=!0),b?f.show():f.hide(),c?this.$.block_mMobile.show():this.$.block_mMobile.hide(),d?g.show():g.hide(),e&&"block"===h||!b&&!d&&"none"===h||(e?this.$.blockFilter.show():this.$.blockFilter.hide(),mvideo.Event.publish("resize.popup"))},_trimInputValue:function(a){return a.find('input[type="text"]').each(function(){var a=$(this);a.val(a.val().trim())}),!0},resizeMap:function(){var a=this;mvideo.Event.subscribe("resize-map",function(b){var c=a.tabs.getActiveTabName();if("map"==c){a.getModule(c).fitToViewport()}}),this.tabs.subscribe("open-tab",function(a,b){mvideo.Event.publish("resize-map")}.bind(this))}}).define("StoreLocatorCheckout")}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){this.config={eventNamespace:".store-tabs",selectors:{tabContent:".store-locator-container",list:"#store-locator-list",map:"#store-locator-map",subway:"#store-locator-subway"}},$.extend(!0,this.config,b||{}),mvideo.observer(this),this.$={},this.$.holder=$(a),this.loadObjects(),this.initialize()},initialize:function(){this.bindEvents()},bindEvents:function(){this.$.holder.on("change"+this.config.eventNamespace,'input[type="radio"]',function(a){var b=a.currentTarget.value;this.$.tabContent.removeClass("active"),this.$[b].addClass("active"),this.publish("open-tab",b)}.bind(this))},unbindEvents:function(){this.$.holder.off(".store-tabs")},getActiveTabName:function(){return this.$.holder.find('input[type="radio"]:checked').val()},setActiveTab:function(a){var b='input[type="radio"]'+(a?"[value="+a+"]":":first");this.$.holder.find(b).prop("checked",!0).change()}}).define("StoreTabs")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config=$.extend(!0,{tpl:null,holder:"body"},a||{}),this.$={},this.$.holder=$(this.config.holder),this._state={},mvideo.observer(this),b&&this.setData(b)},getData:function(){return $.extend(!0,{},this._state)},setData:function(a,b){return this._setNewState({},a||{},!!b)},applyData:function(a,b){return this._setNewState(this._state,a||{},!!b)},_setNewState:function(a,b,c){return this._state=$.extend(!0,a,b),mvideo.Event.publish("store.change",this),this.publish("change",this),c?this:this.render()},_getTpl:function(){var a=this.config.tpl;if(!(a instanceof mvideo.Class.AbstractTplLoader))throw new Error("Template must be inheritor of AbstractTplLoader.");return a.isLoaded()?$.Deferred().resolve(a):a.load()},render:function(){return this._getTpl().then(function(a){return this.$.holder.html(a.render(this._state)),mvideo.Class.ReinitContent.reinit(this.$.holder),a}.bind(this))}});a.define("StoreWithTpl",a)}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b,c){this.config={selectors:{svg:".subway-holder",layerHolder:".subway-layers",stations:".shop-station",stationsNames:"text"},dataMore:"more",dataItr:"itr",dataWeight:"weight",activeSubwayClass:"active-subway",showBesideLabel:"Посмотреть магазины рядом",storesType:{},storesTypeWeight:["mvideoStore","m_mobile","h24Store","myStore"],markerTpl:"mapProductTemplate",btnLabel:"Забрать здесь",prepaymentText:"После предоплаты",centeringMystore:!0,defaultCenterMap:!1},$.extend(!0,this.config,b||{}),c&&$.extend(!0,this.config,c),this.config.oldTooltip="mapProductTemplate"===this.config.markerTpl,this.config.markerTpl=mvideo.template[this.config.markerTpl],this.$={},this.$.holder=$(a),this.loadObjects(this.$.holder),this.initialize()},initialize:function(){this._isRemoveLayer=!1,this._isChangeLayer=!0,this._isScaleChange=!1,this._isNeedParseSvg=void 0===$("svg").html(),this.svgScaleAndMove=new mvideo.Class.svgScaleAndMove(this.$.holder,{transformer:".subway-map",svgSelector:this.config.selectors.svg,controllerHolder:".subway-controllers",controller:".c-btn",scale:this.config.scale,translate:this.config.translate}),this.layoutPlacement={top:0,left:0,marginLeft:"1rem",bottom:"auto",device:mvideo.device.manager.getType()},this.stores=[],this.bindEvents(),this.selectedStore={itr:-1,$holder:null},this.selfSelectedStore={itr:-1,$holder:null}},bindEvents:function(){var a=this;this.$.holder.on("mousedown",this.config.selectors.svg,function(){"desktop"===a.layoutPlacement.device?a._isRemoveLayer=!1:a._isRemoveLayer=!0}).on("mouseup",this.config.selectors.svg,function(){a._isRemoveLayer&&(a.$.layerHolder.empty(),a.setDefaultMarker(),a.selectedStore={itr:-1,$holder:null}),a._isRemoveLayer=!1}).on("mouseup",this.config.selectors.stations,function(b,c){var d=+$(this).data(a.config.dataItr),e=c?$(c[0]):$(b.target).closest(a.config.selectors.stations),f=e[0].getBoundingClientRect(),g=e.offset().left+f.width/2,h=e.offset().top;a.$.layerHolder.empty(),a.stores[d]&&(a.setDefaultMarker(!0),a.selectedStore={itr:d,$holder:$(this)},a.selfSelectedStore={itr:d,$holder:$(this)},a.loadAndSetStation(a.stores[d],{x:g-a.$.holder.offset().left,y:h-a.$.holder.offset().top}),a.selectedStore={itr:d,$holder:$(this)},a.setDefaultMarker(),a.insertSVG($(this),a.config.storesType[a.stores[d].markerType+"_selected"]))}).on("click",".c-btn_close",function(){a.$.layerHolder.empty(),a.setDefaultMarker(!0),a.selfSelectedStore={itr:-1,$holder:null},a.selectedStore={itr:-1,$holder:null}}).on("mouseup","."+this.config.activeSubwayClass,function(){var b=$(this).attr("id").replace("sub-",""),c=a.$.stations.filter('[data-id = "'+b+'"]');c.trigger("mouseup",[c])}).on("closeStoreInfo",function(){a.selectedStore={itr:-1,$holder:null},a.setDefaultMarker(!0)}),this.svgScaleAndMove.subscribe("changeTransform",function(b,c){a._isRemoveLayer=!1,a._isChangeLayer&&a.$.layer&&"move"===c.name&&(a.layoutPlacement.top+=c.attr.dy,a.layoutPlacement.left+=c.attr.dx,a.setLayoutPlacement()),a.selectedStore.$holder&&"scale"===c.name&&(a._isScaleChange=!0,a.selectedStore.$holder.trigger("mouseup",[a.selectedStore.$holder]),a._isScaleChange=!1)}),mvideo.Event.subscribe("device",function(b,c){a.layoutPlacement.device=c,a.setLayoutPlacement()}),mvideo.Event.subscribe("resize",function(){a.svgScaleAndMove.updateTransform(),a.selectedStore.$holder&&a.selectedStore.$holder.trigger("mouseup",[a.selectedStore.$holder])})},setLayoutPlacement:function(){this.$.layer&&("mobile"===this.layoutPlacement.device?this.$.layer.css({left:"50%",top:"auto","margin-left":-this.$.layer.outerWidth()/2,bottom:0}):this.$.layer.css({left:this.layoutPlacement.left,top:this.layoutPlacement.top,"margin-left":this.layoutPlacement.marginLeft,bottom:this.layoutPlacement.bottom}))},loadAndSetStation:function(a,b){return b=b||{},b.x=+b.x||0,b.y=+b.y||0,this.loadStation(a).then(this.setStation.bind(this,b))},loadStation:function(a){return a._cache?$.Deferred().resolve(a._cache):"string"==typeof a.storeDetails?$.ajax({url:a.storeDetails.replace(/&amp;/g,"&"),dataType:"json",cache:!0}).done(function(b){return a._cache=b,a._cache.showBeside=a._cache.showBeside||a.showBeside,b}):$.Deferred().resolve(a)},setStation:function(a,b){var c,d,e,f,g,h=0,i=0;$.extend(!0,b,this.config.markersConfig||{}),this.$.layer=$(this.config.markerTpl({data:b})),this.$.layerHolder.append(this.$.layer),mvideo.Class.ReinitContent.reinit(this.$.layer),c=this.$.layer.outerWidth(!0),d=this.$.layer.outerHeight(!0),this.config.oldTooltip||(c/=2),this._isScaleChange||(a.x<c&&(h=c-a.x),"mobile"===mvideo.device.manager.getType()?(f=this.selectedStore.$holder[0].getBoundingClientRect(),g=this.$.holder[0].getBoundingClientRect(),i=g.bottom-(f.bottom+d)-5,a.x>c&&(h=-(a.x-c))):a.y<d&&(i=d-a.y),!this.config.oldTooltip&&a.x+c>this.$.holder.width()&&(h+=this.$.holder.width()-(a.x+c))),e=parseInt(this.$.layer.css("margin-right"),10),e<0&&a.x>this.$.holder.width()+e&&(h+=e),e=parseInt(this.$.layer.css("margin-bottom"),10),e<0&&a.y>this.$.holder.height()+e&&(i+=e),this._isChangeLayer=!1,this.svgScaleAndMove.changeTranslate(h,i),this._isChangeLayer=!0,"mobile"===mvideo.device.manager.getType()?this.layoutPlacement.top=a.y+i:(f=this.selectedStore.$holder?this.selectedStore.$holder[0].getBoundingClientRect():this.selfSelectedStore.$holder[0].getBoundingClientRect(),this.layoutPlacement.top=a.y+i-d+f.height),this.layoutPlacement.left=a.x+h-c,this.setLayoutPlacement()},setData:function(a,b){a=a||{},this.config.storesType=a.svgOfStationsType||this.config.storesType,this.config.storesTypeWeight=a.storesTypeWeight||this.config.storesTypeWeight,this.config.markerTpl=mvideo.template[a.markerTpl]||this.config.markerTpl,this.stores=a.stores||this.stores,this.withCurrentStoreBalloon=b,this.updateStationData()},updateStationData:function(){var a,b,c,d={};for(this.$.layerHolder.empty(),b=0,c=this.stores.length;b<c;b++)this.stores[b]&&this.stores[b].undergroundStationId&&(a=this.stores[b].undergroundStationId,d[a]||(d[a]=[]),d[a].push(this.stores[b]));for(a in d)if(d.hasOwnProperty(a)&&d[a].length>1)for(b=0,c=d[a].length;b<c;b++)d[a][b].showBeside=d[a][b].besideBtnText||this.config.showBesideLabel},setStations:function(){var a,b,c,d,e,f,g,h,i=!1;this.clearStations();for(var j in this.stores)"myLocation"===this.stores[j].markerType&&(i=!0),this.stores[j]&&this.stores[j].undergroundStationId&&this.config.storesType[this.stores[j].markerType]&&(a=this.$.stations.filter('[data-id="'+this.stores[j].undergroundStationId+'"]'),this.stores[j].btnLabel=this.config.btnLabel,this.stores[j].prepaymentText=this.config.prepaymentText,c=!0,b=this.config.storesTypeWeight.indexOf(this.stores[j].markerType),a.length&&!a.is(":empty")&&(a.attr(this.config.dataMore,!0),d=+a.data(this.config.dataItr),c=+a.data(this.config.dataWeight)<b,this.stores[j].showBeside=this.config.showBesideLabel,this.stores[d]&&!this.stores[d].showBeside&&(this.stores[d].showBeside=this.config.showBesideLabel)),c&&(a.data(this.config.dataItr,j).data(this.config.dataWeight,b),this.insertSVG(a,this.config.storesType[this.stores[j].markerType])),this.withCurrentStoreBalloon&&this.config.centeringMystore&&"myStore"===this.stores[j].markerType&&(f=a),this.withCurrentStoreBalloon&&this.stores[j].isConvenientStore&&(h=this.stores[j].undergroundStationId,f=a),g||(g=a)),this.stores[j].undergroundStationId&&(e="sub-"+this.stores[j].undergroundStationId,this.$.stationsNames.filter("#"+e).addClass(this.config.activeSubwayClass));(i||$("#frm-search-store").val())&&(f=g),f?this.setStationInCenter(f):this.config.defaultCenterMap?$("#take-today").prop("checked")?this.setStationsCentral():this.setCentralMap():this.setStationsCentral(),!i&&this.withCurrentStoreBalloon&&h&&this.openPlacement(h)},closePopup:function(){if($("#frm-store-subway").val()){var a=this;setTimeout(function(){a.openPlacement($("#frm-store-subway").val())})}this.$.layerHolder.find(".c-tooltip_map").empty().trigger("closeStoreInfo")},openPlacement:function(a){var b=this.$.stations.filter('[data-id = "'+a+'"]');setTimeout(function(){b.trigger("mouseup",[b])})},clearStations:function(){this.$.stations.data(this.config.dataMore,null).data(this.config.dataItr,null).data(this.config.dataWeight,null).empty(),this.$.stationsNames.removeClass(this.config.activeSubwayClass)},insertSVG:function(a,b){var c,d;if(this._isNeedParseSvg){for(c=document.createElementNS("http://www.w3.org/1999/xhtml","div"),c.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+b+"</svg>",d=document.createDocumentFragment();c.firstChild.firstChild;)d.appendChild(c.firstChild.firstChild);a.append(d)}else a.html(b);return a},setStationInCenter:function(a){var b,c,d=/translate\((\d*?(\.\d+)?)\s(-?\d*?(\.\d+)?)\)/,e=a.attr("transform"),f=this.svgScaleAndMove.settings.scale.value,g=d.exec(e);g&&(b=(this.$.holder.width()/2-g[1])*f,c=(this.$.holder.height()/2-g[3])*f,this.svgScaleAndMove.changeTranslate(b,c,!0))},setStationsCentral:function(){var a,b,c,d,e=this.$.holder[0].getBoundingClientRect(),f=this.$.stations.parent()[0];this.svgScaleAndMove.setScale(1),this.svgScaleAndMove.changeTranslate(0,0,!0),a=f.getBoundingClientRect(),a.width&&a.height&&(b=Math.min(e.width/a.width,e.height/a.height),this.svgScaleAndMove.setScale(b||0),a=f.getBoundingClientRect(),c=(e.width-a.width)/2-(a.left-e.left),d=(e.height-a.height)/2-(a.top-e.top),this.svgScaleAndMove.changeTranslate(c||0,d||0))},setCentralMap:function(){var a,b,c,d,e,f,g=this.$.holder[0].getBoundingClientRect(),h={};this.svgScaleAndMove.setScale(this.config.scale.value),h=this.svgScaleAndMove.$.transformer[0].getBoundingClientRect(),c=h.width/2,d=h.height/2,e=g.width/2,f=g.height/2,a=0-c+e*this.config.scale.value,b=0-d+f*this.config.scale.value,this.svgScaleAndMove.changeTranslate(a||0,b||0,!0)},setDefaultMarker:function(a){var b=a?this.selfSelectedStore.itr:this.selectedStore.itr,c=a?this.selfSelectedStore.$holder:this.selectedStore.$holder;this.stores[b]&&this.insertSVG($(c),this.config.storesType[this.stores[b].markerType])}}).define("Subway")}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={activeItem:null,useHistoryNavigation:!1},this.$={},this.$.holder=a instanceof jQuery?a:$(a),$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){mvideo.observer(this),this.page=mvideo.instance.page.page,this.tabsBody=new mvideo.Class.ItemsContainerAccordion(this.$.holder),this.tabsHeadings=new mvideo.Class.TabsHeadings(this.$.holder,this),this.tabset=new mvideo.Class.Tabset(this.$.holder,this,{autoInit:!0,method:"before",tplData:this.getTabsData()}),this.navigation=this.config.useHistoryNavigation?new mvideo.Class.TabsHistoryNavigation(this,this.config):new mvideo.Class.TabsHashNavigation(this,this.config)},getTabsData:function(){var a=this.tabsHeadings.$.items,b=[];return a.each(function(){var a=$(this).find("a");b.push({id:a.data("target")||a.attr("href").replace("#",""),href:a.attr("href"),text:a.html(),gtmId:a.data("holder"),className:a.attr("class")})}),b},initAccordionView:function(){return this.applyView("ItemsContainerAccordion")},initTabsetView:function(){return this.applyView("ItemsContainerTabs")},applyView:function(a){return this.tabsBody=new mvideo.Class[a](this.$.holder),this},getItemById:function(a){return this.tabsBody.$.items.filter('[data-id="'+a+'"]')},unsetActiveItem:function(a){return this.tabsBody.unsetActiveItem(a),this.publish("unsetActiveItem",a.data("id")),this},unsetActiveItemById:function(a){var b=this.getItemById(a);return this.unsetActiveItem(b)},unsetActiveAll:function(){return this.tabsBody.unsetActiveAll(),this.publish("unsetActiveAll"),this},setActiveItem:function(a,b,c){var d;return(this._isItemEmpty(a)||b)&&(d=this.getItemContent(a)),this.tabsBody.setActiveItem(a),this.config.activeItem=a,this.publish("setActiveItem",a.data("id")),d&&this.goToActiveItem(a),"function"==typeof c&&(d?d.done(function(){c(a)}):c(a)),this},setActiveItemById:function(a,b,c){var d=this.getItemById(a);return this.setActiveItem(d,b,c)},goToActiveItem:function(a){return this.page.goToBlock(a instanceof jQuery?a:$(a)),this},_isItemEmpty:function(a){return 0===a.find(".tab-inner").children().length},getItemContent:function(a){var b=a.data("content-url"),c=a.find(".tab-inner"),d=$.Deferred();return c.html('<div class="tab-placeholder">'),$.ajax({url:b,dataType:"html",cache:!1,success:function(a){c.slideUp().promise().done(function(){c.html(a).slideDown(),mvideo.Class.ReinitContent.reinit(c),d.resolve()})}}),d},activeItemHandler:function(a){var b=this;a.activeItemId?this.setActiveItemById(a.activeItemId,a.refresh,function(c){a.subTargetTab&&$('a[href="'+a.subTargetTab+'"]').tab("show"),a.subTargetId?b.goToActiveItem("#"+a.subTargetId):a.subTargetBlock?b.goToActiveItem(a.subTargetBlock):a.withoutScrollToActive||b.goToActiveItem(c)}):a.unActiveItemId?this.unsetActiveItemById(a.unActiveItemId):a.unsetActiveAll&&"mobile"==mvideo.device.manager.getType()&&this.unsetActiveAll()}});a.define("Tabs",a)}(),function(){"use strict";var a=mvideo.Class.DynamicElement.extend({constructor:function(a,b,c){this.config={autoInit:!1,method:"before",tpl:mvideo.template.tabsetTpl,tplData:[],activeClass:"active",items:"li"},$.extend(!0,this.config,c||{}),this.$={},this.$.holder=a instanceof jQuery?a:$(a),this.tabs=b,this.$.items="string"==typeof this.config.items?this.$.holder.find(this.config.items):this.config.items,this.config.autoInit&&this.initialize()},initialize:function(){mvideo.observer(this),this.insert(),this.$.items=this.$.el.find(this.config.items);var a=this.tabs.tabsBody.getActiveItem().data("id");this.setActiveById(a),this.bindEvents()},bindEvents:function(){var a=this;this.tabs.subscribe("setActiveItem",function(b,c){a.setActiveById(c)}),a.tabs.config.useHistoryNavigation&&!Modernizr.history||this.$.items.on("click",function(b){a.handler(b,$(this))})},handler:function(a,b){a.preventDefault();var c={activeItemId:this.getItemTarget(b),url:b.find("a").attr("href")};this.setActiveItem(b),this.tabs.publish("switchTab",c)}});a.include(mvideo.Mixin.itemsContainer,mvideo.Mixin.tab),a.define("Tabset",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={},this.tabs=a,$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){this.showContent(),this.bindEvents()},_isValidHash:function(){return!!$.grep(this.tabs.getTabsData(),function(a){return a.href===window.location.hash}).length},_getDataFromUrl:function(){var a=window.location.hash.substring(1),b=mvideo.helpers.getUrlParam();return{activeItemId:this._isValidHash()?a:null,subTargetTab:b.subTargetTab||null,subTargetId:b.subTargetId||null}},showContent:function(){var a=this._getDataFromUrl();this.tabs.activeItemHandler(a)},bindEvents:function(){var a=this;$(window).on("hashchange",function(){var b=window.location.hash.substring(1),c={};"collapse"===b?c.unActiveItemId=a.tabs.tabsBody.getActiveItem().data("id"):c.activeItemId=a._isValidHash()?b:null,a.tabs.activeItemHandler(c)}),a.tabs.subscribe("switchTab",function(a,b){window.location.hash=b.activeItemId||"collapse"})}});a.define("TabsHashNavigation",a)}(),function(){"use strict";var a=mvideo.Class.ItemsContainer.extend({constructor:function(a,b,c){this.config={activeClass:"active",items:".tab-heading"},$.extend(!0,this.config,c||{}),this.tabs=b,this.$={},this.$.holder=$(a),this.$.items="string"==typeof this.config.items?this.$.holder.find(this.config.items):this.config.items,this.bindEvents()},bindEvents:function(){var a=this;this.tabs.subscribe("setActiveItem",function(b,c){a.setActiveById(c)}),this.tabs.subscribe("unsetActiveItem",function(b,c){a.unsetActiveById(c)}),this.tabs.subscribe("unsetActiveAll",function(){a.unsetActiveAll()}),a.tabs.config.useHistoryNavigation&&!Modernizr.history||this.$.items.on("click",function(b){a.handler(b,$(this))})},handler:function(a,b){a.preventDefault();var c=this.getItemTarget(b),d={};this.isActiveItem(b)?(this.unsetActiveAll(),d.unsetActiveAll=!0):(this.setActiveItem(b),d.url=b.find("a").attr("href"),d.activeItemId=c),this.tabs.publish("switchTab",d)}});a.include(mvideo.Mixin.tab),a.define("TabsHeadings",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={},this.tabs=a,$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){this.titles=this._fillTitles(this.tabs.tabsBody.$.items),this.showContent(),Modernizr.history&&this.bindEvents()},_fillTitles:function(){var a={};return this.tabs.tabsBody.$.items.each(function(){var b=$(this);a[b.data("id")]=b.data("pageTitle")}),a},_getDataFromUrl:function(){var a=new RegExp(this.config.baseUrl+"/([^/]+)"),b=a.exec(window.location.pathname),c=mvideo.helpers.getUrlParam();return{activeItemId:b?b[1]:null,subTargetTab:c.subTargetTab||null,subTargetId:c.subTargetId||null}},showContent:function(){var a=this._getDataFromUrl();this.tabs.activeItemHandler(a)},bindEvents:function(){var a=this;a.tabs.subscribe("switchTab",function(b,c){var d=a.titles[c.activeItemId]||document.title,e=c.url||a.config.baseUrl;c.__stateId=Date.now(),c.replaceHistory?History.replaceState(c,d,e):History.pushState(c,d,e)}),History.Adapter.bind(window,"statechange",function(){a.tabs.activeItemHandler(History.getState().data)})}});a.define("TabsHistoryNavigation",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={activeItem:null,useHistoryNavigation:!1,offsetTop:{desktop:0,tablet:0,mobile:0},scrollBlock:!0},this.$={},this.$.holder=a instanceof jQuery?a:$(a),$.extend(!0,this.config,b||{}),this.initialize()},initialize:function(){mvideo.observer(this),this.page=mvideo.instance.page.page,this.tabsBody=new mvideo.Class.ItemsContainerAccordion(this.$.holder),this.tabsMenu=new mvideo.Class.TabsNavMenu(this.$.holder,this),this.config.useHistoryNavigation?this.navigation=new mvideo.Class.TabsHistoryNavigationNewSG(this,this.config):this.bindSwitchTab(),this.config.useButtons&&(this.tabsButtons=new mvideo.Class.TabsButtons(this.$.holder,this.config.buttonsConfig))},getItemById:function(a){return this.tabsBody.$.items.filter('[data-id="'+a+'"]')},unsetActiveItemById:function(a){var b=this.getItemById(a);return this.unsetActiveItem(b)},setActiveItem:function(a,b,c){var d,e=this;if(0!==a.length)return this.$.holder.trigger("tabs.getItemContent.before",a),this._isItemEmpty(a)||b?(d=this.getItemContent(a),d.done(function(){e.$.holder.trigger("tabs.getItemContent.after",a)})):this.$.holder.trigger("tabs.getItemContent.after",a),this.tabsBody.setActiveItem(a),this.config.activeItem=a,this.publish("setActiveItem",a.data("id")),d&&this.goToActiveItem(a),"function"==typeof c&&(d?d.done(function(){c(a)}):c(a)),this},setActiveItemById:function(a,b,c){var d=this.getItemById(a);return this.setActiveItem(d,b,c)},goToActiveItem:function(a){var b=this;if(this.config.scrollBlock)return setTimeout(function(){var c=mvideo.device.manager.getType(),d=-parseInt(b.tabsMenu.$.items.height(),10)-b.config.offsetTop[c];b.page.goToBlock(a instanceof jQuery?a:$(a),d)}),this},_isItemEmpty:function(a){return 0===a.find(".c-tabs__body-inner").children().length},getItemContent:function(a){var b=a.data("content-url"),c=a.find(".c-tabs__body-inner"),d=$.Deferred();return c.html('<div class="tab-placeholder">'),$.ajax({url:b,dataType:"html",cache:!1,success:function(a){c.slideUp().promise().done(function(){c.html(a).slideDown(),mvideo.Class.ReinitContent.reinit(c),d.resolve()})}}),d},activeItemHandler:function(a){var b=this;a.activeItemId&&this.setActiveItemById(a.activeItemId,a.refresh,function(c){a.subTargetTab&&$('a[href="'+a.subTargetTab+'"]').tab("show"),a.subTargetId?b.goToActiveItem("#"+a.subTargetId):a.subTargetBlock?b.goToActiveItem(a.subTargetBlock):a.withoutScrollToActive||b.goToActiveItem(c)})},bindSwitchTab:function(){this.subscribe("switchTab",function(a,b){this.activeItemHandler(b)}.bind(this))}});a.define("TabsNewSG",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={selectors:{btnNext:".js-btn-right",btnPrev:".js-btn-left",wrap:".c-tabs__menu-wrap",list:".c-tabs__menu-list",btn:".c-btn__direction",items:".c-tabs__menu-link"},step:0,hiddenClass:"c-tabs__btn_hidden"},this.$={},this.$.holder=a instanceof jQuery?a:$(a),$.extend(!0,this.config,b||{}),this.loadObjects(this.$.holder),this.initialize()},initialize:function(){this.step=this.config.step,this.DIRECTION_PREV="prev",this.DIRECTION_NEXT="next",this.btnWidth=0,this.childrenOffsets=[],this.hideVisibleArea=!0,this.active=!0,this.$.btnNext.length||this.addButtons(),this.bindEvents()},bindEvents:function(){var a=this;this.$.holder.on("click",this.config.selectors.btn,function(b){b.preventDefault();var c,d=$(this),e=parseInt(a.$.list.css("left"),10),f=d.data("direction");c=a.getNextPos(e,f),a.$.list.css({"transition-property":"left","transition-duration":"0.3s",
"transition-timing-function":"cubic-bezier(0, 0, 0.12, 0.89)"}),a.$.list.css("left",c),a.managerBtn(c,f)}),$(window).on("load",function(){navigator.userAgent.indexOf("Safari")>-1&&-1==navigator.userAgent.indexOf("Chrome")&&a.setActive()}),window.mvideo.helpers.checkOrientationChange.init(),window.mvideo.Event.subscribe("orientationchange-end",function(){a.setActive()})},getTabSizes:function(){this.wrapWidth=this.$.wrap.width(),this.listWidth=this.$.list.width(),this.btnWidth=this.$.btnPrev.width(),this.itemLeftMargin=parseInt(this.$.items.eq(2).children().css("margin-left"),10),this.marginLR=parseInt(this.$.wrap.css("margin-left"),10),this.maxLeft=this.wrapWidth-this.listWidth,this.step||(this.childrenOffsets=[],this.getChildrenOffsets())},handleSwipe:function(){var a=this;this.$.list.off("swiped").on("swiped",function(){a.changePosHandler()})},changePosHandler:function(a){if(this.active){var b=a||parseInt(this.$.list.css("left"),10);this.managerBtn(b)}},managerBtn:function(a,b){var c=b===this.DIRECTION_PREV?a<0:a<0-this.marginLR,d=b===this.DIRECTION_NEXT?a>this.maxLeft:a>this.maxLeft+this.marginLR;c?this.$.btnPrev.removeClass(this.config.hiddenClass):(this.$.list.css("left",0),this.$.btnPrev.addClass(this.config.hiddenClass)),d?this.$.btnNext.removeClass(this.config.hiddenClass):(this.$.btnNext.addClass(this.config.hiddenClass),this.$.list.css("left",this.maxLeft))},setActive:function(){var a,b=this;this.getTabSizes(),a=this.$.list.find(".c-tabs__menu-item.active")[0].offsetLeft,this.$.list.css("left",-a),this.active=!0,this.wrapWidth<this.listWidth?setTimeout(function(){b.handleSwipe(),b.managerBtn(-a)}):this.setInactive()},setInactive:function(){this.$.list.css("left",0),this.$.btnPrev.addClass(this.config.hiddenClass),this.$.btnNext.addClass(this.config.hiddenClass),this.$.list.off("swiped"),this.active=!1},getChildrenOffsets:function(){var a=this;this.$.items.each(function(){var b=$(this).width(),c=this.offsetLeft;a.childrenOffsets.push({offset:c+a.marginLR,endOffset:c+b-a.marginLR})}),this.childrenOffsets[this.childrenOffsets.length-1].endOffset=this.listWidth},getNextPos:function(a,b){var c=this.maxLeft,d=this.childrenOffsets.length-1,e=a-this.wrapWidth,f=0;if(this.step)c=b===this.DIRECTION_PREV?a-this.step:a+this.step;else if(b===this.DIRECTION_NEXT)for(;a>=c;)c=-this.childrenOffsets[d].offset+this.getVisibleAreaLeftOffset(this.itemLeftMargin),d--;else{for(d=0;e<=f;)f=-this.childrenOffsets[d].endOffset,d++;c=a+f-e-this.getVisibleAreaRightOffset(this.itemLeftMargin)}return c},getVisibleAreaLeftOffset:function(a){return this.hideVisibleArea&&!this.$.btnPrev.hasClass(this.config.hiddenClass)?this.btnWidth-a:0},getVisibleAreaRightOffset:function(a){return this.hideVisibleArea&&!this.$.btnNext.hasClass(this.config.hiddenClass)?this.btnWidth-a:0},addButtons:function(){var a="c-btn c-btn__direction c-btn_white c-btn_circle c-btn_border-transparent c-btn_icon u-box-shadow-droop";this.hideVisibleArea=!1,this.$.btnPrev=$('<a data-direction="next" class="js-btn-left i-icon-chevron-left '+a+'"  data-sel="typ-link-prev" href="#"></a>').addClass(this.config.hiddenClass),this.$.btnNext=$('<a data-direction="prev" class="js-btn-right i-icon-chevron-right '+a+'" data-sel="typ-link-next" href="#"></a>').addClass(this.config.hiddenClass),this.$.holder.append(this.$.btnPrev).append(this.$.btnNext)}});a.define("TabsButtons",a)}(),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={},this.tabs=a,$.extend(!0,this.config,b||{}),this.config.useHistoryNavigation&&this.initialize()},initialize:function(){this.titles=this._fillTitles(this.tabs.tabsBody.$.items),this.showContent(),Modernizr.history&&this.bindEvents()},_fillTitles:function(){var a={};return this.tabs.tabsBody.$.items.each(function(){var b=$(this);a[b.data("id")]=b.data("pageTitle")}),a},_getDataFromUrl:function(){var a=new RegExp(this.config.baseUrl+"/([^/]+)"),b=a.exec(window.location.pathname),c=mvideo.helpers.getUrlParam();return{activeItemId:b?b[1]:null,subTargetTab:c.subTargetTab||null,subTargetId:c.subTargetId||null}},showContent:function(){var a=this._getDataFromUrl();this.tabs.activeItemHandler(a)},bindEvents:function(){var a=this;a.tabs.subscribe("switchTab",function(b,c){var d=a.titles[c.activeItemId]||document.title,e=c.url||a.config.baseUrl;c.__stateId=Date.now(),c.__stateId=Date.now(),c.replaceHistory?History.replaceState(c,d,e):History.pushState(c,d,e)}),History.Adapter.bind(window,"statechange",function(){a.tabs.activeItemHandler(History.getState().data)})}});a.define("TabsHistoryNavigationNewSG",a)}(),function(){"use strict";var a=mvideo.Class.ItemsContainer.extend({constructor:function(a,b,c){this.config={activeClass:"active",menu:".c-tabs__menu-list",items:".c-tabs__menu-item"},$.extend(!0,this.config,c||{}),this.tabs=b,this.$={},this.$.holder=$(a),this.$.menu=this.$.holder.find(this.config.menu),this.$.items="string"==typeof this.config.items?this.$.holder.find(this.config.items):this.config.items,this.bindEvents()},bindEvents:function(){var a=this;this.tabs.subscribe("setActiveItem",function(b,c){a.setActiveById(c)}),this.tabs.subscribe("unsetActiveItem",function(b,c){a.unsetActiveById(c)}),a.tabs.config.useHistoryNavigation&&!Modernizr.history||this.$.items.on("click",function(b){a.handler(b,$(this))})},handler:function(a,b){a.preventDefault();var c={activeItemId:this.getItemTarget(b),url:b.find("a").attr("href")};this.isActiveItem(b)||(this.setActiveItem(b),this.tabs.publish("switchTab",c))},getActiveTabItem:function(){return this.$.items.filter("."+this.config.activeClass)}});a.include(mvideo.Mixin.tab),a.define("TabsNavMenu",a)}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){if(this.tplPath="jade/blocks/",this._currentPage=0,this.config={tpl:"comparisonNewSG/comparison-pager.tpl",quantity:0,maxdots:5,currentNumber:1,selectors:{dots:".c-compare-pager__items",text:".c-compare-pager__text > span:first-child()"}},this.$={},this.$.holder=$(a),!this.$.holder.length)return console.warn("mvideo.Class.TemplatePager: incorrect holder provided"),null;$.extend(!0,this.config,b||{}),this.config.maxdots=Math.min(this.config.maxdots,this.config.quantity),this.render(),this.loadObjects(this.$.holder),this.setPage(0)},render:function(){this.$.holder.html(JST&&JST[this.tplPath+this.config.tpl](this.config))},update:function(a){$.extend(!0,this.config,a||{}),this.config.maxdots=Math.min(this.config.maxdots,this.config.quantity),this.render(),this.loadObjects(this.$.holder),this.setPage(this.config.currentNumber)},setPage:function(a){this.$.text.text(a+1),this.$.dots.children().removeClass("active").eq(this.config.maxdots<this.config.quantity?Math.round(a/(this.config.quantity-1)*(this.config.maxdots-1)):a).addClass("active"),this._currentPage=a},getPage:function(){return this._currentPage}}).define("TemplatePager")}(),function(a){"use strict";var b=a.Class.Class.extend({constructor:function(a){this.config={seconds:30,template:"#m#:#s#",selectors:{timer:".b-countdown-timer_msg span"},holder:""},$.extend(!0,this.config,a||{}),this.$={},this.loadObjects(this.config.holder),this.initialize()},initialize:function(){this.time=this.config.seconds,this.regex=/#h#|#m#|#s#/g,this.getTimeParts(),this.parser=a.helpers.timeParser},getTimeParts:function(){var a=this.config.template.match(this.regex);this.timeParts={hours:a.indexOf("#h#")>-1,minutes:a.indexOf("#m#")>-1,seconds:a.indexOf("#s#")>-1}},start:function(a){this.tickTimer(a),this.intervalId=setInterval(this.tickTimer.bind(this,a),1e3)},renderTime:function(){var a=this.parser.parseTime(this.time,this.timeParts);this.$.timer.text(this.config.template.replace(this.regex,function(b){return"#h#"===b?a.hours:"#m#"===b?a.minutes:a.seconds}))},tickTimer:function(a){this.time>=0?(this.renderTime(),this.time--):(this.reset(),"function"==typeof a&&a())},reset:function(a){clearInterval(this.intervalId),this.time=a||this.config.seconds,this.renderTime()}});b.define("Timer",b)}(window.mvideo),function(){"use strict";var a=mvideo.Class.Class.extend({constructor:function(a,b){this.config={selectors:{actionBtn:".wishlist-comment-btn",textBlock:".wishlist-user-comment"},btnText:{comment:"Комментарий",edit:"Редактировать",save:"Сохранить"},btnIcon:{comment:'<i class="font-icon i-icon-comment-left wishlist-ico-action" />',edit:'<i class="font-icon icon-edit wishlist-ico-action" />',save:'<i class="font-icon icon-enter wishlist-ico-action">'},btnClass:{comment:"wishlist-link-comment",edit:"wishlist-link-edit",save:"wishlist-link-save"},editClass:"wishlist-edit"},this.$={},this.$.holder=$(a),$.extend(!0,this.config,b||{}),this.loadObjects(a),this.initialize(),this.bindEvents()},initialize:function(){this.emptyBlock(this.$.textBlock.html())?this.changeBtnTo("comment"):this.changeBtnTo("edit"),this.$.textBlock.siblings("textarea").hide()},emptyBlock:function(a){return 0===$.trim(a).length},changeBtnTo:function(a){var b=this.config;this.$.actionBtn.removeClass(b.btnClass.comment+" "+b.btnClass.edit+" "+b.btnClass.save).addClass(b.btnClass[a]),this.$.actionBtn.empty().append(b.btnIcon[a]).append(b.btnText[a])},saveComment:function(){this.$.holder.find("input.wishlist-submit-comment").trigger("click")},editComment:function(){this.$.textBlock.siblings("textarea").show(),this.$.textBlock.hide(),this.changeBtnTo("save"),this.$.holder.addClass(this.config.editClass)},reinit:function(){this.emptyBlock(this.$.textBlock.html())&&this.$.textBlock.siblings("textarea").is(":hidden")&&("mobile"===mvideo.device.manager.getType()?this.$.textBlock.empty().hide():this.$.textBlock.empty().show())},bindEvents:function(){var a=this,b=this.config;this.$.actionBtn.on("click",function(c){var d=a.isState(b.editClass),e="",f=a.$.actionBtn[0].classList;f.contains(b.btnClass.comment)?e="addComment":f.contains(b.btnClass.edit)?e="editComment":f.contains(b.btnClass.save)&&(e="saveComment"),a.$.actionBtn.trigger("comment-click",{clickType:e}),c.preventDefault(),d?a.saveComment():a.editComment()})}});a.include(mvideo.Mixin.state),a.define("WishlistAddComment",a)}(),function(){"use strict";mvideo.Class.Class.extend({constructor:function(a,b){this.config=$.extend(!0,{selectors:{form:".c-wizard__form",title:".c-header-progress-bar__title",description:".c-wizard__description",hintContainer:".c-wizard__hint-container",recommendationBlock:".c-wizard__recommendation-block",percentHolder:".c-header-progress-bar__percent",percentValue:".c-header-progress-bar__line-value",previousLinkHolder:".c-wizard__previous-link"},eventNamespace:"wizard",previousWizardAttribute:"previousWizardFormId"},b),this.$={},this.$.holder=$(a),this.loadObjects(this.$.holder),this.initialize()},initialize:function(){this.overlay=new mvideo.Class.Overlay(this.$.holder),this.unBindEvents(),this.bindEvents()},bindEvents:function(){this.$.previousLinkHolder.on("click."+this.config.eventNamespace,".c-link",function(a){var b=this.$.form.serializeArray(),c=$(a.currentTarget).data("previousId");return void 0!==c&&(b.push({name:this.config.previousWizardAttribute,value:c}),this.sendRequest($.param(b))),!1}.bind(this)),this.$.form.on("submit."+this.config.eventNamespace,function(){return this.sendRequest(this.$.form.serialize()),!1}.bind(this))},unBindEvents:function(){this.$.form.off("submit."+this.config.eventNamespace),this.$.previousLinkHolder.off("click."+this.config.eventNamespace)},sendRequest:function(a){$.ajax({url:this.$.form.attr("action"),type:this.$.form.attr("method"),data:a,context:this,dataType:"json",beforeSend:function(){this.overlay.show()},success:this.successHandler,complete:function(){this.overlay.hide()}})},successHandler:function(a){this.$.title.html(a.title),this.$.description.html(a.description),this.$.hintContainer.html(a.hints),this.$.recommendationBlock.html(a.recommendationBlock||""),this.$.form.html(a.formFields),this.$.percentHolder.html(a.percent||""),this.$.percentValue.css("width",a.percent+"%"),this.$.previousLinkHolder.html(a.previousLink||""),this.scrollToTop(),mvideo.Class.ReinitContent.reinit(this.$.holder)},scrollToTop:function(){var a=this.$.holder.parent(),b=parseInt(a.css("margin-top"));$(window).scrollTop()>a.offset().top-b&&mvideo.instance.page.page.goToBlock(a,-b)}}).define("Wizard")}(),function(a){a.Class.svgScaleAndMove.extend({constructor:function(a,b){this.constructor.__super__.constructor.apply(this,arguments);var c=this,d=$(a),e=$(b.svgSelector,d);this.subscribe("changeTransform",function(a,b){"scale"===b.name?1>=b.attr.value?(c.changeTranslate(0,0,!0,!0),d.attr("data-disabled-slike","false"),d.trigger("touch-zoom",{type:"off"})):(d.attr("data-disabled-slike","true"),d.trigger("touch-zoom",{type:"on"})):"move"===b.name&&1>=b.settings.scale.value&&(c.changeTranslate(0,0,!0,!0),d.attr("data-disabled-slike","false"),d.trigger("touch-zoom",{type:"off"}))}),d.off("touch-zoom-setDefault").on("touch-zoom-setDefault",c.setDefault.bind(c)),e.swipe({tap:c.doubletap.bind(c,c.zoomIn.bind(c))}),c.startTimer=null,c.delayTap=200},getTimeStamp:function(){return(new Date).getTime()},zoomIn:function(){var a=this;a.changeScale(a.settings.scale.value+a.settings.scale.step)},doubletap:function(a){var b=this;if(b.startTimer&&b.startTimer+b.delayTap>b.getTimeStamp())return b.startTimer=null,void a();b.startTimer=b.getTimeStamp()},updateTransform:function(){var a=["scale("+this.settings.scale.value+")","translate("+this.settings.translate.values[0]+"px, "+this.settings.translate.values[1]+"px)"].join(" ");return this.$.transformer[0].setAttribute("style","transform: "+a),this},setDefault:function(){this.setScale(1)}}).define("ZoomTouchImg")}(window.mvideo);$("body").on("mousedown mouseup click",".ajax-overlay",function(a){return a.stopImmediatePropagation(),!1}),new mvideo.Class.CustomSelect("select"),$(document).on("focus",".input input:not(.disabled)",function(){$(this).closest(".input").addClass("focus")}).on("blur",".input input:not(.disabled), .c-text-field input",function(){$(this).closest(".input").removeClass("focus")}).on("focus","textarea:not(.disabled):not(.c-textarea__textarea)",function(){$(this).addClass("focus")}).on("blur","textarea:not(.disabled):not(.c-textarea__textarea)",function(){$(this).removeClass("focus")}),$("body").on("focus",".header-search-input, .b-autocomplete",function(){$(this).closest(".header-search-form, .b-autocomplete").addClass("focus")}).on("blur",".header-search-input, .b-autocomplete",function(){$(this).closest(".header-search-form, .b-autocomplete").removeClass("focus")}),function(){$.datepicker._checkOffset=function(a,b,c){var d=a.dpDiv.outerWidth(),e=a.dpDiv.outerHeight(),f=a.input?a.input.outerWidth():0,g=a.input?a.input.outerHeight():0,h=document.documentElement.clientWidth+(c?0:$(document).scrollLeft()),i=document.documentElement.clientHeight+(c?0:$(document).scrollTop());return b.left-=this._get(a,"isRTL")?d-f:0,b.left-=c&&b.left===a.input.offset().left?$(document).scrollLeft():0,b.top-=c&&b.top===a.input.offset().top+g?$(document).scrollTop():0,b.left-=Math.min(b.left,b.left+d>h&&h>d?Math.abs(b.left+d-h):0),b.top-=Math.min(b.top,b.top+e>i&&i>e?Math.abs(e+g)+10:-10),b},$.datepicker._updateDatepicker_original=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(a){$.datepicker._updateDatepicker_original(a);var b=this._get(a,"afterShow");b&&b.apply(a.input?a.input[0]:null)}}(),$(".no-functionality, .no-functionality *").click(function(a){return a.stopPropagation(),a.preventDefault(),a.stopImmediatePropagation(),!1}),$(function(){var a=$(".disabled-area").children().addBack();a.off(),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(b,c){a.on(c,function(a){return a.stopPropagation(),a.preventDefault(),!1})})}),mvideo.Module.define("pseudo-tabs",function(a){var b=$(this),c=b.find(".c-pseudo-tabs__item"),d="c-pseudo-tabs__item_active",e=$.extend(!0,{space:"pseudoTab",toggle:!1,multiselect:!1,collapsible:!1},a||{});c.off("click."+e.space).on("click."+e.space,function(a){var b=$(this);if(e.multiselect)b.toggleClass(d);else if(e.toggle){var f=c.filter("."+d);b.toggleClass(d),f.is(b)||f.removeClass(d)}else c.filter("."+d).removeClass(d),b.addClass(d);a.preventDefault()}),e.collapsible&&(b.expandableList=new mvideo.Class.ExpandableList(b,{showQty:9,linkConfig:{text:{show:'<span class="u-inline-block u-mt-4">Показать всё<span>',hide:'<span class="u-inline-block u-mt-4">Свернуть<span>'},tag:"a",attributes:{href:"#",class:"c-link c-link_gray c-link_pseudo u-ml-8 c-plp-facets__show-full-facet"}}}),b.off("visible.PseudoTabs").on("visible.PseudoTabs",function(){b.expandableList.reinit()}))}),function(){var a=!1,b=[];mvideo.Module.define("add-youtube-video-statistic",function(c){function d(a){n.addEventListener("onStateChange",h)}function e(a){var b=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??(?:v=)?([^#\&\?]*).*/,c=a.match(b);return!(!c||11!=c[7].length)&&c[7]}function f(a){g(a),j(),r.videoId=a,n=new window.YT.Player(m,r),$(u).show()}function g(a){o="#youtube-"+a}function h(a){var b=a.data;b===window.YT.PlayerState.PLAYING&&k(),b!==window.YT.PlayerState.ENDED&&b!==window.YT.PlayerState.PAUSED||l()}function i(){var a=window.mvideoGtm[o]||{};return $.extend({eventLocation:q},a)}function j(){n&&(n.destroy(),n=null,t={})}function k(){n&&"function"==typeof n.getPlayerState&&n.getPlayerState()==window.YT.PlayerState.PLAYING&&(l(),setTimeout(k,1e3))}function l(){var a,b;n&&n.getCurrentTime&&(b=Math.floor(n.getCurrentTime()/n.getDuration()*100),window.dataLayer=window.dataLayer||[],b>=0&&!t["0%"]&&(a=i(),a.eventAction="play",window.dataLayer.push(a),t["0%"]=!0),b>=25&&!t["25%"]&&(a=i(),a.eventAction="25% progress",window.dataLayer.push(a),t["25%"]=!0),b>=50&&!t["50%"]&&(a=i(),a.eventAction="50% progress",window.dataLayer.push(a),t["50%"]=!0),b>=100&&(a=i(),a.eventAction="100% progress",window.dataLayer.push(a),t={}))}var m,n,o,p,q,r,s=$(this),t={},u=this;c=c||{},m=c.videoIframeId||s.find(".product-carousel-view-iframe").attr("id"),r=$.extend(!0,{playerVars:{controls:1,showinfo:1,modestbranding:1,wmode:"transparent"},events:{onReady:d}},c.videoConfig||{}),function(){var c,d,e,f=document.getElementsByTagName("script"),g=!0,h="https://www.youtube.com/iframe_api";for(e=0;e<f.length;e++)if(f[e].src===h){g=!1;break}g&&(c=document.createElement("script"),c.src=h,c.onload=function(){window.YT.ready(function(){if(a=!0,b.length>0)for(var c=0;c<b.length;c+=1)b[c]()})},d=f[0],d.parentNode.insertBefore(c,d))}(),s.on("addUrl",function(c,d){var g=e(d.url);q=d.eventLocation,a?f(g):(p=function(){f(g)},b.push(p))}),c.initializeImmediatly&&s.trigger("addUrl",{url:c.url,eventLocation:c.eventLocation}),s.on("clear",j)})}(),mvideo.Module.define("ajax-pagination",function(a){function b(a){a.preventDefault();var b=$(this);b.hasClass("c-pagination_disabled")||b.hasClass("c-pagination__num_active")||(d.removeClass("u-hidden"),$.getJSON(b.attr("href")).then(function(a){$("[data-pagination-part]").each(function(){var b,c=$(this),d=c.data("paginationPart");a.hasOwnProperty(d)&&(b=$(a[d]),c.replaceWith(b),mvideo.Class.ReinitContent.reinit(b))}),c.scrollToSelector&&mvideo.instance.page.page.goToBlock(c.scrollToSelector,c.scrollToOffset),d.addClass("u-hidden")}))}var c=$.extend(!0,{holder:this,scrollToSelector:"",scrollToOffset:0,overlay:null},a),d=$(c.overlay);$(c.holder).on("click","a",b)}),mvideo.Module.define("autofocus",function(a){if(a=$.extend(!0,{holder:this,deviceType:{desktop:!0,tablet:!0,mobile:!1}},a),a.deviceType[mvideo.device.manager.getType()]){var b=$(a.holder);b.focus().caret(b.val().length)}}),mvideo.Module.define("birthdayDatePicker",function(a){function b(){c.blur()}a=$.extend(!0,{},a);var c=$(this);jQuery(window).on("resize",$.throttle(1e3,function(){c.hasClass("hasDatepicker")&&c.datepicker("hide")})),function(){var d;c.datepicker({changeYear:!0,maxDate:a.maxDate?a.maxDate:"-12y",minDate:a.minDate?a.minDate:"-90y",yearRange:a.yearRange?a.yearRange:"-90:-12",onSelect:b,showOn:a?a.showOn:"focus",beforeShow:function(a,b){d=b.dpDiv.addClass("birthday-datepicker")},onChangeMonthYear:function(a,b,c){var d=c.selectedDay;$(this).datepicker("setDate",new Date(a,b-1,d))},afterShow:function(){d.find(".ui-datepicker-calendar").addClass("sel-calendar")},onClose:function(a,b){var c=b.currentDay;c&&b.dpDiv.find('a:contains("'+c+'")').addClass("sel-selected-date")},onSelect:function(){c.trigger("input")}}).on("keyup",function(){var a=$(".birthday-datepicker .ui-state-active");a.length&&a.addClass("sel-selected-date")})}()}),mvideo.Module.define("change-by-length",function(a){if(!a||!a.count||!$.isNumeric(a.count))return void console.warn("change-by-length - param.count must be a number");var b=$(this),c=!1;b.on("input",function(){b.val().length==a.count&&(c=!0,b.blur(),b.trigger("full.change-by-length"))}).on("change",function(){if(!c)return!1;c=!1})}),mvideo.Module.define("city-autocomplete",function(a){a=$.extend(!0,{transformResponseToItems:function(a){return a&&a.cities&&a.cities.length?a.cities.map(function(a){var b=a.label||a.name;return{text:b,name:a.name,id:a.id,info:{regionId:a.regionId||"",text:b}}}):[]},isEmptyResponse:function(a){return!a.cities.length},getRequestData:function(a){return{nameStartsWith:a.val()}}},a);var b=$(this);new mvideo.Class.AutocompleteSG(b,a)}),mvideo.Module.define("counter-input",function(a){function b(a){a.preventDefault();var b=Number(j.val())-1;b>=1&&(j.val(b),k())}function c(a){a.preventDefault(),j.val(Number(j.val())+1),k()}function d(){i.trigger("change-count")}function e(){g()&&d()}function f(a){13===a.which&&(a.preventDefault(),a.stopImmediatePropagation(),g()&&d())}function g(){return l!==Number(j.val())}var h=Object.assign({minusBtn:".c-counter-input__minus-btn",plusBtn:".c-counter-input__plus-btn",holder:this,counterInput:".c-counter-input__input",submitDelay:500},a||{}),i=$(h.holder),j=$(h.counterInput,i),k=$.debounce(h.submitDelay,d),l=Number(j.val());$(h.minusBtn,i).click(b),j.focusout(e),j.keypress(f),$(h.plusBtn,i).click(c)}),mvideo.Module.define("custom-scroll-browser",function(a){var b=$.extend(!0,{holder:this},a||{});new mvideo.Class.ScrollCrossBrowser(b)}),mvideo.Module.define("cutText",function(a,b,c){function d(){f&&h.run("reloadlink"),h.run("enable")}function e(){h.run("disable")}var f=!1,g="";a&&b&&c?(g=a,c=c&&c.length?JSON.parse(c):{}):(f=!0,g=a.selector,b=a.type,c=a.config,c.titleWithLink="Читать полностью",c.selectorWithLink=".text-cutter-link");var h=new mvideo.Class.ModulesCollection,i=new mvideo.Class.TextCutterFactory,j=i.makeTextCutter(b,c||{});return $(this).find(g).each(function(){var a=new j($(this),c);h.add(a),f&&d()}),{mobileBehavior:d,desktopBehavior:f?d:e,tabletBehavior:f?d:e}}),window.mvideo.Module.define("download-file",function(a){var b=$.extend(!0,{selectors:{overlayHolder:".js-download-overlay",notificationHolder:".js-download-notification"}},a||{});new window.mvideo.Class.DownloadFileAjax(this,b)}),mvideo.Module.define("enter-hook",function(a){a=$.extend(!0,{target:{selector:this,event:"focusout"}},a||{}),$(this).on("keypress",function(b){13===b.keyCode&&($(this).blur(),$(a.target.selector).trigger(a.target.event),b.preventDefault())})}),mvideo.Module.define("event-throwing",function(a){function b(b,f){c(b),(e||d()).trigger(a.target.event,f)}function c(b){a.target.originalEvent&&(a.target.event=b)}function d(){return $(a.target.selector,a.target.context)}a=$.extend(!0,{holder:{event:"click",selector:this,canRecreate:!1,context:document,contextThis:!1},target:{event:"click",selector:this,canRecreate:!1,context:document,originalEvent:void 0}},a||{});var e;a.holder.contextThis&&(a.holder.context=this),a.target.canRecreate||(e=d()),a.holder.canRecreate?$(a.holder.context).on(a.holder.event,a.holder.selector,b):$(a.holder.selector,a.holder.context).on(a.holder.event,b)}),mvideo.Module.define("facets-panel",function(a){function b(){g.addClass("u-no-scroll"),f.addClass(a.shownClass),setTimeout(function(){var b=$(document).scrollTop();h.css("maxHeight","100vh").css("overflow","hidden"),f.addClass(a.openedClass),h.scrollTop(b)}),f.swipe("enable"),f.swipe({swipeLeft:function(){c(),mvideo.Event.publish("hide-drop")}}),i=!0}function c(b){var c=h.scrollTop();h.css("max-height","").css("overflow",""),g.removeClass("u-no-scroll"),$(document).scrollTop(c),f.removeClass(a.openedClass),f.swipe("disable"),setTimeout(function(){f.removeClass(a.shownClass)},300),i=!1,mvideo.Event.publish("hide-facets-panel",b)}a=$.extend(!0,{btn:"[data-facet-open]",panel:".c-facets",closeBtn:"[data-facet-close]",shownClass:"c-facets_shown",openedClass:"c-facets_opened"},a);var d=$(this),e=d.find(a.btn),f=d.find(a.panel),g=$("body"),h=$(".wrapper"),i=!1;e.on("click",b),f.on("click",function(a){a.target==f[0]&&c(a.target)}),d.on("click",a.closeBtn,function(a){c(a.currentTarget)}),mvideo.Event.subscribe("device",function(a,b){b===mvideo.device.manager.TYPES.DESKTOP&&c()})}),mvideo.Module.define("focus-block",function(a,b){var c="true"===a||void 0===a?this:a,d=new mvideo.Class.SmartFocus;setTimeout(function(){d.focusBlock(c,b)},0)}),mvideo.Module.define("focus-next",function(a){a=$.extend(!0,{insideForm:!1},a),$(this).on("keypress","input,select",function(b){if(13==b.which){b.preventDefault();var c=a.insideForm?$(this).closest("form"):$("body"),d=$(":tabbable",c).not("[disabled], [hidden], [readonly], a, :button, :submit"),e=$(this);if(e.data("next-click"))return $(e.data("next-click"),c).trigger("click");var f=d.index(this)+1;if(f>=d.length)return void $(this).blur();d.eq(f).focus()}})}),mvideo.Module.define("forbid-input-symbols",function(a){a=$.extend({input:"",symbols:"[\\s]"},a);var b=a.input?$(a.input):$(this),c=new RegExp(a.symbols,"g"),d=mvideo.device.manager.isItMobile("Android");b.on("input",function(){var a=b.val(),e=a.replace(c,""),f=a.length-e.length,g=b.caret()&&b.caret().end-f;0!=f&&(b.val(e),b.caret()&&b.caret().end>g&&(d?setTimeout(function(){b.caret(g)},0):b.caret(g)))})}),mvideo.Module.define("loadMoreContent",function(){var a=$(this).data("init-json");$.isPlainObject(a)||(console.warn('Module "loadMoreContent" got incorrect JSON setting from data-init-json attribute'),a={}),a.holder=$(this),new mvideo.Class.LoadMoreContent(a)}),mvideo.Module.define("masked-input",function(a,b,c,d){var e,f=b||"999-9999999",g=a?$(a):$(this),h=g.val();h=!b&&h?h:f;var i=h.indexOf(" ");e="+"===h[0]&&-1!=i?h.substr(0,i)+h.substr(i).replace(/(\d)|(\_)/g,"9"):h.replace(/(\d)|(\_)/g,"9"),g.mask(e,{placeholder:void 0!=d?d:"_",autoclear:!1,withoutSelectForFilling:!!c}),g.trigger("mask-applied")}),mvideo.Module.define("multiline-ellipsis",function(a){function b(){var a=c.height();for(d.text(e);d.outerHeight()>a;)d.text(d.text().replace(/\.{3}|…/,"").replace(/.$/,"…"))}var c=$(this),d=c.find(a.textSelector),e=d.text().trim();return b(),{mobileBehavior:b,desktopBehavior:b,tabletBehavior:b}}),mvideo.Module.define("page",function(a){function b(a){f.isAvailable()&&(a?(e.updateHeight(e.getHeight()),e.show(g)):d.show(g),c.goToBlock(g.$.holder))}var c=new mvideo.Class.Page(".page-content"),d=c.sidebar,e=c.topbar,f=c.message,g=f.bar;return{page:c,desktopBehavior:function(){f.switchTo("desktop"),d.jump(),b(!0)},tabletBehavior:function(){f.switchTo("tablet"),e.jump(),b()},mobileBehavior:function(){f.switchTo("tablet"),e.jump(),b()}}}),function(){var a={};mvideo.Module.define("popup",function(b){var c=$(this);if(b.once){if(a[b.namespace])return!1;a[b.namespace]=!0}return b.classes=[],b.large&&b.classes.push("large"),b.withButton&&b.classes.push("with-button"),b.withTitle&&b.classes.push("with-title"),b.fullScreen&&b.classes.push("full-screen"),b.additionalClasses&&(Array.isArray(b.additionalClasses)?$.map(b.additionalClasses,function(a){b.classes.push(a)}):b.classes.push(b.additionalClasses)),b=$.extend(!0,{contentAsHTML:!0},b||{}),{popup:new mvideo.Class.Popup(c,b)}})}(),mvideo.Module.define("print",function(a){(a&&$(a)||$(this)).off("click").on("click",function(a){return a.preventDefault(),window.print(),!1})}),window.mvideo.Module.define("remote-validation",function(a){function b(b,c,d){var e=$.extend(!0,{data:b},a.requestParams);return $.ajax(e).done(c).always(d)}function c(a,b){"success"===b.status&&$.isArray(b.newState)&&b.newState.forEach(function(b){var c=a.find("[name="+b.name+"]");if(c.val(b.val),b.error){var d=c.siblings(".u-error-text");c.addClass("u-error"),d.text(b.error).css({display:"block"})}})}function d(b){delete h[b],f.trigger(a.eventOnDone,{isValidationRunning:e()})}function e(){return Object.keys(h).length>0}a=$.extend(!0,{event:"change",inputs:"[data-remote-validation]",dataHolder:"[data-remote-validation-data-holder]",requestParams:{method:"POST",url:"",dataType:"json",cache:!1},eventOnDone:"update-remote-validation"},a);var f=$(this),g=mvideo.helpers.prepareDataSend.getSerializedData,h={};return a.requestParams.url?(f.on(a.event,a.inputs,function(e){var f,i,j,k,l=$(e.currentTarget),m=l.attr("name"),n=h[m];!l.hasClass("u-error")&&l.val().trim()&&(n&&n.abort(),i=l.parents(a.dataHolder),f=g(i),j=c.bind(this,i),k=d.bind(this,m),h[m]=b(f,j,k))}),{isRemoteValidationRunning:e}):void window.console.warn("remote-validation: url for validation is not defined")}),mvideo.Module.define("replace-form-after-submit",function(){var a=$(this),b=a.find("form"),c=a.parent(),d=new mvideo.Class.Overlay,e=a.parents(".c-popup").data("popup-instance"),f=function(){b.on("submit",function(a){if(b.validate().valid())return $.ajax({type:b.attr("method")||"post",url:b.attr("action"),dataType:"html",data:b.serialize(),beforeSend:function(){d.show(c)},complete:function(){d.hide(c)},success:function(a){if("OK"==a)return e.hide(),void(e.$.holder&&e.$.holder.trigger("popup-success-close"));c.html(a),mvideo.Class.ReinitContent.reinit(c)}}),!1})};b.data("apply.validation")?f():b.one("apply.validation",f)}),mvideo.Module.define("scrollOnClick",function(a){$(this).click(function(b){b.preventDefault();var c=$(this).attr("href"),d=$('[data-target="'+c+'"]').length>0,e=a&&a.offset||0;mvideo.instance.page.page.goToBlock(c,e),d&&!$(c).hasClass("in")&&$('[data-target="'+c+'"]').trigger("click")})}),mvideo.Module.define("scroll-up-button",function(){function a(){j=!1,g.removeClass(i.showClass)}function b(){j=!0,g.addClass(i.showClass)}function c(){var c=h.scrollTop();c>k&&!j?b():c<=k&&j&&a()}function d(a){a.preventDefault(),e()}function e(){var a=h.scrollTop();window.scrollBy(0,(a+100)/-10),window.pageYOffset>0&&requestAnimationFrame(e)}function f(a,b){k="mobile"===b?i.topOffsetMobile:i.topOffset,c()}var g=$(this),h=$(document),i={showClass:"c-scroll-up_shown",topOffset:400,topOffsetMobile:2e3},j=!1,k=0;!function(){g.on("click",d),h.on("scroll",c),mvideo.Event.subscribe("device",f)}(),c()}),mvideo.Module.define("select-tab",function(a){a=$.extend(!0,{lazyLoad:!1},a||{});var b=$(this),c=b.parents("form"),d=new mvideo.Class.LazyLoad;b.on("change",function(){c.find("[data-select-tab]").addClass("u-hidden"),c.find("[data-select-tab="+b.val()+"]").removeClass("u-hidden"),a.lazyLoad&&d.update()})}),mvideo.Module.define("sg-tooltip",function(a){var b=$(this),c={contentAsHTML:!0,sel:{}};$.extend(!0,c,a||{}),c.closeOnScroll&&(c.trigger&&"hover"!=c.trigger?(c.triggerOpen={click:!0,tap:!0},c.triggerClose={click:!0,tap:!0,scroll:!0}):(c.triggerOpen={mouseenter:!0,touchstart:!0},c.triggerClose={mouseleave:!0,originClick:!0,touchleave:!0,scroll:!0}),c.trigger="custom"),new mvideo.Class.Tooltip(b,c)}),mvideo.Module.define("sg-validation-handler",function(a){var b=$.extend({ignoreSelectors:".ignore, .dont-validate, :hidden",errorTextClass:"u-error-text",errorFieldClass:"u-error",validFieldClass:"u-valid",notSubmit:!1,requireValidateAfterSubmit:!1,needShowErrorEvents:!1,dontShowError:!1},a||{}),c=$(b.holder||this),d=new mvideo.Class.Overlay,e={ignore:b.ignoreSelectors,errorClass:b.errorTextClass,highlight:function(a){$(a).addClass(b.errorFieldClass).removeClass(b.validFieldClass)},
unhighlight:function(a){$(a).addClass(b.validFieldClass).removeClass(b.errorFieldClass)},submitHandler:function(){return c.data("loader-select")&&d.show($(c.data("loader-select"))),mvideo.Event.publish("formValid",c.attr("id")),c.trigger("formValid"),!b.notSubmit&&(c[0].submit(),!1)},invalidHandler:function(a,b){mvideo.Event.publish("formInvalid",c.attr("id"))}},f=function(a,c){if("select"!==a.nodeName.toLowerCase()){var d,e=$(a);if("masked-input"===e.data("init")&&e.val()===e.attr("placeholder")&&e.val(""),(d=e.val())==e.data("prevVal")||!d&&!e.data("prevVal"))return!1;if(e.data("prevVal",d),!e.val().length)return e.removeClass(b.errorFieldClass).removeData("previousValue").parent().find("."+b.errorTextClass).empty().hide(),!1;this.element(a)}};b.dontShowError&&(e=$.extend(e,{errorPlacement:$.noop})),b.requireValidateAfterSubmit&&(e=$.extend(e,{onchange:function(a,c){if("select"===a.nodeName.toLowerCase()){var d=$(a),e=d.hasClass(b.errorFieldClass);if(0===d.val().length&&!e)return!1;this.element(a)}},onfocusout:f})),b.needShowErrorEvents&&(e=$.extend(e,{showErrors:function(a,c){if(c.length>1)this.defaultShowErrors(),c.forEach(function(a){var c=$(a.element),d=c.attr("id"),e=d?'[for="'+d+'"]':"";c.siblings("."+b.errorTextClass+e).trigger("show.error")});else if(1===c.length){var d=$(c[0].element),e=d.attr("id"),f=e?'[for="'+e+'"]':"",g=d.hasClass(b.errorFieldClass),h=d.siblings("."+b.errorTextClass+f),i=h.text();this.defaultShowErrors(),h=d.siblings("."+b.errorTextClass+f),(!g||g&&i!=h.text())&&h.trigger("show.error")}else this.defaultShowErrors()}})),c.attr("id")||c.uniqueId(),mvideo.instance.page.page.validationForms[c.attr("id")]=c.validate(e),c.data("apply.validation",!0),c.trigger("apply.validation"),c.find(":input").on("input",function(){$(this).hasClass(b.errorFieldClass)&&f.call(mvideo.instance.page.page.validationForms[c.attr("id")],this)})}),mvideo.Module.define("smart-break-word",function(a){function b(){var b,n=0;if(h.css("width",m),i.text(i.text().trim()),c=h.outerWidth(!0),e=j.outerWidth(!0),d=i.outerWidth(!0),f=0,g=0,k.length&&k.each(function(a,b){f+=$(b).outerWidth(!0)}),l.length&&l.each(function(a,b){g+=$(b).outerWidth()-$(b).width()}),n=d+e+f+g,c<=n){b=e,a.afterTooltip&&(b+=f),c===n&&(b+=1);var o=c-b;o>0&&h.css("width",o)}}var c,d,e,f,g,h=$(this),i=h.find(a.text),j=h.find(a.tooltip),k=h.find(a.otherElements),l=h.find(a.offsetElements),m=a.resetWidth?a.resetWidth:"auto";i.length>0&&b(),a.namespace?$(window).off("resize."+a.namespace).on("resize."+a.namespace,b):$(window).on("resize",b),a.event&&$(a.event.element).off(a.event.name+"."+a.namespace).on(a.event.name+"."+a.namespace,b)}),window.mvideo.Module.define("sticky",function(a){if(window.CSS&&(window.CSS.supports("position","sticky")||window.CSS.supports("position","-webkit-sticky")))return!1;var b=this;b.classList.remove("u-sticky"),a&&a.selectorAffix&&(b=this.querySelector(a.selectorAffix)),window.mvideo.Module.init("affix",arguments,b)}),mvideo.Module.define("stores-autocomplete",function(a){a=$.extend(!0,{method:"post",transformResponseToItems:function(a){return a&&a.options&&a.options.length?a.options.map(function(a){return{text:a.text,name:a.text,id:a.id}}):[]},isEmptyResponse:function(a){return!a.options.length},getRequestData:function(a){return{pickupStoreSearch:a.val()}},allowEmptySending:!1},a);var b=$(this);new mvideo.Class.AutocompleteSG(b,a)}),mvideo.Module.define("street-autocomplete",function(a){var b,c=$(this),d=a.nameParentId||"parentid";if(!a.cityIdSelector)return void console.warn("config.cityIdSelector is required");if(b=$(a.cityIdSelector),!b.length)return void console.warn("cityId element must exist");a=$.extend(!0,{transformResponseToItems:function(a){return a&&a.streets&&a.streets.length?a.streets.map(function(a){return{text:a.label||a.name,name:a.name,id:a.id}}):[]},isEmptyResponse:function(a){return!a.streets.length},getRequestData:function(a){var c={nameStartsWith:a.val()};return c[d]=b.val(),c},withoutLoader:!0},a);var e=new mvideo.Class.AutocompleteSG(c,a);b.change(function(){e.clearDrop(),e.hideDrop()})}),mvideo.Module.define("swipe-fixed-width",function(a){function b(){m.swipe("destroy"),c(),d()}function c(){m.prop("style").removeProperty("position"),m.prop("style").removeProperty("left"),m.prop("style").removeProperty("transition-property"),m.prop("style").removeProperty("transition-duration"),m.prop("style").removeProperty("transition-timing-function")}function d(){m.css({position:"relative",left:"0"})}function e(){d(),i()}function f(){g(),mvideo.Event.subscribe("resize",e)}function g(){mvideo.Event.unsubscribe("resize",e)}function h(){var a=m.outerWidth(!0),b=m.parent(),c=b.width();n=a>c?c-a:0,k.setMaxLeftDistance(n)}function i(){h(),n||a.turnOnSwipe?j():b()}function j(){m.css({position:"relative"}),h(),a.fromTheEnd&&m.css({left:n}),m.swipe({swipeStatus:function(a,b,c,d,e){switch(b){case"start":m.prop("style").removeProperty("transition-property"),m.prop("style").removeProperty("transition-duration"),m.prop("style").removeProperty("transition-timing-function"),h(),k.startMeasure(parseInt(m.css("left"))||0);break;case"move":"left"!==c&&"right"!==c||m.css("left",k.interimMeasure(d,c));break;case"cancel":case"end":m.css({"transition-property":"left","transition-duration":"0.3s","transition-timing-function":"cubic-bezier(0, 0, 0.12, 0.89)"}),m.css("left",k.stopMeasure(d,c)),m.trigger("swiped",[c])}},allowPageScroll:$.fn.swipe.pageScroll.VERTICAL}),m.trigger("initSwipe")}var k,l,m=$(this),n=0,o={desktopBehavior:function(){b(),g()},tabletBehavior:function(){a.tablet?(f(),i()):(b(),g())},mobileBehavior:function(){f(),i()}};return a=$.extend(!0,{tablet:!0,turnOnSwipe:!1,evNamespace:""},a),l=a.evNamespace?"."+a.evNamespace:"",m.off("reinit"+l).on("reinit"+l,function(){f(),i()}),function(){k=new mvideo.Class.RelativeDistanceCalculator({maxLeftDistance:0}),mvideo.device.manager.getType()===mvideo.device.manager.TYPES.MOBILE&&o.mobileBehavior()}(),o}),mvideo.Module.define("swiperoll-var-width",function(a){function b(a){var b=parseInt(a);return isNaN(b)?0:b}function c(){I=b(x.css("left")),J=b(x.width()),K=y.get(0).getBoundingClientRect().width,H=K/3,t=new mvideo.Class.RelativeDistanceCalculator({maxLeftDistance:K-J})}function d(){switch(mvideo.device.manager.getType()){case mvideo.device.manager.TYPES.DESKTOP:M.desktopBehavior();break;case mvideo.device.manager.TYPES.TABLET:M.tabletBehavior();break;case mvideo.device.manager.TYPES.MOBILE:M.mobileBehavior()}}function e(){x.swipe("destroy"),f(),g()}function f(){x.prop("style").removeProperty("position"),x.prop("style").removeProperty("left"),x.prop("style").removeProperty("transition-property"),x.prop("style").removeProperty("transition-duration"),x.prop("style").removeProperty("transition-timing-function")}function g(){x.css({position:"relative",left:"0"})}function h(){var a=x.outerWidth(!0);G=a>K?K-a:0,t.setMaxLeftDistance(G)}function i(){e(),h(),G&&k()}function j(){L&&(h(),G?n():o(),p(u,0))}function k(){x.css({position:"relative"}),h(),a.fromTheEnd&&x.css({left:G}),x.swipe({swipeStatus:function(a,b,c,d,e){switch(b){case"start":x.css({"transition-property":"none"}),x.prop("style").removeProperty("transition-duration"),x.prop("style").removeProperty("transition-timing-function"),h(),t.startMeasure(parseInt(x.css("left"))||0);break;case"move":"left"!==c&&"right"!==c||x.css("left",t.interimMeasure(d,c));break;case"cancel":case"end":x.css({"transition-property":"left","transition-duration":"0.3s","transition-timing-function":"cubic-bezier(0, 0, 0.12, 0.89)"}),I=t.stopMeasure(d,c),x.css("left",I),l()}},allowPageScroll:$.fn.swipe.pageScroll.VERTICAL}),x.trigger("initSwipe")}function l(b){if(E&&F){var c=mvideo.device.manager.getType();c===mvideo.device.manager.TYPES.DESKTOP||c===mvideo.device.manager.TYPES.TABLET&&a.tabletScroll?(I>=0?E.removeClass(a.btnVisibleClass):E.addClass(a.btnVisibleClass),I>K-J?F.addClass(a.btnVisibleClass):F.removeClass(a.btnVisibleClass)):m()}}function m(){E&&F&&(E.removeClass(a.btnVisibleClass),F.removeClass(a.btnVisibleClass))}function n(){0==$("."+A+",."+B,y).length&&L&&(E=$(C),F=$(D),y.append(E).append(F),E.on("click",p.bind(this,v)),F.on("click",p.bind(this,u))),l()}function o(){$("."+A+",."+B,y).length>0&&(m(),E.off("click",p.bind(this,v)),F.off("click",p.bind(this,u)),E.remove(),F.remove())}function p(a,b,c,d){var e=0,f=0;null!=b&&"number"==typeof b||(b=H),x.addClass("swipe-start"),e=q(),d||(x.removeClass("swipe-start"),x.css({"transition-property":"left","transition-duration":"0.3s","transition-timing-function":"cubic-bezier(0, 0, 0.12, 0.89)"})),f=a===u?e-b:e+b,r(f),setTimeout(function(){x.removeClass("swipe-start")})}function q(){var a=b(x.css("left"));return isFinite(a)?a:0}function r(a){var b=a;b>0||K>J?b=0:b<K-J&&(b=K-J),x.css({left:b}),I=b,l()}function s(){var b=($(a.activeSel,x),0),c=u;z.each(function(){if($item=$(this),$item.is(a.activeSel))return!1;b+=$item.width()}),b+=I,c=b>=0?u:v,p(c,Math.abs(b))}a=$.extend(!0,{tabletSwipe:!0,tabletScroll:!1,desktopScroll:!1,containerSel:".c-tabs__menu-scrollable",peepholeSel:".c-tabs__menu-wrap",movingListSel:".c-tabs__menu-list",movingItemsSel:".c-tabs__menu-item",leftBtnClass:"c-tabs__menu-slide-left",rightBtnClass:"c-tabs__menu-slide-right",btnVisibleClass:"c-tabs__menu-visible",activeSel:".active"},a);var t,u=$.fn.swipe.directions.LEFT,v=$.fn.swipe.directions.RIGHT,w=$(a.containerSel),x=$(a.movingListSel),y=a.peepholeSel?$(a.peepholeSel):$(this),z=($(a.containerSel),x.find(a.movingItemsSel)),A=a.leftBtnClass,B=a.rightBtnClass,C='<button class="c-btn_white c-btn_circle c-btn_border-transparent c-btn_icon i-icon-chevron-left u-box-shadow-droop '+A+'"/>',D='<button class=" c-btn_white c-btn_circle c-btn_border-transparent c-btn_icon i-icon-chevron-right u-box-shadow-droop '+B+'"/>',E=null,F=null,G=0,H=0,I=0,J=0,K=0,L=a.desktopScroll||a.tabletScroll,M={desktopBehavior:function(){c(),e(),a.desktopScroll?j():o(),s()},tabletBehavior:function(){c(),a.tabletSwipe?i():e(),a.tabletScroll?j():o(),s()},mobileBehavior:function(){c(),i(),m(),s()}};return function(){window.mvideo.Event.subscribe("resize",d),window.mvideo.Event.subscribe("open-side-bar-menu",function(){w.css({transition:"opacity 0.2s linear",opacity:0})}),window.mvideo.Event.subscribe("close-side-bar-menu",function(){w.css({transition:"opacity 1s linear",opacity:1})})}(),M}),mvideo.Module.define("switchTab",function(a){if(a=void 0!==a?a:{},Modernizr.history){var b=a.hasOwnProperty("itemsSelector")?$(this).find(a.itemsSelector):$(this),c=!!a.hasOwnProperty("subTarget")&&a.subTarget,d=!!a.hasOwnProperty("urlParams")&&a.urlParams,e=!!a.hasOwnProperty("subTargetBlock")&&a.subTargetBlock;b.on("click",function(a){a.preventDefault();var b,f=mvideo.instance.productTabs.tabs,g=$(this),h=g.data("target"),i=f.getItemById(h);d&&(b=i.data("contentUrl"),i.data("contentUrl",b+"&"+$.param(d))),f.publish("switchTab",{activeItemId:h,url:g.attr("href"),refresh:!!d,subTargetTab:c||g.data("subtarget"),subTargetBlock:e}),d&&i.data("contentUrl",b)})}}),mvideo.Module.define("switchesDisableSubmitBtn",function(a,b,c){function d(){i.checkForm()?(c||h.removeClass(f.disabledClass),h.removeAttr("disabled")):(c||h.addClass(f.disabledClass),h.attr("disabled","disabled"))}var e;"object"!=typeof a||a instanceof jQuery||a instanceof HTMLElement||(e=a,a=this);var f=$.extend(!0,{form:a||this,submitBtn:b||'[type="submit"]',notAddingClass:c||!1,disabledClass:"disabled",validateOnInit:!1},e||{}),g=$(f.form),h=$(f.submitBtn,g),i=g.validate();g.on("formOnfocusout",d).on("formOnkeyup",d).on("formElementOnclick",d).find("select.c-dropdown").on("change",d).end().find(".star-rating-canvas").one("click",d),f.validateOnInit&&d()}),mvideo.Module.define("tabs-newsg",function(a){function b(){var b=g.tabsMenu.getActiveItem(),c="[data-id="+b.find(".c-tabs__menu-link").data("target")+"]",e=$(c),f={withoutScrollToActive:!g.config.activeItem,activeItemId:g.tabsMenu.getActiveTabId(),url:b.find("a").attr("href")};a.firstSwitch||g.publish("switchTab",f),d(b,!0),g._isItemEmpty(e)&&g.setActiveItem(e)}function c(){i.off("click.showFullItem").on("click.showFullItem",function(a){d(a.target)}),h.off("initSwipe").on("initSwipe",function(){d(g.tabsMenu.getActiveItem(),!0)})}function d(b,c){var d,e=$(b),f=e.closest(".c-tabs__menu-item"),g=f.offset().left,i=f.width(),k=0,l=$(window).width(),m=0,n=0;if(a.useButtons&&(k=parseInt(e.css("margin-left")||0,10),m=j.getVisibleAreaLeftOffset(k),n=j.getVisibleAreaRightOffset(k)),g<m)c||h.css("transition","0.3s"),d=(parseInt(h.css("left"))||0)-g+m,h.css("left",d);else if(g+i>l-n){c||h.css("transition","0.3s");var o=l-(g+i);d=(parseInt(h.css("left"))||0)+o-n,h.css("left",d)}a.useButtons&&j.changePosHandler(d)}function e(){a.useButtons&&j.setActive()}function f(){a.useButtons&&j.setInactive()}a=$.extend(!0,{firstSwitch:!0,compareTableHeadingWrapper:".c-compare-table-header-wrapper",comparePager:".c-compare-pager",useButtons:!1,buttonsConfig:{device:{desktop:!0,tablet:!1,mobile:!1}}},a);var g=new mvideo.Class.TabsNewSG($(this),a),h=g.tabsMenu.$.menu,i=g.tabsMenu.$.items,j=g.tabsButtons;return function(){h.on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(a){h.css("transition","0s")}),g.$.holder.on("tabs.getItemContent.before",function(){$(a.compareTableHeadingWrapper).hide(),$(a.comparePager).hide()}),g.$.holder.on("tabs.getItemContent.after",function(b,c){var d=c instanceof jQuery?c:$(c);d.find(a.compareTableHeadingWrapper).show(),d.find(a.comparePager).show()}),b(),c()}(),{tabs:g,desktopBehavior:a.buttonsConfig.device.desktop?e:f,tabletBehavior:a.buttonsConfig.device.tablet?e:f,mobileBehavior:a.buttonsConfig.device.mobile?e:f}}),mvideo.Module.define("vertical-equalizer",function(a,b,c){function d(){h.initialize(),h.setNormalizedParam()}var e=$(this),f=e.find(a),g=e.find(b),h=new mvideo.Class.VerticalIndentEqualizer(e,{needRecalc:!0,selectors:{items:f,wrapper:g},alignMax:!!c});mvideo.Event.subscribe("resize",h.reinit.bind(h)),$(window).on("load",function(){navigator.userAgent.indexOf("Safari")>-1&&-1==navigator.userAgent.indexOf("Chrome")&&-1==navigator.userAgent.indexOf("Mobile")&&d()}),d()}),function(){mvideo.Module.define("accept-mechanics",function(a){function b(){["c-quest-progress__list-item_success","c-quest-progress__list-item_failed"].forEach(function(a){d.find("."+a).prev().addClass(a+"-line")})}function c(){d.find(a.questDiscardForm).submit()}a=$.extend(!0,{formId:"form",list:".c-quest-progress__list",questionsLeft:".c-quest-progress__remains",spinnerClass:"u-load",discardTooltipTitle:"",discardLink:"#discardLink",questDiscard:"#questDiscard",questDiscardForm:"#questDiscardForm",progressStatus:".c-quest-progress__status",refreshBell:!1,counter:0},a);var d=$(this),e=parseInt(a.counter),f=$(".c-amount-indicator.header-user-pic__promolist-amount"),g=$(".c-amount-indicator.header-user-drop-down__promolist-amount"),h=$(".navigation-item__indicator-amount"),i=new mvideo.Class.ListStateManager(this,{ajaxResponseName:"acceptMechanics",doReinitContent:!0,allowHtml:!0,selectors:{list:a.list,questionsLeft:a.questionsLeft,progressStatus:a.progressStatus}}),j=d.find(a.discardLink),k=new mvideo.Class.Tooltip(j,{title:a.discardTooltipTitle,side:"bottom",contentAsHTML:!0,trigger:"click",triggerOpen:{click:!0,tap:!0},triggerClose:{click:!0,tap:!0,scroll:!0}}),l=null;mvideo.Event.subscribe("formValid",function(b,c){var e,f;c===a.formId&&(f=mvideo.instance.page.page.validationForms[c],f.currentElements.addClass(a.spinnerClass).attr("readonly","readonly"),e=d.find("#"+c),i.get(e.attr("action"),e.serialize()))}),mvideo.Event.subscribe("listchange",function(a,c){"acceptMechanics"===c.listName&&b()}),b(),k.tooltip?k.tooltip.tooltipster("instance").on("ready",function(b){$(b.tooltip).find(a.questDiscard).on("click",c)}):k.popup&&k.popup.$.template.find(a.questDiscard).on("click",c),a.refreshBell&&(e>0?(f.text(e),g.text(e),h.text(e)):(f.addClass("hidden"),g.closest(".header-user-drop-down-item").addClass("hidden").empty(),h.closest(".navigation-item").addClass("hidden"),l=$(".comparelist-amount").first().text(),mvideo.Event.publish("listchange",{listName:"comparisonMenu",changedData:{productCount:{newValue:l}}})))})}(),window.mvideo.Module.define("account-manager",function(a){a=$.extend(!0,{eventSelect:".js-form__change-phone"},a);var b=$(this);$(a.eventSelect).on("load-content.always",function(){b.hide()}).on("pseudo-form.cancel",function(){b.show(),$(a.eventSelect).empty()})}),mvideo.Module.define("add-bonus-card-code",function(){function a(a){b();var d=$("<div></div>").addClass("text-error").text(a);c.after(d)}function b(){c.next(".text-error").remove()}var c=$(this),d=$("#verif-code-card"),e=new mvideo.Class.Overlay(c,!0),f=c.data("error-message")||"Извините, произошла ошибка. Обновите страницу и повторите попытку.";c.on("click",function(b){b.preventDefault();var g=c.data("content-url"),h=$("#recaptcha-sms-checkbox"),i=null,j=window.mvideo.helpers.inputs.getData(".verif-code-recaptcha"),k=h.closest(".verif-code-recaptcha");(i=!(!k.hasClass("hidden")&&!k.hasClass("u-hidden"))||(!h.length||h.valid()))&&$.ajax({type:"POST",url:g,dataType:"json",data:$.extend(!0,{sendAlert:!0},j),cache:!1,beforeSend:function(){e.show()},success:function(b){b=b||{},b.status&&"error"===b.status&&b.errorMessage?a(b.errorMessage):b.status&&"success"===b.status&&b.textMessage?(c.addClass("hidden"),d.removeClass("hidden"),d.find(".verif-code-message").html(b.textMessage),mvideo.Event.publish("verification-code-show",b)):a(f)},error:function(){a(f)},complete:function(){e.hide()}})})}),mvideo.Module.define("add-bonus-card-switcher",function(){function a(){var a=c.filter(":checked").attr("id").split("-")[0];$(".wrapper-bc-type-form").addClass("hidden").filter(".wrapper-"+a+"-bonus-card").removeClass("hidden")}var b=$("#js-switch-add-bonus-card"),c=b.find(":radio"),d=$("#register-bc-form");$('#js-switch-add-bonus-card input[type="radio"]').change(a),a(),function(){d.hasClass("disable-partialy")&&b.addClass("disable-partialy")}()}),mvideo.Module.define("bonus-card-type-switcher",function(){function a(){var a=c.filter(":checked").attr("id").split("-").pop();$(".wrapper-bc-form").addClass("hidden").filter(".wrapper-bc-"+a).removeClass("hidden")}function b(){var a=$(".wrapper-bc-warning-info");a.removeClass("hidden"),d.is(":unchecked")&&a.addClass("hidden")}var c=$("#js-switch-bc-type").find(":radio"),d=$("#addToProfile");a(),b(),c.change(function(){a()}),d.change(function(){b()})}),mvideo.Module.define("addParentClass",function(a){$(a).on("show",function(a){"custom-tooltip"!=$(a.target).data("init")&&$(this).parent().addClass("accordion-opened")}).on("hidden",function(a){"custom-tooltip"!=$(a.target).data("init")&&$(this).parent().removeClass("accordion-opened")})}),window.mvideo.Module.define("add-store-locator",function(a){function b(){var a=JST[c.tpl]({data:c.tplData});d.html(a),mvideo.Class.ReinitContent.reinit(d.find(".c-store"))}var c=$.extend(!0,{tpl:"jade/components/store/tpl-store-page",tplData:{messages:[]},showEvent:"add-store-locator.show"},a||{}),d=$(this),e=!1;d.is(":visible")?b():d.on(c.showEvent,function(){d.is(":visible")&&(e?mvideo.Event.publish("resize-map"):(b(),e=!0))})}),mvideo.Module.define("addToBasket",function(a){function b(){$.post(v,u.serialize(),function(a){c(a)&&(a=$.parseJSON(a));l=a.htmlContent,m=a.count,n=a.inBasket,o=a.availability,p=a.message}).fail(function(){j(a.errorText),r=!0}).then(function(){(o||n)&&!o&&n?d():j(p),y.text(m),x.html(l),k(),mvideo.Event.publish("added-to-basket"),r=!0}).always(function(){f(),a.showPopup&&h(),C.update()})}function c(a){try{JSON.parse(a)}catch(a){return!1}return!0}function d(){w.removeClass("default"),y.css("display","block"),t.addClass(a.successButtonClass).removeClass(a.buttonIcon).addClass(a.successIcon),a.successButtonText&&t.val(a.successButtonText),a.event.trigger&&$(a.event.holder).trigger(a.event.name,"add"),a.showPopup&&i()}function e(){$(a.popupContent).on("load-content.waiting",a.skeletonSelector,function(){var b,c=$(this);"mobile"!==mvideo.device.manager.getType()&&(b=c.closest(a.popupBlock),b.css({"vertical-align":"top",top:b.position().top}))})}function f(){q.toggleClass("c-popup_add-to-basket_loading")}function g(){window.mvideo.Event.publish("hide.pdp-c-popup"),a.showPopup&&(B=new mvideo.Class.Popup(q,{functionFormat:function(){return $("<div></div>")},ajaxUrl:!1,template:a.popup.template,classes:a.popup.classes,additionalCloseButton:a.popup.additionalCloseButton,seleniumAttribute:a.popup.seleniumAttribute,contentAsHTML:a.popup.contentAsHTML}),B.show(),h(),B.destroy())}function h(){$(".c-popup__content").toggleClass("c-popup_add-to-basket_hide c-popup_add-to-basket_loading")}function i(){a.showPopup&&(e(),$.get(a.popup.ajaxUrl).then(function(a){B._setContent(a,!0)}))}function j(b){a.showPopup?B._setContent(b,!0):a.showErrorTooltip?z=new mvideo.Class.Tooltip(q,{trigger:"click",title:b,contentAsHTML:!0}):(B=new mvideo.Class.Popup(q,{title:b,ajaxUrl:!1,classes:a.popup.classes,seleniumAttribute:a.popup.seleniumAttribute,contentAsHTML:a.popup.contentAsHTML}),B.show(),B.destroy())}function k(){y.css("font-size",0),y.css("line-height",0),y.animate({fontSize:"1.3rem","line-height":"1.8rem"},300)}a=$.extend(!0,{miniBasketParent:".mini-basket-block",miniBasketContent:".mini-basket-content",miniBasketCounter:".mini-basket-amount",formId:"add-to-basket-form",errorText:"Нет ответа сервера.",successText:"Товар уже находится в корзине",showTooltip:!0,showErrorTooltip:!1,tooltip:{trigger:"click",title:a.successText,contentAsHTML:!0},popup:{template:mvideo.template.popup({affix:!0,selector:".c-popup.c-popup_add-to-basket"}),ajaxUrl:"/sitebuilder/blocks/addToBasketPopup",classes:["extra-large","with-button","with-title","add-to-basket","affix"],additionalCloseButton:".u_close_popup",seleniumAttribute:"div-popup_content",contentAsHTML:!0},popupContent:".c-popup__content",popupBlock:".c-popup__block",skeletonSelector:".c-accessories-skeleton",event:{trigger:!1}},a);var l,m,n,o,p,q=$(this),r=!0,s=q.attr("data-id"),t=$(".add-to-basket-button[data-id='"+s+"']"),u=$("#"+a.formId),v=u.attr("action"),w=$(a.miniBasketParent),x=$(a.miniBasketContent),y=$(a.miniBasketCounter),z=a.showTooltip?new mvideo.Class.Tooltip:"",A=!1,B=new mvideo.Class.Popup,C=new mvideo.Class.LazyLoad;q.on("click",function(){!q.hasClass(a.successIcon||a.successButtonClass)&&r?(r=!1,f(),g(),b()):a.cartUrl?window.location.href=a.cartUrl:a.showTooltip&&!A&&(z=new mvideo.Class.Tooltip(q,a.tooltip),z.show(),A=!0)})}),window.mvideo.Module.define("add-to-wallet",function(a){function b(){if(o.close(),i.notificationInsteadRequest)c(p.error,i.notificationInsteadRequest);else{var a=new XMLHttpRequest,b=l.attr("action"),h=l.attr("method"),j=l.serialize();n.show(null,!0),a.onreadystatechange=function(){4==a.readyState?(200==a.status?i.isLoadFile?e(a.response):d(a.response):g(a),f()):2==a.readyState&&(200==a.status?a.responseType=i.isLoadFile?"blob":"json":a.responseType="text")},a.open(h,b,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(j)}return!1}function c(a,b){o.replace({type:a,text:b})}function d(a){(a="string"==typeof a?JSON.parse(a):a)&&a.content&&(a.content.hasOwnProperty("redirectTo")?window.location=a.content.redirectTo:c(p[a.status],a.content))}function e(a){var b=window.URL||window.webkitURL,c=j.find(i.link);h&&b.revokeObjectURL(h),h=b.createObjectURL(a),c.attr("href",h),c[0].click()}function f(){n.hide()}function g(a){var b=a.responseText,d=a.status;b&&d<500?c(p.error,b):c(p.error,i.defaultError)}var h,i=$.extend(!0,{overlayHolder:".c-add-to-wallet__link",isLoadFile:!1,notificationHolder:".c-add-to-wallet__notifications",link:".js-get-file",notificationInsteadRequest:"",notificationConfig:{notificationParams:{smallText:!0,useColorForText:!0,onlyText:!0,notificationAttrs:{"data-sel":"your-bonus-notification-add_to_wallet"},notificationTitleAttrs:{"data-sel":"your-bonus-notification_text-add_to_wallet"}}},defaultError:"Сервис временно недоступен"},a||{}),j=$(this),k=i.overlayHolder?j.find(i.overlayHolder):j,l=j.find("form"),m=j.find(i.notificationHolder),n=new mvideo.Class.Overlay(k,null,"ajax-overlay_opacity-9 ajax-overlay_black"),o=new mvideo.Class.Notification(m,i.notificationConfig),p={success:"success",error:"error"};l.submit(b)}),mvideo.Module.define("setYouTubeBackground",function(a){var b=$(this),c={ratio:16/9,videoId:"",mute:!0,repeat:!0,width:$(window).width(),wrapperZIndex:99,increaseVolumeBy:10,start:0},d=function(a,b,d){d=d||0,b=$.extend({},c,b);var e=$(a),f="youtubebg-container-"+d,g="youtubebg-player-"+d,h='<div id="'+f+'" style="overflow: hidden; z-index: 1; width: 100%; height: 100%"><div id="'+g+'" style="position: absolute"></div></div><div id="tubular-shield" style="width: 100%; height: 100%; z-index: 2; position: absolute; left: 0; top: 0;"></div>';e.prepend(h),window.players[d]=new window.YT.Player(g,{width:b.width,height:Math.ceil(b.width/b.ratio),videoId:b.videoId,playerVars:{controls:0,showinfo:0,modestbranding:1,wmode:"transparent"},events:{onReady:function(a){i(),b.mute&&a.target.mute(),a.target.seekTo(b.start),a.target.playVideo()},onStateChange:function(a){0===a.data&&b.repeat&&window.players[d].seekTo(b.start)}}});var i=function(){var a,c,d=$(window).width(),e=$("#"+g),f=e.closest(".TIBlock-image-wrap").height();d/b.ratio<f?(a=Math.ceil(f*b.ratio),e.width(a).height(f).css({left:(d-a)/2,top:0})):(c=Math.ceil(d/b.ratio),e.width(d).height(c).css({left:0,top:(f-c)/2}))};$(window).on("resize.youtubeBackground",function(){i()})},e=function(a,b){b=b||{};var c=$.data(document.body,"youTubeBackgroundItr");a.each(function(){var a=$(this),e=/\/([\w\d]+)(\?[\w\d=&]+)?$/,f=e.exec(a.attr("data-original"));f&&(void 0===c?c=0:c++,b.videoId=f[1],d(this,b,c))}),$.data(document.body,"youTubeBackgroundItr",c)},f=document.createElement("script");f.src="//www.youtube.com/iframe_api";var g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(f,g),window.players=window.players||{},window.setYouTubeBackgroundQueue=window.setYouTubeBackgroundQueue||[],window.onYouTubeIframeAPIReady=function(){for(var a=0;window.setYouTubeBackgroundQueue[a];a++)window.setYouTubeBackgroundQueue[a]()},"undefined"==typeof YT?window.setYouTubeBackgroundQueue.push(function(){e(b,a)}):e(b,a)}),mvideo.Module.define("additionalFieldsLoad",function(a,b){function c(b){var c=$("<div />").html(b).find(a),d=$(a,e);c.each(function(a,b){var c,e=$(b).attr("id"),f=d.filter("#"+e);f.length?(c=$(b).children(".search-advanced-wrapper"),f.append(c)):(c=$(b),d.last().after(c))}),h.reinit(e.find("select")),mvideo.instance.page.page.goToBlock($("body")),f.hide(),g.hide()}function d(){g.hide()}var e=$(this),f=$(b,e),g=new mvideo.Class.Overlay(e),h=new mvideo.Class.CustomSelect,i=$(":submit",e);f.on("click",function(a){a.preventDefault(),g.show(),$.ajax({url:f.data("url"),type:"GET",success:c,error:d})}),i.on("click",function(a){g.show()})}),mvideo.Module.define("affix",function(a){function b(){d=f.parents(a.offsetContentSelector),e=f.outerHeight()||0,d.css({paddingTop:e,minHeight:"calc(100% - "+e+"px)"})}function c(){return f.hasClass("affix")||(a.topOffset=f.offset().top+(a.targetSelector&&$(a.targetSelector).length?$(a.targetSelector).scrollTop()-$(document).scrollTop():0)-a.topAffixOffset),a.topOffset}var d,e,f=$(this),g=a&&a.targetSelector||window;a=$.extend(!0,{topAffixOffset:12,fnTop:!1,offsetContentSelector:""},a),f.removeClass("affix affix-top affix-bottom"),a.offsetContentSelector&&(b(),f.on("resize",b)),a.fnTop||a.hasOwnProperty("topOffset")||c(),$(window).on("resize",function(){var a=f.hasClass("affix");a&&f.removeClass("affix"),f.data("bs.affix")&&(f.data("bs.affix").options.offset.top=c()),a&&f.addClass("affix")}),f.affix({offset:{top:a.fnTop?c:a.topOffset},target:g})}),window.mvideo.Module.define("aggregated-reviews",function(a){var b=$(this),c=$.extend(!0,{},a);new mvideo.Class.AggregatedReviewsManager(b,c).showBlock()}),mvideo.Module.define("ajax-aviability",function(a){function b(){$.post(a.ajaxUrl,function(a){a=c(a),d=a.availability,e=a.message}).fail(function(){h=new mvideo.Class.Tooltip(f,{trigger:"click",title:a.errorMessage}),h.show()}).then(function(){d?f.submit():g||(h=new mvideo.Class.Tooltip(f,{trigger:"click",title:e,contentAsHTML:!0}),h.show(),g=!0)})}function c(a){try{JSON.parse(a)}catch(b){return a}return JSON.parse(a)}a=$.extend(!0,{ajaxUrl:"/sitebuilder/blocks/cart/fragments/mini-basket-filled.jsp",errorMessage:"Сервер не ответил"},a);var d,e,f=$(this),g=!1,h=new mvideo.Class.Tooltip(f);f.on("click",function(a){a.preventDefault(),a.stopPropagation(),b()})}),window.mvideo.Module.define("ajax-category-carousel",function(a){var b=$(this),c=$.extend(!0,{container:".gallery-content",element:".c-pseudo-tabs__item",link:"a"},a),d=b.find(c.container),e=new window.mvideo.Class.Overlay(d);b.off("click.CategoryCarousel",c.element).on("click.CategoryCarousel",c.element,function(a){var b=$(this).find(c.link).attr("href");$.ajax({url:b,cache:!1,dataType:"json",method:"GET",beforeSend:function(a){e.show()}}).done(function(a,b){a&&a.carousel&&(d.html(a.carousel),window.mvideo.Class.ReinitContent.reinit(d))}).always(function(){e.hide()})})}),mvideo.Module.define("ajax-like-dislike",function(a){function b(a){var b=c.find(d.btnLike+"."+d.activeClass),e=b.find(d.btnLikeCounter),f=parseInt(e.text(),10),g=a.find(d.btnLikeCounter),h=parseInt(g.text(),10);b.is(a)?(a.removeClass(d.activeClass),g.text(h-1)):(b.removeClass(d.activeClass),e.text(f-1),a.addClass(d.activeClass),g.text(h+1))}var c=$(this),d=$.extend(!0,{btnLike:".c-comments-list__rating-btn",btnLikeCounter:".c-comments-list__rating-counter",activeClass:"c-comments-list__rating-icon_active",errorPopupContent:{title:"Произошла ошибка сервера",message:"Пожалуйста, повторите попытку позже.",buttonText:"Закрыть"}},a),e=new window.mvideo.Class.ErrorPopup(c,d.popupConfig);c.on("click",d.btnLike,function(a){a.preventDefault();var c=$(this),f=c.find("form");$.ajax({type:"POST",url:f.attr("action"),data:f.serialize()}).success(function(a){a.isRateSuccess?b(c):(e.setContent({message:a.errorMessage}),e.show())}).fail(function(a){e.setContent(d.errorPopupContent),e.show()})})}),mvideo.Module.define("ajax-load-bundle",function(a){function b(a){c.find("."+d.bundleActiveClass).removeClass(d.bundleActiveClass),a.addClass(d.bundleActiveClass)}var c=$(this),d=$.extend(!0,{url:"/",method:"GET",tabSelector:".c-pseudo-tabs__item",tabActiveClass:"c-pseudo-tabs__item_active",bundlesSelector:".c-strict-bundle__list-item",bundleActiveClass:"c-strict-bundle__list-item_active",bundleWrapper:".c-bundle__list-wrap"},a),e=new mvideo.Class.Overlay(c,!0);c.on("click",d.tabSelector,function(a){var f=$(this),g=f.data("name"),h=c.find(d.bundlesSelector+'[data-name="'+g+'"]');if(a.preventDefault(),""===h.html().trim())$.ajax({type:d.method,url:d.url,beforeSend:function(){e.show()},data:{blockId:g}}).success(function(a){"success"===a.status&&(a.htmlContent&&h.html(a.htmlContent),b(h),mvideo.Class.ReinitContent.reinit(h))}).always(function(){e.hide()});else{var i=h.find(d.bundleWrapper);b(h),mvideo.device.manager.getType()===mvideo.device.manager.TYPES.TABLET?i.trigger("reinit.Swipe"):mvideo.device.manager.getType()===mvideo.device.manager.TYPES.DESKTOP&&i.trigger("reinit.Carousel")}})}),mvideo.Module.define("ajax-related-products-carousel",function(a){var b=$(this),c=b.find(a.childContainer),d=!1,e=document.location.href,f=$("#js-product-tabs").find(".c-tabs__menu-link"),g=!0,h=$.extend(!0,{childContainer:".related-products-carousel",spinner:"o-pdp-related-products"},a||{});f.each(function(a){if(-1!==e.indexOf("/"+$(this).data("target")))return g=!1,!1}),$(window).one("mousewheel.RelatedProducts",function(){d=!0}),h.url&&$.ajax({type:"GET",url:a.url,data:a.data||null,success:function(a){c.append(a),mvideo.Class.ReinitContent.reinit(c)}}).always(function(){c.removeClass(h.spinner),setTimeout(function(){
g||d||mvideo.instance.productTabs.tabs.goToActiveItem(".c-tabs__body.active")})})}),mvideo.Module.define("ajax-reviews-filters",function(a){var b=$.extend(!0,{container:".reviews-ext-list",element:".c-pseudo-tabs__item",loadLayer:".review-ext-header-transparency",link:"a"},a),c=$(b.container);c.off("click.ReviewsFilters",b.element).on("click.ReviewsFilters",b.element,function(a){var d=$(this).find(b.link).attr("href");$.ajax({url:d,cache:!1,dataType:"json",method:"GET",beforeSend:function(a){c.find(b.loadLayer).show()}}).done(function(a,b){c.html(a.reviews),mvideo.Class.ReinitContent.reinit(c)}).always(function(){c.find(b.loadLayer).hide()})})}),mvideo.Module.define("ajax-send-comment",function(a){var b=$(this),c=$.extend(!0,{overlayClass:".ajax-overlay",successSendingLayer:".c-comment-form__success",hiddenClass:"u-hidden",errorPopupContent:{title:"Произошла ошибка сервера",message:"Пожалуйста, повторите попытку позже.",buttonText:"Закрыть"}},a),d=b.find(c.overlayClass),e=b.find(c.successSendingLayer),f=new window.mvideo.Class.ErrorPopup(b,c.popupConfig);b.on("submit",function(a){a.preventDefault(),b.valid()&&(d.removeClass(c.hiddenClass),$.ajax({type:"POST",url:b.attr("action"),data:b.serialize()}).success(function(a){a.isRateSuccess?(e.removeClass(c.hiddenClass),b[0].reset()):(f.setContent({message:a.errorMessage}),f.show())}).fail(function(a){f.setContent(c.errorPopupContent),f.show()}).always(function(){d.addClass(c.hiddenClass)}))})}),window.mvideo.Module.define("ajax-send-promocode",function(a){function b(){i.on("input",function(){j!=i.val()&&d.find(".o-promo-code__information").hide()}),d.off("click."+e.namespace,e.linkGoBack).on("click."+e.namespace,e.linkGoBack,function(){$(e.stageSelector,d).val(e.valueStageChange),d.find(e.buttonSelector).trigger("click")}),d.find(e.buttonSelector).off("click."+e.namespace).on("click."+e.namespace,function(a){d.valid()&&c()}),d.find(e.inputConfirmSelector).off("change."+e.namespace).on("change."+e.namespace,function(a){d.valid()&&c()}),d.find(e.linkRequestSelector).off("click."+e.namespace).on("click."+e.namespace,function(a){a.preventDefault(),a.target.hasAttribute("data-change-stage")&&$('[name="stage"]',d).val(a.target.getAttribute("data-change-stage")),c()})}function c(){$.ajax({type:"POST",url:d.attr("action"),data:d.serialize(),beforeSend:function(){h.show(),i.attr("readonly",!0)}}).success(function(a){"error"===a.stage?$("#order-"+g).trigger(e.namespace,{status:a.stage,message:a.message,gtmPush:a.gtmPush,amount:a.amount}):"success"===a.stage?($("#order-"+g).trigger(e.namespace,{gtmPush:a.gtmPush,amount:a.amount,status:"success",noClosePopup:!0,reloadTimeout:e.reloadTimeout}),d.html(a.html)):(a.gtmPush&&$("#order-"+g).trigger(e.namespace,{gtmPush:a.gtmPush,status:a.stage,noClosePopup:!0}),d.html(a.html),window.mvideo.Class.ReinitContent.reinit(d),b())}).fail(function(a){$("#order-"+g).trigger(e.namespace,{status:"error",message:e.errorMessage})}).always(function(){h.hide()})}var d=$(this),e=$.extend(!0,{buttonSelector:".o-promo-code__btn .c-btn",inputConfirmSelector:".c-code-confirm__field-sms-code .c-text-field__input",linkRequestSelector:".c-code-confirm__btn-request",inputOrderId:'[name="orderId"]',namespace:"apply-promocode",inputSelector:"input.c-text-field__input",linkGoBack:".o-promo-code__go-back",valueStageChange:"stage-1",stageSelector:'[name="stage"]',reloadTimeout:8e3,errorMessage:"Сервис по применению промокода временно недоступен"},a),f=d.find(e.inputOrderId),g=f.val(),h=new window.mvideo.Class.Overlay(d),i=d.find(e.inputSelector),j=i.val();b()}),mvideo.Module.define("ajax-breadcrumbs",function(){var a=new mvideo.Class.AsyncDataLoader,b=".o-main-toolbar";a.addModule({container:b,dataAdapter:function(a){for(var b=0;b<a.length;b++)if(a[b].breadcrumbs)return{breadcrumbs:a[b].breadcrumbs}},onDataHandler:function(a,c,d){try{a.breadcrumbs&&($(b).find(".o-main-toolbar__breadcrumbs").remove(),$(b).append(a.breadcrumbs),mvideo.Class.ReinitContent.reinit($(b).find(".c-breadcrumbs__list")))}catch(a){}},moduleName:"ajax-breadcrumbs"})}),mvideo.Module.define("ajax-collections",function(a){var b=new mvideo.Class.AsyncDataLoader,c=$.extend(!0,{container:".c-collections__bottom",topContainer:".c-collections__top",bottomContainer:".c-collections__bottom",elementClass:".c-list-of-links__item"},a),d=$(c.container),e=new mvideo.Class.Page(".page-content");b.addModule({container:c.container,dataAdapter:function(a){for(var b={},c=0;c<a.length;c++)if(a[c].collections){b=a[c].collections;break}return b},onDataHandler:function(a){try{if("string"==typeof a.topCollections){var b=$(c.topContainer);b.html(a.topCollections),mvideo.Class.ReinitContent.reinit(b.find(".c-pseudo-tabs"))}if("string"==typeof a.bottomCollections){var d=$(c.bottomContainer);d.html(a.bottomCollections),mvideo.Class.ReinitContent.reinit(d)}}catch(a){}},moduleName:"ajax-collections"}),d.off("click.Collections",c.elementClass).on("click.Collections",c.elementClass,function(a){var c=$(this),d=c.attr("href")||c.find("a").attr("href"),f=c.attr("data-client-prev-action");if(a.preventDefault(),f){var g=$.parseJSON(f);for(var h in g){var i="&"+h+"=([^&]$|[^&]*)",j=new RegExp(i,"i");d=d.replace(j,"")}}b.load({url:d},a).done(function(){e.goToBlock($("body"),0,{duration:400,easing:"easeOutCirc"})})})}),mvideo.Module.define("ajax-content-replace",function(a){a=a||{};var b=new mvideo.Class.AsyncDataLoader,c=a.container||"";b.addModule({container:c,dataAdapter:function(a){for(var b=0;b<a.length;b++)if(a[b].contentDynamicReplace)return{contentDynamicReplace:a[b].contentDynamicReplace}},onDataHandler:function(a){if(a.contentDynamicReplace)for(var b in a.contentDynamicReplace){var c=$(b);c.length&&(c.empty().append(a.contentDynamicReplace[b]),mvideo.Class.ReinitContent.reinit(c))}},moduleName:"ajax-content-replace"})}),window.mvideo.Module.define("ajax-content",function(a){a=$.extend({namespace:"ajax-notification",nameResponse:"notification"},a);var b=new mvideo.Class.AsyncDataLoader,c=$(this);b.subscribe("loaded",function(b,d){d.hasOwnProperty(a.nameResponse)&&c.html(d[a.nameResponse])}),b.addModule({container:c,dataAdapter:function(b){var c=b.find(function(b){return b.hasOwnProperty(a.nameResponse)});if(c)return $.extend({},c)},moduleName:a.namespace})}),window.mvideo.Module.define("ajax-footer",function(){var a=new mvideo.Class.AsyncDataLoader,b="ajaxFooter",c=$(this);a.addModule({container:c,dataAdapter:function(a){for(var c=0;c<a.length;c++)if(a[c][b]){var d={};return d[b]=a[c][b],d}},onDataHandler:function(a,d,e){try{a[b]&&(c.empty(),c.html(a[b]),window.mvideo.Class.ReinitContent.reinit(c))}catch(a){}},moduleName:"ajax-footer"})}),mvideo.Module.define("ajax-header-detectum",function(){var a=new mvideo.Class.AsyncDataLoader,b=$(this);a.addModule({dataAdapter:function(a){for(var b={},c=0;c<a.length;c++)if(a[c].headerDetectum){b.headerDetectum=a[c].headerDetectum;break}return b},onDataHandler:function(a){try{a.headerDetectum&&$(b).html(a.headerDetectum)}catch(a){}},moduleName:"ajax-header-detectum"})}),mvideo.Module.define("ajax-header-facets",function(a){var b=new mvideo.Class.AsyncDataLoader,c=$.extend(!0,{container:".promotion-plp-heading-facets",elementClass:".heading-facets-list-name",activeElementClass:"heading-facets-list-name_active",promotion:!1,isAccessories:!1},a),d=$(c.container),e=window.location.search.slice(1).split("&"),f={},g=c.activeElementClass,h=c.elementClass;e.forEach(function(a){var b=a.split("=");f[b[0]]=b[1]}),f.categoryId?d.find("[data-id="+f.categoryId+"]").addClass(g):c.promotion&&d.each(function(a,b){$(b).find(h).first().addClass(g)}),b.addModule({container:c.container,dataAdapter:function(a){for(var b={},c=0;c<a.length;c++)if(a[c].headerFacets){b.headerFacets=a[c].headerFacets;break}return b},onDataHandler:function(a){try{a.headerFacets&&d.html(a.headerFacets)}catch(a){}},moduleName:"ajax-header-facets"}),d.off("click.HeaderFacets",h).on("click.HeaderFacets",h,function(a){var e=$(this),f=e.attr("href")||e.find("a").attr("href"),h=e.attr("data-client-prev-action"),i=new mvideo.Class.PLPFacetSection;if(h){var j=$.parseJSON(h);for(var k in j){var l="&"+k+"=([^&]$|[^&]*)",m=new RegExp(l,"i");f=f.replace(m,"")}}if(d.find("."+g).removeClass(g),e.addClass(g),a.preventDefault(),c.isAccessories){var n=$("form.c-plp-facets");n.find("[data-facet-item] input:checked").not("[disabled]").attr("checked",!1),f=i.getUrl(n,n.data("base-url"),n.data("delimiter")),f!=document.location.href&&b.load({url:f},a)}else b.load({url:f},a)})}),mvideo.Module.define("ajax-header",function(){var a=new mvideo.Class.AsyncDataLoader,b=".search-results-heading-qty, .c-plp-category-title__amount, .c-plp-heading__count",c=$(this);a.addModule({container:b,dataAdapter:function(a){for(var b={},c=0;c<a.length;c++)(a[c].searchResultsNumber||0===a[c].searchResultsNumber)&&(b.searchResultsNumber=a[c].searchResultsNumber),a[c].headerContent&&(b.headerContent=a[c].headerContent);return b},onDataHandler:function(a){try{if(a.searchResultsNumber||0===a.searchResultsNumber){b=$(b);var d=b.text().replace(/\d+\s?\d*/,a.searchResultsNumber);b.html(d)}a.headerContent&&c.parent().find(".search-results-heading, .c-plp-category-title, .c-plp-heading__title .e-h1").contents().first().replaceWith(a.headerContent)}catch(a){}},moduleName:"ajax-header"})}),mvideo.Module.define("ajax-history",function(a){function b(a){var b=i.serialize();a&&(b+="&"+$.param(a)),h&&h.abort(),h=j.load({url:i.attr("action"),getParams:b,notUseHistory:!0})}function c(b){if(b.facetsContent&&d(k,b.facetsContent),b.listContent){d(l,b.listContent);var c=l.find(a.list).data(a.focusItem),e=l.find(a.listItem).eq(c);o.focusBlock(e)}b.notificationContent&&d(m,b.notificationContent)}function d(a,b){a.html(b),mvideo.initScripts(a)}function e(){b()}function f(c){var d=$(c.currentTarget),e=d.data(a.pagination);c.preventDefault(),b(e)}function g(c){if("desktop"!==c){var d=i.find(a.activePage).data(a.pagination);d&&1!==d.page&&("mobile"===c&&(d.all=!0),b(d))}}a=$.extend({facetsContainer:"[data-facets-content]",listContainer:"[data-history-content]",notificationContainer:"[data-notification-content]",pagination:"pagination-ajax-params",activePage:".c-pagination__num_active",popupMessage:'<div class="c-line-img order-status_error"><i class="c-line-img__icon i-icon-error c-line-img_red"></i>Извините, сервис временно недоступен. Попробуйте позже.</div>',focusItem:"focus-item",list:".c-history-list",listItem:".c-history-item"},a);var h,i=$(this),j=new mvideo.Class.AsyncDataLoader,k=i.find(a.facetsContainer),l=i.find(a.listContainer),m=i.find(a.notificationContainer),n=new window.mvideo.Class.ErrorPopup(i,a.popupConfig),o=new mvideo.Class.SmartFocus;return j.addModule({container:i,dataAdapter:function(a){for(var b={},c=0;c<a.length;c++)a[c].listContent&&(b.listContent=a[c].listContent),a[c].facetsContent&&(b.facetsContent=a[c].facetsContent),a[c].notificationContent&&(b.notificationContent=a[c].notificationContent);return b},onDataHandler:function(a,b,d){try{c(a)}catch(a){}},onError:function(b,c){"abort"!=c.statusText&&(n.setContent({message:a.popupMessage}),n.show())},moduleName:"ajax-history"}),i.on("change",e),i.on("click","[data-"+a.pagination+"]",f),{desktopBehavior:g.bind(this,"desktop"),tabletBehavior:g.bind(this,"tablet"),mobileBehavior:g.bind(this,"mobile")}}),window.mvideo.Module.define("ajax-load-link",function(a){var b=$(this),c=new mvideo.Class.AsyncDataLoader;b.on("click",'[data-ajax-load-link="true"]',function(a){var b=$(this).attr("data-href");b&&(a.preventDefault(),c.load({url:b}))})}),mvideo.Module.define("ajax-navigation-detectum",function(){var a,b,c=new mvideo.Class.AsyncDataLoader,d=".pagination-section",e=$(this);a=void 0!==e.data("scroll-to")&&e.data("scroll-to"),b=void 0!==e.data("scroll-offset")?$(this).data("scroll-offset"):0,c.addModule({container:d,dataAdapter:function(a){for(var b={},c=0;c<a.length;c++)a[c].pagination&&(b.pagination=a[c].pagination),a[c].topPagination&&(b.topPagination=a[c].topPagination),a[c].seoText&&(b.seoText=a[c].seoText);return b},onDataHandler:function(a,b,c){try{a.pagination&&($(d).parent().replaceWith(a.pagination),mvideo.Class.ReinitContent.reinit($(d).parent())),a.topPagination&&($(".top-pagination .pagination-section").parent().replaceWith(a.topPagination),mvideo.Class.ReinitContent.reinit($(".top-pagination .pagination-section").parent()));var e=$(".notes");a.seoText?(e.length?e.first().replaceWith(a.seoText):$(d).after(a.seoText),$(".top-pagination .notes").remove()):e.length&&e.remove()}catch(a){}},moduleName:"ajax-navigation"}),$(d).off("click",".pagination-section-content a").on("click",".pagination-section-content a",function(d){var e=$(this);e.hasClass("disabled")||(c.load({url:e.attr("href")},d),a?mvideo.instance.page.page.goToBlock(a,b):mvideo.instance.page.page.goTo())})}),mvideo.Module.define("ajax-navigation",function(a){var b,c,d=new mvideo.Class.AsyncDataLoader,e=$(this),f=$.extend(!0,{container:".pagination-section",topContainer:".top-pagination .pagination-section",topPaginationSeoText:".top-pagination .notes",pageLinkSelector:".pagination-section-content a",notUseHistory:!1},a);b=void 0!==e.data("scroll-to")&&e.data("scroll-to"),c=void 0!==e.data("scroll-offset")?$(this).data("scroll-offset"):0,d.addModule({container:f.container,dataAdapter:function(a){for(var b={},c=0;c<a.length;c++)a[c].pagination&&(b.pagination=a[c].pagination),a[c].topPagination&&(b.topPagination=a[c].topPagination),a[c].seoText&&(b.seoText=a[c].seoText);return b},onDataHandler:function(a,b,c){var d=$(f.container),e=d.parent();try{a.pagination&&(e.replaceWith(a.pagination),mvideo.Class.ReinitContent.reinit(e)),a.topPagination&&(e.replaceWith(a.topPagination),mvideo.Class.ReinitContent.reinit($(f.topContainer).parent()));var g=$(".notes");g.length&&g.remove(),a.seoText&&(d.after(a.seoText),$(f.topPaginationSeoText).remove(),mvideo.Class.ReinitContent.reinit(".notes"))}catch(a){}},onError:f.onError?function(){$(f.container).html("")}:"",moduleName:"ajax-navigation"}),$(f.container).off("click",f.pageLinkSelector).on("click",f.pageLinkSelector,function(a){var e,g=$(this),h=g.attr("href"),i=new mvideo.Class.Popup,j=a.target.getAttribute("data-client-prev-action"),k=[];if(k.push("sorting=true"),j){var l=$.parseJSON(j);for(var m in l){var n=m+"=([^&]$|[^&]*)",o=new RegExp(n,"i");h=h.replace(o,""),k.push(m+"="+l[m])}}e=k.join("&"),g.hasClass("disabled")||(d.load({url:h,getParams:e,notUseHistory:f.notUseHistory},a),b?(mvideo.instance.page.page.goToBlock(b,c),i.goTo(b,c)):(mvideo.instance.page.page.goTo(),i.goTo()))})}),window.mvideo.Module.define("ajax-notification",function(){var a=new mvideo.Class.AsyncDataLoader,b=$(this);a.addModule({container:b,dataAdapter:function(a){for(var b=0;b<a.length;b++)if(a[b].notification)return{notification:a[b].notification}},onDataHandler:function(a,c,d){try{a.notification?b.html(a.notification):b.html("")}catch(a){}},moduleName:"ajax-notification"})}),mvideo.Module.define("ajax-order-history",function(a){function b(a,b,c){a&&a.orders&&(a.orders.selected=c,a.orders.isMobile="mobile"===mvideo.device.manager.getType()),g(i,{},a,c.group),i.applyData(a)}function c(c,f,g){g.preventDefault();var h=$(g.currentTarget).data(c.data),j=i.getData();return d(j,h)?i.applyData({orders:{selected:h}}):((j.isMobile||"mobile"===mvideo.device.manager.getType())&&(h[a.getAllPagesParam]=!0),e(f,h).then(function(a){b(a,j,h)})),!1}function d(a,b){var c,d;if(a&&a.orders&&a.orders.groups){a=a.orders,d=null;for(c in a.groups)if(a.groups.hasOwnProperty(c)&&a.groups[c].id===b.group){d=a.groups[c];break}return!!(d&&d.pages&&d.pages[b.page])}return!1}function e(b,c){var d,f={},g=void 0===e.hadRequested;return g&&(f[a.getFullParam]=!0),d=$.ajax({dataType:"json",method:"GET",url:b,data:$.extend(!0,f,c)}),g&&d.then(function(a){return e.hadRequested=!0,a}),d}function f(a,b,c){var d,e;try{d=a.orders.groups[c].count}catch(a){}try{e=b.orders.groups[c].count}catch(a){}return!(!d||d!==e)}function g(a,b,c,d){(b=$.extend(!0,{},b))&&b.orders&&(f(b,c,d)&&b.orders.groups&&b.orders.groups[d]&&(b.orders.groups[d].page={}),b.orders.alerts&&(b.orders.alerts.length=0),a.setData(b,!1))}function h(a){i.getData().orders&&i.applyData({orders:{isMobile:!!a}})}a=$.extend(!0,{holder:this,url:"#",tpl:"order-history-holder",getFullParam:"isGetFullData",getAllPagesParam:"getAllPrevPages",reloaders:{click:{selector:"[data-ajax-click]",data:"ajax-click"}},needDataForFirstPage:!1},a||{});var i=new mvideo.Class.StoreWithTpl({tpl:new mvideo.Class.JadeTplLoader(a.tpl),holder:a.holder});return function(a,b,d){var e;d=d||document;for(e in b)b.hasOwnProperty(e)&&$(d).on(e,b[e].selector,c.bind(this,b[e],a))}(a.url,a.reloaders,a.holder),a.needDataForFirstPage&&function(){var c=a.reloaders.click,d=$(".active"+c.selector),f=d.data(c.data);f.page=1,e(a.url,f).then(function(a){b(a,{},f)})}(),$(a.holder).data("instance",i),{desktopBehavior:h.bind(this,!1),tabletBehavior:h.bind(this,!1),mobileBehavior:h.bind(this,!0)}}),mvideo.Module.define("ajax-order-requests",function(a){function b(b,c){var d,f;c&&c.orders&&(d=c.orders.groups&&c.orders.groups["g-"+b.group],f=c.orders.groups&&d&&!$.isEmptyObject(d.pages),f?e():h.clearCache(a.url,b),c.orders.selected=b,c.orders.isMobile="mobile"===mvideo.device.manager.getType(),g.applyData(c))}function c(a,b){return b.preventDefault(),d($(b.currentTarget).data(a.data)),!1}function d(c){(g.getData().isMobile||"mobile"===mvideo.device.manager.getType())&&(c[a.getAllPagesParam]=!0),h.getData({data:c,url:a.url,done:function(a){b(c,a)}})}function e(){var a=g.getData(),b=$.isEmptyObject(a)?{}:a.orders.selected,c={orders:{groups:{}}};$.isEmptyObject(b)||(c.orders.groups["g-"+b.group]={pages:[]},g.applyData(c,!0))}function f(a){var b,c=g.getData();c.orders&&(b=c.orders.selected.page,a&&1!==b?(g.applyData({orders:{isMobile:!!a}},!0),d(c.orders.selected)):g.applyData({orders:{isMobile:!!a}}))}a=$.extend(!0,{holder:this,url:"#",tpl:"order-history-holder",getAllPagesParam:"getAllPrevPages",reloaders:{click:{selector:"[data-ajax-click]",data:"ajax-click"}},initState:{}},a||{});var g=new mvideo.Class.StoreWithTpl({tpl:new mvideo.Class.JadeTplLoader(a.tpl),holder:a.holder}),h=new mvideo.Class.LoadCacheController;return g.applyData(a.initState,!0),function(a,b){var d=Object.keys(a);b=b||document;for(var e=0;e<d.length;e++)$(b).on(d[e],a[d[e]].selector,c.bind(this,a[d[e]]))}(a.reloaders,a.holder),$(a.holder).data("instance",g),{desktopBehavior:f.bind(this,!1),tabletBehavior:f.bind(this,!1),mobileBehavior:f.bind(this,!0)}}),mvideo.Module.define("ajax-pickup-store",function(a){function b(a){c.load({url:$(this).find(":selected").val()},a)}a=a||{};var c=new mvideo.Class.AsyncDataLoader,d=a.container||".search-results-availability",e=$(a.targetSelector||"#availability-filter"),f=e.find("[selected]");f.length&&$(d).find(".center").html(f.html()),c.addModule({moduleName:"ajax-pickup-store",container:d,dataAdapter:function(a){for(var b=0;b<a.length;b++)if(a[b].searchPickupStore)return{searchPickupStore:a[b].searchPickupStore}},onDataHandler:function(a){try{a.searchPickupStore&&($(d).replaceWith(a.searchPickupStore),mvideo.Class.ReinitContent.reinit(d))}catch(a){}}}),e.off("change",b).on("change",b)}),mvideo.Module.define("ajax-pickup-today",function(a){function b(a){c.load({url:$(this).data("ajaxUrl")},a)}a=a||{};var c=new mvideo.Class.AsyncDataLoader,d=a.container||".search-results-delivery-date",e=$(a.targetSelector||"#today-filter");c.addModule({moduleName:"ajax-pickup-today",container:d,dataAdapter:function(a){for(var b=0;b<a.length;b++)if(a[b].searchPickupTodayOnly)return{searchPickupTodayOnly:a[b].searchPickupTodayOnly}},onDataHandler:function(a){try{a.searchPickupTodayOnly&&($(d).replaceWith(a.searchPickupTodayOnly),mvideo.Class.ReinitContent.reinit(d))}catch(a){}}}),e.off("change",b).on("change",b)}),mvideo.Module.define("ajax-products",function(a){var b=new mvideo.Class.AsyncDataLoader,c=a||".product-tiles-list";b.addModule({container:c,dataAdapter:function(a){var b={};b.products=[];for(var c=0;c<a.length;c++)(a[c].searchResultsFirstPart||""===a[c].searchResultsFirstPart)&&b.products.push(a[c].searchResultsFirstPart),(a[c].searchResultsSecondPart||""===a[c].searchResultsSecondPart)&&b.products.push(a[c].searchResultsSecondPart);return b},onDataHandler:function(a){try{if(a.products&&a.products.length>0){if(c=$(c),c[0===a.searchResultsNumber?"addClass":"removeClass"]("no-search-results"),1===a.products.length)$(c[0]).empty().append(a.products[0]),$(c[1]).empty();else for(var b=0;b<a.products.length;b++)$(c[b]).off().empty().append(a.products[b]);var d=new mvideo.Class.LazyLoad;new mvideo.Class.ProductListCollection(".o-plp-container__product-listing","grid",null,"new"),d.add(c),mvideo.initScripts($(c).parent())}}catch(a){}},moduleName:"ajax-products"})}),mvideo.Module.define("ajax-seo-text",function(a){var b=new mvideo.Class.AsyncDataLoader,c=$.extend(!0,{seoBlock:".o-plp-container__info"},a);b.addModule({container:c.container,dataAdapter:function(a){for(var b={},c=0;c<a.length;c++)if(a[c].seoText){b.seoText=a[c].seoText;break}return b},onDataHandler:function(a){try{var b=$(c.seoBlock);b.html(a.seoText),mvideo.Class.ReinitContent.reinit(b)}catch(a){}},moduleName:"ajax-seo-text"})}),mvideo.Module.define("ajax-sort-detectum",function(){function a(a){var b=new mvideo.Class.DetectumSearchInvoker;b.changeSort(a.target.value),b.invoke()}$(document.body).addClass("detectum-enabled"),$(this).css("visibility","visible"),$("#sort-by").attr("onchange","").off("change",a).on("change",a)}),mvideo.Module.define("ajax-sort",function(a){function b(a){$(".c-plp-facets__area").each(function(b,c){var d=$(c).find(".collapse");a[d.attr("id")]=d.hasClass("in")})}var c=new mvideo.Class.AsyncDataLoader,d=a.containerName||".search-results-sort-popularity",e=a.selectId;c.addModule({container:d,dataAdapter:function(a){for(var b=0;b<a.length;b++)if(a[b].hasOwnProperty("searchSort"))return{searchSort:a[b].searchSort}},onDataHandler:function(a,b,c){try{if(a.hasOwnProperty("searchSort"))if(a.searchSort){$(d).replaceWith(a.searchSort);var e=new mvideo.Class.CustomSelect,f=$(d);e.reinit(f.find("select")),f.removeClass("disabled-until-scripts-loaded"),mvideo.initScripts(f)}else $(d).html("")}catch(a){}},moduleName:"ajax-sort"}),$(e).attr("onchange","").off("change").on("change",function(a){var d,e=$(this).find("option:selected"),f=e.attr("data-client-prev-action"),g=$($(this).children().get(this.selectedIndex)).val(),h=[];if(h.push("sorting=true"),f){var i=$.parseJSON(f);for(var j in i){var k=j+"=([^&]$|[^&]*)",l=new RegExp(k,"i");g=g.replace(l,""),h.push(j+"="+i[j])}}d=h.join("&"),b(d),c.load({url:g,getParams:d},a)})}),window.mvideo.Module.define("ajax-tabs",function(a){function b(){var a=d(),b=$("input[name]:checked",f),c=b.val(),e=b.attr("data-url"),g={};return a?(g[a]=c,e&&(g.url=e)):g=null,g}function c(b){var c,d=new mvideo.Class.PLPFacetSection,e={};return a.withInputs&&(c=d.getStateFacetForm().stateForm,a.withInputs.split(",").forEach(function(a){c[a]&&(e[a]=c[a].join(","))}),b=window.mvideo.helpers.setUrlParam(b,e)),b}function d(){return $("input[name]",f).attr("name")}a=$.extend(!1,{url:"",withInputs:""},a);var e=new mvideo.Class.AsyncDataLoader,f=$(this);f.off("change").on("change",function(){var d=b();if(d.url)return void e.load({url:d.url});e.load({url:c(a.url),getParams:d})}),e.addModule({container:f,dataAdapter:function(a){for(var b=0;b<a.length;b++)if(a[b].tabsFacets)return{tabsFacets:a[b].tabsFacets}},onDataHandler:function(a,b,c){try{a.tabsFacets&&(f.html(a.tabsFacets),window.mvideo.Class.ReinitContent.scripts(f))}catch(a){window.console.warn("ajax-tabs:",a)}},moduleName:"ajax-tabs"})}),window.mvideo.Module.define("ajax-visibility",function(){function a(){d.find('[data-facet="form"]').length>0?c.show():c.hide()}var b=new mvideo.Class.AsyncDataLoader,c=$(this),d=$(this).closest('[data-init="select-products"]'),e={moduleName:"ajax-visibility",onDataHandler:function(b){setTimeout(function(){a()})}};b.addModule(e),a()}),mvideo.Module.define("autocompleteForm",function(a){function b(){c.on("click",function(){mvideo.Event.publish("search-popup-opened",c)})}a=a||{};var c=$(this),d=c.closest(".header-area").length?c.closest(".header-area"):c.closest(".sticky-header"),e={template:"searchAutocomplete"};if($.extend(!0,e,a||{}),d.length){var f=new mvideo.Class.DynamicElement(d,{tpl:mvideo.template[e.template],tplData:{classes:"",seleniumClasses:a.seleniumClasses||{},defaultImgSrc:e.defaultImgSrc||""}}),g=new mvideo.Class.PopupLinkDynamic(this,f,{isUnique:!0,affectParent:!1,setPopupFocus:!0});return{mobileBehavior:b,tabletBehavior:b,desktopBehavior:function(){g.hidePopup()}}}}),mvideo.Module.define("autocompleteHandler",function(a){var b={};a.hasOwnProperty("resultId")&&(b.selectors={},a.hasOwnProperty("nameParentId")?b.selectors[a.nameParentId]=a.resultId:b.selectors.parentid=a.resultId);var c=a.hasOwnProperty("element")?a.element:"#frm-search-text",d=a.hasOwnProperty("promoSearchAdditional")?{selectors:{Dr:a.promoSearchAdditional}}:{},e=a.hasOwnProperty("autoCompleteControllerClass")?a.autoCompleteControllerClass:"AutocompleteController",f=a.defaultImgSrc?{defaultImgSrc:a.defaultImgSrc}:{},g=new mvideo.Class[e](this,null,{theme:a.hasOwnProperty("theme")?a.theme:"default",behavior:function(){return a.hasOwnProperty("submitAfter")?{submit:!0,redirect:!0}:a.hasOwnProperty("submitAfterFormInHeader")?{submit:!0,redirect:!1}:{}}(),selectors:{input:c,preloadedContent:".popup"},acPlacement:a.hasOwnProperty("placement")?a.placement:"after",handlers:{ajax:a.hasOwnProperty("controller")?mvideo.Class[a.controller]:mvideo.Class.SearchAjaxController},idStoreParamName:a.hasOwnProperty("idStoreParamName")?a.idStoreParamName:"",idStore:a.hasOwnProperty("idStore")?a.idStore:"",ajaxParams:$.extend(!0,$.extend(!0,b,d),f,a.ajaxParams||{}),showLoading:!!a.hasOwnProperty("showLoading")&&a.hasOwnProperty("showLoading"),scrollAll:!!a.hasOwnProperty("scrollAll")&&a.scrollAll,timeout:a.hasOwnProperty("timeout")?a.timeout:"500",selectSingleElement:!!a.hasOwnProperty("selectSingleElement")&&a.selectSingleElement,selectFirstElement:!!a.hasOwnProperty("selectFirstElement")&&a.selectFirstElement,seleniumClasses:a.seleniumClasses||{},noSubmitIfEmpty:!!a["no-empty-submit"]}),h=$(window).width();g.input.subscribe("input",function(a){mvideo.Event.publish("autocomplete.inputChange-"+c,g)}),g.popup.subscribe("show",function(a){mvideo.Event.publish("autocomplete.popupVisible-"+c,g),h=$(window).width()}),g.popup.subscribe("hide",function(a){mvideo.Event.publish("autocomplete.popupHide-"+c,g)}),g.list.subscribe("change",function(a){mvideo.Event.publish("autocomplete.optionSelected-"+c,g)}),$(window).resize(function(){$(window).width()!=h&&(g.popup.isShown()&&g.popup.hide(),h=$(window).width())})}),mvideo.Module.define("autocompleteValidation",function(a,b,c,d,e){function f(a){void 0!==a.ajax.getItemId&&void 0!==a.ajax.checkData&&(h(q.data("validator")),a.input.getValue().length>=a.config.minLength&&l(a,i))}function g(a,b){a.data("valid-autocomplete",!!b),m(!b)}function h(a){void 0!==a&&(c?(a.resetForm(),a.reset(),m(!0)):a.resetField(r))}function i(a,b,c){b?a.ajax.getItemId(c).then(k,j):j(),r.data("ignore-change",!1)}function j(){g(r,!1)}function k(a){var b=a||0===a;b&&t.length&&t.val(a),g(r,b)}function l(a,b){var c=a.input.getValue(),d=a.ajax,e=d.state();r.data("ignore-change",!0),(e||"pending"===e)&&d.process.done(function(){n(a,c,b)})}function m(a){c&&(a?(s.attr("disabled","disabled"),s.filter("[type=text],textarea").val("").addClass("disabled"),s.filter("[type=checkbox],[type=radio]").prop("checked",!1)):s.removeAttr("disabled").removeClass("disabled"))}function n(a,b,c){o(),p=a.ajax.checkData(b),p.done(function(d){c(a,d,b)})}function o(){p&&"function"==typeof p.abort&&(p.abort(),p=null)}var p,q=$(a).first(),r=q.find(b),s=function(a,b,c){var d=":not("+b+"):not([type=hidden]):not(.constant-state)",e="input"+d,f="textarea"+d;return c&&(e=c+" "+e,f=c+" "+f),a.find(e+","+f)}(q,b,d),t=$(e);mvideo.Event.subscribe("autocomplete.inputChange-"+b,function(a,b){f(b)}),mvideo.Event.subscribe("autocomplete.popupVisible-"+b,function(){r.data("ignore-change",!0)}),mvideo.Event.subscribe("autocomplete.popupHide-"+b,function(){r.data("ignore-change",!1).trigger("focusout")}),mvideo.Event.subscribe("autocomplete.optionSelected-"+b,function(a,b){r.data("ignore-change",!1).trigger("focusout"),g(r,!0),b.input.handleValueChange(),b.input.getValue().length>=b.config.minLength&&m(!1)}),r.on("keypress",function(a){var b=$(this);13===a.keyCode&&(b.data("valid-autocomplete")?b.trigger("focusout"):b.blur())})}),mvideo.Module.define("backwards-input",function(a){function b(a){$("input, textarea",i).each(function(){var b=$(this);(b.data(j)||a&&""===b.data(j))&&("checkbox"===b.attr("type")||"radio"===b.attr("type")?(b.attr("checked",b.data(k)),b.prop("checked",b.data(k))):b.val(b.data(j)))})}function c(a){$("input, textarea",i).each(function(){var b=$(this);"checkbox"!==b.attr("type")&&"radio"!==b.attr("type")||b.data(k,b.is(":checked")),"tel"===b.attr("type")&&a&&b.one("mask-applied",function(){b.data(j,b.val().trim())}),b.data(j,b.val().trim())})}function d(a,b){if("checkbox"===a.attr("type")||"radio"===a.attr("type"))return void a.data(k,!1);a.data(j,b)}function e(a){return a.data(j)}function f(a){return a.data(k)}function g(a){var b=null;switch(a.attr("type")){case"checkbox":case"radio":b=a.is(":checked")!==f(a);break;default:b=e(a)!==a.val().trim()}return b}function h(){return i.find("[data-dirty]").filter(function(){var a=$(this),b=g(a);return a.data("dirty",b),b})}a=$.extend(!0,{myself:!0},a);var i=$(this),j="backwards-input-prev",k="backwards-input-prev-checked";return a.myself&&(i.on("load-content.success",c.bind(this)).on("load-content.error",b.bind(this)),setTimeout(function(){c()})),{updateCacheValue:c,backwards:b,elementUpdateCacheValue:d,getElementPrevValue:e,getElementPrevChecked:f,testChanged:g,searchDirty:h}}),window.mvideo.Module.define("balance-choose",function(){var a,b=$(this),c=b.closest(".c-popup__content").find(".c-popup__title"),d=$("FORM",b);d.on("submit",function(d){var e=$(this);e.valid()&&(e.trigger("form-submit"),$.ajax({url:e.attr("action"),dataType:"json",data:e.serialize(),type:e.attr("method"),cache:!1,beforeSend:function(c){a||(a=new mvideo.Class.Overlay(b)),a.show()}}).fail(function(a,b,c){}).done(function(a,d,e){a&&(a.title&&c.text(a.title),a.htmlContent&&b.html(a.htmlContent)&&window.mvideo.Class.ReinitContent.reinit(b)||b.html("")),window.dataLayer&&a.gtmPush&&window.dataLayer.push(window.mvideo.helpers.gtmMutationFunctions.mergeAttrs(a.gtmPush))}).always(function(){a.hide()}))})}),mvideo.Module.define("birthday-validation",function(a,b){function c(a){var b=l.val();l.rules("add",{"exception-value":b,messages:{"exception-value":a}}),l.valid()}function d(a){s?(a.find(".disabled").not(".check-card-basic .disabled").removeClass("disabled"),a.find("[disabled]").not(".check-card-basic [disabled]").removeAttr("disabled")):(a.find(".disabled").not(".enable-forbidden .disabled").removeClass("disabled"),a.find("[disabled]").not(".enable-forbidden [disabled]").removeAttr("disabled"))}function e(){o.attr("disabled","disabled"),p.addClass("disabled"),q.addClass("disabled"),r.addClass("disabled")}function f(){m.addClass("disabled-form")}function g(){m.removeClass("disabled-form")}function h(a){window.location.assign(a)}function i(){var a=parseInt(l.attr("id").split("-").pop(),10),b="dateBirth="+l.val()+(a>0?"&index="+a:"");$.ajax({type:"GET",url:n,data:b,dataType:"json",cache:!1,beforeSend:function(){f(),l.rules("remove","exception-value")},success:function(a){a=a||{},s=a.disabledCardBasic||!1,a.redirectUrl?h(a.redirectUrl):a.status&&"error"===a.status?(c(a.errorMessage),e()):a.status&&"success"===a.status&&(d(k),j())},error:function(){c(t)},complete:function(){g()}})}function j(){$("#phone-data").find(".pseudo-td a").removeAttr("tabindex")}
var k=$(b),l=$(a),m=l.parents("form"),n=l.data("url"),o=k.find("#card-basic"),p=o.siblings(".label-checkbox"),q=p.find(".fake-checkbox"),r=k.find(".found-user-data-btn"),s=!1,t=k.data("text-error")||"Извините, произошла ошибка. Обновите страницу и повторите попытку.";l.on("change",function(){l.valid()?i():e()})}),mvideo.Module.define("bonus-card-operations",function(a){function b(){var a=n.serialize();if(a===m)return!1;p.load({url:n.attr("action"),getParams:a,notUseHistory:!0})}function c(){f("default-val"),b()}function d(){n.find("select, input").each(function(a,b){var c=$(b);c.data("active-val",c.val())})}function e(b,c){var d=$(c);c&&!d.is(a.filterBtn+","+a.clearBtn)&&f("active-val")}function f(a){n.find("select, input").each(function(b,c){var d=$(c);d.val(d.data(a)),d.is("select")&&d.trigger("change","renderLabel")})}function g(){n.on("change",b)}function h(){n.off("change",b)}function i(a){a.facetsContent&&j(q,a.facetsContent),a.tableContent&&j(r,a.tableContent),o.hide(),l()}function j(a,b){var c;a.html(b),c=new mvideo.Class.CustomSelect,c.reinit(a.find("select")),mvideo.initScripts(a)}function k(){"desktop"!==mvideo.device.manager.getType()?(h(),$(a.mobileActive).attr("disabled",!1),$(a.mobileDisabled).attr("disabled",!0)):(g(),$(a.mobileActive).attr("disabled",!0),$(a.mobileDisabled).attr("disabled",!1))}function l(){k(),m=n.serialize(),d()}a=$.extend({facetsContainer:"[data-facets-content]",tableContainer:"[data-table-content]",filterBtn:"[data-filter-btn]",mobileActive:"[data-mobile-active]",mobileDisabled:"[data-mobile-disabled]",clearBtn:"[data-clear-btn]",defaultError:"Извините, сервис временно недоступен. Попробуйте позже.",notificationConfig:{notificationParams:{notificationAttrs:{class:["o-container__section"," o-container__section_mobile","u-mt-40"]}},errorParams:{iconStyle:"error",iconColor:"red",textColor:""}}},a);var m,n=$(this),o=new mvideo.Class.Overlay(n),p=new mvideo.Class.AsyncDataLoader,q=n.find(a.facetsContainer),r=n.find(a.tableContainer),s=new mvideo.Class.Notification(r,a.notificationConfig);return p.addModule({container:n,dataAdapter:function(a){for(var b={},c=0;c<a.length;c++)a[c].tableContent&&(b.tableContent=a[c].tableContent),a[c].facetsContent&&(b.facetsContent=a[c].facetsContent);return b},onDataHandler:function(a,b,c){try{i(a)}catch(a){}},beforeRequest:function(){o.show(null,!0)},onError:function(){s.replace({type:"error",text:a.defaultError}),o.hide()},moduleName:"bonus-card-operations"}),l(),function(){mvideo.Event.subscribe("hide-facets-panel",e),n.on("click",a.filterBtn,b),n.on("click",a.clearBtn,c)}(),{desktopBehavior:k,tabletBehavior:k,mobileBehavior:k}}),mvideo.Module.define("borrowContent",function(a,b,c){function d(a){return a.removeAttr("data-init").removeAttr("data-init-param").removeAttr("data-device")}b=b||"after",c=c||"clone";var e=$(this);$(a).each(function(){var a=$(this),f=$(a[c]());f.find("[data-init]:not([data-without-clear])").each(function(){d($(this))}),f.find("[data-init][data-without-clear]").each(function(){var a=$(this),b=a.attr("data-title");b&&a.attr("title",b),mvideo.Class.ReinitContent.reinit(this)}),e[b](f)}),e.remove()}),mvideo.Module.define("brandBG",function(){var a;""!==$("#promo-bg").attr("data-promo-bg")&&(a=$("#promo-bg").attr("data-promo-bg"),a="background:url("+a+") no-repeat 50% 0;",$(".main-holder").attr("style",a))}),mvideo.Module.define("btnLikeTooltip",function(){function a(a){var b=a.find(".btn-like-text"),c=parseInt(b.text(),10);b.text(c+1)}function b(a){a.tooltip("show"),setTimeout(function(){a.tooltip("hide")},1e3)}var c=$(this);c.find(".btn-like").tooltip({trigger:"manual",animation:!0}),c.on("click",".btn-like",function(d){d.preventDefault();var e=$(this);if(!e.hasClass("disabled")){var f=e.siblings("form");$.ajax({type:"POST",url:f.attr("action"),data:f.serialize(),success:function(){a(e),c.find(".btn-like").addClass("disabled"),b(e)}})}})}),mvideo.Module.define("call",function(a){var b={referrer:window.location.href,headers:$.param(a.headers).replace(/=|&/g,function(a){return"="===a?":":";"})};$(this).on("click",a.selector,function(a){var c=a.currentTarget.href.indexOf("?")>-1?"&":"?",d=a.currentTarget.href+c+"referrer="+encodeURIComponent(b.referrer)+"&headers="+encodeURIComponent(b.headers);return d=decodeURIComponent(d),window.open(d,"_blank","width=236,height=220,resizable=no,toolbar=no,menubar=no,location=no,status=no"),!1})}),window.mvideo.Module.define("cart-check-accessory",function(a){function b(a){var b={};a.forEach(function(a){a.productId&&(b[a.productId]=a.needShow)}),f.forEach(function(a){b[a.productId]&&(a.needShow=b[a.productId])})}function c(){f.forEach(function(a){a.needShow||a.$linkAccessory.hide()})}a=$.extend(!0,{url:"",wrapperItem:".c-cart-item__wrapper",overlayClass:"box-overlay"},a);var d=$('[data-need-check-accessory="true"]',this),e=window.mvideo.helpers.setUrlParam,f=[],g=function(){var a={};return f.forEach(function(b){a[b.productId]=!0}),Object.keys(a)},h=function(){return e(a.url,{products:g().join(",")})};d.length&&(d.each(function(){var b=$(this),c=b.closest(a.wrapperItem).data("productId");c&&f.push({productId:c,$linkAccessory:b,needShow:void 0})}),function(){$.ajax({type:"get",url:h(),contentType:"application/json",data:null,beforeSend:function(){d.addClass(a.overlayClass)}}).done(function(a,c,d){"success"===a.status&&b(a.items)}).always(function(){d.removeClass(a.overlayClass),c()})}())}),mvideo.Module.define("cart-services",function(a){function b(){u.useBeforeRender?(K&&clearTimeout(K),K=setTimeout(function(){c()},u.renderFinishDelay)):c()}function c(){B=$(u.serviceItem,v),C=$(u.servicesTabs,v),D=$(u.collapse,v),E=$(u.cartService,v),I="cartItemIdWithOpenedServices"+E.data(u.cartItemId),D.off().click(n),$(u.serviceClose,v).off().click(n);var a=g();E.hasClass("in")&&E.removeClass("in"),C.length&&(F=j()),a?(w.html(a),mvideo.Class.ReinitContent.reinit(w),mvideo.Class.ReinitContent.reinit(D),A=!0):A=!1;var b=l();G=b.servicesHeight,H=b.topServiceHeight,m()?(z=!0,f(),q()&&k(F),z=!1):A?(e(),z=!0):z=!!G,t()&&v.trigger("services-rendered")}function d(){f(),A&&e(),z&&k(F),z=!z}function e(){H&&J&&(z?x.css({height:0}):x.css({height:H})),x.toggleClass("in")}function f(){G&&J&&(z?E.css({height:G}):E.css({height:0})),E.toggleClass("in"),y.toggleClass("collapsed")}function g(){if(!B.length)return null;if(!C.length)return i(B[0]);var a=h("pickup"),b=h("courier");return a.name===b.name?i("courier"===F?b.element:a.element):null}function h(a){var b=$(u.serviceItem,C.find("[data-id^="+a+"]"))[0];return{name:$(u.checkboxText,b).text(),element:b}}function i(a){return $(a).clone()[0]}function j(){var a=$("[data-id^=courier]",C);return $(u.checkboxInput+":checked",a).length?"courier":"pickup"}function k(a){$(u.tabsMenuItem+" "+u.tabsMenuLink+"[data-target^="+a+"]",C).click()}function l(){return{servicesHeight:$(u.cartServicesWrapper,E).height(),topServiceHeight:$(u.topServiceWrapper,x).height()}}function m(){return sessionStorage.getItem(I)}function n(){m()&&p(),d()}function o(){!z&&m()&&p(),z&&r(),d()}function p(){sessionStorage.removeItem(I)}function q(){return C.length}function r(){sessionStorage.setItem(I,!0)}function s(){r(),d()}function t(){return E.data(u.cartItemId)===$(u.cartService).last().data(u.cartItemId)}var u=Object.assign({selectedElement:this,serviceItem:".c-cart-service__item",checkboxInput:".c-checkbox__input",selectedTarget:".js-c-cart-top-service__list",fullServicesList:".js-c-cart-top-service__full-services-list",chooseServices:".c-link_chevron",collapse:".js-c-cart-top-service__collpase",topService:".c-cart-top-service",serviceClose:".c-cart-service__close",checkboxText:".c-checkbox__text",servicesTabs:".o-cart-service__tabs",cartItemWrapper:".c-cart-item__wrapper",cartService:".js-c-cart-services",tabsMenuItem:".c-tabs__menu-item",tabsMenuLink:".c-tabs__menu-link",cartServicesWrapper:".js-c-cart-services__wrapper",topServiceWrapper:".js-c-cart-top-service__wrapper",shouldAnimationUse:!1,renderFinishDelay:1500,useBeforeRender:!0,cartItemId:"cart-item-id"},a||{}),v=$(u.selectedElement),w=$(u.selectedTarget,v),x=$(u.topService,v),y=v.prev(u.cartItemWrapper).find(u.chooseServices),z=!1,A=!1,B=null,C=null,D=null,E=null,F=null,G=null,H=null,I=null,J=u.shouldAnimationUse,K=null;$(u.fullServicesList,v).click(s),y.click(o),v.one("cart-services-loaded",b),b()}),mvideo.Module.define("cart-storage-manager",function(a){function b(){var a=sessionStorage.getItem(h),b=new mvideo.Class.SmartFocus({desktopOffset:-35,tabletOffset:-35,mobileOffset:-35});if(a){var c=null;try{c=JSON.parse(a),c&&("scroll"===c.type?j.scrollTop(c.value):"id"===c.type&&b.focusBlock(g.find("[data-item-id="+c.value+"]"))),sessionStorage.removeItem(h)}catch(a){}}}function c(){var a=sessionStorage.getItem("cartWindowUnloadDate");a&&((new Date).valueOf()-new Date(a).valueOf()>i.pageReloadLimit?e():i.shouldScrollUse&&g.on("services-rendered",b))}function d(){sessionStorage.setItem("cartWindowUnloadDate",new Date),sessionStorage.getItem(h)||sessionStorage.setItem(h,JSON.stringify({type:"scroll",value:j.scrollTop()}))}function e(){f(),sessionStorage.removeItem(h),sessionStorage.removeItem("cartWindowUnloadDate")}function f(){Object.keys(sessionStorage).forEach(function(a){-1!==a.indexOf("cartItemIdWithOpenedServices")&&sessionStorage.removeItem(a)})}var g=$(this),h="keyWithLatestInteraction",i=$.extend(!0,{shouldScrollUse:!0,pageReloadLimit:1e4},a||{}),j=$(window);j.load(c),j.unload(d)}),mvideo.Module.define("cart",function(a){function b(a){if(!m.validate().checkForm())return a.preventDefault();c()}function c(){new mvideo.Class.Overlay(m).show()}function d(a){o.trigger("click"),k($(a.target).parents(t.itemId).data("item-id"))}function e(){$('[data-target="'+$(this).attr("data-for-data-target")+'"]',m).trigger("click")}function f(){g($(this)),p.trigger("click")}function g(a,b){a.closest(".c-cart-service__group").find("[data-bind-input-id]").each(function(){var a,c=$(this),d=c.data("bind-type");d&&d!=b||(a=$(c.data("bind-input-id"),m),a.val(c.val()))})}function h(){var a=$(this);if(j(a),a.prop("checked"))return g(a,"add"),void q.trigger("click");g(a,"remove"),r.trigger("click")}function i(){var a=$(this),b=a.parents(".c-cart-item").find($('[data-bind-id="'+a.data("service-bind")+'"]')),c=null;if(1===b.length)c=b;else{if(!(b.length>1))return void console.error('Module "cart": Can\'t find services for binding');b.each(function(){var a=$(this);a.parents(".c-tabs__body").hasClass("active")&&(c=a)}),c||(c=b.eq(0))}c.prop("checked",a.prop("checked")).trigger("change")}function j(a){var b=a.parents("[data-cart-item-id]").data("cart-item-id"),c=a.parents(".c-cart-top-service").next("[data-cart-item-id]").data("cart-item-id"),d="cartItemIdWithOpenedServices"+(b||c);b&&sessionStorage.setItem(d,!0),(b||c)&&l({type:"scroll",value:$(window).scrollTop()})}function k(a){a&&l({type:"id",value:a})}function l(a){sessionStorage.setItem(u,JSON.stringify(a))}var m=$(this).find("form"),n=m.find(".c-radio-button__label"),o=$("#update",m),p=$("#updateServiceQantityButton",m),q=$("#addServiceButton",m),r=$("#removeServiceButton",m),s=$("body"),t=Object.assign({itemId:"[data-item-id]"},a),u="keyWithLatestInteraction";m.on("submit",b).on("change",".cart-count-select",d).on("change",".cart-count_services-select",f).on("change",".c-cart-service .c-checkbox__input",h).on("click",".c-cart-service__close",e).on("change",".c-cart__trade-in .c-checkbox__input",i).on("change-count",d).on("change",".c-cart__apply-discount",function(a){a.preventDefault();var b=$(this).closest("[data-product-position]"),c=b.data("product-position");$("#currentPosition").val(c),$("[data-apply-discount]",b).trigger("click")}),s.on("click","[data-cart-reload-btn]",c),m.css("minHeight",$(".c-cart__right_block",m).css("height")),n.on("change",function(){c()})}),mvideo.Module.define("catalogAllocator",function(a){var b=new mvideo.Class.CatalogAllocator(this,a);return{desktopBehavior:function(){b.allocate("desktop")},tabletBehavior:function(){b.allocate("tablet")},mobileBehavior:function(){b.allocate("mobile")}}}),mvideo.Module.define("change-wishlist-items",function(){var a=$(this),b=$(".wishlist-amount",a);window.mvideo.Event.subscribe("change-to-wishlist",function(a,c){b.html(c.amount),c.amount>0?(b.show(),b.closest(".wishlist-link").removeClass("default")):(b.hide(),b.closest(".wishlist-link").addClass("default")),window.mvideo.Event.publish("listchange",{listName:"wishlistMenu",eventName:"ajax",changedData:{productCount:{newValue:c.amount}},value:c.amount})})}),mvideo.Module.define("change-wishlist",function(a){a=$.extend(!0,{inputSelector:".js-checkbox-input-wishlist"},a);var b=$(this),c=a.inputSelector;b.on("change",c,function(a){var b=$(a.currentTarget),c=b.closest("form"),d=b.prop("checked");$.ajax({url:c.attr("action"),type:c.attr("method"),dataType:"json",data:c.serialize(),error:function(){b.prop("checked",!d)},success:function(a){a=a||{},"success"===a.status?window.mvideo.Event.publish("change-to-wishlist",{amount:a.amount}):b.prop("checked",!d)}})})}),mvideo.Module.define("checkout-choose-store",function(a){new mvideo.Class.PopupStore(this,a)}),mvideo.Module.define("checkout-controller",function(){new mvideo.Class.CheckoutController(this)}),mvideo.Module.define("checkout-notifications-close",function(a){function b(){h.each(function(){$(this).find(".c-notifications__close").click()}),$(this).parent().attr("data-down")&&mvideo.instance.page.page.goToBlock("body"),e(),t=!1}function c(){if(t){var a=l.scrollTop(),b=l.height()-(j.offset().top-a+m);i.offset().top-a<0?(p.hide(),b>0?q.show():q.hide()):(p.show(),q.hide())}}function d(){h=$(f.notification,g),i=h.first(),j=h.last(),m=j.height();var a=h.length;a||(t=!1),1===a&&e(),a>1&&($(f.link,g).off().click(b),r?(q.show(),o.show()):(p.show(),s.show())),r||(a<=2?o.hide():u||(o.show(),l.scroll(c),u=!0))}function e(){k.each(function(){$(this).hide()})}var f=$.extend(!0,{link:"[data-close-link=true]",notification:"[data-init=notifications]",item:"[data-close-item=true]",withSticky:!1},a||{}),g=$(this),h=null,i=null,j=null,k=$(f.item,g),l=$(window),m=null,n=$(f.link,g),o=k.last(),p=n.first(),q=n.last(),r=f.withSticky,s=k.first(),t=!0,u=!1;g.on("notification-removed",d),mvideo.Event.subscribe("checkout.add-notification",d),d()}),mvideo.Module.define("checkout-notifications",function(){new mvideo.Class.CheckoutNotifications(this)}),mvideo.Module.define("checkout-promocode",function(a){function b(){p.removeClass("u-error"),r.hide(),t="",a.showListByFocus&&c()}function c(){var b;j.length&&p.is(":focus")&&(b=0!==p.val().length,b?(j.addClass(a.hiddenClass),l.removeClass(x)):j.removeClass(a.hiddenClass))}function d(a){var b=a.data("id"),c=$(".c-saved-promo-code__number",a).text();k.val(b),v=c,p.off("keydown.delete input.delete").val(c).trigger("input").focus().on("keydown.delete input.delete",e)}function e(a){var b=a.keyCode;return 8!==b&&46!==b&&p.val()?p.val(v):(p.off("keydown.delete input.delete").val("").trigger("input").focus(),k.val("")),!1}function f(a){if(!p.val()){var b=a.keyCode,c=l.filter("."+x),e=l.index(c),f=l.length-1;switch(c.removeClass(x),b){case 13:a.preventDefault(),-1!==e&&d(l.eq(e));break;case 38:if(-1===e)return;0===e?e=f:e--,l.eq(e).addClass(x),h();break;case 40:e===f||-1===e?e=0:e++,l.eq(e).addClass(x),h()}}}function g(a){13===a.keyCode&&q.click()}function h(){var a=m.height(),b=m.find("."+x),c=b.length?b[0].offsetTop:0,d=b.outerHeight();m.scrollTop(c+d-a)}function i(){if(0===u.length||u.is(":hidden"))return!0;var b=n.closest("FORM").validate(),c=b.check(u);return c?n.hasClass(a.nameStates+"waiting-code-state")&&o.toggleComponentsDisable(!1):b.showErrors(),c}a=$.extend(!0,{holder:this,inputCode:"#promocode-field",selectBtn:".js_select-btn",nameStates:"o-promo-code_",elementCode:"#confirm-code-promo",selectCode:".o-promo-code__select-code",inputSelected:"#selectedPromocode",list:".c-list__wrapper",listItem:".c-saved-promo-code",selectBtnRequest:".c-code-confirm__btn-request",selectTimer:".c-code-confirm__timer-msg span",selectWrapperTimer:".c-code-confirm__timer-msg",timerSeconds:"120",codeLimitError:"",hiddenClass:"u-hidden",recaptcha:"#recaptcha-promocode-checkbox",showListByFocus:!0,timerTemplate:"#m#:#s#"},a);var j,k,l,m,n=$(a.holder),o=new mvideo.Class.CheckoutSmsConfirm(n,{selectBtnRequest:a.selectBtnRequest,selectTimer:a.selectTimer,selectWrapperTimer:a.selectWrapperTimer,timerSeconds:a.timerSeconds,elementCode:a.elementCode,limitError:a.codeLimitError,timerTemplate:a.timerTemplate}),p=$(a.inputCode,n),q=$(a.selectBtn,n),r=p.siblings(".u-error-text"),s=p.validate(),t=p.val(),u=$(a.recaptcha,n),v="",w=new mvideo.Class.SmartFocus,x="c-list__item_selected";n.hasClass(a.nameStates+"waiting-code-state")&&(o.open(),o.toggleComponentsDisable(u.length&&u.is(":visible"))),a.checkboxOpen&&$(a.checkboxOpen).on("open",function(){w.focusBlock(p.eq(0),p.eq(0))}),p.one("blur",function(){""!=p.val()&&t===p.val()&&r.text().trim()&&(p.addClass("u-error"),r.show())}),p.off("input.promocode").on("input.promocode",b),q.on("click",function(){return p.val(p.val().replace(/\s/g,"")).trigger("input"),s.check(p)?i():(p.addClass("u-error").focus(),r.text(p.data("msg-minlength")).show(),setTimeout(function(){r.trigger("show.error")},0),!1)}),p.on("keydown",g),j=$(a.selectCode,n),j.length&&(k=$(a.inputSelected,n),m=j.find(a.list),l=j.find(a.listItem),l.hover(function(){l.removeClass(x),$(this).addClass(x)},function(){$(this).removeClass(x)}),a.showListByFocus&&(p.on("focus",c),p.on("focusout",function(b){b.originalEvent&&b.originalEvent.relatedTarget&&$(b.originalEvent.relatedTarget).parents(a.selectCode).length?l.is(b.originalEvent.relatedTarget)||p.focus():j.addClass(a.hiddenClass)})),p.on("keydown.next",f),k.on("input",function(){p.off("keydown.delete input.delete")}),l.on("click",function(a){d($(a.currentTarget))}),k.val()&&(v=p.val(),p.on("keydown.delete input.delete",e))),"block"===n.css("display")&&!n.hasClass(a.nameStates+"success-code-state")&&("desktop"===window.mvideo.device.manager.getType()||k&&k.val())&&p.select(),u.length&&u.on("change",i),"block"!==n.css("display")||n.hasClass(a.nameStates+"success-code-state")||j.select()}),mvideo.Module.define("checkout-roubles",function(a){function b(){var b=c.closest("FORM").validate(),e=!0;return f.length&&!f.is(":hidden")&&(e=b.check(f)),e&&(e=b.check(h)),e?c.hasClass(a.nameStates+"waiting-code-state")&&d.toggleComponentsDisable(!1):b.showErrors(),e}a=$.extend(!0,{holder:this,inputField:'[data-range-field="true"]',elementCode:"#confirm-code-bonus",selectBtn:".js_select-btn",selectBtnRequest:".c-code-confirm__btn-request",selectTimer:".c-code-confirm__timer-msg span",selectWrapperTimer:".c-code-confirm__timer-msg",timerSeconds:"120",codeLimitError:"",elementResult:".o-bonus-roubles__result",selectEditRoubles:"edit_roubles",nameStates:"o-bonus-roubles_",recaptcha:"#recaptcha-bonus-roubles-checkbox"},a);var c=$(a.holder),d=new mvideo.Class.CheckoutSmsConfirm(c,{selectBtnRequest:a.selectBtnRequest,selectTimer:a.selectTimer,selectWrapperTimer:a.selectWrapperTimer,timerSeconds:a.timerSeconds,elementCode:a.elementCode,limitError:a.codeLimitError}),e=$(a.elementResult,c),f=$(a.recaptcha,c),g=$(a.selectBtn,c),h=$(a.inputField,c);c.hasClass(a.nameStates+"waiting-code-state")?(d.open(),d.toggleComponentsDisable(f.length&&f.is(":visible"))):c.hasClass(a.nameStates+"success-bonus-state")&&e.on("click","[data-js="+a.selectEditRoubles+"]",function(){c.removeClass(a.nameStates+"success-bonus-state"),c.addClass(a.nameStates+"select-roubles-state")}),g.on("click",function(){return b()}),f.length&&f.on("change",b)}),mvideo.Module.define("clever-login",function(a){function b(){var a=k.val(),b={};0!==a.length&&(b=f(a),b.phone?(l.val("PHONE"),k.val(b.currentLogin),g(k,"email","phone")):(l.val("EMAIL"),g(k,"phone","email")),p.check(k),c())}function c(){setTimeout(function(){if(!d())return k.addClass("u-error"),void(m.text().length>0?m.show():m.hide());k.removeClass("u-error").addClass("u-valid"),m.hide()})}function d(){return k.hasClass("u-valid")}function e(){(k.hasClass("u-error")||"block"===m.css("display"))&&(k.removeClass("u-error"),m.hide())}function f(b){var c=new RegExp(/[^0-9^A-Z^a-z^А-Я^а-я]/g);if(-1!==b.search(/[@]/g))return{phone:!1};if(b=b.replace(c,""),b.length<10||b.length>11)return{phone:!1};10===b.length&&(b="7"+b);var d=new RegExp("^"+b[0]);return b=b.replace(d,a.oSymbols[b[0]]),{phone:!0,currentLogin:b}}function g(a,b,c){i(a,b),h(a,c)}function h(a,b){o[b].attrs&&a.attr(o[b].attrs);for(var c in o[b].rules)a.data(c,o[b].rules[c])}function i(a,b){o[b].attrs&&a.removeAttrs(Object.keys(o[b].attrs).join(" "));var c=[];for(var d in o[b].rules)c.push("data-"+d);a.removeAttrs(c.join(" "))}a=$.extend(!0,{loginSelector:"#login-original",loginTypeSelector:'[data-default-login="true"]',errorLabelSelector:".js-login-error-label",submitSelector:'[data-js-submit="true"]',oSymbols:{7:"7",8:"7"}},a);var j=$(this),k=$(a.loginSelector,j),l=$(a.loginTypeSelector,j),m=$(a.errorLabelSelector,j),n=$(a.submitSelector),o={phone:{rules:{"rule-regexp":k.data("phone-rule-regexp")},attrs:k.data("phone-attrs")},email:{rules:{"rule-regexp":k.data("email-rule-regexp")},attrs:k.data("email-attrs")}},p=j.validate();k.on("focusout",b).on("input",e),n.on("click",c),b()}),mvideo.Module.define("delivery-date",function(a){function b(a){var b=null,g=e.val();c()?(b=d())&&f.changeAddress(b,g):a&&f.changeAddress(b,g)}function c(){var b,c,d=!1;return"all"===a.fullAddressRegions?d=!0:(b=e.data("info"),c=b&&b.regionId,Array.isArray(a.fullAddressRegions)&&a.fullAddressRegions.length&&c&&(d=-1!=a.fullAddressRegions.indexOf(c)),d)}function d(){for(var b,c,d="",e=0;e<j.length;e++){var f=j.eq(e);if(!k.check(f))return!1;switch(f.data(a.addressPartAttr)){case"city":c=f.data("info"),b=c&&c.text,d+=(b||f.prev("input").val())+", ";break;case"street":d+=f.val()+", ";break;case"house":d+=f.val()}}return d}a=$.extend(!0,{element:"#frm-city",currentCity:"#frm-city-id",elementDate:"#delivery-date",elementTime:"#delivery-time",elementAddressBook:".o-delivery-address-book",showPrice:!0,restApi:{getTimes:""},addressPartAttr:"address-part",fullAddressRegions:["1"]},a);var e=$(a.currentCity),f=new mvideo.Class.CheckoutLeadTime({restApi:a.restApi}),g=new mvideo.Class.CheckoutDeliveryDate({elementDate:a.elementDate}),h=new mvideo.Class.CheckoutDeliveryTimeSlot({elementTime:a.elementTime,showPrice:a.showPrice}),i=$(a.elementAddressBook),j=$("[data-"+a.addressPartAttr+"]"),k=j.validate();mvideo.Event.subscribe("update.Checkout.LeadTime",function(a,b){g.setDate(b.timeSlot)}),mvideo.Event.subscribe("update.Checkout.TimeSlot",function(a,b){h.setTimeSlot(b)}),mvideo.Event.subscribe("loading.Checkout.LeadTime",function(a,b){g.loading(),h.loading()}),g.setDate(a.timeSlot);var l=i.find("input:checked");l.length&&(l.is("[data-new-address]")?f.currentIdCity=e.val():(f.currentIdCity=l.data("city-id"),f.currentAddress=l.data("address"))),i.on("change","input:checked",function(a){var c,d=$(this),g=e.val();d.is("[data-new-address]")?b(!0):(c=d.data("address"),g=d.data("city-id"),f.changeAddress(c,g))}),j.change(function(c){b("city"===$(c.currentTarget).data(a.addressPartAttr))})}),mvideo.Module.define("form-error",function(a){a=$.extend(!0,{form:this,inputs:"",applyClass:"u-error",cancelClass:"u-valid",errorClassForm:"",events:"input.error-form change.error-form"},a);var b=$(a.form);0!==a.inputs.length&&b.hasClass(a.errorClassForm)&&(setTimeout(function(){b.find(a.inputs).removeClass(a.cancelClass).addClass(a.applyClass)}),b.one(a.events,a.inputs,function(){b.off(a.events).removeClass(a.errorClassForm),b.find(a.inputs).removeClass(a.applyClass)}))}),mvideo.Module.define("update-wish-list",function(){function a(a){var b=$(this),c=b.attr("href"),d=b.parent();$.post(c).done(function(a){"success"===a.status&&(d.html(a.htmlContent),window.mvideo.Class.ReinitContent.gtmTracking(d))}),a.preventDefault()}$(this).on("click","[data-wish-list-btn]",a)}),mvideo.Module.define("chooseAttribute",function(a){function b(a){var b=e.find(d.desc_img+" img"),c=e.find(d.desc_info+" h2"),f=e.find(d.desc_info+" p"),g=e.find("#skulink"),h=a;b.attr("src",h.img),c.empty().html(h.price),f.empty().html(h.description),g.val(h.id),e.find(d.desc_img).show(),e.find(d.desc_info).show()}function c(a){var c="",f=a[0];i.empty();for(var h=0,j=f.length;h<j;h++)c+='<option value="'+f[h].value+'">'+f[h].text+"</option>";i.html(c),g.reinit(i),e.find(d.desc_img).hide(),e.find(d.desc_info).hide(),b(a[1])}var d={radio_attr:"input[type=radio]",select_attr:"#attr2",desc_img:".promocode-editions-image",desc_info:".promocode-editions-description",url:"/sitebuilder/blocks/preorder/components/subscribe.json.jsp"},e=$(this),f=new mvideo.Class.AbstractAjaxController,g=new mvideo.Class.CustomSelect;$.extend(!0,d,a||{});var h=e.find(d.radio_attr),i=e.find(d.select_attr);$("#checkout-sbm-btn").length?(i.on("change",function(){var a={attr2Id:$(this).val(),attr1Id:h.filter(":checked").attr("id"),campaignId:e.attr("id"),requestType:"attr2Selected"};f.get(d.url,a,b)}),h.on("change",function(){if(!i.length){var a={attr2Id:"",attr1Id:$(this).attr("id"),campaignId:e.attr("id"),requestType:"attr2Selected"};return void f.get(d.url,a,b)}var g={attr1Id:$(this).attr("id"),campaignId:e.attr("id"),requestType:"attr1Selected"};f.get(d.url,g,c)})):(window.location.hash="",window.location.hash=e.attr("id"))}),mvideo.Module.define("city-store",function(a){function b(a){var b=[];a.forEach(function(a){b.push('<option value="'+a.id+'">'+a.store+"</option>")}),e.find("option:gt(0)").remove(),e.append(b.join()),f.reinit(e)}a=$.extend(!0,{url:"",method:"GET",citiesSelector:"",dropdownView:"",storesSelector:"",handlers:{customSelect:mvideo.Class.CustomSelect,overlay:mvideo.Class.Overlay}},a);var c=$(this),d=$(a.citiesSelector,c),e=$(a.storesSelector,c),f=new a.handlers.customSelect;d.on("change",function(){var c=e.siblings(a.dropdownView),f=new a.handlers.overlay(c);$.ajax({url:a.url,type:a.method,data:{selectedCity:d.val()},dataType:"json",beforeSend:function(){f.show()},success:function(a){f.hide(),b(a.stores)},complete:function(){f.hide()}})})}),mvideo.Module.define("cleaning-input-field",function(a,b,c,d,e){function f(){k.removeAttr("disabled"),k.removeClass("disabled")}var g=$(g).attr("value"),h=$(a),i=$(b),j=i.find(c),k=$(d),l=$(e),m=!0;i.length&&i.addClass("allowed-сhange"),h.change(function(){i.length&&(m=i.hasClass("allowed-сhange")),g!=h.attr("value")&&m&&($(".can-be-removed").remove(),h.removeAttr("value"),h.valid(),i.length?i.removeClass("allowed-сhange"):m=!1,j.length&&j.removeClass("hidden"),k.length&&f(),l.length&&l.val(""),$("#form-register-terms").prop("checked")&&$(".add-address-submit-btn").removeAttr("disabled"))})}),mvideo.Module.define("clear-input",function(a){function b(){var b=0!==e.val().length;b&&!h?(f.removeClass(a.hiddenClass),h=!0):b||(f.addClass(a.hiddenClass),h=!1)}function c(){e.val("").trigger("input").trigger("focus"),g.val("").trigger("input")}a=$.extend(!0,{holder:this,clearBtn:".c-text-field__btn",input:"#promocode-field",relatedInputs:"#selectedPromocode",hiddenClass:"u-hidden"},a);var d=$(a.holder),e=$(a.input,d),f=$(a.clearBtn,d),g=$(a.relatedInputs,d),h=!1;f.on("click",c),e.off("input.clear").on("input.clear",b),b()}),mvideo.Module.define("close-popup",function(a){$(this).click(function(){$(this).closest(".c-popup__block").find(".c-btn_close").trigger("click")})}),mvideo.Module.define("commentary",function(a){function b(){e.removeClass("disabled")}a=$.extend(!0,{parentId:null,formHolder:".js-form-holder",commentsHolder:".js-lazy-comments",makeCmtBtn:".js-create-comment-btn",showCmtsBtn:".js-show-other-comments",openCloseChangeText:"Скрыть комментарии",createCommentInstName:"createComment"},a);var c=$(this),d=c.find(a.formHolder),e=c.find(a.makeCmtBtn),f=new mvideo.Class.OpenCloseContent(c,{selectors:{opener:a.showCmtsBtn,opencloseBlock:a.commentsHolder},changeText:a.openCloseChangeText});e.on("click",function(c){c.preventDefault(),0===d.get(0).children.length?mvideo.instance[a.createCommentInstName].attach(d,a.parentId,b):mvideo.instance[a.createCommentInstName].show(b),e.addClass("disabled")}),f.initialize()}),function(){var a,b=!1,c=null,d=null;mvideo.Module.define("comparisonManager",function(e){function f(a,b){if(null===p)return console.warn("'comparisonManager' can't find element for 'compareLink' option, link will not be updated"),!1;if(b&&!isNaN(b)&&b>1){var c=mvideo.helpers.getUrlParam(decodeURIComponent(q)),d=q.split("?")[0];a&&a.length>0&&(c[e.waresParamName]=a),d=decodeURIComponent(d+"?"+$.param(c,!0)),p.attr("href",d),g(d)}else p.removeAttr("href"),g()}function g(b){if(!a){var c=d.querySelector(".navigation");if(null===c)return;a=c.querySelector(".comparelist-link")}if(null!==a)return b?a.setAttribute("href",b):void a.removeAttribute("href")}function h(a){var b=$(a.target),d=b.siblings("label"),e=b.closest("form");return d.addClass("ajax-processing"),b.is(":checked")?(e.find(".remove-param").attr("disabled","disabled"),e.find(".add-param").removeAttr("disabled"),c++,l()):(e.find(".add-param").attr("disabled","disabled"),e.find(".remove-param").removeAttr("disabled"),c--,l()),b.attr("disabled","disabled"),{input:b,form:e,label:d}}function i(a){var b=a.input,c=a.label;b.removeAttr("disabled"),c.removeClass("ajax-processing"),c.hasClass("c-product-tile__compare-button")&&c.toggleClass("c-product-tile__compare-button_active")}function j(a){var b=this.defaultPreAjaxDelete(a);return m.val(b.data("prodid")),n&&n.length>0&&n.val(b.data("siteid")),b}function k(a){this.defaultPostAjaxDelete(a);var b=$("#frm-compare-"+a.data("prodid")).siblings("label");b.hasClass("c-product-tile__compare-button")&&b.toggleClass("c-product-tile__compare-button_active")}function l(a){var b=$(e.checkboxes),d=$(e.tooltips),f=o.find(e.itemPlate),g=null,h=[];b.removeAttr("disabled").siblings("label").removeClass(e.disabledClass),d.addClass("hidden"),a?(f.each(function(a,b){var c=$(b).data("prodid");c&&h.push(c)}),g=b.filter(function(a,b){if(b.id&&b.id.length>0){b.checked=!1;for(var c=0,d=h.length;c<d;c++)if(b.id.indexOf(h[c])>-1)return b.checked=!0,!1}return!0})):g=b.filter(":not(:checked)"),isNaN(c)||null===c||c>=e.maxAllowedInCompare&&(g.attr("disabled","disabled"),g.siblings("label").addClass(e.disabledClass),d.removeClass("hidden"))}var m=null,n=null,o=$(this),p=null,q=null,r={waresParamName:"wares",compareLink:null,maxAllowedInCompare:100,ajaxResponseName:"comparisonMenu",initFromAjax:!1,addToList:{actionType:"change"},timeToShow:2500,disabledClass:"u-disabled"},s=window.mvideo.cacheControl,t=new mvideo.Class.ComparisonManager;null===d&&(d=document.querySelector(".sidebar")),e=mvideo.helpers.paramParser(e,r),e.addToList.actionElement=e.checkboxes,e.initFromAjax=s.isPageFromCache(),e.idFormInput&&(m=$(e.idFormInput),e.actionForm=m.closest("form")),e.idSiteInput&&(n=$(e.idSiteInput)),e.maxAllowedInCompare&&(e.maxAllowedInCompare=parseInt(e.maxAllowedInCompare),isNaN(e.maxAllowedInCompare)&&(e.maxAllowedInCompare=r.maxAllowedInCompare,console.warn("'comparisonManager' can't parse 'maxAllowedInCompare' options resetting to default: "+r.maxAllowedInCompare))),null!==e.compareLink&&(p=o.find(e.compareLink),p.length<1?p=null:q=p.attr("href")),e.onCounterChange=function(a,b,d){b>1&&"ajax"===d&&(o.addClass("hover"),setTimeout(function(){o.removeClass("hover")},e.timeToShow)),c=b},e.configDeleteButtonEventHandlers=function(){var a,b=this;b.config.deleteBtn&&(b.config.itemPlate&&b.$.actionForm&&b.$.actionForm.length>0&&b.$.holder.on("click",b.config.deleteBtn,function(c){c.preventDefault(),a=b.preAjaxDelete(c),t.deleteProduct({url:b.$.actionForm.attr("action"),method:"POST",data:b.$.actionForm.serialize()})}),mvideo.Event.subscribe("comparisonDelete.MiniComparison",function(c,d){a=$('[data-prodid="'+d.comparisonMenu.productId+'"]'),b.manager._commonHandler.call(b.manager,d,d.action),b.postAjaxDelete(a)}))},mvideo.Event.subscribe("listchange",function(a,b){b.listName===e.ajaxResponseName&&(l(!0),
f(b.changedData[e.waresParamName]?b.changedData[e.waresParamName].newValue:null,b.changedData[e.counterName]?b.changedData[e.counterName].newValue:null))});var u=new mvideo.Class.ListStateViewController(this,e);u.preAjax=h,u.postAjax=i,u.preAjaxDelete=j,u.postAjaxDelete=k,b||(b=!0,(new mvideo.Class.AsyncDataLoader).subscribe("after-request",function(a){l(!0)}))})}(),mvideo.Module.define("comparison-slider",function(a){function b(b){var c=$(a.pinableProductTile+"[data-productid="+b+"]");c.length&&(l(c),c.each(function(){$(this).parents(a.holderSelector).trigger({type:a.deleteItemEvent,productId:b})}),setTimeout(function(){N()}))}function c(b){var c,g,h=$(a.pinableProductTile+"[data-productid="+b+"]",U),i=h.closest(a.movingItems);h.addClass(a.removingTileClass),la=e(),$(a.pinableProductTile,U).each(function(b,d){if($(d).is("."+a.removingTileClass))return c=b,!1}),d(),z("delete"),f(h),g=$(a.movingItems+" "+a.cellItems+":nth-child("+(c+1)+")",U),h.remove(),g.remove(),K(i,0)}function d(){var b=T&&T.data(R),c=$("."+a.removingTileClass,U),d=c.data(Q),e=c.data(R),f=$(a.pinableProductTile+":not(."+a.removingTileClass+",."+a.fixedTileClass+")",U);if(b){var g,h=$(V,U),i=T.data(Q);g=e>b?d>i?parseInt(T.css("x")):parseInt(T.css("x"))+Z:d>i?parseInt(T.css("x"))-Z:parseInt(T.css("x")),h.css({x:g})}f.each(function(b){var c=$(this),f=c.data(Q),g=c.data(R),h=parseInt(c.css("x")),i=$(a.movingItems+" "+a.cellItems+":nth-child("+(c.index()+1)+")",U);d>f&&e<g?i.css({x:h-Z}):d<f&&e>g&&i.css({x:h+Z})})}function e(){return $.map($(a.clusterTabHeader),function(b){var c=$(b);return{name:c.attr("data-target"),value:parseInt(c.find(a.clusterHeaderCounter).text())}})}function f(b){var c,d,e,f=b.attr("data-cluster");if(f)d=$(a.clusterBodyContainer).first().attr("data-id"),c=la.filter(function(a,b){return a.name===f||a.name===d}),c.forEach(function(a){e=$('[data-id="'+a.name+'"]'),1===a.value?g(e,b):0===a.value&&(g(e,b),e.find(".c-compare-filter").css("display","none"),e.find(".c-accordion").css("display","none"),e.find(".c-compare-footer form").css("display","none"))});else{$(a.pinableProductTile,U).not(".removing-cell").length<=1&&(g(U,b),U.find(".c-compare-filter").css("display","none"),U.find(".c-accordion").css("display","none"),U.find(".c-compare-footer form").css("display","none"))}}function g(b,c){var d=b.find(a.emptyCell);d.css("display","inline-block"),d.find(".c-product-tile-picture__link").css("background-image","url("+c.find("img").attr("src")+")"),d.find("a").attr("href",c.attr("data-category-url")),U.addClass(a.addToComparisonTableClass)}function h(b){var c,d,e,f,g,h=$(a.clusterBodyContainer).first(),i=decodeURIComponent(location.href),j={};b.forEach(function(a){f=$('[data-productid="'+a+'"]'),d=f.attr("data-cluster"),g=$('[data-id="'+d+'"]'),g.length&&(c=j[d]||g.attr("data-content-url"),j[d]=k(c,a)),h.length&&(c=e||h.attr("data-content-url"),e=k(c,a)),i=k(i,a)});for(var l in j)if(j.hasOwnProperty(l)){var m=$('[data-id="'+l+'"]');m.attr("data-content-url",j[l])}h.attr("data-content-url",e),History.pushState(b.join(","),document.title,i)}function i(b){var c,d,e=$('[data-productid="'+b+'"]'),f=$('[data-id="'+e.attr("data-cluster")+'"]'),g=$(a.clusterBodyContainer).first();f.length&&(c=f.attr("data-content-url"),d=k(c,b),f.attr("data-content-url",d)),g.length&&(c=g.attr("data-content-url"),d=k(c,b),g.attr("data-content-url",d)),j(b)}function j(a){var b=k(decodeURIComponent(location.href),a);History.pushState(a,document.title,b)}function k(a,b){var c=a.split("?")[0],d=mvideo.helpers.getUrlParam(a);if(Object.keys(d).length&&d.wares){for(var e=d.wares.split(","),f=[],g=[],h=0;h<e.length;h+=1)e[h]!==b&&f.push(e[h]);d.wares=f.join(",");for(var i in d)""!==d[i]&&g.push(i+"="+d[i]);return c+"?"+g.join("&")}return a}function l(b){if(la&&la.length){var c,d,e,f,g=b.attr("data-cluster");g&&(c=$(a.clusterTabHeader).first().find(a.clusterHeaderCounter),d=$('[data-target="'+g+'"]').find(a.clusterHeaderCounter),e=parseInt(c.text()),f=parseInt(d.text()),e&&c.text(e-1),f&&d.text(f-1))}}function m(b){b.forEach(function(b){var c=$('[data-productid="'+b+'"]'),d=c.attr("data-cluster");if(d){var e=$('[data-target="'+d+'"]').find(a.clusterHeaderCounter);parseInt(e.text())&&e.text("0")}})}function n(){$(W,U).removeClass(a.divingTileSel),$(V,U).removeClass(a.fixedTileClass),$(a.pinableProductTile+"."+a.fixableTiles).data(P,[]),T=null}function o(b){var c,d,e=$(b.target),f=e.closest(a.cellItems),g=f.closest(a.movingItems),h=!!f&&!f.hasClass(a.fixedTileClass),i={};f.length>0&&(n(),h&&(T=f,p(f),F(f,C(f)),i=K(g,0),d=i.fixedItem.renderedIndex,c=a.movingItems+" "+a.cellItems+":nth-child("+(d+1)+")",p($(c,U))))}function p(b){b.addClass(a.fixedTileClass)}function q(a){a=$(a);var b=a.attr("title"),c=a.text(b).height(),d=a.parent().height(),e=a.text("W").height();if(a.text(b),c-d>=e){for(e=Math.floor(d/e)*e;a.height()>e&&a.text().length>10;)a.text(a.text().slice(0,-1));a.text(a.text().slice(0,-4)+" ...")}}function r(){ca.each(function(a,b){q($("a",b))})}function s(){null!=_.left&&null!=_.right&&_.left.add(_.right).hide()}function t(a){u(),a&&U.on("touchstart.comparison-slider",function(a){ga=a.originalEvent.touches[0].clientX>$(window).width()/2?O.RIGHT:O.LEFT}),U.swipe({preventDefaultEvents:!1,swipeStatus:function(a,b,c,d){var e=!1;switch(b){case"start":U.addClass("swipe-start"),da.startMeasure(B());break;case"move":c!==$.fn.swipe.directions.RIGHT&&c!==$.fn.swipe.directions.LEFT||ia?c!==$.fn.swipe.directions.UP&&c!==$.fn.swipe.directions.DOWN||null!==ia||(ia=!0):(J(da.interimMeasure(d,c),e),ia=!1,a.preventDefault(),a.stopImmediatePropagation(),a.stopPropagation());break;case"cancel":case"end":"end"==b&&(e=!0),U.removeClass("swipe-start"),ia||J(da.stopMeasure(d,c),e),ia=null}},allowPageScroll:$.fn.swipe.pageScroll.AUTO})}function u(){U.off("touchstart.comparison-slider").swipe("destroy"),ga=O.LEFT}function v(){var b,c,d=Y.left.first().find(a.cellItems);Z=d.length&&d.get(0).getBoundingClientRect().width,ea=d.length,fa=Math.round(X.left.width()/Z),ea>fa?mvideo.device.manager.getType()!==mvideo.device.manager.TYPES.MOBILE?(b=Z*(fa-ea),c=X.left.width()-Z*ea,Math.abs(c-b)<.18*Z?da.setMaxLeftDistance(b):da.setMaxLeftDistance(c)):da.setMaxLeftDistance(Z*(fa-ea)):da.setMaxLeftDistance(0),da.setWidthOfOne(Z)}function w(){U.addClass("swipe-start"),da.startMeasure(0);for(var a in O)Y[O[a]].css({x:da.stopMeasure(Z*(aa[O[a]]?aa[O[a]].getPage():0),$.fn.swipe.directions.LEFT,!0)});setTimeout(function(){U.removeClass("swipe-start")})}function x(){parseInt(Y.left.css("width"))>=Z*$(a.pinableProductTile,U).length?($(a.pinBtn,U).hide(),$(V,U).removeClass(a.fixedTileClass)):$(a.pinBtn,U).show()}function y(a,b,c,d){ga=c||O.LEFT,b&&"number"==typeof b||(b=Z),U.addClass("swipe-start"),da.startMeasure(B()),d||U.removeClass("swipe-start"),J(da.stopMeasure(b,a,!0)),z(a),setTimeout(function(){U.removeClass("swipe-start")}),ga=O.LEFT}function z(b){var c,d,e,f=$(a.pinableProductTile,U);switch(b){case"init":f.each(function(a,b){$(b).data(R,a)});break;case"left":T&&T.length&&(c=T.data(R)||T.data(Q),d=c+1,e=$(a.pinableProductTile,U).filter(function(a){return $(this).data(R)==d}),T.data(R,d),e.data(R,c));break;case"right":T&&T.length&&(c=T.data(R)||T.data(Q),d=c-1,e=$(a.pinableProductTile,U).filter(function(){return $(this).data(R)==d}),T.data(R,d),e.data(R,c));break;case"delete":var g=$("."+a.removingTileClass,U),h=g.data(R);c=T&&T.data(R),h!==f.length-1&&f.each(function(a,b){var c=$(this),d=c.data(R);d>h&&c.data(R,d-1)})}}function A(a){var b=parseFloat(a);return isFinite(b)?b:0}function B(){return A(Y[ga||O.LEFT].css("x"))}function C(b){return b.offset().left-b.closest(a.movingItems).offset().left}function D(a){return a.data(P)||[]}function E(a){var b=D(a);return b[b.length-1]}function F(a,b){var c=D(a);return c.push(b),a.data(P,c),c}function G(a){var b=D(a),c=b.shift();return a.data(P,b),c}function H(a,b){return a*b}function I(a,b){return Math.trunc(a/b)}function J(b,c){var d,e,f,g,h,i,j,k=$(V,U),l=$(V+a.pinableProductTile,U),m={};if(ga)aa[ga]&&aa[ga].setPage(Math.abs(Math.round(b/Z))),a.fixableTiles&&l.length>0&&(i=E(l),null==i&&(i=C(l)),j=i-H(l.data(Q),Z),h=A(Y[ga].css("x"))-b,g=h+j,F(l,i+h),0!=h&&(m=K(l.closest(a.movingItems),h))),Y[ga].css({x:b}),a.fixableTiles&&k.length>0&&0!=h&&(l.one(S,function(a){G($(a.currentTarget))}),k.css({x:g}),$.each(m.movingItems,function(b,c){c&&c.item&&c.item.$el&&c.item.$el.is(a.cellItems)&&(e=c.item.renderedIndex,d=$(a.movingItems+" "+a.cellItems+":nth-child("+(e+1)+")",U),d.length>0&&(f=c.shiftX,d.addClass(a.divingTileClass),d.one(S,function(b){$(b.currentTarget).removeClass(a.divingTileClass)}),d.css({x:f})))})),ga===O.LEFT&&mvideo.device.manager.getType()!==mvideo.device.manager.TYPES.MOBILE&&L(b);else{Y[O.LEFT].add(Y[O.RIGHT]).css({x:b});for(var n in O)aa[O[n]]&&aa[O[n]].setPage(Math.abs(Math.round(b/Z)))}}function K(b,c){var d={fixedItemPosition:-1,divingRenderedIndex:-1,divingRenderedIndexes:[],fixedItem:null,unsortedItems:[],sortedItems:[],movingItems:[]},e={};return b.children(a.cellItems).each(function(b){var c=$(this),e=C(c),f=I(e,Z),g=[];if(c.data(Q,b),!c.is(":visible"))return!0;c.hasClass(a.fixedTileClass)?(g=D(c),e=g.length>1?g[g.length-2]:e,d.fixedItem={$el:c,renderedIndex:b,startPosition:I(e,Z)}):d.sortedItems[f]={$el:c,renderedIndex:b,left:e,fixed:c.hasClass(a.fixedTileClass),startPosition:f}}),d.fixedItem&&(e=function(a,b,c){var d,e,f,g=Z,h=[],i=D(b.$el),j=i[i.length-1],k=i.length>1?i[i.length-2]:j-c,l=Math.round(Math.min(j,k)-g),m=Math.round(Math.max(j,k)+g);return 0!=c&&(e=Math.sign(k-j),$.each(a,function(a,c){var i,n,o,p=null,q=!1;c&&(p=c),p&&(i=Math.round(p.left))>l&&i<m&&(n=Math.round(Math.abs(i-k)),o=Math.round(Math.abs(i-j)),f=H(a,g),o<g?(d=p.startPosition>b.startPosition?2*f-j-g:2*f-j+g,q=n<g):n<g?(d=p.startPosition==b.startPosition?f+e*g:f,q=!0):d=j>i?f-g:f+g,!q&&Math.abs(d-i)>g&&(d=i+e*g),q&&i>f&&i<f+g&&(d<f?d=f:d>f+g&&(d=f+g)),h.push({item:p,shiftX:d-H(p.renderedIndex,g)}))})),h}(d.sortedItems,d.fixedItem,c),d.movingItems=e),d}function L(a){null==a?a=ha:ha=a,da.config.maxRightDistance<=a?_.left.hide():_.left.show(),da.config.maxLeftDistance>=a?_.right.hide():_.right.show()}function M(){return ba&&ba.length&&ba.hasClass("affix")}function N(){for(var b in X)X[b].find(a.pager).each(function(a,c){var d=parseInt(aa[b].$.text.text())-1;aa[b].update({currentNumber:d===ea?d-1:d,quantity:ea})})}var O={LEFT:"left",RIGHT:"right"},P="relativeX",Q="renderedIndex",R="newIndex",S="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend";a=$.extend(!0,{comparisonContainer:".c-compare-wrapper-content",holderSelector:".o-compare-page-content",movingItems:".c-compare-content",cellItems:".c-compare-cell__pinable-product-tile",leftCtl:".c-compare-table__slide-left",rightCtl:".c-compare-table__slide-right",leftSide:".c-compare-table__left",rightSide:".c-compare-table__right",tabsContainer:".c-tabs",pager:".o-compare-heading-wrapper__pager",pinBtn:".c-btn.i-icon-pin-fixable",deleteBtn:".i-icon-delete",clearClusterBtn:".c-compare-footer__btn_clear",pinableProductTile:".c-compare-cell__pinable-product-tile",fixedTileClass:"fixed-tile",divingTileClass:"diving-tile",removingTileClass:"removing-cell",headerToFix:null,titlesToTruncate:".c-compare-table-header-wrapper .c-product-tile__description",gainToFix:".c-compare-heading .c-product-tile__description",clusterBodyContainer:".c-tabs__body",clusterBodyInnerContainer:".c-tabs__body-inner",clusterTabHeader:".c-tabs__menu-link",clusterHeaderCounter:"span.c-tabs__menu-counter",gainToFixOffset:-8,offsetFromTopPredefine:233,fixableTiles:!1,emptyCell:".c-compare-cell-empty",addToComparisonTableClass:"c-compare-table__add-new-btn",deleteFromComparisonEvent:"comparisonDelete.ComparisonSlider",deleteItemEvent:"comparison-delete-item"},a);var T,U=$(this),V="."+a.fixedTileClass,W="."+a.divingTileClass,X={left:U.find(a.leftSide),right:U.find(a.rightSide)},Y={left:X.left.find(a.movingItems),right:X.right.find(a.movingItems)},Z=0,_={left:null,right:null},aa={left:null,right:null},ba=null,ca=U.find(a.titlesToTruncate),da=new mvideo.Class.RelativeDistanceCalculator({widthOfOne:Z}),ea=0,fa=0,ga=O.LEFT,ha=0,ia=null,ja={desktopBehavior:function(){L(),u()},tabletBehavior:function(){L(),t()},mobileBehavior:function(){s(),t(!0)}},ka=new mvideo.Class.ComparisonManager,la=e();return v(),z("init"),function(){for(var b in X)X[b].find(a.pager).each(function(a,c){aa[b]=new mvideo.Class.TemplatePager(c,{quantity:ea})})}(),function(){var b=0,c=U.find(a.gainToFix);ba=a.headerToFix?U.find(a.headerToFix):U,ba.length&&c.length&&(b=c.offset().top,b<=0&&(b=$(a.comparisonContainer).offset().top+a.offsetFromTopPredefine),b+=a.gainToFixOffset||0,ba.affix({offset:{top:b}}).on("affixed.bs.affix",function(a){setTimeout(function(){ba.addClass("affixed")})}).on("affixed-top.bs.affix",function(a){ba.removeClass("affixed")}),setTimeout(function(){M()&&(ba.addClass("affixed"),r())}))}(),y($.fn.swipe.directions.LEFT,Z,O.RIGHT,!0),U.find(".c-accordion__item").on("hidden",function(a){$(a.currentTarget).find('[data-toggle="collapse"]').addClass("collapsed")}),new mvideo.Class.ComparisonTable(this,a),mvideo.Event.subscribe("resize.ComparisonSlider",function(){v(),M()&&r(),w(),x(),L()}),a.leftCtl&&a.rightCtl&&(_.left=U.find(a.leftCtl).on("click",y.bind(this,$.fn.swipe.directions.RIGHT)),_.right=U.find(a.rightCtl).on("click",y.bind(this,$.fn.swipe.directions.LEFT))),a.fixableTiles&&(U.on("click",a.pinBtn,o.bind(this)),U.closest(a.tabsContainer).on("tabs.getItemContent.before",n.bind(this))),$(a.tabsContainer).on("tabs.getItemContent.after",function(){mvideo.Event.publish("resize.ComparisonSlider"),N()}),a.deleteBtn&&(U.on("click",a.deleteBtn+", "+a.clearClusterBtn,function(a){var b=$(a.currentTarget),c=b.parent();a.preventDefault(),ka.deleteProduct({method:"POST",url:c.attr("action"),data:c.serialize(),source:"comparison"})}),mvideo.Event.unsubscribe(a.deleteFromComparisonEvent).subscribe(a.deleteFromComparisonEvent,function(a,c){var d=c.comparisonMenu.productId.split(",");if(1===d.length){var e=d[0];i(e),b(e)}else h(d),m(d),d.forEach(b);mvideo.Event.publish("resize.ComparisonSlider")})),U.on(a.deleteItemEvent,function(a){c(a.productId)}),x(),ja}),mvideo.Module.define("comparisonAndWishStateIcon",function(a){function b(){var b=$(a.promoListIndicatorSelector).text();e>0||f>0||b>0?d.addClass(a.headerMenuBtnHasItem):d.removeClass(a.headerMenuBtnHasItem)}a=mvideo.helpers.paramParser(a||{},{headerMenuBtnHasItem:"header-menu-btn__has-items",compareListName:"comparisonMenu",wishlistListName:"wishlistMenu",wishListAmountSelector:".wishlist-amount",headerMenuBtn:".header-menu-btn",list2count:{minicartMenu:"counter",comparisonMenu:"productCount",wishlistMenu:"productCount"},promoListIndicatorSelector:".header-user-drop-down__promolist-amount"});var c=Object.keys(a.list2count),d=$(a.headerMenuBtn),e=0,f=0;mvideo.Event.subscribe("listchange",function(d,g){if(a.doHeaderFlicker&&c.indexOf(g.listName)>-1&&"ajax"===g.eventName){var h=a.list2count[g.listName];if(g.changedData[h]&&g.changedData[h].newValue)var i=parseInt(g.changedData[h].newValue)}g.listName!==a.compareListName&&g.listName!==a.wishlistListName||(h=a.list2count[g.listName],g.changedData[h]&&(i=parseInt(g.changedData[h].newValue),isNaN(i)||(g.listName===a.compareListName?f=i:e=i)),b())})}),mvideo.Module.define("confirm-dubl",function(a,b,c){function d(a){var b=$(a),c=b.data("content-url");m.is(":visible")&&m.addClass("hidden"),h(c,b)}function e(a){var b=$("<div />");b.append(a).appendTo(k),mvideo.initScripts(b)}function f(a){m.text(a).removeClass("hidden")}function g(a){window.location.assign(a)}function h(a,b){return $.ajax({type:"GET",url:a,dataType:"json",cache:!1,beforeSend:function(){i(),m.is(":visible")&&m.addClass("hidden")},success:function(a){a=a||{},a.redirectUrl?g(a.redirectUrl):a.status&&"error"===a.status&&a.errorMessage?f(a.errorMessage):a.status&&"success"===a.status&&a.userData&&(e(a.userData),b.addClass("hidden"))},error:function(){f("Извините, произошла ошибка. Обновите страницу и повторите попытку.")},complete:function(){j()}})}function i(){l.addClass("disabled-form")}function j(){l.removeClass("disabled-form")}var k=$(a),l=k.parents("form"),m=k.find(c);k.on("click",b,function(a){a.preventDefault(),d(this)})}),mvideo.Module.define("confirm-email",function(){function a(){f.addClass("disabled-form")}function b(){i.remove(),j.removeClass("hidden"),n.focusBlock(j,"input:first")}function c(a){var b=$("<div/>",{class:"text-error",text:a});g.append(b)}function d(){f.removeClass("disabled-form")}function e(a){window.location.assign(a)}var f=$("#change-personal-details-form"),g=$(this),h=$("#edit-email"),i=h.find(".change-personal-details-dupl-email"),j=h.find(".change-personal-details-verif-code"),k=$("#confirm-email"),l=$("#frm-new-email"),m=$(this).data("text-error")||"Извините, произошла ошибка. Обновите страницу и повторите попытку.",n=new mvideo.Class.SmartFocus;k.on("click",function(f){f.preventDefault();var g=l.val(),h=$(this).data("content-url");$.ajax({type:"GET",url:h,dataType:"json",data:g,cache:!1,beforeSend:function(){a()},success:function(a){a=a||{},a.redirectUrl?e(a.redirectUrl):a.status&&"success"===a.status&&b()},error:function(){c(m)},complete:function(){d()}})})}),mvideo.Module.define("confirm-phone-for-card",function(a,b,c){function d(){l.addClass("disabled-form")}function e(){l.removeClass("disabled-form"),q.removeClass("disable-partialy")}function f(){k.remove(),m.removeClass("hidden"),t.focusBlock(m,"input:first")}function g(){l.removeClass("disable-partialy")}function h(a){window.location.assign(a)}function i(a){u.text(a).removeClass("hidden")}function j(){u.addClass("hidden")}var k=$(this),l=$(a),m=$(b),n=$(c),o=k.find(".confirm-phone-btn"),p=k.find(".discard-phone-btn"),q=$("#js-switch-add-bonus-card"),r="",s=o.data("content-url"),t=new mvideo.Class.SmartFocus,u=$("<div/>",{class:"text-error hidden"}),v=k.data("text-error")||"Извините, произошла ошибка. Обновите страницу и повторите попытку.";k.append(u),o.on("click",function(a){a.preventDefault(),r="tel="+n.val().replace(/\D/g,""),$.ajax({type:"GET",url:s,dataType:"json",data:r,cache:!1,beforeSend:function(){d(),j()},success:function(a){a=a||{},a.redirectUrl?h(a.redirectUrl):a.status&&"success"===a.status&&f()},error:function(){i(v)},complete:function(){e()}})}),p.on("click",function(a){a.preventDefault(),k.addClass("hidden"),g(),n.val("")})}),mvideo.Module.define("confirm-user-data",function(a,b,c,d){function e(a){var b=a.data("enable"),c=a.data("url"),e=a.data("submit"),j=a.data("focus"),l=a.data("enabled"),m=a.data("hidden"),n=a.data("visibility");return!v.data("disabled")&&!a.hasClass("disabled")&&(b&&f(b),j&&(d?mvideo.Event.publish("confirmUserData",j):t(j)),l&&u(),m&&h(m),n&&i(n),e?(g(w,e),!1):c?(p(c),!1):void k(v))}function f(a){var b=a?a.split(","):[];$.each(b,function(a,b){var c=$.trim(b);q($(c))})}function g(a,b){$("input[type=submit]",a).each(function(){var b=$(this);$("<input type='hidden'/>").attr("name",this.name).val(b.val()).appendTo(a)}),"reject"===b&&mvideo.instance.page.page.validationForms[x].elements().addClass("dont-validate"),a.submit()}function h(a){var b=a?a.split(","):[],c=$($.trim(b[0])),d=$.trim(b[1]);c.val(d)}function i(a){$(a).toggleClass("hidden")}function j(){return z.find("form").length<=2}function k(a){a.slideUp("200",function(){a.remove()})}function l(a){$("<div />").append(a).insertAfter(v),mvideo.initScripts(w)}function m(a){y.text(a).removeClass("hidden")}function n(){y.addClass("hidden")}function o(a){window.location.assign(a)}function p(a){$.ajax({type:"GET",url:a,dataType:"json",cache:!1,beforeSend:function(){r(),n()},success:function(a){a=a||{},a.redirectUrl?o(a.redirectUrl):a.status&&"error"===a.status&&a.errorMessage?m(a.errorMessage):a.status&&"success"===a.status&&(a.userData&&l(a.userData),k(z.hasClass("dubl-journal-form")?j()?z:w:v))},error:function(){m(A)},complete:function(){s()}})}function q(a){a.removeAttr("disabled"),a.removeClass("disabled")}function r(){w.addClass("disabled-form")}function s(){w.removeClass("disabled-form")}function t(a){var b=$(a);return b.attr("value"," "),b.focus(),!1}function u(){$("#form-register-terms").prop("checked")&&$(".add-address-submit-btn").removeAttr("disabled")}var v=$(a),w=v.parents("form"),x=w.attr("id"),y=v.find(c+":last"),z=w.parent(),A=v.data("text-error")||"Извините, произошла ошибка. Обновите страницу и повторите попытку.";v.on("click",b,function(a){var b=$(this);b.is("a")&&a.preventDefault(),e(b)})}),mvideo.Module.define("confrirmation-preload-print",function(a){function b(){if(g)return void window.print();g=!0,window.mvideo.Event.publish("map-fitToViewport"),window.print()}var c=$(".c-tabs"),d=$(".o-confirmation__personal-block-item",c),e=d.length>1?"u-border-top":"",f=this,g=!1,h=$('<div><div class="c-header-checkout u-hidden o-confirmation__number-print">'+$(".c-header-checkout").html()+"</div></div>");h.find(".tooltipstered").data("tooltipster-ns",null).removeClass("tooltipstered"),d.each(function(a){var b=$(this);c.find('[data-id="'+b.data("id")+'"].tab-body .o-confirmation__number-print').before(a>0&&h.html()).after('<div class="o-confirmation__personal-block u-hidden o-confirmation__number-print '+e+'">'+b.html()+"</div>")}),$(".js_link-print").on("click",b.bind(f))}),window.mvideo.Module.define("controller-confirmation-additional",function(a){function b(a,b){new window.mvideo.Class.Notification(a,{errorParams:{textColor:null},successParams:{textColor:null},notificationParams:{notificationAttrs:{class:"u-mb-20"}}}).replace({type:"error",text:b})}var c=$(this),d=c.parents(".c-popup").data("popup-instance");c.on("load-content.success load-content.error code-blocked",'[data-btn-trigger="true"]',function(a,b){b.isSmsConfirmation=!0,d.$.holder.trigger("done",b)}).on("click",'[data-btn-trigger="true"]',function(a){var c=$(this).closest("form");c.validate().valid(),setTimeout(function(){c.validate().valid()&&$.ajax({type:c.attr("method")||"post",url:c.attr("action"),dataType:"json",data:mvideo.helpers.prepareDataSend.getData(a,c).formData,processData:!1,contentType:!1}).done(function(a){return"redirect"===a.status?void window.location.assign(a.url):"error"===a.status?(b(c.find('[data-notification="true"]'),a.notification&&a.notification.text),void c.removeClass("disabled-form")):void d.$.holder.trigger("done",a)}).fail(function(){d.$.holder.trigger("done",{status:"error"})})})})}),window.mvideo.Module.define("controller-confirmation-notification",function(){var a=$(this),b=$('[data-notification-warning="true"]',a);a.one("oneWatch",function(){b.remove()})}),window.mvideo.Module.define("controller-confirmation-warning",function(a){function b(){a.notificationText&&a.notificationText.length>0&&(h.replace({type:"info",text:a.notificationText}),d(!0)),a.limitReached&&d(!0),j&&(a.titleBtn&&a.titleBtn.length>0&&g.text(a.titleBtn),$('[data-notification-phone="true"]',e).remove())}function c(){$.ajax({url:a.url,method:"post",dataType:"json",beforeSend:function(){i||(i=new window.mvideo.Class.Overlay(e,!0)),i.show()}}).then(function(c){"success"===c.status&&(j=c.limitReached,a.titleBtn=c.titleBtn,a.notificationText=c.notificationText,b())}).always(function(){i.hide()})}function d(a){f.toggleClass("u-hidden",!a).toggleClass("u-mb-20",a)}a=$.extend(!0,{url:null,limitReached:!1,titleBtn:null,notificationText:null},a);var e=$(this),f=$('[data-notification-warning="true"]',e),g=$('[data-popup-confirmation="true"]',e),h=new window.mvideo.Class.Notification(f,{infoParams:{iconColor:"orange"}}),i=null,j=a.limitReached;e.on("input-change",function(){b(),!j&&c()}).on("oneWatch",function(){d(!1)})}),window.mvideo.Module.define("controller-confirmation",function(a){function b(a,b){var d=null;n.forEach(function(b,c){b===a&&(d=c)}),c(n[d+1],b)}function c(a,b){switch(a){case"init":k(),y.updateCacheValue(!0),l();break;case"input-dirty":m()?c("submit",b):i();break;case"submit":g(!0),j(b);break;case"confirmation":w.begin(b.content);break;case"notification":d(b);break;case"hideNotification":e();break;case"cancel":i();break;case"showBtn":f(!0);break;case"oneWatch":p.one("input",u),"code-blocked"!==b.state?f():h(),b.backward&&y.backwards(!0),y.updateCacheValue(),t.hide();break;case"replaceContent":g(),p.html(b.content)}o.trigger(a,b)}function d(a){x.replace({type:a.type,text:a.text}),e(!0)}function e(a){s.toggleClass("u-hidden",!a)}function f(a){r.toggleClass("u-hidden",!a)}function g(a){p.toggleClass("disabled-form",!!a)}function h(){p.find("input[data-dirty]").attr("readonly",!0).attr("disabled",!0).addClass("u-disabled"),r.attr("disabled",!0)}function i(){g(!1)}function j(d){var e=mvideo.helpers.prepareDataSend.getData(d,p,!0).formData;$.ajax({type:p.attr("method")||"post",url:p.attr("action"),dataType:"json",data:e,processData:!1,contentType:!1}).done(function(d){return"redirect"===d.status?void window.location.assign(d.url):"success"===d.status?a.withoutSMS?(g(!1),void q.publish("update-confirmation",{status:"done",notification:d.notification})):a.withoutPopup?void c("replaceContent",{content:d.htmlContent}):void b("submit_done",{content:d.htmlContent}):void v(d)}).fail(v)}function k(){p.on("submit",function(a){a.preventDefault()}),p.on("click",'[type="submit"]',function(a){p.validate().valid(),setTimeout(function(){if(p.validate().valid())return b("validation_done",a),!1})})}function l(){p.find('input[data-dirty="true"]').each(function(a,b){var c=$(b);c.data("dirty",!0),y.elementUpdateCacheValue(c,"")})}function m(){return y.searchDirty().length}a=$.extend(!0,{form:"form",confirm:"ClassConfirmation",errMsg:"error",withoutPopup:!1,withoutSMS:!1},a);var n=["validation","validation_done","input-dirty","submit","submit_done","confirmation","confirmation_done","notification","notification_done","cancel","replaceContent"],o=$(this),p=$(a.form,o),q=this,r=$('[data-popup-confirmation="true"]',p),s=$('[data-notification="true"]',o),t=$('[data-notification-phone="true"]',p),u=function(){f(!0),c("hideNotification"),c("input-change"),t.show()}.bind(this),v=function(b){g(!1),c("notification",{type:"error",text:b.notification?"string"==typeof b.notification?b.notification:b.notification.text:a.errMsg})}.bind(this);window.mvideo.observer(this);var w=new window.mvideo.Class[a.confirm](r,{eventBus:"update-confirmation"},q.publish),x=new window.mvideo.Class.Notification(s,{errorParams:{textColor:null},successParams:{textColor:null}}),y=window.mvideo.Module.init("backwards-input",[{myself:!1}],this);q.subscribe("update-confirmation",function(d,e){"done"===e.status?(b("confirmation_done",e.notification),e.isSmsConfirmation&&(o.trigger("confirm.success"),c("oneWatch",e)),c("oneWatch",e.notification)):"error"===e.status?(e.notification||(e.notification={type:"error",text:e.errMsg||a.errMsg}),c("notification",e.notification)):"cancel"===e.status&&c("cancel")}),p.data("apply.validation")?c("init"):p.one("apply.validation",function(){c("init")})}),mvideo.Module.define("countDown",function(a){function b(){if(h>0){h--;var a=i.parseTime(h,j);d.text(a.days),e.text(a.hours),f.text(a.minutes),g.text(a.seconds),setTimeout(function(){b()},1e3)}}a=$.extend(!0,{hoursSelector:".count-down-timer-hours",minutesSelector:".count-down-timer-minutes",secondsSelector:".count-down-timer-seconds",deadline:0,isDiff:!1},a);var c=$(this),d=c.find(a.daysSelector),e=c.find(a.hoursSelector),f=c.find(a.minutesSelector),g=c.find(a.secondsSelector),h=function(a,b){return b?a:Math.floor((a-Date.now())/1e3)}(a.deadline,a.isDiff),i=mvideo.helpers.timeParser,j=function(){return{days:d.length,hours:e.length,minutes:f.length,seconds:g.length}}();b(),setTimeout(function(){c.trigger("count-down-init")},1e3)}),mvideo.Module.define("createComment",function(a){function b(){d(),j.slideUp(function(){p.removeClass("preplay play"),q.append(j),$.isFunction(h)&&h()})}function c(a){$.ajax({type:k.attr("method"),url:k.attr("action"),data:k.serialize()+"&"+decodeURIComponent($.param(a)),dataType:"json",beforeSend:function(){p.addClass("preplay")},success:function(a){a.success?(p.addClass("play"),d(),setTimeout(b,1500)):(d(!0),a.errors&&(s.setForm(k),s.showErrors(a.errors,!0)),p.removeClass("preplay"))},error:function(){r.setContent(g.errorPopupContent),r.show(),p.removeClass("preplay play")}})}function d(a){a||k.get(0).reset(),k.validate().resetForm(),n.removeClass("valid"),l.addClass("disabled").attr("disabled","disabled")}function e(a){var b=$(a.currentTarget);b.data("ignore-change",!0),n.off("focusout",e),setTimeout(function(){b.data("ignore-change",!1),n.on("focusout",e),!o.is(document.activeElement)&&i&&(b.hasClass("ignore")||(b.data("rule-required")||b.val().length||b.hasClass("valid")||b.hasClass("text-error"))&&b.valid(),n.is(document.activeElement)||l.is(a.target)||n.filter(":not(.ignore)").each(function(){var a=$(this);a.data("rule-required")&&a.valid()}))},200)}function f(a){j.slideDown(function(){i=!0}),h=a&&"function"==typeof a?a:null}var g={holder:this,form:"#js-create-comment-form",submitBtn:".js-send-comment",reviewId:"#reviewId",closeBtn:".js-close-form",overlay:".comment-airplane-block",errorPopupContent:{title:"Произошла ошибка сервера",message:"Пожалуйста, повторите попытку позже.",buttonText:"Закрыть"}},h=null,i=!1;$.extend(!0,g,a||{});var j=$(g.holder),k=j.find(g.form),l=k.find(g.submitBtn),m=k.find(g.reviewId),n=k.find("input, textarea"),o=j.find(g.closeBtn),p=j.find(g.overlay),q=$("<div id='create-comment-home'>"),r=new window.mvideo.Class.ErrorPopup(j,g.popupConfig),s=window.mvideo.helpers.form;return q.insertBefore(j).append(j),function(){k.on("click",g.submitBtn,function(a){a.preventDefault(),c(l)}),o.on("click",function(a){a.preventDefault(),b()}),n.on("focusout",e)}(),{attach:function(a,b,c){i=!1,d(),j.hide(),$.isFunction(h)&&h(),void 0!==b?m.val(b):console.warn("[createComment]: reviewId not given"),a.append(j),f(c)},show:f}}),mvideo.Module.define("createMultiBundle",function(a){function b(b){m.addClass(a.copyFromLoadClass),z.show(),D=!0,$.ajax({url:a.contentUrl,method:"GET",dataType:"json",data:b}).fail(function(){location.reload()}).done(function(a){a.htmlContent?(m.html(a.htmlContent),mvideo.Class.ReinitContent.reinit(m)):location.reload()}).always(function(){m.removeClass(a.copyFromLoadClass),z.hide(),D=!1})}function c(b){var c=t.filter(x.editable);b&&(c=c.add(b)),c.removeClass(a.activeClass),c.hasClass(a.selectedClass)||c.addClass(a.emptyClass),m.empty()}function d(b,c){"string"!=typeof c&&(c=JSON.stringify(c));var d=u.serialize()+"&operationName="+b+"&operationValue="+c;return D=!0,$.ajax({url:a.statusUrl,method:"POST",dataType:"json",data:d}).always(function(){D=!1}).fail(function(){location.reload()}).done(function(a){if("object"==typeof a){if("success"===a.status)return void k(a);if(a.redirectUrl)return void location.assign(a.redirectUrl)}location.reload()})}function e(a){a=a||{},p.text(a.new),o.toggle(void 0!==a.old).text(a.old),q.parent().toggle(void 0!==a.profit).end().text(a.profit)}function f(b){var c=$("option:selected",r).data(a.storeIdData);if(r.empty(),b)for(var d=0,e=b.length;d<e;d++)r.append('<option data-icon="icon icon-checkbox" data-store-id="'+b[d].id+'" '+(c===b[d].id?"selected":"")+">"+b[d].name+"</option>");A.reinit(r)}function g(a){var b;for(var c in a)a.hasOwnProperty(c)&&(a[c]=!a[c],b=s.filter('[id^="'+c+'"]').toggleClass("disabled",a[c]).attr("disabled",a[c]),$('label[for="'+b.attr("id")+'"]',C).toggleClass("disabled",a[c]),a[c]&&b.is(":checked")&&s.not(b).click())}function h(b){$(a.submit.holder,C).replaceWith(b)}function i(b,c){for(var d=["img","title","price"],e=0,f=d.length;e<f;e++)c.find(a.copyTo[d[e]]).empty().append(b.find(a.copyFrom[d[e]]).clone());c.data(a.tileIdData,b.data(a.tileIdData))}function j(a){v.toggleClass("hidden",a)}function k(a){a.updateParamsHtml&&h(a.updateParamsHtml),a.price&&e(a.price),a.shops&&a.shops.length>0&&f(a.shops),a.shippingType&&g(a.shippingType),j(!a.isPreSell)}var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B={copyFrom:{holder:this,selector:".product-tile",img:".product-tile-picture-holder",
title:".product-tile-title",price:".product-tile-data",action:".product-tile-add",disabledClass:"disabled-area",permanentlyDisabled:".permanently-disabled"},copyTo:{holder:this,selector:".product-tile:not(:first-child)",img:".product-tile-picture",title:".product-tile-description",price:".product-tile-data-holder",action:".product-tile-delete",activator:".info-icon-holder",disabledClass:"disabled"},totalPrice:{holder:this,new:".multi-bundles-new-price",old:".multi-bundles-old-price",profit:".highlighted-text-primary"},submit:{holder:this},emptyClass:"empty",activeClass:"active",selectedClass:"selected",copyFromLoadClass:"isLoading",storeIdData:"store-id",tileIdData:"tile-id",rebuilderSelector:"",activeClassRebuilder:"active",rebuilderKeyData:"rebuilder-key",rebuilderValueData:"rebuilder-value",messageSelector:".message",bundleSelectHolder:".bundle-pickup-select-holder",pickupType:"",pickupStore:"",contentUrl:"",statusForm:".status-form",statusUrl:"",disabledCount:0},C=$(this),D=!1;C.on("click",".js-multi-bundles-add-to-basket",function(){new mvideo.Class.Overlay($(this).closest("form")).show()}),function(){a=$.extend(!0,{},B,a||{}),a.disabledCount=+a.disabledCount||0,v=$(a.messageSelector,C),s=$(a.pickupType,C),u=$(a.statusForm,C),r=$(a.pickupStore,C),l=$(a.copyTo.holder,C),m=$(a.copyFrom.holder,C),n=$(a.totalPrice.holder,C),t=$(a.copyTo.selector,l),o=$(a.totalPrice.old,n),p=$(a.totalPrice.new,n),q=$(a.totalPrice.profit,n),!a.statusUrl&&a.statusForm&&(a.statusUrl=u.attr("action")),x={empty:"."+a.emptyClass,editable:"."+a.activeClass,selected:"."+a.selectedClass},y={removeTile:"removeTile",addTile:"addTile",changeShippingType:"changeShippingType",changeStore:"changeStore"},z=new mvideo.Class.Overlay(m),A=new mvideo.Class.CustomSelect,w=t.length,a.disabledCount>0&&(t.slice(-a.disabledCount).addClass(a.copyTo.disabledClass),w-=a.disabledCount),$.trim(m.text())&&t.filter(x.empty).first().addClass(a.activeClass),l.on("click",a.copyTo.activator,function(){var c=t.filter(x.editable);!D&&$(this).parents(a.copyTo.selector).is(t.filter(x.empty).first())&&(c.length<=0||c.is(x.selected))&&t.filter(x.selected).length<w&&(b(),t.removeClass(a.activeClass).filter(x.empty).first().addClass(a.activeClass))}).on("click",a.copyTo.action,function(b){b.preventDefault();var e;D||(e=$(this).parents(a.copyTo.selector),e.is(x.selected)&&d(y.removeTile,{id:e.data(a.tileIdData),position:t.index(e)+2}),c(e),e.addClass(a.emptyClass).removeClass(a.activeClass+" "+a.selectedClass))}),m.on("click",a.copyFrom.action,function(b){b.preventDefault();var c,e,f,g;D||(c=$(this).parents(a.copyFrom.selector),e=t.filter(x.editable),d(y.addTile,{id:c.data(a.tileIdData),position:t.index(e)+2}),i(c,e),e.addClass(a.selectedClass).removeClass(a.emptyClass),$(a.copyFrom.selector,m).not(a.copyFrom.permanentlyDisabled).removeClass(a.copyFrom.disabledClass),c.addClass(a.copyFrom.disabledClass),f=[],c.filter(x.selected).each(function(){f.push($(this).data(a.tileIdData))}),(g=c.data("ga-content"))&&e.data("ga-content",g))}).on("click",a.rebuilderSelector,function(c){c.preventDefault();var d=$(this),e={};D||d.hasClass(a.activeClassRebuilder)||($(a.rebuilderSelector,m).filter("[data-"+a.rebuilderKeyData+"="+d.data(a.rebuilderKeyData)+"]").removeClass(a.activeClassRebuilder),d.addClass(a.activeClassRebuilder),e[d.data(a.rebuilderKeyData)]=d.data(a.rebuilderValueData),b(e))}),C.on("click",a.pickupType,function(b){var e=$(this).attr("id");D?b.preventDefault():(e=e?e.split(".")[0]:"",d(y.changeShippingType,{shippingType:e,storeId:$("option:selected",a.pickupStore).data(a.storeIdData)}).then(function(){$(".custom-select-"+r.attr("select-id")).parent(a.bundleSelectHolder).toggleClass("hidden","courier"===e)}),c())}).on("change",a.pickupStore,function(b){var e;D?b.preventDefault():(e=$("input:checked",a.pickupStore).attr("id"),d(y.changeStore,{shippingType:e?e.split(".")[0]:"",storeId:$("option:selected",this).data(a.storeIdData)}),c())})}()}),mvideo.Module.define("create-question",function(a){function b(a){$.ajax({type:g.attr("method"),url:g.attr("action"),data:g.serialize()+"&"+decodeURIComponent($.param(a)),beforeSend:function(){j.addClass("preplay")},success:function(){j.addClass("play")},complete:function(){setTimeout(function(){c(),j.removeClass("preplay play")},e.timeout)}})}function c(){g.get(0).reset(),g.validate().resetForm(),i.removeClass("valid"),h.addClass("disabled").attr("disabled","disabled")}function d(a){var b=$(a.currentTarget);b.data("ignore-change",!0),i.off("focusout",d),setTimeout(function(){if(b.data("ignore-change",!1),i.on("focusout",d),!i.is(document.activeElement)&&!h.is(a.target))return void i.filter(":not(.ignore)").each(function(){var a=$(this);a.data("rule-required")&&a.valid()});b.hasClass("ignore")||(b.data("rule-required")||b.val().length||b.hasClass("valid")||b.hasClass("text-error"))&&b.valid()},200)}var e={holder:this,form:"#js-question-create-form",submitBtn:".js-send-question",overlay:".airplane-block",timeout:2e3};$.extend(!0,e,a||{});var f=$(e.holder),g=f.find(e.form),h=g.find(e.submitBtn),i=g.find("input, textarea"),j=f.find(e.overlay);!function(){h.on("click",function(a){a.preventDefault(),b(h)}),i.on("focusout",d)}()}),mvideo.Module.define("create-review-ext",function(a){function b(a){$.ajax({type:h.attr("method"),url:h.attr("action"),dataType:"json",data:h.serialize()+"&"+decodeURIComponent($.param(a)),beforeSend:function(){e(!0)},success:function(a){c(a.errors),a.success&&(f.isOldSG&&k.addClass("play"),g.trigger("create-review-ext.success",a))},error:function(){l.setContent(f.errorPopupContent),l.show(),g.trigger("create-review-ext.error")},complete:function(){e(!1)}})}function c(a){var b=window.mvideo.helpers.form;h.validate().resetForm(),j.removeClass("valid"),a?(b.setForm(h),b.showErrors(a,f.isOldSG)):d(),f.isOldSG&&i.addClass("disabled").attr("disabled","disabled")}function d(){h.get(0).reset(),h.find(f.characteristic).val("").change(),g.find(f.userImages).val(""),g.find(f.photoList).empty()}function e(a){f.isOldSG?a?k.addClass("preplay"):setTimeout(function(){k.removeClass("preplay play")},f.timeout):a?m.show(h):m.hide(h)}var f={holder:this,form:"#js-review-ext-create-form",submitBtn:".js-send-review",submitAuthorize:".js-authorize-review",characteristic:".characteristic-value",userImages:"#userImages",photoList:".photo-list",overlay:".airplane-block",timeout:3e3,errorPopupContent:{title:"Произошла ошибка сервера",message:"Пожалуйста, повторите попытку позже.",buttonText:"Закрыть"},isOldSG:!0};$.extend(!0,f,a||{});var g=$(f.holder),h=g.find(f.form),i=h.find(f.submitBtn),j=h.find("input, textarea"),k=g.find(f.overlay),l=new window.mvideo.Class.ErrorPopup(g,f.popupConfig),m=!f.isOldSG&&new mvideo.Class.Overlay;!function(){var a=!1;g.on("click",f.submitBtn,function(a){f.isOldSG&&a.preventDefault(),h.validate().checkForm()&&b(i)}).on("click",f.submitAuthorize,function(){j.addClass("dont-validate")}),f.isOldSG&&j.on("focusout",function(b){var c=$(b.currentTarget);c.data("ignore-change",!0),setTimeout(function(){if(c.data("ignore-change",!1),a)return void(a=!1);c.hasClass("ignore")||(c.data("rule-required")||c.val().length||c.hasClass("valid")||c.hasClass("text-error"))&&c.valid(),j.is(document.activeElement)||i.is(b.target)||j.filter(":not(.ignore)").each(function(){var a=$(this);a.data("rule-required")&&a.valid()})},200)}),i.on("click",function(){a=!0})}()}),mvideo.Module.define("customScrollSelectShop",function(a,b){function c(a){a.removeAttr("style"),a.hasClass(b.customScrollClasses)&&a.customScrollArea("destroy")}function d(a){Modernizr.cssscrollbar?g[a?"addClass":"removeClass"](b.hasScrollClass):g.customScrollArea({scrollInertia:0})}function e(){var a,e=g.parentsUntil(b.sidebar).last();c(g),a=h.height(),e.outerHeight(!0)>a&&(g.css({height:a-g.offset().top,overflow:"auto"}),d(!0))}function f(){c(g),d(!1)}b=$.extend(!0,{sidebar:".header-slideup",customScrollClasses:"customScrollArea _CSA",hasScrollClass:"has-scroll"},b||{});var g=$(a),h=g.parents(b.sidebar);return{desktopBehavior:f,tabletBehavior:e,mobileBehavior:e}}),mvideo.Module.define("customScroll",function(a){function b(a){c.parents(".sticky-header").length>0?f.update():e.off("sticky-show",b)}var c=$(this),d=c.children().first(),e=c.parents(".sticky-header"),f=new mvideo.Class.CustomScroll(c,{selectors:{scrolledArea:d}});e.length>0&&e.on("sticky-show",b)}),mvideo.Module.define("custom-tooltip",function(a,b,c,d,e,f){console.warn('MVIDEO WARNING  ======>  You use deprecated module "custom-tooltip", please, use "sg-tooltip"'),"#"+this.id==a&&(console.warn('MVIDEO WARNING  ======>  You use "selector" ('+a+')  equal "this"'),a=!1),d="true"===d;var g=a?$(a):$(this);new mvideo.Class.Tooltip(g,{contentAsHTML:!0,side:b,trigger:d?"hover":"click",title:g.data("tooltipText")})}),window.mvideo.Module.define("data-persister-over-submit",function(a){var b=$.extend(!0,{holder:this,cookieName:"mvid_d4gtm",keepValue:"bc",expiryMinutes:1},a),c=$(b.holder),d=b.form?$(b.form):c,e=b.expiryMinutes+6e4;d.on("submit",function(){var a=new Date((new Date).getTime()+e);$.cookie(b.cookieName,b.keepValue,{expires:a})})}),mvideo.Module.define("dateInterval",function(a){function b(a){var b=null;if(a){if(/^[0-9]{2}\.[0-9]{2}\.[0-9]{4}$/.test(a)){var c=a.split("."),d=parseInt(c[0],10),e=parseInt(c[1],10),f=parseInt(c[2],10);b=new Date(f,e-1,d)}else b=a}return b}function c(a,b){var c=!1,d=b.split("."),e=parseInt(d[0],10),f=parseInt(d[1],10),g=parseInt(d[2],10),h=new Date(g,f-1,e),i=$.datepicker._getInst(a),j=$.datepicker._getMinMaxDate(i,"min"),k=$.datepicker._getMinMaxDate(i,"max");return j<=h&&k>=h&&(c=!0),c}function d(){var b=this,d=$(this),e=d.val(),f="#"+d.attr("id");return c(b,e)?d.datepicker("setDate",e):f===a.startInput?d.datepicker("setDate",a.startDate):f===a.endInput&&d.datepicker("setDate",a.endDate),!1}a=$.extend({startInput:"#date-filter-1",endInput:"#date-filter-2",minDate:"01.11.2013",maxDate:"0",startDate:"-1y",endDate:"0"},a);var e=$(this),f=e.find(a.startInput),g=e.find(a.endInput);f.datepicker({dateFormat:"dd.mm.yy",defaultDate:a.startDate,changeYear:!0,maxDate:b(a.maxDate),minDate:b(a.minDate),onSelect:function(){var a=$(this),b=a.datepicker("getDate");g.datepicker("option","minDate",b)}}),g.datepicker({dateFormat:"dd.mm.yy",defaultDate:a.endDate,changeYear:!0,maxDate:b(a.maxDate),minDate:b(a.minDate),onSelect:function(){var a=$(this),b=a.datepicker("getDate");f.datepicker("option","maxDate",b)}}),f.datepicker("setDate",a.startDate),g.datepicker("setDate",a.endDate),f.on("change",d),g.on("change",d),$(window).on("resize",$.throttle(1e3,function(){window.innerWidth<=800&&window.innerHeight<=600?$(window).on("orientationchange",function(){f.datepicker("hide"),g.datepicker("hide")}):(f.datepicker("hide"),g.datepicker("hide"))}))}),mvideo.Module.define("delSocialAccount",function(a,b){$(a).on("click",function(a){$(this).parent().find(b).trigger("click"),a.preventDefault(),a.stopPropagation()})}),mvideo.Module.define("determine-user-data",function(a){function b(){k.addClass("disabled-form")}function c(){k.removeClass("disabled-form")}function d(){r.hasClass("enable-forbidden")||(q.removeAttr("disabled"),s.removeClass("disabled"),t.removeClass("disabled")),v.removeClass("disabled")}function e(){q.attr("disabled","disabled"),s.addClass("disabled"),t.addClass("disabled"),v.addClass("disabled")}function f(a){var b=o.val();o.rules("add",{"exception-value":b,messages:{"exception-value":a}}),o.valid()}function g(){p.text(z)}function h(){l.removeAttr("disabled"),l.removeClass("disabled")}function i(a){window.location.assign(a)}function j(a){n.addClass("hidden"),u.val(a),h()}var k=$("#change-personal-details-form"),l=$(".add-address-submit-btn"),m=$(a),n=m.find(".found-user-data"),o=$("#js-birthday-date-dubl"),p=$('label[for = "js-birthday-date-dubl"][class = "text-error"]'),q=$("#card-basic"),r=$("#card-basic").closest(".check-card-basic"),s=$('label[for = "card-basic"]'),t=s.find("span"),u=$("#confirm-found-data"),v=$("#confirm-data"),w=m.find(".disclame-data"),x="",y=$(this).data("content-url"),z=$(this).data("text-error")||"Извините, произошла ошибка. Обновите страницу и повторите попытку.";o.on("change",function(){o.valid()?(x="dateBirth="+$("#js-birthday-date-dubl").val(),$.ajax({type:"GET",url:y,data:x,dataType:"json",cache:!1,beforeSend:function(){b()},success:function(a){a=a||{};var b=a.errorMessage?a.errorMessage:"";a.redirectUrl?i(a.redirectUrl):a.status&&"error"===a.status?(f(b),e()):a.status&&"success"===a.status&&d()},error:function(){g()},complete:function(){c()}})):e()}),v.on("click",function(a){a.preventDefault(),$(this).hasClass("disabled")||j(!0)}),w.on("click",function(a){a.preventDefault(),j(!1)}),$("#card-basic").on("change",function(){$(this).prop("checked")?$("#input-for-card-basic").val("true"):$("#input-for-card-basic").val("false")})}),mvideo.Module.define("digital-code-activation",function(a){function b(a){e.css("display","block").text(a||d.errorMessage)}var c=$(this),d=$.extend(!0,{disableFormClass:"disabled-form",errorSelector:".c-text-field .u-error-text",errorMessage:"Извините, сервис временно недоступен. Попробуйте позже.",recaptchaSelector:".recaptcha-wrapper"},a),e=c.find(d.errorSelector),f=$('[data-recaptcha-checkbox="true"]',c);c.on("submit",function(a){if(c.valid()){var e=c.attr("action"),g=c.attr("method"),h=c.serialize();c.addClass(d.disableFormClass),$.ajax({url:e,type:g,data:h}).then(function(a){a.redirectUrl?(c[0].reset(),window.open(a.redirectUrl,"_blank")):a.errorMessage&&b(a.errorMessage),a.showRecaptcha?(f.trigger("show-recaptcha"),f.trigger("reinit-recaptcha")):f.trigger("hide-recaptcha")}).fail(function(){b(d.errorMessage)}).always(function(a){c.removeClass(d.disableFormClass)})}})}),mvideo.Module.define("dc-bind-actions-old",function(a){a=$.extend(!0,{selector:"",logUrl:"/checkout/widgetDCStatusLogger.json.jsp",dcFunctionAvailableError:"DCLoans function is not defined in window"},a);var b=new mvideo.Class.DirectCreditOld;window.DCCheckStatus=b.dcCheckStatus,window.dcOrderIdForCheck="",$(a.selector).on("click",function(){$(this).prop("disabled",!0),b.startPayment(a)})}),mvideo.Module.define("dc-bind-actions",function(a){a=$.extend(!0,{selector:"",logURL:"/checkout/widgetDCStatusLogger.json.jsp",dcFunctionAvailableError:"DCLoans function is not defined in window",debug:!1},a);var b=new mvideo.Class.DirectCredit(a);window.DCCheckStatus=function(){b.dcCheckStatus()},b.startDirectCreditPayment()}),mvideo.Module.define("dynamicCarouselNavigation",function(a,b){a=$(a,b);var c=$(this),d=new mvideo.Class.Overlay(b),e=new mvideo.Class.LazyLoad;c.on("change",function(b){var c=$(this),f=c.val();d.show(),a.load(f,function(){e.add(a).update(),a.attr("rel","true"),a.triggerHandler("updateSizes"),d.hide(),a.find("[data-pushable='true']").each(function(){mvideo.Module._items.GTMEventsEnableTracking($(this))})})})}),mvideo.Module.define("edit-email",function(a,b,c){function d(){w.val(""),x.removeClass("error success"),y.empty(),z.val(""),A.removeClass("error success"),B.empty()}function e(){t.val(""),u.removeClass("error success"),v.empty()}function f(a){var b=$("<div/>",{class:"text-error",text:a});D.append(b)}function g(){m.addClass("disabled-form")}function h(){m.removeClass("disabled-form")}function i(){var a,b=$("#verif-code-email"),c=b.find(".btn-submit").data("content-url"),d=b.data("error-message"),e=null;(e=!(!F.hasClass("hidden")&&!F.hasClass("u-hidden"))||(!E.length||E.valid()))&&(a=window.mvideo.helpers.inputs.getData(F),n.addClass("hidden"),b.removeClass("hidden"),$.ajax({type:"POST",url:c,dataType:"json",data:$.extend(!0,{sendAlert:!0},a),cache:!1,beforeSend:function(){g()},success:function(a){a=a||{},a.status&&"success"===a.status?(b.find(".verif-code-message").html(a.textMessage),mvideo.Event.publish("verification-code-show",a),l=mvideo.instance.verificationCode.codeConfirmation,k(b),j()):"error"===a.status&&f(a.error)},error:function(){f(d)},complete:function(){h()}}))}function j(){var a=$("#verif-code-email");l.subscribe("confirmation-code-check-before",function(a){g()}),l.subscribe("confirmation-code-check-success",function(b,c){c.status&&"success"===c.status?(o.removeClass("hidden"),C&&C.length&&C.val("true")):"error"===c.status&&(a.removeClass("hidden"),a.find(".input").next(".text-error").show().html(c.error),a.find(".input").removeClass("success").addClass("error"),a.find(".input-verif-code").removeClass("valid").addClass("text-error"))}),l.subscribe("confirmation-code-check-request-error",function(b,c){f(a.data("error-message"))}),l.subscribe("confirmation-code-check-complete",function(a){h()})}function k(a){a.find(".btn-cancel").on("click",function(b){b.preventDefault(),a.addClass("hidden"),n.removeClass("hidden"),h(),m.find("label.text-error").hide().html(""),a.find(".input").removeClass("success error"),a.find(".input-verif-code").removeClass("valid text-error").val(""),m.trigger("closeEditMode"),l.cancelConfirmation()})}var l,m=$("#change-personal-details-form"),n=$(a).find(c),o=$(b),p=o.find(".change-personal-details-dupl-email"),q=o.find(".cancel-change"),r=o.find(".change-personal-details-account-password"),s=$("#cancel-dubl-email"),t=r.find(".input-account-pass"),u=t.closest(".input"),v=r.find(".label-for-account-pass"),w=$("#frm-number-email"),x=w.closest(".input"),y=$('label[for = "frm-number-email"][class = "text-error"]'),z=$("#frm-new-email-repeat"),A=z.closest(".input"),B=$('label[for = "frm-new-email-repeat"][class = "text-error"]'),C=$("#email-edit-state"),D=$(this),E=$("#recaptcha-email-change-checkbox"),F=E.parents(".verif-code-recaptcha");new mvideo.Class.SmartFocus,n.on("click",function(a){a.preventDefault(),$(this).hasClass("available")&&!$(this).hasClass("disabled")&&i()}),q.on("click",function(a){o.addClass("hidden"),n.removeClass("hidden"),d(),e(),C&&C.length&&C.val("false"),m.trigger("closeEditMode")}),s.on("click",function(a){a.preventDefault(),p.remove(),r.removeClass("hidden"),q.removeClass("hidden"),d(),w.focus()})}),mvideo.Module.define("edit-phone-or-email",function(a,b,c){var d=$(b).find(a),e=$(c).find(a),f=d.hasClass("disabled"),g=e.hasClass("disabled");d.on("click",function(a){a.preventDefault(),$(this).hasClass("available")&&!$(this).hasClass("disabled")&&e.addClass("disabled")}),e.on("click",function(a){a.preventDefault(),$(this).hasClass("available")&&!$(this).hasClass("disabled")&&d.addClass("disabled")}),$("#change-personal-details-form").on("closeEditMode",function(){!f&&d.removeClass("disabled"),!g&&e.removeClass("disabled")})}),mvideo.Module.define("enableTrackingForObject",function(a){var b=a.data("track-event")||"click",c=a.data("track-category-function"),d=a.data("track-action-function"),e=a.data("track-label-function");a.on(b,function(){var b,f,g;f=d?mvideo.Module.init(d,[a.data("track-action-function-param")]):a.data("track-action"),b=e?mvideo.Module.init(e,[a.data("track-label-function-param")]):a.data("track-label"),g=c?mvideo.Module.init(c,[a.data("track-category-function-param")]):a.data("track-category"),"undefined"!=typeof _gaq&&window._gaq.push(["_trackEvent",g,f,b])})}),$(function(){$("[data-ga-track=true]").each(function(a,b){mvideo.Module._items.enableTrackingForObject($(b))})}),mvideo.Module.define("gaProdcutSortingActionFunction",function(a){return{"sorting.options.displayName.ascending":"Sorting_on_name_AZ","sorting.options.displayName.descending":"Sorting_on_name_ZA","sorting.options.price.ascending":"Sorting_on_price_smallest_first","sorting.options.price.descending":"Sorting_on_price_biggest_first"}[$(a).find("option:selected").data("label")]}),mvideo.Module.define("gaBundleLabelFunction",function(a){var b=$(a),c=b.find("[type=checkbox]:checked"),d=[];return c.each(function(a,b){var c=$(b).attr("id").slice("bundleComponent_".length);d.push($("#image_"+c).attr("href"))}),d.join(", ")}),mvideo.Module.define("gaCheckoutLabel",function(){var a=[];return $("[data-category]").each(function(b,c){var d=$(c).data("category");a.push(d)}),a.join(", ")}),mvideo.Module.define("gaProductTileCategoryFunction",function(){return{addToBasket:"add_to_cart_pop_up",promotionPLP:"PLP_Adding_to_cart"}[$(document.body).attr("class").split(" ")[0]]}),mvideo.Module.define("gaProductTileActionFunction",function(){return{addToBasket:"add_accessory_to_cart_Click",promotionPLP:"Add_product_to_cart_click"}[$(document.body).attr("class").split(" ")[0]]}),mvideo.Module.define("bindCarouselEventsForGA",function(a){var b=$(a),c=b.find(".prev-btn"),d=b.find(".next-btn"),e=b.find(".carousel-paging");c.data("track-event","click").data("track-category","add_to_cart_pop_up").data("track-action","scrolling_acessories_list_left").data("track-label",document.location.href),d.data("track-event","click").data("track-category","add_to_cart_pop_up").data("track-action","scrolling_acessories_list_right").data("track-label",document.location.href),e.data("track-event","click").data("track-category","add_to_cart_pop_up").data("track-action","circles_navigation").data("track-label",document.location.href),mvideo.Module._items.enableTrackingForObject(c),mvideo.Module._items.enableTrackingForObject(d),mvideo.Module._items.enableTrackingForObject(e)}),window.mvideo.Module.define("event-watch",function(a){if(a=$.extend(!0,{evHolder:this,ev:"load-content.success",additionalModule:null,additionalModuleParam:null},a),a.additionalModule&&window.mvideo.Module._items[a.additionalModule]){var b=$(a.evHolder,this),c=window.mvideo.Module.init(a.additionalModule,a.additionalModuleParam,this);b.on(a.ev,function(a,b){c&&c.eventDone(a,b)})}}),window.mvideo.Module.define("set-attribute",function(a){a=$.extend(!0,{nameAttribute:"data-similar-status",selectTarget:null,possibleValues:["success","error"]},a);var b=a.selectTarget?$(a.selectTarget,this):$(this);return{eventDone:function(c,d){~a.possibleValues.indexOf(d.status)&&b.attr(a.nameAttribute,d.status)}}}),window.mvideo.Module.define("target-event",function(a){function b(b,c){d.trigger(a.triggerEvent)}a=$.extend(!0,{ev:"formValid",selector:'[data-target-event="true"]',triggerEvent:"nextsubmit",myself:!0},a);var c=$(this),d=a.selector?c.find(a.selector):c;return a.myself&&c.on(a.ev,b),{eventDone:b}}),window.mvideo.Module.define("toggle-class",function(a){a=$.extend(!0,{nameClass:"footer-subscribe_success",selectTarget:null},a);var b=a.selectTarget?$(a.selectTarget,this):$(this);return{eventDone:function(c,d){b.toggleClass(a.nameClass)}}}),mvideo.Module.define("exchange-tabs",function(a){var b={container:"[data-state-container]",states:["o-exchange_method-quality-check","o-exchange_method-quality"],className:"o-exchange_method-",input:'[name="qualityCheck"]',ev:"tabs.getItemContent.after"};b=$.extend(!0,b,a||{});var c=$(this),d=c.find(b.input),e=new mvideo.Class.StateContainer(b.container||c,{states:b.states});c.on(b.ev,function(a,c){var f=$(c).data("id"),g=b.className+f;d.length&&d.val(f),e.setState(g)})}),mvideo.Module.define("expandableInfo",function(a){var b=new mvideo.Class.OpenClose(this,a),c={delimiter:a&&a.delimiter||"&nbsp;— "};return a&&a.selectorMessageStat&&$(a.selectorMessageStat,this).html($(b.config.selectors.opener,this).html()+c.delimiter),{init:b.initialize()}}),mvideo.Module.define("extend-reserve",function(a){function b(){var a,b,d="html",e=c;if("mobile"===mvideo.device.manager.getType()?$(".c-popup__block").find(".c-btn_close").trigger("click"):"reserve"===l.action&&q.click(),"reserve"===l.action)a={orderID:l.orderID,page:l.page};else if("cancel"===l.action){if(b=m.closest("form"),!b.validate().checkForm())return!1;a=b.serialize()+"&page="+l.page,b.closest(".c-popup__block").find(".c-btn_close").click()}else a={orderID:l.orderID},d="json",e=f;return h(),$.ajax({type:"POST",url:l.url,data:a,dataType:d,cache:!1}).done(e).fail(g),!1}function c(a){if(k(),n.replaceWith(a),n=$("#order-"+l.orderID),mvideo.Class.ReinitContent.reinit(n),o=n.find(l.notificationClass),p=o.find(".c-notifications__close"),p.off("click").on("click",j),n.trigger("changeBtnCount"),"orderHistory"===l.page){var b,c,e=$(l.orderHistorySelector),f=e.data("init-param");"object"==typeof f&&f.holder&&(b=$(f.holder),(c=b.data("instance"))&&d(c))}}function d(a){var b,c=a.getData(),d=c.orders,f=d.selected,g=l.statusMap[n.find(l.itemSelectors.icon).attr("class")],h=n.find(l.itemSelectors.status).html(),i=n.find(l.itemSelectors.infoBtn),j=e(d,f);i.length&&(b=q[0].outerHTML),j.icon=g,j.status=h,j.tooltipContent=b,a.setData(c,!0)}function e(a,b){for(var c,d=a.groups["g-"+b.group],e=d.pages[b.page],f=l.orderID,g=e.length;g--;)if(c=e[g],c.order===f)return c}function f(a){var b,c=n.find(l.lifeCycleWrapper);a.data?(c.prepend(a.data),b=new mvideo.Class.OpenClose(n,{selectors:{opener:".show-status-life-cycle",opencloseBlock:".status-life-cycle"},changeText:l.lifeCycleHideBtnText}),m.off("click"),b.initialize(),i(),m.trigger("click")):g(a.error)}function g(a){var b="string"==typeof a?a:l.errorMessages[l.action];i(),o.find(".c-notifications__title").html(b),o.slideDown(l.errorAnimationDuration),"show-life-cycle"===l.action&&window.dataLayer.push({event:"OWOX",eventAction:"show",eventCategory:"Non-Interactions",eventLabel:"errorStatusDetail",eventContext:l.orderID,eventError:b})}function h(){r.attr("class","font-icon i-icon-overlay"),n.addClass(l.overlayClass)}function i(){r.attr("class",s),n.removeClass(l.overlayClass)}function j(){o.slideUp(l.errorAnimationDuration)}function k(){"cancel"===l.action&&$('[data-content-gifts="true"]').remove()}var l=$.extend(!0,{url:"/extend-reserve",orderID:"12345678",iconWrapper:".order-history-item-icon-wrapper",notificationClass:".order-history-notification",lifeCycleWrapper:".order-details-item-status-bottom-wrapper",page:"orderHistory",overlayClass:"u-disabled-white",action:"reserve",errorReserveText:"Ошибка продления резерва. Попробуйте позже",errorCancelText:"Ошибка отмены заказа. Попробуйте позже",errorShowLifeCycleText:"Ошибка загрузки этапов заказа. Попробуйте позже",lifeCycleHideBtnText:"Скрыть подробный статус",errorAnimationDuration:300,orderHistorySelector:'[data-init="ajax-order-history"]',itemSelectors:{icon:".font-icon",status:".order-history-item-status",infoBtn:".order-history-item-info-btn"},statusMap:{"font-icon i-icon-clock":"progress","font-icon i-icon-check":"success","font-icon i-icon-cross":"cancelled"}},a),m=$(this),n=$("#order-"+l.orderID),o=n.find(l.notificationClass),p=o.find(".c-notifications__close"),q=n.find('[data-order-id="'+l.orderID+'"]'),r=n.find(l.iconWrapper+" .font-icon"),s=r.attr("class");l.errorMessages={reserve:l.errorReserveText,cancel:l.errorCancelText,"show-life-cycle":l.errorShowLifeCycleText},m.click(b),p.off("click").on("click",j)}),mvideo.Module.define("facetDetectum",function(a,b){function c(a){a&&b?d.stickyItem.enable():d.stickyItem.disable()}var d=new mvideo.Class.FacetSectionDetectum(a,{enableDetectumStickyItem:"true"===b,enableStickyItem:!1,routes:{desktop:{target:".main-section .search-results-toolbar",method:"after"}},closeBtnTextOnFilter:$(a).find(".sticky-result-holder").text()});return{desktopBehavior:function(){d.hideSidebarOverlay(),d.switchTo("desktop"),d.$.holder.show(),d.facets.run("reinit"),c(!1),d.disableSwipe()},tabletBehavior:function(){d.switchTo("tablet"),c(!0),d.disableSwipe()},mobileBehavior:function(){d.switchTo("mobile"),c(!0),d.disableSwipe()}}}),mvideo.Module.define("facet-price",function(a){new mvideo.Class.FacetPrice(this,$.extend(!0,{withoutAsyncDataLoader:!0},a))}),mvideo.Module.define("facet",function(a,b){function c(a){var b=e.page.sidebar,c=e.sidebar,d=mvideo.device.manager.getType();a?e.stickyItem.enable():e.stickyItem.disable(),b.isVisible()&&"desktop"!==d&&b.show(c)}var d="true"===b,e=new mvideo.Class.FacetSection(a,{enableStickyItem:d,routes:{desktop:{target:".facet-section",method:"after"}}});return{desktopBehavior:function(){e.hideSidebarOverlay(),e.switchTo("desktop"),e.$.holder.show(),e.facets.run("reinit"),c(!1)},tabletBehavior:function(){e.$.holder.hide(),e.switchTo("tablet"),c(d)},mobileBehavior:function(){e.$.holder.hide(),e.switchTo("mobile"),c(d)}}}),mvideo.Module.define("file-loader",function(a){function b(a){a.preventDefault(),i(),q.trigger("click")}function c(){var b=parseInt(a.maxSize);switch(w.toLowerCase()){case"мб":b*=Math.pow(1024,2);break;case"кб":b*=1024}return b}function d(b){var c=mvideo.helpers.getFileInfo(q[0]);if(a.isFullSize?c.byteSize+x>v:c.byteSize>v)q.val(""),h(a.canNotAttachMsg.replace("#f#",c.name));else if(k(c.type)){var d=++u;s.append(f(c.type,c.name,c.size,d)),e(q[0],d),j(c.byteSize)}}function e(a,b){var c=$(a),e=c.clone();c.data("file-id",b),c.attr("data-file-id",b),c.off("change"),e.val(""),e.on("change",d),q=e,r.append(e)}function f(a,b,c,d){var e=z.clone(),f=$(".c-file-preview__type",e),h=$(".c-file-preview__name",e),i=$(".c-file-preview__size",e),j=$(".c-file-preview__button",e);return f.text(a),h.text(b),i.text(c?"("+c+")":""),j.on("click",{fileId:d},g),e}function g(b){var c=b.data.fileId,d=$(b.target),e=d.parent(".c-file-preview"),f=$(a.inputSelector+"[data-file-id="+c+"]",r),g=mvideo.helpers.getFileInfo(f[0]);e.remove(),f.remove(),j(-g.byteSize)}function h(a){t.removeClass("hidden"),B.replace({type:"info",text:a})}function i(){t.addClass("hidden"),B.close()}function j(b){var c,d,e=l();x+=b,c=a.isFullSize&&v-x<.1,d=a.filesCount&&e>=a.filesCount,a.required&&(e?(y.prop("checked",!0),y.valid()):y.prop("checked",!1)),c||d?(r.addClass("hidden"),a.needLimitMsg&&h(d?a.fullCountMsg:a.fullSizeMsg)):(r.removeClass("hidden"),i())}function k(b){var c=!0,d=/%type%/g;return a.forbiddenFiles.forEach(function(a){var e=new RegExp(b,"i"),f=a.type.match(e);c&&f&&(c=!1,q.val(""),h(a.message.replace(d,f[0])))}),c}function l(){return r.find("input[data-file-id]").length}function m(){r.find(".c-file-loader__input:not([data-file-id])").remove()}function n(b,c){var e=$(C),f=!(c&&c.notClear);if(c){if(c.banAttachments)return void o.addClass("u-hidden");v=c.maxSize||v,c.capacityMsg&&A.html(c.capacityMsg),a.fullSizeMsg=c.fullSizeMsg||a.fullSizeMsg}r.append(e),e.on("change",d),q=e,f&&(u=0,x=0,s.html(""),r.find("input[data-file-id]").remove(),a.required&&y.prop("checked",!1)),j(0)}a=$.extend(!0,{fileLoaderSelector:"",maxSize:"5 Мб",isFullSize:!0,filesCount:null,required:!1,previewContainerSelector:".c-file-loader__preview",loaderBtnSelector:".c-file-loader__button",inputSelector:".c-file-loader__input",inputContainerSelector:".c-file-loader__control",notificationContainerSelector:".c-file-loader__notification",notificationSelector:".c-notifications__title",requiredInput:".c-file-loader__required",fullSizeMsg:"",fullCountMsg:"",needLimitMsg:!0,canNotAttachMsg:"",forbiddenFiles:[{type:"",message:"Файл с неуказанным типом прикрепить невозможно."},{type:"exe",message:"Файл с типом exe прикрепить невозможно."}],sizeClasses:"",typeClasses:"",notificationConfig:{notificationParams:{iconColor:"gray20"}},capacityMsg:"[data-capacity-msg]",nameInstanceFileLoader:void 0},a);var o=$(a.fileLoaderSelector||this),p=o.find(a.loaderBtnSelector),q=o.find(a.inputSelector).first(),r=o.find(a.inputContainerSelector),s=o.find(a.previewContainerSelector),t=o.find(a.notificationContainerSelector),u=0,v=0,w="",x=0,y=a.required&&$(a.requiredInput,o),z=$('<div class="c-file-preview"><span class="c-file-type c-file-preview__type '+a.typeClasses+'"></span><span class="c-file-preview__name"></span><span class="c-file-preview__size '+a.sizeClasses+'"></span><a class="c-link u-color-gray60 c-file-preview__button i-icon-delete"></a></div>'),A=$(a.capacityMsg),B=new window.mvideo.Class.Notification(t,a.notificationConfig),C=q[0].outerHTML;!function(){w="string"==typeof a.maxSize&&(a.maxSize.split(" ")[1]||""),v="number"==typeof a.maxSize?a.maxSize*Math.pow(1024,2):c(),$(q[0].form).attr("enctype","multipart/form-data"),p.on("click",b),q.on("change",d),o.on("files-sending",m),o.on("file-loader-reinit",n),a.nameInstanceFileLoader&&o.data(a.nameInstanceFileLoader,{getCountFiles:l})}()}),mvideo.Module.define("focus-account-block",function(a){function b(){h.trigger("click")}function c(a){
mvideo.helpers.inViewport(this,80)||window.mvideo.instance.page.page.goToBlock(this)}a=$.extend(!0,{label:".c-accordion__header",inputs:".c-accordion__input"},a);var d=$(this),e=$(a.label,d),f=$(a.inputs,d),g=!1,h=$("#clear-radio",d);f.on("change",function(a){g=!0}),e.on("click",function(a){var d=$(this);setTimeout(function(){g?setTimeout(c.bind(d),250):b(),g=!1})})}),mvideo.Module.define("format-product-code",function(){var a=$(this),b=a.text().trim(),c=/\d{4}/g,d=b.match(c);8===b.length?a.html('<span class="c-product-code__first-part">'+d[0]+"</span><span>"+d[1]+"</span>"):a.html("<span>"+b+"</span>")}),mvideo.Module.define("frame-sizing",function(){$(this).iFrameResize()}),mvideo.Module.define("galleryCarousel",function(a){function b(){if(l.banners){var a=mvideo.device.manager.getType(),b="mobile"==a?"phone":a;m.find("li:first-child img.visible-"+b).off("load.GalleryCarousel").on("load.GalleryCarousel",function(){g.updateSize()})}}function c(a,b){if(window.mvideo.device.manager.getType()!==mvideo.device.manager.TYPES.DESKTOP&&!q&&"left"==b&&m[0].offsetWidth-document.documentElement.clientWidth<Math.abs(parseInt(m[0].style.left,10))){var c=m.find("> li").length;if(l.ajaxContentLoad.total>c){var d={dataSend:{},currentUrl:l.ajaxContentLoad.contentUrl,methodType:"post"};l.ajaxContentLoad.dataIds?d.dataSend={productIds:l.ajaxContentLoad.dataIds.slice(c,c+l.mobileLoad).join("|")}:(d.methodType="get",d.currentUrl=window.mvideo.helpers.setUrlParam(l.ajaxContentLoad.contentUrl,{startFrom:c+1,to:c+l.mobileLoad})),f(d).then(e)}else m.off("swiped")}}function d(a){var b=new mvideo.Class.VerticalIndentEqualizer(m,{selectors:a,needRecalc:!0,defaultHeight:"auto"});return b.initialize(),b}function e(){j.reinit(),i.reinit(),g.updateSize()}function f(a){return $.ajax({url:a.currentUrl,data:a.dataSend,type:a.methodType,cache:!1,beforeSend:function(a){q=!0,p||(p=new window.mvideo.Class.Overlay(m)),p.show()}}).fail(function(a,b,c){}).done(function(a,b,c){var d=$(a);m.append(d),mvideo.Class.ReinitContent.reinit(d),m.trigger("scroll")}).always(function(){q=!1,p.hide()})}var g,h,i,j,k,l={auto:!1,mobileLoad:4,dataIds:null,resetParam:!1,evNamespace:""},m=$(this),n={items:".gallery-list-item",wrapper:""},o={items:".c-pdp-price",wrapper:".gallery-list-item"},p=null,q=!1,r={};return $.extend(!0,l,a||{}),$.extend(!0,r,a.settings||{}),a&&a.pagination&&!0===a.pagination&&delete l.pagination,g=new mvideo.Class.CommonCarousel(this,{carousel:l,settings:r}),h=g.config.carousel.pagination||!1,i=d(n),j=d(o),k=a.evNamespace?"."+a.evNamespace:"",a.tabletSwipe&&!l.responsive&&l.ajaxContentLoad&&l.ajaxContentLoad.contentUrl&&m.on("swiped",c),m.on("carouFred.dataLoaded",e),m.off("reinit"+k).on("reinit"+k,function(){g.reinit(g.config.carousel)}),{desktopBehavior:function(){!0===l.responsive?(g.config.carousel.items=a.desktop||null,g.config.carousel.pagination=h):(g.destroy(),j.reinit(),i.reinit()),g.config.carousel.auto=!!a.auto,b(),g.reinit(g.config.carousel)},tabletBehavior:function(){a.tabletSwipe?(g.destroy(),l.verticalMobile?i.reinit():(j.reinit(),i.initialize(!0),i.setNormalizedParam())):(!0===l.responsive&&(g.config.carousel.items=a.tablet||null,g.config.carousel.pagination=h),g.config.carousel.auto=!1,b(),g.reinit(g.config.carousel),l.verticalMobile&&i.reinit())},mobileBehavior:function(){!0===l.responsive?(g.config.carousel.items=a.mobile||null,g.config.carousel.auto=!1,g.config.carousel.pagination=h,b(),g.reinit(g.config.carousel)):g.destroy(),j.reinit(),i.reinit()}}}),mvideo.Module.define("galleryModal",function(){function a(a,b,c){e.$modal.find(e.slideTotal).text(e.thumnailsLength),$.get(a,function(a){a&&(e.$modalBody.html($(a).prop("outerHTML")),mvideo.Class.ReinitContent.reinit(e.$modalBody.find("ul.category-banner-slider-list")),c(e.$modalBody,b))})}function b(a,b){a.find(e.innerFrame).replaceWith(b)}function c(a,b){var c=a.find("img, iframe"),f=c.length;c.length>0?c.on("load",function(){0===--f&&(e.prepareFlag=!0,d(b))}):(e.prepareFlag=!0,d(b))}function d(a){var c,d=e.$modalBody.find(".category-banner-slider-list"),f=d.parent(),g=$('<a class="prev-btn" href="#"/>'),h=$('<a class="next-btn" href="#"/>'),i=!1;d.children("li").each(function(){var a,c=$(this),d=$(e.videoContent,c),f=$(e.videoYTIframe,c);d.length>0&&f.length>0&&!f.attr("src")&&(i=!0,(a=d.data("init-param"))&&b(d,$('<div id="'+a.videoIframeId+'" frameborder="0" />')))}),i&&mvideo.Class.ReinitContent.reinit(d),f.append(g),f.append(h),c=d.carouFredSel({height:"variable",prev:g,next:h,auto:!1,align:"center",items:{height:"variable",min:1,visible:1,start:a},scroll:{onAfter:function(){var a=e.$modal.find("span.carousel-slide-index");d.trigger("currentPosition",function(b){a.text(b+1)})}},swipe:{onTouch:!0},onWindowResize:"debounce",responsive:!0,pagination:""}),e.$modal.modal(),e.$modal.on("hide",function(){g.remove(),h.remove(),c.trigger("slideTo",0),d.children().removeAttr("rel"),c.trigger("destroy")}),e.$modal.on("hidden",function(){e.$modal.removeAttr("style")})}var e={};e.prepareFlag=!1,e.$this=$(this),e.$modal=e.$this.find(".gallery-modal"),e.$modalBody=e.$modal.find(".modal-body"),e.thumbnails=".gallery-modal-link",e.$thumbnailsHolder=e.$this.find(".pre-order-media-container"),e.thumnailsLength=e.$thumbnailsHolder.find(e.thumbnails).length,e.slideTotal=".carousel-slide-total",e.videoContent=".video-content",e.innerFrame=" > iframe",e.videoYTIframe=e.videoContent+e.innerFrame,e.prefixVideoId=e.$this.attr("prefix-video-id")||"video-item-",e.$thumbnailsHolder.on("click",e.thumbnails,function(b){b.preventDefault();var f=$(this),g=f.parent().index();e.prepareFlag?d(g):a(f.attr("href"),g,c)})}),mvideo.Module.define("geolocation",function(a){function b(){$.kladr.check({token:"51dfe5d42fb2b43e3300006e",key:"86a2c2a06f1b2451a87d05512cc2c3edfdf41969",type:$.kladr.type.city,name:h})}function c(a){var b={desktop:{targetElement:$(".header-sities-link"),offset:{top:17,left:0}},tablet:{targetElement:$(".header-main-area .header-menu-btn"),offset:{top:25,left:-9}}},c=new mvideo.Class.Tooltip(".region-popup-btn",{contentAsHTML:!0,color:"gray20",trigger:"custom",large:"true",classes:["geolocation"],triggerClose:{click:!0},functionFormat:function(){var a=$('<div><p>Ваш регион</p><strong></strong><div class="region-popup-btn-group"><a class="btn btn-invers-deep-grey btn-choice-other-city" href="#">Выбрать другой</a><a class="btn btn-approve-city" href='+k+">Да, все верно</a></div></div>");return a.find("strong").text(j),a.find(".btn").click(function(){c.hide()}),a},functionPosition:function(a,c,d){var e,f=b[mvideo.device.manager.getType()];return f&&f.targetElement&&f.targetElement.length&&(e=f.targetElement.offset(),d.coord.top=e.top+f.offset.top-$("body").scrollTop(),d.coord.left=e.left+f.offset.left),d}});c.show(),a&&"function"==typeof a&&a()}function d(){$(".btn-approve-city").on("click",function(a){var b=$.trim($(this).attr("href"));if(b===$.trim($("#header-regions").find(":checked").siblings().find("a").attr("href")))return $.ajax({type:"GET",url:b,success:function(){$("#region-popup").popover("hide")}}),!1})}function e(){$(".btn-choice-other-city").on("click",function(a){l=!1,$("#region-popup").popover("hide"),$(".header-sities-link").trigger("click"),a.preventDefault(),a.stopPropagation()})}function f(){$(".btn-choice-other-city").on("click",function(a){l=!1,$("#region-popup").popover("hide"),$(".header-main-area .header-menu-btn").trigger("click"),$(".navigation-list-primary .choice-city .navigation-item-link").trigger("click"),a.preventDefault(),a.stopPropagation()})}function g(){var a=(new Date).getTime();$.ajax({type:"GET",url:"/navigation/kladr-to-city.json.jsp",data:{cityKladrId:i,time:a},dataType:"json",success:function(a){if(!a)return void(l=!1);j=a.city,k=a.url,c(d),$(document).one("click",function(a){var b=$(a.target).parents().addBack(),c=$(".popover.fade.in");-1===$.inArray(c[0],b)&&l&&($(".btn-approve-city").trigger("click"),l=!1)}),"desktop"===mvideo.device.manager.getType()?e():f(),l=!0}})}var h,i,j,k,l=!1;return $.kladr={url:"//kladr-api.ru/api.php",type:{region:"region",district:"district",city:"city",street:"street",building:"building"}},$.kladr.api=function(a,b){var c={};a.token&&(c.token=a.token),a.key&&(c.key=a.key),a.type&&(c.contentType=a.type),a.name&&(c.query=a.name),a.parentType&&a.parentId&&(c[a.parentType+"Id"]=a.parentId),a.withParents&&(c.withParent=1),c.limit=a.limit?a.limit:2e3;var d=!1;$.getJSON($.kladr.url+"?callback=?",c,function(a){if(a.result.length){if(a.result.forEach(function(a){"free"!=a.id&&(i=a.id)}),g(),d)return;d=!0,b&&b(a.result)}}),setTimeout(function(){d||(d=!0,b&&b([]))},1e3)},$.kladr.check=function(a,b){a.withParents=!1,a.limit=1,$.kladr.api(a,function(a){a&&a.length?b&&b(a[0]):b&&b(!1)})},function(){new mvideo.Class.MapLazy(a).loadScript().then(function(a){a.geolocation.get({provider:"yandex"}).then(function(a){var c=a.geoObjects.get(0);(h=c&&c.getLocalities()&&c.getLocalities()[0])&&b()})})}(),{mobileBehavior:f,tabletBehavior:f,desktopBehavior:e}}),mvideo.Module.define("goToBlock",function(a,b,c,d,e,f){function g(){d?i.is(":visible")&&mvideo.instance.page.page.goToBlock(a||i,+b||0):mvideo.instance.page.page.goToBlock(a||i,+b||0)}var h,i=$(this);"object"==typeof arguments[0]&&(h=$.extend({ev:"click"},arguments[0]),e=i,f=h.ev,a=h.target),e?$(e).on(f,g):setTimeout(function(){g()},c||0)}),mvideo.Module.define("google-translate-init",function(a){var b=$(this);if(a=$.extend(!0,{googleTranslateId:"google_translate_element",googleTranslateCloseSelector:".c-google-translate__close",languages:"en,es,pt"},a),-1===window.navigator.language.toLowerCase().indexOf("ru")&&!$.cookie("stopTranslate")){window.googleTranslateElementInit=function(){new window.google.translate.TranslateElement({pageLanguage:"ru",includedLanguages:a.languages,layout:window.google.translate.TranslateElement.InlineLayout.SIMPLE},a.googleTranslateId),b.removeClass("u-hidden"),b.find(a.googleTranslateCloseSelector).on("click.CloseGoogleTranslate",function(){var a,c,d=$(".goog-te-banner-frame.skiptranslate")[0];d&&(a=d.contentDocument,c=a.createEvent("UIEvents"),c.initUIEvent("click",!0,!0,window,1),$(a).find(".goog-close-link")[0].dispatchEvent(c)),$.cookie("stopTranslate",!0),b.remove()})};var c=document.createElement("script");c.src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit",window.document.body.appendChild(c)}}),mvideo.Module.define("gtm-banner-events",function(a){function b(b){var c=parseInt(b,10);c>=0&&"undefined"!=typeof dataLayer&&window.dataLayer.push(window.mvideoGtm[a.gtmSwitch+c])}function c(b){var c=parseInt(b,10);!a.auto&&!m[c]&&c>=0&&"undefined"!=typeof dataLayer&&(window.dataLayer.push(window.mvideoGtm[a.gtmShow+c]),m[c]=!0)}function d(d){var e,f,g=d.currentTarget,l=$(g).attr("class"),m=a.carouselName;e=m?h.find('ul[data-init="'+m+'"] > li'):h.find("li"),l===j&&(f=e.eq(0).attr("rel")),l===i&&(f=e.eq(k).attr("rel")),b(f),c(f)}function e(a){var d=a.currentTarget,e=$(d).text(),f=(parseInt(e,10)-1)*k;c(f),b(f)}function f(){g();var a=window.mvideoGtm[l.gtmShow+0];m[0]=!0;for(var b=1;b<k;b++){var c=window.mvideoGtm[l.gtmShow+b];c&&a.ecommerce.promoView.promotions.push(c.ecommerce.promoView.promotions[0]),m[b]=!0}void 0===window.dataLayer&&(window.dataLayer=[]),window.dataLayer.push(a)}function g(){var b=mvideo.device.manager.getType();a[b]&&(k=a[b])}var h=$(this),i="next-btn",j="prev-btn",k=1,l={gtmShow:"#gtmCarouselShowBanner_",gtmSwitch:"#gtmCarouselSwitchedBanner_",auto:!0,showGroupPush:!1},m={};return function(){g(),a=$.extend(l,a),a.showGroupPush?f():a.auto||c(0),h.on("click",".prev-btn",d),h.on("click",".next-btn",d),h.one("create",function(){h.find(".carousel-paging").on("click","a",e)})}(),{desktopBehavior:function(){g()},tabletBehavior:function(){g()},mobileBehavior:function(){g()}}}),mvideo.Module.define("gtmBestPriceMutationFunction",function(a){a.bestPriceInputSelector=a.bestPriceInputSelector||"#best-price",a.productPriceLocal=+a.productPriceLocal||0;var b=+$(a.bestPriceInputSelector).val()||0;return a.eventValue=b-a.productPriceLocal,delete a.bestPriceInputSelector,delete a.productPriceLocal,a}),mvideo.Module.define("gtmChangeAmountMutationFunction",function(a){var b=$(a.amountInputSelector).text();return a.eventAmount=parseInt(String(b).replace(/ /g,"")),a.cartState&&Array.isArray(a.cartState)&&a.cartState.forEach(function(b){b.id==a.eventProductId&&(b.count=a.eventAmount)}),delete a.amountInputSelector,a}),mvideo.Module.define("gtmChangeLocationMutationFunction",function(a){var b=$(a.locationSelector).text();return a.eventLocation=b,delete a.locationSelector,a}),mvideo.Module.define("gtmCompareMutationFunction",function(a){return"toCompare"==a.eventLabel?(a.eventCategory="Interactions",a.eventAction="remove",a.eventLabel="removeFromCompare"):(a.eventCategory="Conversions",a.eventAction="add",a.eventLabel="toCompare"),a}),mvideo.Module.define("GTMEventsEnableTracking",function($elem){function actionHandler(a,b){var c,d,e=b&&b.event?b:data,f=mutateAndCleanup(e,a,b);if(void 0!==window.dataLayer&&(c=needIgnore(f),d=c.ignore,f=c.data,!d)){for(var g=0,h=window.dataLayer.length;g<h;g++)if("OWOX"===window.dataLayer[g].event)for(var i in window.dataLayer[g])f[i]||(f[i]="");window.dataLayer.push(f)}}var actionType=$elem.data("action"),$dataHolder=$($elem.data("holder")),data={},regex=/\r|\n|\s/g,actionOnce=$elem.data("action-once");if(window.mvideoGtm&&window.mvideoGtm[$elem.data("holder")])data=window.mvideoGtm[$elem.data("holder")];else{if(0===$dataHolder.length)return console.log("Html element "+$elem.data("holder")+" with data hasn't been found");try{data=JSON.parse($dataHolder.text().replace(regex," "))}catch(a){throw"Html element "+$elem.data("holder")+" must have JSON"}}var mutateAndCleanup=function(a,b,c){return cleanup(mutate(a,b,c))},mutate=function(a,b,c){return"true"===a.mutable?resolveNamespaceAndCallFunction(a,b,c):a},cleanup=function(a){var b=jQuery.extend(!0,{},a);return delete b.mutable,delete b.mutationFunction,delete b.actionEvent,b},resolveNamespaceAndCallFunction=function(data,event,eventParams){var fullQualifiedName=data.mutationFunction.split("."),functionName=fullQualifiedName.pop(),namespace=fullQualifiedName.join(".");namespace||(namespace="window");var namespaceObject=eval(namespace);return namespaceObject[functionName].call(namespaceObject,data,event,eventParams)},needIgnore=function(a){var b=a.ignore||!1;!b&&a.once&&window.dataLayer.length>0&&window.dataLayer.forEach(function(c){c.once&&c.eventLabel===a.eventLabel&&c.eventAction===a.eventAction&&(b=!0,a.additionalcompare&&c[a.additionalcompare]!=a[a.additionalcompare]&&(b=!1))});var c=jQuery.extend(!0,{},a);return delete c.additionalcompare,delete c.ignore,{data:c,ignore:b}};"show"===actionType?actionHandler():($elem.off(actionType+".ga"),actionOnce?$elem.one(actionType+".ga",actionHandler):$elem.on(actionType+".ga",actionHandler))}),$(function(){$("[data-pushable='true']").each(function(){mvideo.Module._items.GTMEventsEnableTracking($(this)),"load"===$(this).data("action")&&$(this).trigger("load")})}),mvideo.Module.define("gtm-nc-form-tracking",function(a){function b(a){i=(new Date).getTime(),k=0,j=a}function c(){g({event:n,timingCategory:o,timingVar:q.ui,timingValue:(new Date).getTime()-i,timingLabel:p.activation,eventForm:h(),eventField:j?j.attr("id"):null})}function d(a){var c=(new Date).getTime();j||b(a),a.one("blur",function(){g({event:n,timingCategory:o,timingVar:q.ui,timingValue:(new Date).getTime()-c,timingLabel:p.deactivation,eventForm:h(),eventField:a.attr("id")})})}function e(a){var b;k||c(a),k++,b=a.validate().errorList[0],g({event:n,timingCategory:o,timingVar:q.ui,timingValue:(new Date).getTime()-i,timingLabel:p.error,eventForm:h(),eventField:b?$(b.element).attr("id"):null,eventError:b?b.message:null,eventAttemptCount:k})}function f(a){var b=(new Date).getTime();k||c(a),k++,g({event:n,timingCategory:o,timingVar:q.ui,timingValue:b-i,timingLabel:p.success,eventForm:h(),eventAttemptCount:k})}function g(a){"undefined"!=typeof dataLayer&&window.dataLayer.push(a)}function h(){return a}var i,j,k,l=$(this),m=l.attr("id"),n="OWOX_Forms",o="Forms",p={success:"successful",error:"unsuccessful",activation:"activation",deactivation:"deactivation"},q={ui:"send",backend:"response"};!function(){l.on("focus","input",function(a){d($(a.target))}),mvideo.Event.subscribe("formValid",function(a,b){b===m&&f(l)}),mvideo.Event.subscribe("formInvalid",function(a,b){b===m&&e(l)})}()}),mvideo.Module.define("gtmPriceMutationFunction",function(a){var b=$(a.priceInputsSelector),c=b.eq(0).val(),d=b.eq(1).val();return a.eventLocation=c+"-"+d,delete a.priceInputsSelector,a}),mvideo.Module.define("gtm-push-products",function(a){a=$.extend({dataProductInfo:"product-info",linkSelector:"[data-product-info]",linkHolderSelector:this,productsVar:"GTMListingPage",GTMPushVar:"GTMPush"},a||{});var b=new mvideo.Class.GTMPushOnload;window[a.GTMPushVar]=b,$(a.linkHolderSelector).on("click",a.linkSelector,function(){b.updateDataPushProduct($(this).data(a.dataProductInfo))}),$(function(){var c=window[a.productsVar];c&&b.updateDataPush(c)})}),mvideo.Module.define("header-regions-cart",function(a){function b(){if(j)return void("block"===g.css("display")?i.closeBlock():i.openBlock());d().done(function(a){a&&a.htmlContent&&(g.html(a.htmlContent),j=!0,i.openBlock(),mvideo.Class.ReinitContent.reinit(g))})}function c(){if(k)return void h.show();d().done(function(a){a&&a.htmlContent&&(h.setContent(e(a.htmlContent),!0),k=!0,h.show())})}function d(){return f.data("post-load-url")?$.ajax({url:"desktop"===mvideo.device.manager.getType()?f.data("post-load-url"):f.data("post-load-url-mobile")||f.data("post-load-url")+"&mobile=true",dataType:"json",type:"GET",cache:!1}):(window.console.warn("post-load-url - не определено"),$.Deferred().reject())}function e(a){return'<div class="navigation-top"><div class="navigation-top-holder sel-mob-menu-opened" style="left: -258px;"><a href="#" onclick="$(\'.o-page__sidebar\').trigger(\'swipeLeft\');return false;" class="navigation-back-btn"><i class="font-icon icon-left-open"></i>Назад</a></div></div><div class="navigation-container">'+a+"</div>"}a=$.extend(!0,{selectors:{opener:".region-opener, .region-close",opencloseBlock:"#header-regions"},elementCity:""},a);var f=$(a.elementCity),g=$(a.selectors.opencloseBlock),h=new mvideo.Class.SideBar,i=new mvideo.Class.OpenClose(this,{selectors:a.selectors}),j=!1,k=!1;return i.initialize(),f.on("click",function(a){a.preventDefault(),"desktop"===mvideo.device.manager.getType()?b():c()}),{desktopBehavior:function(){h.hide(),i.closeBlock()},tabletBehavior:function(){i.closeBlock()},mobileBehavior:function(){i.closeBlock()}}}),mvideo.Module.define("headerRegions",function(){var a=$("#header-regions");new mvideo.Class.OpenClose(this,{selectors:{opener:".region-opener, .region-close",opencloseBlock:"#header-regions"}}).initialize(),$(this).find(".region-opener[data-post-load-url]").one("click",function(){$.ajax({url:$(this).data("post-load-url"),dataType:"json",type:"GET",cache:!1}).done(function(b){b&&b.htmlContent&&a.html(b.htmlContent),mvideo.Class.ReinitContent.reinit(a)})})}),mvideo.Module.define("header-section-controller",function(a){a=$.extend(!0,{},a);var b=new mvideo.Class.FocusBlurState(this,{blockElement:".header-search-form-section",inputFocus:"#frm-search-text",activeClass:"header-section_wide"}),c=b.dispose.bind(b);return{desktopBehavior:function(){b.initialize()},tabletBehavior:c,mobileBehavior:c}}),mvideo.Module.define("heroCarousel",function(a){function b(a){$.extend(!0,f.config.carousel,a||{}),f.reinit(f.config.carousel),g.trigger("updateSizes")}function c(){if(i.length){var a=i.find(".carousel-paging"),b=a.width();a.css({"margin-left":-b/2})}}function d(a,c,d){var e=a.closest(".lazy-load-image-holder");e.hasClass("lazy-load-error")||e.hasClass("lazy-loaded")?b({responsive:!0,items:c,auto:d}):(a.on("loaded",function(){b({responsive:!0,items:c,auto:d})}),a.on("error",function(){b({responsive:!0,items:c,auto:d})}))}function e(b){var c=m?j:k[b];if(-1!=h.destroy.indexOf(b))return void f.destroy();d(c,+a[b]||null,"desktop"==b&&!!a.auto)}var f,g=$(this),h={height:"variable",align:"left",auto:!1,destroy:[],onCreate:function(){g.trigger("create")}},i=g.parents(".hero-banner-holder"),j=g.find("li:first-child img.lazy").not(".visible-desktop, .visible-tablet, .visible-phone"),k={desktop:g.find("li:first-child img.visible-desktop"),tablet:g.find("li:first-child img.visible-tablet"),mobile:g.find("li:first-child img.visible-phone")},l=mvideo.device.manager.getType(),m=j.length;return $.extend(!0,h,a||{}),g.addClass("activated"),f=new mvideo.Class.CommonCarousel(this,{carousel:h}),c(),mvideo.Event.subscribe("resize",function(){f.applyConfig({reInit:!0}),c()}),function(){if(m)j.load(function(){f.updateSize()});else{var a="mobile"==l?"phone":l;g.find("li:first-child img.visible-"+a).load(function(){f.updateSize()})}}(),{desktopBehavior:e,tabletBehavior:e,mobileBehavior:e}}),mvideo.Module.define("highlight-link",function(a){function b(a){return a.search(g)>=0?'<a class="c-link c-link_gray" target="_blank" rel="noopener" href="mailto:'+a+'">'+a+"</a>":(-1===a.search(f)&&(a="http://"+a),'<a class="c-link c-link_gray" target="_blank" rel="noopener" href="'+a+'">'+a+"</a>")}var c=a&&a.textContainer?$(this).find(a.textContainer):$(this),d=c.text(),e=/(https?:\/\/)?(www\.)?([-a-z0-9@:%_\+~#=]{2,256}\.)+([a-z]{1,4})(?::[0-9]+)?(\/?[-a-zа-яё0-9:@%_\+~#?=&\/]+(\.[a-z0-9]+)?)+/gi,f=/(https?:\/\/)/g,g=/([a-zа-яё0-9_\.-]+)@([a-zа-яё0-9_\.-]+)\.([a-zа-яё\.]{2,6})/gi,h=d.replace(e,b);c.html(h)}),window.mvideo.Module.define("input-range",function(a){function b(){return{min:d.data("min-giftcard-price"),max:d.data("max-giftcard-price"),currentValue:d.val()}}a=$.extend(!0,{slider:".c-range__slider",inputField:'[data-range-field="true"]'},a);var c=$(this),d=$(a.inputField,c),e=$(a.slider,c),f=null,g=function(a,b){d.val(b.value)}.bind(this),h=function(a){f.setValue(a.target.value)}.bind(this),i=function(a){d.trigger("blur")};!function(){var a=b();f=new window.mvideo.Class.RangeSlider(e,{range:"min",min:a.min,max:a.max,value:a.currentValue,values:null,slide:g,stop:i}),d.on("input",h)}()}),mvideo.Module.define("input-tooltip",function(a){function b(){var a=d.outerWidth();f.closest(".tooltipster-show").css({minWidth:a,maxWidth:a}),d.tooltipster("reposition")}function c(){d.tooltipster("show"),setTimeout(b)}a=$.extend(!0,{contentAsHTML:!0,trigger:"custom",title:"text",withoutMobilePopup:!0,large:!0,closable:!0,scrollToFieldDuration:100,scrollToFieldTopOffset:-20,repositionOnScroll:!1,wrapperClass:"c-input-tooltip"},a);var d=$(this),e=new mvideo.Class.Page(".page-content"),f=$('<div class="'+a.wrapperClass+'">'+a.title+"</div>");a.repositionOnScroll&&$.tooltipster.setDefaults({repositionOnScroll:!0}),a.title=f,d.on("focus",function(){"mobile"===mvideo.device.manager.getType()?e.goToBlock(d,a.scrollToFieldTopOffset,{duration:a.scrollToFieldDuration,complete:c}):c()}),d.on("blur",function(){d.tooltipster("hide")}),d.on("input",function(){d.tooltipster("show")}),new mvideo.Class.Tooltip(d,a)}),mvideo.Module.define("listchange-tooltip",function(a){function b(b){var c=$(a.parent+">"+a.floctoryWidget);c.filter(":visible").length&&b.css("bottom",c.innerHeight())}function c(){f.tooltipster("status").open&&f.tooltipster("close")}var d,e,f=$(this);return a=$.extend(!0,{title:"Товар добавлен в сравнение",contentAsHTML:!0,withoutMobilePopup:!0,withMobileTooltip:!0,trigger:"custom",triggerOpen:{click:!1},propName:"tooltipContent",parent:"body",zIndex:"100501",listName:"comparisonMenu",floctoryWidget:".flocktory-widget-overlay",closeTime:3e3},a||{}),new mvideo.Class.Tooltip(f,a),mvideo.Event.subscribe("listchange",function(c,g){var h,i=g.changedData[a.propName];d&&i&&g.listName===a.listName&&(f.tooltipster("content",i.newValue),f.tooltipster("status").open?clearTimeout(e):f.tooltipster("open"),h=f.tooltipster("instance"),window.mvideo.Class.ReinitContent.gtmTracking(h._$tooltip.find(".tooltipster-content")),b(h._$tooltip),e=setTimeout(function(){f.tooltipster("close")},a.closeTime),h.one("close",function(){clearTimeout(e)}))}),{desktopBehavior:function(){d=!1,c()},tabletBehavior:function(){d=!1,c()},mobileBehavior:function(){d=!0}}});window.mvideo.Module.define("load-cart-service",function(a){function b(a){Array.isArray(a.items)&&a.items.forEach(function(a,b,c){var d=$('[data-additional-services-content="'+a.id+'"]');a.htmlContent&&(d.html(a.htmlContent),window.mvideo.Class.ReinitContent.reinit(d),d.trigger("cart-services-loaded"));var e=f.indexOf(a.id);-1!=e&&f.splice(e,1)})}function c(){Array.isArray(f)&&f.forEach(function(b,c,d){$("["+a.nameDataAttr+'="'+b+'"]').add($("["+a.serviceElements+'="'+b+'"]')).hide()})}a=$.extend(!0,{url:"",nameDataAttr:"data-additional-services-link",selectLink:"[data-additional-services-link]",serviceElements:"data-additional-services-element"},a);var d=$(a.selectLink),e=$("["+a.serviceElements+"]"),f=[];d.each(function(){f.push(this.getAttribute(a.nameDataAttr))}),$.ajax({type:"post",url:a.url,contentType:"application/json",data:null,beforeSend:function(){d.add(e).addClass("box-overlay")}}).done(function(a,c,d){"success"===a.status&&b(a)}).always(function(){d.add(e).removeClass("box-overlay"),c()})}),window.mvideo.Module.define("async-form-with-files",function(a){function b(b){var c=$(a.additionalModuleParam[0].selectTarget);c.html(b.htmlContent),window.mvideo.instance.page.page.goToBlock("body",{duration:a.scrollDuration}),window.mvideo.Class.ReinitContent.reinit(c)}function c(a){g.trigger("file-loader-reinit",{notClear:!0}),f.setContent({message:a}),f.show()}function d(){return g.trigger("files-sending"),new FormData(e[0])}a=$.extend(!0,{additionalModule:"load-content",additionalModuleParam:[{selectTarget:".o-exchange",msgErr:"Извините, сервис временно недоступен, попробуйте позже.",errIconColor:"orange",popupError:!0,useFormData:!0,ev:"submit",overlayBlock:".o-exchange",serializeForm:!0}],fileLoader:".c-file-loader",scrollDuration:300},a);var e=$(this),f=new window.mvideo.Class.ErrorPopup("body",a.popupConfig),g=$(a.fileLoader);a.additionalModule&&window.mvideo.Module._items[a.additionalModule]&&($.extend(!0,a.additionalModuleParam[0],{showError:c,prepareDataSend:d,successHandler:b,ajaxConfig:{url:e.attr("action"),type:e.attr("method"),processData:!1,contentType:!1}}),window.mvideo.Module.init(a.additionalModule,a.additionalModuleParam,this))}),window.mvideo.Module.define("async-send-dirty",function(a){function b(){return d}a=$.extend(!0,{additionalAsyncModuleParam:[{ev:"send-dirty",serializeForm:!0}],ev:"click",trigger:'[data-btn-trigger="true"]'},a);var c,d,e=$(this);$.extend(!0,a.additionalAsyncModuleParam[0],{prepareDataSend:b}),window.mvideo.Module.init("load-content",a.additionalAsyncModuleParam,this),c=window.mvideo.Module.init("backwards-input",[{myself:!1}],this),c.updateCacheValue(!0),e.off(a.ev,a.trigger).on(a.ev,a.trigger,function(b){c.searchDirty().length&&(d=mvideo.helpers.prepareDataSend.getSerializedData(e,"input",b,!0),e.trigger(a.additionalAsyncModuleParam[0].ev))})}),window.mvideo.Module.define("load-content",function(a){function b(b,c){return b?a.inside?$(b,m):$(b):c}function c(){var b,c={};return $.isFunction(a.prepareDataSend)?a.prepareDataSend():(a.serializeForm?(b=m.is("form")?m:a.serializeFormClosest?m.closest("form"):m.find("form"),c=b.length&&b.serialize()):c=a.dataSend,c)}function d(b){if($.isFunction(a.showError))return void a.showError(b);var c=b;a.tplError&&(c=window.JST[n]({params:$.extend({notificationMessages:[{title:b}]},a.notificationParams)})),setTimeout(function(){var b;a.selectTargetError?(t.html(c).show(),t.trigger("tooltip-reposition"),b=t):(o.html(c),b=o),window.mvideo.Class.ReinitContent.reinit(b)})}function e(){a.selectTargetError&&t.html("").hide()}function f(b,c,e){return u=!1,i(),l(b),"redirect"===b.status?(u=!0,void window.location.assign(b.url)):"success"===b.status?$.isFunction(a.successHandler)?void a.successHandler(b):(g(b),m.trigger("load-content.success",b)):(o.trigger("load-content.error",b),void d(b.msgErr||a.msgErr))}function g(a){o.html(a.htmlContent),window.mvideo.Class.ReinitContent.reinit(o),e()}function h(b,c,e){u=!1,o.trigger("load-content.error"),d(a.msgErr)}function i(){a.needOverlay&&p.hide(),a.showNotification&&s.hide()}function j(){i(),o.trigger("load-content.always")}function k(b){o.trigger("load-content.waiting"),u=!0,a.needOverlay&&(p||(p=new mvideo.Class.Overlay($.extend(!0,{holder:q,overlayClasses:a.overlayClasses},a.overlayConfig))),p.show(q,a.overlayInBlock)),a.showNotification&&s.show()}function l(a){a&&window.dataLayer&&a.gtmPush&&(a.gtmPush.elem||(a.gtmPush.elem=m),window.dataLayer.push(window.mvideo.helpers.gtmMutationFunctions.mergeAttrs(a.gtmPush)))}a=$.extend(!0,{selectElm:this,ev:"click",action:"",method:"POST",selectTarget:null,msgErr:"error",needOverlay:!0,overlayInBlock:!1,overlayClasses:"",dataSend:{},cached:!1,serializeForm:!1,serializeFormClosest:!1,namespace:"load-content",overlayBlock:"",elmErr:null,inside:!1,tplError:!0,selectTargetError:null,showError:null,prepareDataSend:null,ajaxConfig:{},successHandler:null,notificationParams:{iconStyle:"error",iconColor:"red"},notificationBlock:"[pending-request-notification]",showNotification:!1,overlayConfig:{}},a);var m=$(a.selectElm),n="common/jade/tpls/notifications.tpl",o=b(a.selectTarget,m),p=null,q=a.needOverlay&&function(){var b;return a.overlayBlock&&(b=m.siblings(a.overlayBlock),b.length||(b=$(a.overlayBlock))),b&&b.length||(b=m),b}(),r="load"===a.ev,s=$(a.notificationBlock,m),t=b(a.selectTargetError,null),u=!1;a.ev=a.ev+"."+a.namespace,m.off(a.ev).on(a.ev,function(b){var d;if(b.preventDefault(),!(u||a.serializeForm&&!m.validate().checkForm()))if(a.cached&&"GET"===a.method)d=new mvideo.Class.LoadCacheController,d.getData({data:a.dataSend,url:a.action,beforeSend:k,fail:h,done:f,always:j});else{var e=$.extend(!0,{url:a.action,dataType:"json",data:c(),type:a.method,cache:!1,beforeSend:k},a.ajaxConfig);$.ajax(e).fail(h).done(f).always(j)}}),r&&m.trigger(a.ev)}),mvideo.Module.define("load-photo",function(a){function b(){h.val(""),j.find("li img").each(function(){h.val(h.val()+this.src+";")})}function c(a){return window.JST&&window.JST[e.tplPhotoItem]?window.JST[e.tplPhotoItem](a):""}function d(){return{imageSrc:g.val().trim()}}var e={holder:this,input:"#userProductPhoto",userImages:"#userImages",loadBtn:".js-load-photo",photoList:".photo-list",closeBtn:".close-btn-load-img",url:"",method:"post",tplPhotoItem:"jade/blocks/load-photo-item.tpl",photoMaxCount:8,loaderSrc:"/assets/img/mvideo_grey_preloader_small.gif",cancelSrc:"/assets/img/cancelled.png",disabledClass:"disabled"};$.extend(!0,e,a||{});var f=$(e.holder),g=f.find(e.input),h=f.find(e.userImages),i=f.find(e.loadBtn),j=f.find(e.photoList);g.on("keyup",function(){var a=g.val().trim();i.toggleClass(e.disabledClass,j.find("li").length>=e.photoMaxCount||!a)}),i.on("click",function(a){a.preventDefault();var b,f=d();!i.hasClass(e.disabledClass)&&f.imageSrc&&(b=$(c({imageSrc:e.loaderSrc})),$.ajax({type:e.method,url:e.url,dataType:"json",data:f,beforeSend:function(){g.val("").keyup(),j.prepend(b)},success:function(a){a=a||{},"success"===a.result&&a.url&&(b.find("img").attr("src",a.url),h.val(h.val()+a.url+";")),"error"===a.result&&b.addClass("error").find("img").attr({src:e.cancelSrc,"data-init":"tooltip","data-title":a.message})},complete:function(){mvideo.Class.ReinitContent.reinit(j)}}))}),f.on("click",e.closeBtn,function(a){a.preventDefault(),$(this).parent("li").remove(),b(),g.keyup()})}),mvideo.Module.define("load-services",function(a){var b={item:".sidebar-category",itemsHolder:".sidebar-categories-list",blockHolder:".services-blocks-holder",activeClass:"sidebar-active-link"};return $.extend(!0,b,a||{}),new mvideo.Class.AjaxLoadedBlocks(b).init()}),mvideo.Module.define("m-service-background",function(a){var b=$.extend({backgroundFloatingClass:"m-service-page-wrapper-floating",
modifier:"m-service-page-wrapper-floating_sidebar"},a),c=$("."+b.backgroundFloatingClass);$(".main-holder").css("background","transparent"),function(){(window.navigator.userAgent.indexOf("MSIE")>-1||window.navigator.userAgent.indexOf("Trident/")>-1||window.navigator.userAgent.indexOf("Edge/")>-1)&&c.appendTo("body")}(),window.mvideo.Event.subscribe("close-side-bar-menu",function(){c.removeClass(b.modifier)}),window.mvideo.Event.subscribe("open-side-bar-menu",function(){c.addClass(b.modifier)})}),mvideo.Module.define("m-service-grid",function(a){function b(){var a=0;return f.heightContainers.forEach(function(b){a+=$("."+b)[0].clientHeight}),a}function c(a){var c=b(),d=$(window).height()*a-c;d=d>0?d:null,e.css({"padding-top":d})}var d,e,f={source:"m-service-grid",receiver:"m-service-grid",block:"m-service-block",column:"m-service-col",paddingContainer:"m-service-second-section",heightContainers:["m-service-first-section","header-main"],topPaddingPercent:{mobile:.8,desktop:.8,tablet:.8},columns:{desktopCount:3,tabletCount:2,mobileCount:1}};return function(){f=$.extend(f,a),d=new mvideo.Class.CustomGrid({source:f.source,receiver:f.receiver,column:f.column,block:f.block}),e=$(".m-service-second-section")}(),{desktopBehavior:function(){c(f.topPaddingPercent.desktop),d.render({columnCount:f.columns.desktopCount})},tabletBehavior:function(){c(f.topPaddingPercent.tablet),d.render({columnCount:f.columns.tabletCount})},mobileBehavior:function(){c(f.topPaddingPercent.mobile),d.render({columnCount:f.columns.mobileCount})}}}),mvideo.Module.define("mainNavigation",function(a){return{mobile:new mvideo.Class.Navigation(a),desktopBehavior:function(){},tabletBehavior:function(){},mobileBehavior:function(){}}}),window.mvideo.Module.define("maps-handler",function(a){a=$.extend(!0,{holder:this,markersUrl:"",mapSettings:{params:{apikey:""}},stores:[]},a),new window.mvideo.Class.MapLazy(a.mapSettings).loadMap(a.holder).then(function(b){if(a.stores.length>0)return b.initMarkers(a.stores),void window.mvideo.Event.subscribe("map-fitToViewport",function(){b.map.container.fitToViewport()});b.initMarkersByUrl(a.markersUrl)})}),mvideo.Module.define("mark-bonus-card",function(){$("#confirmation-card").on("change",function(){$(this).parent().siblings(".confirmation-card-data").toggle(this.checked),$(this).siblings(".lazy-loaded").toggleClass("opacity")})}),mvideo.Module.define("mediaShowcase",function(a){function b(){$(l.carouselHolder).find("a.zoom").one("click",function(a){a.preventDefault();var b=$(l.modalId),c=$(l.pageCarousel),e=$(l.modalCarousel),g=c.find("li.selected-image .wrapper"),h=e.find("[rel='"+g.parents("li").attr("rel")+"']");b.find(l.carouselHolder).show(),d(g,$(l.modalId).find(l.mainHolder),!1,!0),f(l.modalCarousel),h.addClass("selected-image").siblings("li").removeClass("selected-image"),c.trigger("currentPosition",function(a){e.trigger("slideTo",a)}),b.modal({maxHeight:function(){return $(window).height()-150}}),b.on("hide",function(){$(l.modalId+" "+l.carouselHolder).hide(),$(l.modalCarousel).trigger("destroy",!1)}),b.on("hidden",function(){$(this).removeAttr("style")}),b.on("shown",function(){n.update()})})}function c(a,b,c){$.reel.instances.unreel(),void 0===c||null===c?c=36:c*=36,a.reel({responsive:1,loops:!0,images:b,speed:.4,frames:c,width:a.width,height:a.height}),a.closest(".lazy-load-image-holder").addClass("lazy-loaded")}function d(a,b,d,e){var f,g="",h="a"==a.prop("tagName").toLowerCase()?a.attr("href"):a.data("page-src");if($.reel.instances.unreel(),"img"==a.data("type")||"3d"==a.data("type")){var i=b.find("img.product-image"),j=a.data("srcObj");if(b.find(".youtube-player").trigger("clear").hide(),j&&"object"==typeof j?e?(p.attr("src",j.original),o.attr("src",j.original)):o.attr("src",j[mvideo.device.manager.getType()]):i.attr("src",h).attr("data-original",h),"3d"==a.data("type")){var k=null;k=!e&&a.data("images-small")?a.data("images-small"):a.data("images"),$("<img/>").on("load",function(a){a.currentTarget&&a.currentTarget.height>1?c(i,k,2):c(i,k,1)}).on("error",function(){c(i,a.data("images"),1)}).attr("src",a.data("images").replace("###","072"))}g=b.find("div.image.image-holder img.product-image")}else"video"==a.data("type")&&(f=a.parent().index(),b.find("img.product-image").attr("src","").closest("div.image.image-holder").hide(),b.find(".youtube-player").trigger("addUrl",{url:h,eventLocation:f}),b.find("iframe").closest("div.image-holder").show(),d.hide(b));g.length>0&&g.one("load",function(){$(this).closest("div.image-holder").show(),d&&d.hide(b)}).each(function(){this.complete&&$(this).load()})}function e(a){var b=l.carouselList+" li a",c=$(l.carouselList).find("li.selected-image .wrapper"),e=$(l.compWrapper).find(l.mainHolder),f=c.data("type");!a||"3d"!=f&&"video"!=f&&"flash"!=f||(m.show(e),d(c,e,m)),$(".product-details-media-container, .pdp-modal").on("click",b,function(a){var b=$(this);a.preventDefault();var c=$(l.carouselHolder).find("a.zoom"),f=b.attr("href");if("swf"==f.substr(f.lastIndexOf(".")+1))window.open(f,"","scrollbars=no,resizable=yes,status=no,location=no,toolbar=no,menubar=no, width=700,height=700,left=0,top=0").focus();else{if(m.show(e),b.closest("li").addClass("selected-image").siblings("li").removeClass("selected-image"),d(b,e,m,!!b.closest(k).length),b.closest(k).length){var g=b.parents("li").attr("rel");q.find('[rel="'+g+'"]').closest("li").addClass("selected-image").siblings("li").removeClass("selected-image")}b.closest("li").hasClass("youtube-item")?c.css("visibility","hidden"):c.css("visibility","visible")}})}function f(a){h?e(!0):(g(a||l.carouselList),b(),e(!1))}function g(a){var b=$(a),c=l.visible+1,d=l.carouselProps;Modernizr.flash||(b.find("a[data-src$='.swf']").parent().remove(),b.find("a[href$='.swf']").parent().remove()),b.find("li").length>=c&&(d||(d={height:"auto",circular:!1,infinite:!1,responsive:!0,prev:{button:function(){return $(this).closest(l.carouselHolder).find("a.prev-btn")}},next:{button:function(){return $(this).closest(l.carouselHolder).find("a.next-btn")}},auto:!1,swipe:{onTouch:!0},items:{width:50,visible:l.visible,minimum:c,start:0},onWindowResize:"debounce",pagination:!1}),b.carouFredSel(d))}a=void 0!==a?a:{};var h=!!a.hasOwnProperty("delegateCarousel")&&a.delegateCarousel,i=a.hasOwnProperty("compWrapper")?a.compWrapper:"div.product-details-media-container",j=a.hasOwnProperty("carouselList")?a.carouselList:".product-carousel",k=a.hasOwnProperty("modalId")?a.modalId:"#pdp-modal",l={compWrapper:i,carouselList:j,mainHolder:a.hasOwnProperty("mainHolder")?a.mainHolder:"div.media-gallery",carouselHolder:a.hasOwnProperty("carouselHolder")?a.carouselHolder:".carousel-holder",pageCarousel:i+" "+j+".in-page",modalCarousel:k+" "+j+".in-modal",pageGallery:a.hasOwnProperty("pageGallery")?a.pageGallery:".page-gallery",modalGallery:a.hasOwnProperty("modalGallery")?a.pageGallery:".modal-gallery",modalId:k,visible:a.hasOwnProperty("visible")?a.visible:4,carouselProps:!!a.hasOwnProperty("carouselProps")&&a.carouselProps},m=$.extend(!0,{},mvideo.Mixin.overlay.overlay),n=new mvideo.Class.LazyLoad,o=$(l.pageGallery).find(".product-image"),p=$(l.modalGallery).find(".product-image"),q=$(l.pageCarousel);return function(){var a,b,c=$(l.carouselHolder).find(".selected-image .wrapper").data("srcObj");c&&"object"==typeof c&&(a=c[mvideo.device.manager.getType()],b=new Image,o.addClass("product-image-loading"),$(b).one("load",function(){o.attr("src",a).removeClass("product-image-loading")}),b.src=a)}(),f(),{tabletBehavior:$.noop,desktopBehavior:$.noop,mobileBehavior:$.noop}}),mvideo.Module.define("minicartManager",function(a){var b=window.mvideo.cacheControl,c=$(this);a=mvideo.helpers.paramParser(a,{zeroCounterNoClick:!0,timeToShow:2500,initFromAjax:!1,ajaxResponseName:"minicartMenu"}),a.initFromAjax=b.isPageFromCache(),a.onCounterChange=function(b,d,e){d>1&&"ajax"===e&&(c.addClass("hover"),setTimeout(function(){c.removeClass("hover")},a.timeToShow))},new mvideo.Class.ListStateViewController(this,a),a.zeroCounterNoClick&&$(this).on("click",function(b){var d=parseInt(c.find(a.ajaxSelectors.counter).text(),10);(isNaN(d)||d<1)&&b.preventDefault()})}),mvideo.Module.define("mobileNavigation",function(){function a(){var a=$(".header-nav-list"),e={title:"Учетная запись",classes:"navigation-item-hidden navigation-item-my-account",content:b($(".header-main").find(".header-main-area .header-user-block"))},f=$(".header-main"),g=c(a),h={title:"Продукты",classes:"active",content:d(a)},i={sities:f.find(".header-sities-link"),addresses:f.find(".header-store-addresses-delivery .header-link"),reviews:f.find(".header-reviews-link .header-link"),bonus:f.find(".header-bonus-link .header-link"),repair:f.find(".header-repair-link .header-link"),help:f.find(".header-help-link .header-link"),call:f.find(".call-free"),shop:f.find(".header-store-addresses-link .header-link"),wishlist:f.find(".wishlist-link"),messenger:f.find(".js-messenger")},j={title:i.shop.text(),classes:"stores",href:i.shop.attr("href")},k=[{title:i.addresses.text(),href:i.addresses.attr("href"),classes:"dark"},{title:i.reviews.text(),href:i.reviews.attr("href"),classes:"dark"},{title:i.bonus.text(),href:i.bonus.attr("href"),classes:"dark"},{title:i.repair.text(),href:i.repair.attr("href"),classes:"dark"},{title:i.help.text(),href:i.help.attr("href"),classes:"dark"},{title:i.call.text(),titleHead:i.call.data("title-mobile"),href:i.call.attr("href"),classes:"dark",preventEventDevice:!0},{title:i.messenger.find(".js-messenger-text").text(),href:i.messenger.attr("href"),classes:"dark",icon:i.messenger.find(".c-header-messenger__img").data("original"),target:i.messenger.prop("target")}],l={title:"Город",classes:"choice-city choice-city-top",description:$(".header-sities-link").text(),type:"region",postLoadUrls:$(".header-sities-link").data("post-load-url")};return{cities:$.map($(".header-primary-cities label"),function(a){return a=$(a),{href:a.find("a").attr("href"),title:$.trim(a.text())}}),compareList:{amount:$(".comparelist-amount").first().text(),link:$(".comparelist-link").first().attr("href")},wishList:{link:i.wishlist.attr("href"),amount:i.wishlist.find(".wishlist-amount").text()},navigation:[].concat(e,l,j,g,h,k.filter(function(a){return a.title}))}}function b(a){var b=[];return $(a).find(".header-user-drop-down-link").each(function(){var a,c=$(this),d=c.find(".header-user-drop-down__promolist-amount"),e=c.text();d.length>0&&(a=d.text(),e=e.slice(0,e.lastIndexOf(a))),b.push({href:c.attr("href"),title:e.trim(),itemClasses:c.data("mobileItemClasses"),itemIndicator:a||null})}),b}function c(a){var b=[];return a.children("li.action").each(function(){var a=$(this),c=a.find(">a"),d=a.find(".header-nav-drop-down-list"),f={title:c.text(),href:c.attr("href"),content:e(d),classes:"action"};b.push(f)}),b}function d(a){var b=[];return a.children("li").filter(":not(.last)").filter(":not(.action)").each(function(){var a=$(this),c=a.find(">a"),d=a.find(".header-nav-drop-down-list"),f={title:c.text(),href:c.attr("href"),clickable:c.data("clickable"),content:e(d)};b.push(f)}),a.find(".header-nav-extra li").each(function(){var a=$(this),c=a.find(">a"),d={title:c.text(),href:c.attr("href"),content:[]};b.push(d)}),b}function e(a){var b=[];return a.children("li").each(function(){var a=$(this),c=a.find(".header-nav-drop-down-title a"),d=c.text()?c:a.find(".header-nav-drop-down-title span"),e=a.find(".header-nav-drop-down-column-list"),g={title:d.text(),href:d.attr("href"),clickable:d.data("clickable"),content:f(e)};b.push(g)}),b}function f(a){var b=[];return a.children("li").each(function(){var a=$(this),c=a.find("a"),d={title:c.text(),href:c.attr("href"),content:[]};b.push(d)}),b}function g(){var b=a(),c=mvideo.instance.page.page.sidebar,d=JST["jade/partials/header/mobile-navigation"](b),e=$(d),f=new mvideo.Class.BarItem(e);return c.controller._insert(f),c.controller.register(f,!0),window.mvideo.Class.ReinitContent.gtmTracking(c.$.bar),c.$.bar.on("click",".active > .navigation-item-link",function(a){"falseClick"===$(this).data("clickable")&&"mobile"===mvideo.device.manager.getType()&&a.preventDefault()}),f}function h(){var a=j.sidebarArea,b=j.sidebar,c=$(".sticky-header"),d=$(".search-results-cluster-heading-menu-container_fixed"),e=$(".c-tabs__menu.affix");l.done(function(){if(i(!0),c.css("left","0"),d.css("left","0"),e.css("left","0"),b&&a)return a.hide(b).always(function(){k.removeClass(j.sidebarMenu)})})}function i(a){a?window.mvideo.Event.publish("close-side-bar-menu"):window.mvideo.Event.publish("open-side-bar-menu")}new mvideo.Class.MainNavigation(".header-nav");var j={sidebarArea:mvideo.instance.page.page.sidebar,sidebar:null,sidebarMenu:"sidebar-menu"},k=$(".sidebar"),l=jQuery.Deferred().resolve();return $(document).on("click",".header-menu-btn",function a(b){a.sidebar||(j.sidebar=a.sidebar=g()),b.preventDefault(),l.done(function(){var b,c=a.sidebar,d=mvideo.instance.page.page,e=$(".sticky-header"),f=$(".search-results-cluster-heading-menu-container_fixed"),g=$(".c-tabs__menu.affix");k.addClass(j.sidebarMenu),b=$(".sidebar-menu").width(),e.css("left",b),f.css("left",b),g.css("left",b),l=d.sidebar.show(c),i(!1)})}),mvideo.Event.subscribe("sidebar-close",h),{desktopBehavior:h,tabletBehavior:jQuery.noop,mobileBehavior:jQuery.noop}}),function(){var a=mvideo.template.iframeModal;mvideo.Module.define("modal",function(b){"use strict";var c=$(this),d=$.extend(!0,{eventLocation:1},b||{});c.click(function(b){var c=$(a({data:{id:d.id,src:d.src}}));b.preventDefault(),$("body").append(c),c.modal("show"),mvideo.Class.ReinitContent.reinit(c),$(".video-content").trigger("addUrl",{url:c.find("[data-src]").attr("data-src"),eventLocation:d.eventLocation}),c.on("destroy.modalmanager",function(a){a.preventDefault(),c.remove()})})})}(),mvideo.Module.define("modalsCloseHadler",function(a){$(a).on("click",function(a){var b=mvideo.instance.page.page.validationForms[$(this).parents(".modal").find("form").attr("id")];b&&(b.resetForm(),b.reset())})}),mvideo.Module.define("multiBundles",function(a){function b(){c.find(e+" li"+f).not(f+g).each(function(a){var b=a,c=$(this);$(":input",c).each(function(){var a=$(this);a.attr("name",a.attr("name").replace(/\[\d.*\]/,"["+b+"]"))})}),d.submit()}var c=$(this),d=c.find(".multi-bundles-send-data"),e=".multi-bundles-send-data",f=".multi-bundles-top-item",g=".multi-bundles-right";c.on("click",".js-multi-bundles-add-to-basket",function(a){a.preventDefault(),b()})}),mvideo.Module.define("multisku",function(a){function b(){var a=g.parent().width(),b=m.html();i||"mobile"===window.mvideo.device.manager.getType()||(f=g.width(),i=!0),m.removeClass(j),a<f?b?(m.removeClass(j),l.addClass(j)):c():(l.removeClass(j),m.addClass(j)),d()}function c(){l.addClass(j),l.find(h.multiskuGroup).each(function(){var a=$(this),b=a.find(h.buttonWrapper),c={title:a.attr("data-title")+" ("+b.length+")",type:a.attr("data-type"),elements:[]};b.each(function(){var a=$(this),b=a.find(h.button),d=b.attr("data-text"),e=b.attr("data-value"),f=b.attr("data-href"),g=b.hasClass("c-btn_white_selected"),i=b.hasClass("u-disabled"),j=a.find(h.price).text(),k=b.attr("data-pushable"),l=b.attr("data-action"),m=b.attr("data-holder");c.elements.push({text:d,value:e,href:f,selected:g,disabled:i,price:j,gaPushable:k,gaAction:l,gaHolder:m})}),m.append(k(c))}),mvideo.Class.ReinitContent.reinit(m)}function d(){m.off("change.MultiskuGtm").on("change.MultiskuGtm",".c-dropdown",function(a){var b=$(this),c=b.find("option:selected"),d=c.data("holder"),e=window.mvideoGtm[d];e&&window.dataLayer.push(e)}),n.off("mouseenter").on("mouseenter",h.button,function(a){var b=$(a.delegateTarget).find(h.multiskuCharacteristic),c=$(a.currentTarget);b.text(c.attr("data-text"))}),n.off("mouseleave").on("mouseleave",h.button,function(a){var b=$(a.delegateTarget).find(h.multiskuCharacteristic),c=$(a.delegateTarget).find(h.button+".c-btn_white_selected");b.text(c.attr("data-text"))})}function e(){n.off("mouseenter").off("mouseleave")}var f,g=$(this),h=$.extend(!0,{buttonsContainer:".c-multisku__buttons",dropdownsContainer:".c-multisku__dropdowns",multiskuGroup:".c-multisku__group",buttonWrapper:".c-btn-group__item",button:".c-multisku__button",price:".c-multisku__price",multiskuCharacteristic:".c-multisku__characteristic",abTestVersion:null},a),i=!1,j="u-hidden",k=mvideo.template.multiskuDropdownTemplate,l=g.find(h.buttonsContainer),m=g.find(h.dropdownsContainer),n=g.find(h.multiskuGroup);return function(){g.find(h.price).each(function(){var a=$(this),b=a.parent().width();a.removeClass(j),a.css({left:(b-a.width())/2})})}(),{desktopBehavior:function(){b(),d()},tabletBehavior:function(){b(),e()},mobileBehavior:function(){g.find(h.dropdownsContainer).addClass(j),g.find(h.buttonsContainer).removeClass(j),e()}}}),mvideo.Module.define("my-account-bonus-rubles-info-line",function(){var a=$(this),b=a.find(".my-account-bonus-rubles-info-line__text");a.find(".my-account-bonus-rubles-info-line__line_green").width()>b.width()+5?b.css("color","white"):b.css("color","black")}),mvideo.Module.define("collapse",function(a){function b(a,b){h=j.find(".collapse-text-initial").height(),h<=b.rangeHeight&&(a=!0,o=!0,g()),a||o?(j.height("auto"),k.toggleClass("hidden",!!a)):h>b.rangeHeight&&j.height(b.maxHeight),o||(m.toggleClass("hidden",!!a),l.toggleClass("hidden",!!a))}function c(a){e(a,"collapse"),o=!1}function d(){e(h,"expand"),o=!0}function e(a,b){"collapse"==b&&m.show(),j.animate({height:a+"px"},n,function(){l.toggleClass("hidden"),k.toggleClass("hidden"),"expand"==b&&m.hide()})}function f(a){l.off("click.Collapse").on("click.Collapse",function(a){a.preventDefault(),d()}),k.off("click.Collapse").on("click.Collapse",function(b){b.preventDefault(),c(a.maxHeight)})}function g(){var a=j.find(".collapse-text-initial").height();j.height(a),l.removeClass("hidden").addClass("hidden"),k.removeClass("hidden").addClass("hidden"),m.hide(),o=!0}a=a||{},a=$.extend({holder:this,hideLinkSelector:".collapse-link-hide",showLinkSelector:".collapse-link-show",gradientSelector:".collapse-gradient"},a);var h,i=$(a.holder),j=i.find(".collapse-text"),k=i.find(a.hideLinkSelector),l=i.find(a.showLinkSelector),m=i.find(a.gradientSelector),n=750,o=!1;return mvideo.Event.subscribe("resize",function(){var a=j.find(".collapse-text-initial");o||(a.height("auto"),h=a.height()),o&&j.height("auto")}),{desktopBehavior:function(){a.desktopBehavior?(b(!a.desktopBehavior,a.desktopBehavior),f(a.desktopBehavior)):g()},tabletBehavior:function(){a.tabletBehavior?(b(!a.tabletBehavior,a.tabletBehavior),f(a.tabletBehavior)):g()},mobileBehavior:function(){a.mobileBehavior?(b(!a.mobileBehavior,a.mobileBehavior),f(a.mobileBehavior)):g()}}}),mvideo.Module.define("notifications",function(a){var b=$(this),c=b.parent(),d=$.extend(!0,{shouldEventPrevent:!1},a||{});b.find(".c-notifications__close").click(function(){b.trigger("notifications-remove"),d.shouldEventPrevent||(b.remove(),c.trigger("notification-removed"))})}),mvideo.Module.define("openBlockAfterPageReload",function(a){var b=$(this),c=b.attr("id");$(window).load(function(){a.preorderCampaignActivated&&(mvideo.instance.page.page.goToBlock("#"+c),b.hasClass("in")||$("[data-target=#"+c+"]").click())})}),mvideo.Module.define("open-close-checked",function(a,b,c){function d(){f?g?h.addClass("hidden"):h.removeClass("hidden"):g?h.removeClass("hidden"):h.addClass("hidden")}var e=$(a),f=e.prop("checked"),g=!!c,h=b?$(b):$(this);d(),e.on("click change",function(){f=e.prop("checked"),d(),e.trigger(f?"open":"close")})}),mvideo.Module.define("openCloseHover",function(a){new mvideo.Class.PopupLinkHover(this,a,{eventOnParent:!0})}),mvideo.Module.define("open-close-radio-change",function(a){a=$.extend(!0,{radioSelector:"",radioValue:"",blockSelector:"",multipleValues:!1},a);var b=$(a.radioSelector),c=$(a.blockSelector);b.on("change",function(){var d=b.find(" input:checked").val();a.multipleValues&&~a.radioValue.indexOf(d)||!a.multipleValues&&d===a.radioValue?c.show():c.hide()}),b.trigger("change")}),mvideo.Module.define("open-services",function(a){a=$.extend({openedHolderClass:"c-link_chevron_opened",openedTargetClass:"c-cart-service_opened"},a);var b=$(this),c=$(b.data("target"));c.removeClass(a.openedTargetClass),b.removeClass(a.openedHolderClass),"desktop"===mvideo.device.manager.getType()&&(c.addClass("in"),b.removeClass("collapsed"))}),window.mvideo.Module.define("order-edit",function(a){function b(a){l.toggleClass("disabled-form",a)}function c(){var b=$.extend(!0,{data:d(),url:m.attr("action")},a.requestParams);$.ajax(b).fail(e).done(f).always(g)}function d(){return new FormData(m[0])}function e(){h()}function f(a){"success"===a.status?j.begin(a.htmlContent):h(a.htmlContent)}function g(){b(!1)}function h(b){var c=b||a.defaultError,d="string"==typeof c?{message:c}:c||{};n.setContent(d),n.show()}a=$.extend(!0,{eventBus:"update-confirmation",confirm:"ClassConfirmation",popupConfig:{classes:["tooltip","tooltip_xs"]},requestParams:{method:"POST",dataType:"json",cache:!1,processData:!1,contentType:!1},defaultError:"Извините сервис временно не доступен. Попробуйте позднее.",sendEvent:"submit",eventOnDoneRemoteValidation:"update-remote-validation",remoteValidationParam:[{}]},a);var i,j,k,l=$(this),m=a.form?$(a.form):l,n=new window.mvideo.Class.ErrorPopup("body",a.popupConfig),o=!1;!function(c){window.mvideo.observer(c),j=new window.mvideo.Class[a.confirm](l,{eventBus:a.eventBus,popupConfig:a.popupConfig},c.publish),c.subscribe(a.eventBus,function(a,c){switch(c.status){case"done":b(),i=c.fullData.delayRedirectUrl;break;case"cancel":i&&window.location.assign(i)}})}(this),function(b){k=window.mvideo.Module.init("remote-validation",$.extend(!0,a.remoteValidationParam,[{eventOnDone:a.eventOnDoneRemoteValidation}]),b),l.on(a.eventOnDoneRemoteValidation,function(b,c){!c.isValidationRunning&&o&&(o=!1,m.trigger(a.sendEvent))})}(this),m.off(a.sendEvent).on(a.sendEvent,function(a){return a.preventDefault(),m.validate().checkForm()?(b(!0),k.isRemoteValidationRunning()?void(o=!0):void c()):void b(!1)})}),mvideo.Module.define("change-delivery-date",function(a){function b(){var a=f.find(":selected");g.val(a.data("price")),h.val(a.data("startdate")),i.val(a.data("enddate"))}a=$.extend(!0,{namespace:"order-status.update",selectOrderId:"[name='orderId']",messageErr:"error",selectPrice:".js_change-date__price",selectStartDate:".js_change-date__startDate",selectEndDate:".js_change-date__endDate",selectDeliveryTime:"#delivery-time"},a);var c,d=$(this),e=$(a.selectOrderId,d).val(),f=$(a.selectDeliveryTime,d),g=$(a.selectPrice,d),h=$(a.selectStartDate,d),i=$(a.selectEndDate,d);d.on("change",function(a){"SELECT"===a.target.nodeName&&b()}).on("submit",function(){$.ajax({type:d.attr("method"),url:d.attr("action"),data:d.serialize(),dataType:"json",cache:!1,beforeSend:function(a){c||(c=new window.mvideo.Class.Overlay(d)),c.show()}}).done(function(b){$("#order-"+e).trigger(a.namespace,b)}).fail(function(){$("#order-"+e).trigger(a.namespace,{orderId:e,status:"error",message:a.messageErr})}).always(function(){c.hide()})}),setTimeout(function(){b()})}),mvideo.Module.define("order-change-cost",function(a){function b(){var a=parseInt(f.find(":selected").data("price"),10),b=g+a;d.html(window.mvideo.helpers.price().spaceCorrectPrice(a)+"¤"),e.html(window.mvideo.helpers.price().spaceCorrectPrice(b)+"¤")}a=$.extend(!0,{costOrder:0},a);var c=$(this),d=$("[data-cost-courier] .c-cost-line__text",c),e=$("[data-cost-order] .c-cost-line__text",c),f=$("#delivery-time",c),g=parseInt(a.costOrder,10);c.on("change",function(a){"SELECT"===a.target.nodeName&&b()}),setTimeout(function(){b()})}),window.mvideo.Module.define("order-manager",function(a){function b(b){e.removeClass(a.notificationSettings.error+" "+a.notificationSettings.success).addClass(a.notificationSettings[b])}a=$.extend(!0,{selectAmount:"[data-order-amount]",selectStatus:"[data-order-status]",orderId:"",redirect:!1,notificationSettings:{notification:".order-history-notification",icon:".c-notifications__icon",error:"i-icon-error u-color-red",success:"i-icon-ok u-color-green"}},a);var c=$(this),d=$(a.notificationSettings.notification,c),e=$(a.notificationSettings.icon,c);c.on("order-status.update apply-promocode",function(e,f){var g=f.reloadTimeout||0;if(!f.noClosePopup&&$(".c-popup_active [data-close]").trigger("click"),f&&window.dataLayer&&f.gtmPush){var h=f.gtmPush.mutationFunction;h?window.mvideo.helpers.gtmMutationFunctions[h]?window.dataLayer.push(window.mvideo.helpers.gtmMutationFunctions[h](f.gtmPush)):window.console.warn(h+" hasn't been found"):window.dataLayer.push(f.gtmPush)}if(f&&"error"===f.status)return b(f.status),d.find(".c-notifications__title").html(f.message),void d.show();a.redirect&&"success"===f.status&&setTimeout(function(){window.location.reload(!0)},g),f&&"success"===f.status&&(c.find(a.selectAmount).html(f.amount),b(f.status),f.message&&c.find(a.selectStatus).html(f.message),d.hide())})}),mvideo.Module.define("order-request-chat",function(a){function b(){k.show(),j.trigger("files-sending"),$.ajax({type:e.attr("method")||"POST",url:e.attr("action"),data:new FormData(e[0]),dataType:"json",cache:!1,processData:!1,contentType:!1}).done(function(b){if(b&&"success"===b.status){if(b.htmlMessages){var e=window.mvideo.Class.ReinitContent.reinit(b.htmlMessages);f.append(e)}return b.msgGt&&i.html(b.msgGt),h.val("").trigger("blur"),j.trigger("file-loader-reinit",b.fileLoader),b.formFreeze&&c(),void g.addClass(a.hiddenClass)}d()}).fail(function(){d()}).always(function(){k.hide()})}function c(){e.addClass("disabled-form c-msg-limit_limit"),h.attr("disabled",!0)}function d(){j.trigger("file-loader-reinit",{notClear:!0}),g.removeClass(a.hiddenClass)}a=$.extend({form:"",blockMessages:"",hiddenClass:"u-hidden",errMsg:".order-request-footer-rate-wrapper__error-msg",selectQt:".c-msg-limit__count",inputClear:"textarea",fileLoader:".c-file-loader"},a);var e=$(a.form),f=$(a.blockMessages),g=$(a.errMsg,e),h=$(a.inputClear,e),i=$(a.selectQt,e),j=$(a.fileLoader),k=new mvideo.Class.Overlay(e);e.submit(function(a){a.preventDefault(),e.validate().checkForm()&&b()})}),window.mvideo.Module.define("order-status-autoload",function(a){a=$.extend(!0,{name:{phone:"phone",order:"orderId"},inputSelect:{phone:'[name="phoneNumber"]',order:'[name="orderNumberOnline"]'}},a);var b={order:null,phone:null},c=window.mvideo.Module.init("popup",arguments,this);c&&c.popup&&(b=function(){var b=window.mvideo.helpers.getUrlParam();return{order:b[a.name.order],phone:b[a.name.phone]}}(),(b.order||b.phone)&&window.mvideo.Event.once(a.namespace+".ajaxForForm",function(){b.order&&c.popup.getContentCurrentPopup().find(a.inputSelect.order).val(b.order).trigger("blur"),b.phone&&c.popup.getContentCurrentPopup().find(a.inputSelect.phone).val(b.phone).trigger("blur")}))}),mvideo.Module.define("order-status",function(a){function b(a){0===a.indexOf("/")?location.href=a:(i.hide(),h.html(a),mvideo.Class.ReinitContent.reinit(h))}function c(){var a=h.find(".order-status_error");a.length?a.replaceWith(k):h.find(".c-btn_text").before(k),i.hide(),window.dataLayer.push({event:"OWOX",eventAction:"show",eventCategory:"Non-Interactions",eventLabel:"errorOrderStatus",eventContext:e.find("[name='orderNumber']").val()})}function d(){e.find(j.inputSelector).each(function(){var a=$(this);a.val("").removeClass("u-error").data("prevVal",""),a.parent().find(".u-error-text").hide()})}var e,f,g,h,i,j=$.extend(!0,{formHolder:"#orderStatusForm",errorResponseText:"Сервис временно недоступен",radio:"[name='way']",radioHolder:"[data-container-radio]",recaptchaSelector:'[name="recaptcha"]',inputSelector:"[data-order-status-input]"},a),k='<div class="c-line-img order-status_error u-mt-20"><i class="c-line-img__icon i-icon-error c-line-img_red c-line-img_l2"></i>'+j.errorResponseText+"</div>";!function(){e=$(j.formHolder),h=e.closest(".c-popup__content"),g=$(j.radioHolder),f=$(j.recaptchaSelector,e),i=new mvideo.Class.Overlay(e),g.on("change",j.radio,function(){f.trigger("reinit-recaptcha"),d()}),e.submit(function(){return e.validate().checkForm()&&(i.show(),$.ajax({type:e.attr("method"),url:e.attr("action"),data:e.serialize(),dataType:"html",cache:!1}).done(b).fail(c)),!1})}()}),mvideo.Module.define("pagination",function(a){var b=$.extend(!0,{holder:".pagination-section",holderItem:"a",form:""},a||{}),c=$(b.form);$(b.holder).on("click",b.holderItem,function(a){a.preventDefault(),c.attr("action",c.attr("action")+"&"+$(this).attr("href").slice(1)),c.find("input[type=submit]").trigger("click")})}),mvideo.Module.define("passwordComplexity",function(a,b,c){function d(){r=j.val(),s=r.split(""),t.Excess=0,t.Upper=0,t.Numbers=0,t.Symbols=0,u.Combo=0,u.FlatLower=0,u.FlatNumber=0,p=0,q=0}function e(){for(var a=0;a<s.length;a++)s[a].match(/[A-Z]/g)&&t.Upper++,s[a].match(/[0-9]/g)&&t.Numbers++,s[a].match(/(.*[!,@,#,$,%,^,&,*,?,_,~])/)&&t.Symbols++;t.Excess=s.length-o,t.Upper&&t.Numbers&&t.Symbols?u.Combo=25:(t.Upper&&t.Numbers||t.Upper&&t.Symbols||t.Numbers&&t.Symbols)&&(u.Combo=15),r.match(/^[\sa-z]+$/)&&(u.FlatLower=-1e3),r.match(/^[\s0-9]+$/)&&(u.FlatNumber=-1e3)}function f(){q=p+t.Excess*u.Excess+t.Upper*u.Upper+t.Numbers*u.Numbers+t.Symbols*u.Symbols+u.Combo+u.FlatLower+u.FlatNumber}function g(a){d(),s.length>=o?(p=50,e(),f()):p=0,i()}function h(a){return[m,a].join(" ")}function i(a){q<50?(k[0].className=h(n[3].className),l.html(n[3].text)):q>=50&&q<75?(k[0].className=h(n[2].className),l.html(n[2].text)):q>=75&&q<100?(k[0].className=h(n[1].className),l.html(n[1].text)):q>=100&&(k[0].className=h(n[0].className),l.html(n[0].text))}var j=$(a),k=$(b),l=$(c),m=k.attr("class"),n=[{className:"password-secure",text:"Безопасный"},{className:"password-good",text:"Хороший"},{className:"password-moderate",text:"Средний"},{className:"password-weak",text:"Слабый"}],o=6,p=0,q=0,r="",s=[],t={};t.Excess=0,t.Upper=0,t.Numbers=0,t.Symbols=0;var u={};u.Excess=3,u.Upper=4,u.Numbers=2,u.Symbols=5,u.Combo=0,u.FlatLower=0,u.FlatNumber=0,j.keyup(function(){g()}),g()}),mvideo.Module.define("password-recovery",function(a){function b(a){d(),c(a.target.value)}function c(a){g.hide().filter('[data-password-recovery="'+a+'"]').show()}function d(){g.find("input").val("").trigger("blur").removeClass("u-error"),g.find(".u-error-text").hide()}a=$.extend(!0,{form:this,switchLogin:".c-toggle-buttons__input"},a);var e=$(a.form),f=$(a.switchLogin,e),g=$("[data-password-recovery]",e);f.on("change",b.bind(this)),c(f.filter(":checked").val())}),window.mvideo.Module.define("pdp-carousel-popup",function(a){a=$.extend(!0,{selectCarousel:"[data-carousel]",selectTouchZoom:'[data-init="touch-zoom"]',selectMobileSwipe:".c-carousel__swipe",selectMobileSwipeCounter:".c-carousel__counter",mediacontainer:{img:"[data-container-img]",iframeHTMl:"[data-container-iframe]",video:"[data-container-video]"},devices:{desktop:8,tablet:6,mobile:1},classManageArrows:window.mvideo.Class.PdpZoomManageArrows,classMediaContainer:window.mvideo.Class.PdpZoomMediaContainer,classMobileSwipe:window.mvideo.Class.PDPZoomMobileSwipe},a);var b=$(this),c=$(a.selectCarousel,b),d=$(a.mediacontainer.img,b),e=$(a.mediacontainer.iframeHTMl,b),f=$(a.mediacontainer.video,b),g=$(a.selectMobileSwipe,b),h=new a.classManageArrows(c,{devices:a.devices}),i=new a.classMediaContainer({imgContainer:d,iframeContainer:e,videoContainer:f}),j=new a.classMobileSwipe(g),k=$(a.selectTouchZoom,b);$.support.touch&&(j.subscribe("swipe",function(a,b){"left"===b.direction?h.cb.next():"right"===b.direction&&h.cb.prev()}),d.swipe({swipe:function(a,b){"false"===k.attr("data-disabled-slike")&&"false"===k.attr("data-disabled-swipe")&&("left"===b?h.cb.next():"right"===b&&h.cb.prev())},threshold:15,allowPageScroll:$.fn.swipe.pageScroll.VERTICAL})),b.on("choose-slide",function(a,b){h.doFistSlideUrl(b.url)}),h.subscribe("set-slide",function(a,b){k.trigger("touch-zoom",{type:"off"}).trigger("touch-zoom-setDefault"),"iframeHTMl"===b.slide.data("type")?k.trigger("touch-zoom",{type:"on"
}):"3d"===b.slide.data("type")?k.attr("data-disabled-swipe","true"):k.attr("data-disabled-swipe","false"),i.run(b.slide),b.counter&&j.updateCounter({current:b.counter.current,allCount:b.counter.allCount})}),h.subscribe("hide-arrows",function(){j.hideArrows()})}),mvideo.Module.define("pdp-carousel",function(a){function b(){var a=window.location.search.slice(1).split("&"),b=!1;return a.indexOf("video")>-1&&(b=!0),b}function c(){var a=b(),c=$('.c-carousel__item[data-type="video"]').not(".u-hidden");a&&(window.history.scrollRestoration="manual",$(window).load(function(){c.click(),d.call(this)}))}function d(){var a=$(".c-carousel__item.u-hidden").toArray(),b=_||1===a.length,c=b?V.find("#media-container-player"):$(".c-zoom").find("#zoom-player-0"),d=c.attr("src");/\?/g.test(d)?c.attr("src",d+"&autoplay=1"):c.attr("src",d+"?autoplay=1"),b&&e(c)}function e(a){a.on("load",function(){var b=a.offset(),c=a.height();$(window).scrollTop(b.top?b.top-c/2:0)})}function f(){V.swipe({swipe:h,threshold:15,tap:function(){V.find("img").hasClass("c-media-container__image_novisible")||V.find("img").trigger("carousel-click")},allowPageScroll:$.fn.swipe.pageScroll.VERTICAL})}function g(){$(".c-carousel__swipe",ca).swipe({swipe:function(a,b){switch(b){case"left":u(),i();break;case"right":u(),j()}},threshold:15})}function h(a,b){if("image"===U.type)switch(b){case"left":i();break;case"right":j()}}function i(){var a;if(s())w();else if(0!==(a=(U.indexImg+1)%Y)){var b=ca.find("[data-slick-index="+a+"]"),c=b.offset().left;if(!da.isPopup&&c+b.width()>V.width()){var d=ca.find("."+da.mediaIconsContainer).width();ca.offset({left:-b.position().left-b.width()-d+V.width()})}n(a)}}function j(){var a;if(s())ia===fa?k():v();else if(a=U.indexImg-1,(a=a>=0?a:Y-1)!==Y-1){var b=ca.find("[data-slick-index="+a+"]"),c=b.offset().left;if(!da.isPopup&&c<0){var d=ca.find("."+da.mediaIconsContainer).width();ca.offset({left:-b.position().left-d})}n(a)}}function k(){X.one("setPosition",function(){v()}),n(-1),X.slick("slickPrev")}function l(a,b,c){ha=c,q()}function m(){n(0)}function n(a){var b=ca.find("[data-slick-index="+a+"]");b.length&&L.call(b)}function o(a,b){var c=X.find('[data-src="'+b.url+'"]'),d=X.find(".c-carousel__item_active").index();c.length&&setTimeout(function(){L.call(c),X.slick("getSlick").slickGoTo(d)})}function p(){var a=X.find("."+da.itemClass).length;a<la()&&(da.slidesToShow.desktop=a,da.slidesToShow.tablet=a,da.slidesToShow.mobile=a)}function q(){ha=ha||$(window).width(),E(),N(),ca.find("."+da.itemClass).on("click",{clickArrow:!0},L),s()&&r()}function r(){$(".c-carousel__arrow_prev",ca).off("click").on("click",{clickArrow:!0},v),$(".c-carousel__arrow_next",ca).off("click").on("click",{clickArrow:!0},w)}function s(){return X.find("."+da.arrowClass).length?(X.addClass(da.paddingClass),!0):(X.removeClass(da.paddingClass),!1)}function t(a){if(void 0!==a){$.extend({clickArrow:!1},a.data).clickArrow&&u()}}function u(){V.trigger("touch-zoom-setDefault")}function v(a){if(t(a),ga)return!1;if(ia===fa)k();else{var b=$("."+da.slickActiveClass,ca).eq(0);L.call(b)}}function w(a){t(a);var b,c;if(ga)return!1;b=ia>fa?2:1,c=$("."+da.slickActiveClass,ca).eq(b),ha<=ea&&ia>fa?(X.one("afterChange",function(){c=$("."+da.slickActiveClass,ca).eq(1),L.call(c)}),X.slick("slickNext")):L.call(c)}function x(){ga=!0}function y(){ga=!1}function z(a){var b;F(),b=U.indexImg||0,b=b>Y?b-Y:b,ca.find("[data-slick-index="+(b+Y)+"]").addClass(da.activeClass),D(a)}function A(a){var b,c,d;F(),c=U.indexImg||0,c=c>Y?c-Y:c,b=ca.find("[data-slick-index="+c+"]").addClass(da.activeClass).data("src"),d=a.data("zoom-img")||b,ca.find("[data-slick-index="+(c+Y)+"]").addClass(da.activeClass),D(a),I(b),B(d),C("image")}function B(a){V.find("img").attr("data-zoom-img",a)}function C(a){V.find("img").attr("data-type",a)}function D(a){var b=$("."+da.slickActiveClass,ca).index(a);if(ia>fa)switch(b){case 0:X.slick("slickPrev");break;case 2:X.slick("slickNext",{data:"sadsad"})}T()}function E(){K(),P()}function F(){ca.find("."+da.activeClass).removeClass(da.activeClass),U.self.addClass(da.activeClass),H()}function G(a){var b=$(a),c=V.find("img");F(),c.addClass("c-media-container__image_novisible"),aa.data("init-iframe")||(aa.html(aa.html()+'<iframe src="'+b.data("src")+'">'),aa.data("init-iframe",!0),aa.data("src",b.data("src-full"))),aa.show()}function H(){aa.hide()}function I(a){V.find("img").attr("src",a),V.find("img").removeClass("c-media-container__image_novisible")}function J(a){var b=$('.c-carousel__item[data-type="video"]',ca).toArray();da.isPopup||1===b.length||_?(F(),V.find("img").addClass("c-media-container__image_novisible"),W=W||V.find("."+da.videoContainer),W.addClass("c-media-container__video_active"),W.trigger("addUrl",{url:a.data("src"),eventLocation:"video"})):U=ja}function K(){W&&(W.removeClass("c-media-container__video_active").trigger("clear").height(""),V.height(""))}function L(a){t(a);var b=$(this);if("true"!==V.attr("data-disabled-slike")){if(!b.data("type"))return M(b);ia++,U={self:b},U.indexImg=U.self.data("slick-index"),U.type=U.self.data("type"),N()}}function M(a){a.data("src")&&window.open(a.data("src"),"","scrollbars=no,resizable=yes,status=no,location=no,toolbar=no,menubar=no,width=700,height=700,left=0,top=0").focus()}function N(){if(E(),U)switch(da.isPopup&&V.trigger("touch-zoom",{type:"off"}),U.type){case"image":A(U.self);break;case"video":da.isPopup&&z(U.self),J(U.self);break;case"3d":da.isPopup&&z(U.self),O(U.self);break;case"iframeHTMl":da.isPopup&&V.trigger("touch-zoom",{type:"on"})&&z(U.self),G(U.self)}}function O(a){var b=a.data("images"),c=V.find("img");C("3d"),F(),c.removeClass("c-media-container__image_novisible"),c.attr("src",a.data("src")),c.reel({responsive:1,loops:!0,images:b,speed:.4,width:c.width,height:c.height,cursor:"../img/cursors/reel.cur"}),c.closest(".lazy-load-image-holder").addClass("lazy-loaded")}function P(){V.find("img").removeAttr("id").parent().removeAttr("id"),$.reel.instances.unreel()}function Q(){_=!0}function R(){_=!1}function S(a,b){var c="next"===a?"next":"previous",d="next"===a?"right":"left";return b&&(d="next"===a?"bottom":"top"),'<button data-role="none" class="'+da.arrowClass+" "+da.arrowClass+"_"+a+" sel-hits-button-"+a+'" aria-label="'+c+'"><i class="font-icon icon-'+d+'-open"></button>'}function T(){ba&&ba.html(X.slick("getCurrent")+1+"/"+(X.slick("getDotCount")+1))}var U,V,W,X,Y,Z,_,aa,ba,ca=$(this),da={class:"",mediaContainer:"c-media-container",imagesContainer:"c-carousel__images",videoContainer:"c-media-container__video",iframeHTMl:"c-media-container__iframeHTMl",mediaIconsContainer:"c-carousel__media",slickActiveClass:"slick-active",slidesToShow:{desktop:3,tablet:3,mobile:1},isPopup:!1},ea=350,fa=1,ga=!1,ha=null,ia=0,ja={},ka=mvideo.device.manager.getType,la=function(){return da.slidesToShow[ka()]};return function(){$.extend(!0,da,a||{}),da.itemClass=da.itemClass||da.class+"__item",da.arrowClass=da.arrowClass||da.class+"__arrow",da.activeClass=da.activeClass||da.itemClass+"_active",da.paddingClass=da.paddingClass||da.imagesContainer+"_padding",da.smallClass=da.smallClass||da.imagesContainer+"_small",V=$("."+da.mediaContainer),X=$("."+da.imagesContainer,ca),ca.off("choose-slide").on("choose-slide",o),aa=$("."+da.iframeHTMl,V.closest(".o-product-gallary")),ba=da.isPopup&&$(".c-carousel__counter",ca),da.slidesToShow.mobile=da.isPopup?da.slidesToShow.mobile:X.find(".c-carousel__item").length,p();var b={vertical:!1,infinite:!0,touchMove:!1,arrows:!0,slidesToShow:da.slidesToShow.tablet,prevArrow:S("prev"),nextArrow:S("next")};Z={vertical:!da.isPopup,touchMove:!1,swipe:!1,infinite:!0,slidesToShow:da.slidesToShow.desktop,prevArrow:S("prev",!da.isPopup),nextArrow:S("next",!da.isPopup),responsive:[{breakpoint:1024,settings:b},{breakpoint:768,settings:$.extend({},b,{slidesToShow:da.slidesToShow.mobile,infinite:da.isPopup,arrows:da.isPopup})}],variableWidth:da.isPopup}}(),function(){X.on("init",q).on("breakpoint",l).on("beforeChange",x).on("afterChange",y),Y=X.find("."+da.itemClass).length,X.slick(Z),m(),f(),g(),c()}(),{desktopBehavior:R,tabletBehavior:R,mobileBehavior:Q}}),window.mvideo.Module.define("pdp-zoom",function(a){var b=new mvideo.Class.PdpZoomEvent(a),c=$('[data-type="iframeHTMl"]');return c.length&&(window.mvideo.helpers.isIE()?c.remove():setTimeout(function(){c.trigger("click")})),{desktopBehavior:b.desktopBehavior.bind(b),tabletBehavior:b.desktopBehavior.bind(b),mobileBehavior:b.mobileBehavior.bind(b)}}),mvideo.Module.define("pdp-best-price-guarantee",function(){var a=$(this),b=a.find("form"),c=a.parent(),d=new mvideo.Class.Overlay,e=function(){b.on("submit",function(a){if(b.validate().valid())return $.ajax({type:b.attr("method")||"post",url:b.attr("action"),dataType:"html",data:b.serialize(),beforeSend:function(){d.show(c)},complete:function(){d.hide(c)},success:function(a){c.html(a),mvideo.Class.ReinitContent.reinit(c)}}),!1})};b.data("apply.validation")?e():b.one("apply.validation",e)}),mvideo.Module.define("pdp-sku-label",function(){var a=$(this);a.find("[data-show-more]").click(function(){$(this).remove(),a.find(".o-pdp-topic__labels-item").css("display","inline-block")})}),function(){var a=null,b=!1;mvideo.Module.define("toggle-trade",function(c){function d(){m.switchState(),a=m.getState(),i.prop("checked",k.prop("checked")),j.trigger("onToggleTrage")}function e(a){a?(k.attr("disabled",!0),k.next(h.label).addClass(h.disabled)):(k.attr("disabled",!1),k.next(h.label).removeClass(h.disabled)),b=a}function f(){p.css("font-size",0),p.css("line-height",0),p.animate({fontSize:"1.3rem","line-height":"1.8rem"},300)}function g(){k.prop("checked",!k.prop("checked"))}var h={holder:".o-pay",states:["o-pay_trade-in",""],toggle:'[data-id="trade-in"]',hiddenInput:'[data-id="js-trade-in"]',idPostfix:"-zoom",label:".c-checkbox__label",disabled:"u-disabled",popup:".c-popup_zoom-pdp",form:".o-pay__trade-toggle",miniBasketContent:".mini-basket-content",miniBasketCounter:".mini-basket-amount",disableAfterCart:!1,addedToCart:!1};h=$.extend(!0,h,c||{});var i,j=$(this),k=j.find(h.toggle),l=$(h.hiddenInput),m=new mvideo.Class.StateContainer($(h.holder),{states:h.states}),n=j.find(h.form),o=$(h.miniBasketContent),p=$(h.miniBasketCounter),q=new mvideo.Class.Overlay(j,!0);if(null===a?(a=m.getState(),b=k.attr("disabled")):(m.setState(a),e(b)),k.add(l).prop("checked",a===h.states[0]),j.parents(h.popup).length){var r=k.attr("id")+h.idPostfix;k.attr("id",r),k.next(h.label).attr("for",r)}i=$(h.toggle).not(k).add(l),k.on("change",function(a){if(!h.disableAfterCart&&h.addedToCart){var b=n.attr("action"),c=n.attr("method");$.ajax({url:b,method:c,data:n.serialize(),beforeSend:function(){q.show()}}).then(function(a){var b=a.minicartMenu;b?(d(),p.text(b.counter),o.html(b.htmlContent),f()):g()}).fail(function(){g()}).always(function(){q.hide()})}else d()}),j.on("add-remove-basket",function(a,b){if(h.disableAfterCart){e("add"===b)}h.addedToCart="add"===b})})}(),mvideo.Module.define("phone-verification",function(a){return a=$.extend(!0,{holder:this,inputConfig:{},confirmConfig:{},codeCheckConfig:{}},a),{phoneVerification:new mvideo.Class.PhoneVerification(a)}}),mvideo.Module.define("photo-gallery",function(){function a(){e&&(d.fancybox(f),e=!1)}function b(){var a=c.find(".photo-gallery-text"),b=Math.max.apply(null,a.map(function(){return 0===$(this).siblings(".photo-holder").width()?0:$(this).outerHeight(!0)}).get());c.find(".slick-slide").css({paddingBottom:b})}var c=$(this),d=c.find(".fancybox"),e=!0,f={autoScale:!0,loop:!1,prevEffect:"fade",nextEffect:"fade",overlayShow:!0,helpers:{overlay:{locked:!1},title:{type:"inside"}},beforeShow:function(){var a=$(this.element).data("note");a&&(this.title=this.title+'<span class="note">'+a+"</span>")}};return c.slick({infinite:!1,speed:300,variableWidth:!0,lazyLoad:"progressive",draggable:!1,prevArrow:'<a href="#" data-role="none" class="slick-prev" aria-label="previous"></a>',nextArrow:'<a href="#" data-role="none" class="slick-next" aria-label="next"></a>',responsive:[{breakpoint:767,settings:{centerMode:!1,centerPadding:"0",slidesToShow:1,variableWidth:!1}}]}),a(),c.find(".photo-holder-image").load(function(){b()}),{desktopBehavior:function(){c.off("click"),a(),b()},tabletBehavior:function(){c.off("click"),a(),b()},mobileBehavior:function(){$(document).unbind("click.fb-start"),e=!0,c.on("click",".fancybox",function(a){a.preventDefault()}),b()}}}),mvideo.Module.define("plp-facet",function(a){$.extend(!0,{page:"listing"},a);var b=$(this).data("facetNewInstance");return new mvideo.Class.PLPFacetSection(this,a,!!b),{desktopBehavior:function(){},tabletBehavior:function(){},mobileBehavior:function(){}}}),window.mvideo.Module.define("popup-energy",function(a){var b=$(this),c=$.extend(!0,{title:"Класс энергосбережения",link:{title:"Подробные характеристики",href:""},classes:[{name:"A+++",color:"greenDark"},{name:"A++",color:"green"},{name:"A+",color:"lime"},{name:"A",color:"yellow"},{name:"B",color:"orange"},{name:"C",color:"orangeDark"},{name:"D",color:"red"}]},a),d=window.mvideo.template.popupEnergyTemplate,e=function(){return d({data:c})}(),f={title:e,side:"bottom",trigger:"click",classes:["energy"],contentAsHTML:!0};new mvideo.Class.Tooltip(b,f)}),window.mvideo.Module.define("popup-order-control",function(a){function b(){f().show(),f().overlay.show()}function c(a){"error"===a.status?d(a):e(a.htmlContent)}function d(b){var c=b.errorMessage?b.errorMessage:a.errorMessage;f().getContentCurrentPopup().addClass("c-popup_tooltip").removeClass("c-popup_with-title c-popup_with-button"),e(c)}function e(a){f().overlay.hide(),f()._setContent(a),window.mvideo.Class.ReinitContent.reinit(f().getContentCurrentPopup())}function f(){return h||(h=new window.mvideo.Class.Popup("",$.extend(!0,{title:" "},a.popupParams)))}a=$.extend(!0,{ajaxConfig:{url:"/cancel-order",dataType:"json",type:"POST",data:{}},popupParams:{contentAsHTML:!0,classes:[],functionClose:function(){f().overlay.hide()}},errorMessage:'<div class="c-line-img u-pl-24"><i class="c-line-img__icon i-icon-error u-color-red"></i>Сервис временно недоступен, попробуйте позднее </div>'},a);var g=$(this),h=null;g.on("click",function(e){e.preventDefault(),b(),$.ajax(a.ajaxConfig).done(c).fail(d)})}),window.mvideo.Module.define("popup-review",function(a){var b,c=a.ajaxForForm?$(this).parents("form"):$(this),d=window.mvideo.Module.init("popup",arguments,this);d&&d.popup&&(b=d.popup,b.$.template.on("create-review-ext.success",function(a,d){var e=new window.mvideo.Class.ErrorPopup("body");e.setContent({message:d.htmlContent}),e.show(),d.limitReached&&(b.$.template.hide(),c.remove())}).on("create-review-ext.error",function(){b.$.template.hide()}))}),function(){var a=null;window.mvideo.Module.define("prevent-event-device",function(b){b=$.extend(!0,{mobile:!0,tablet:!0,mobileDevice:!0,desktop:!1,event:"click"},b),null===a&&(a=window.mvideo.device.manager.isItMobile()||!1),$(this).on(b.event,function(c){if(b.mobileDevice&&a||b[window.mvideo.device.manager.getType()])return c.preventDefault(),void c.stopImmediatePropagation()})})}(),mvideo.Module.define("product-tile-badges",function(){function a(){var a=h.outerWidth(!0),b=0;return i.not(":last").each(function(){var a=$(this);b+=a.outerWidth(!0)}),b>a}function b(){var a=m.outerWidth(!0),b=a;i.not(":last").each(function(c){var d=$(this);if(d.css("width","auto"),d.outerWidth(!0)+a>=h.width()){var e=0;0===c&&2===i.length||0!==c&&i.length>1?(e=h.width()-s,b+=e-a):(e=h.width()-a-s,b+=e),d.css({width:e+"px"})}else b+=d.outerWidth(!0);h.width()>b&&d.addClass(q)})}function c(){j=75,k=100,h.toggleClass("show"),m.toggleClass("show"),m.fadeOut(100),n?$(i.not("."+q).not(":last").get().reverse()).each(function(){var a=$(this);return setTimeout(function(){a.fadeToggle(k),a.removeClass("show")},j),j+=k}):i.not("."+q).not(":last").each(function(){var a=$(this);return setTimeout(function(){a.fadeToggle(k),a.addClass("show u-hidden-phone")},j),j+=k}),n=!n,m.delay(.75*j).fadeIn(k)}function d(){var a=$("."+r);$("."+q).each(function(){$(this).removeClass(q)}),a.removeClass("show"),a.find(".c-label").trigger("tooltip-destroy"),mvideo.Class.ReinitContent.reinit(a)}function e(a){var b=!1;return l.each(function(){a.is($(this))&&(b=!0)}),b}function f(a){var b=$(a.target);!n||b.is(h)||e(b)||c()}function g(){var a=t.width();a!=u&&(u=a,d())}var h=$(this),i=h.children();if(i.length){var j,k,l=i.filter(function(){return!$(this).hasClass("c-product-tile-badge__view-all")}),m=h.find(".c-product-tile-badge__view-all"),n=!1,o=$(".c-toggle-buttons__item"),p=h.closest(".c-product-tile"),q="show-always",r="c-product-tile-badge",s=2*parseInt(i.first().css("margin-right"),10),t=$("body"),u=t.width();!function(){b(),a()&&(m.show(),m.off("click").on("click",function(a){a.stopPropagation(),c()}))}(),p.off("click.hideBadges").on("click.hideBadges",f),o.off("click.badgesReinit").on("click.badgesReinit",d),$(window).off("resize.badgesReinit").on("resize.badgesReinit",g)}}),mvideo.Module.define("productBundlePickup",function(a,b){function c(){return i.find("select.bundle-pickup-select option:selected").data("store-id")}function d(){m=i.find('.bundle-pickup input[type="radio"]:checked').attr("id").split(".")[0],j.toggleClass("hidden","courier"===m)}function e(){return a.slice(1)}function f(){var a={shippingType:m,productId:l.productId,promoId:l.promoId,pickupStoreId:c(),blockId:e()};$.ajax({type:"GET",url:l.contentUrl,data:a,cache:!1,beforeSend:function(){n.show(i),i.off()},success:function(a){mvideo.Class.ReinitContent.reinit(i.html(a))},error:function(){console.error("reload container error")},complete:function(){n.hide(i)}})}function g(){var a={shippingType:m,pickupStoreId:c(),blockId:e()};$.ajax({type:"GET",url:l.messageUrl,dataType:"json",data:a,cache:!1,success:function(a){k.toggleClass("hidden",!(a&&a.isPreSell))},error:function(){console.error("update message error")}})}function h(){d(),b?f():g()}b=!(!b||"false"===b);var i,j,k,l,m,n;!function(){i=$(a),k=i.find(".multi-bundles-discount-message"),j=i.find(".bundle-pickup-select"),l={},l.contentUrl=i.data("content-url"),l.updatedUrl=i.data("updated-bundle-url"),l.messageUrl=i.data("update-bundle-message-url"),l.productId=i.data("product-id"),l.promoId=i.data("promo-id"),l.siteId=i.data("site-id"),n=new mvideo.Class.Overlay,d(),i.on("change",'.bundle-pickup-select, .bundle-pickup input[type="radio"]',h)}()}),mvideo.Module.define("productReviewLoader",function(a,b){var c=$(a),d=$(a+" "+b),e=function(a,b){var c,e=!1,g=b||this,h=$(g);if("A"==g.nodeName?(a.preventDefault(),c=h.attr("href")):c=h.attr("data-href"),!c)return void console.error("Wrong url.");e=f(c),e?d.load(c,function(){mvideo.Class.ReinitContent.reinit(d)}):console.log("Wrong request.")},f=function(a){var b,c=[];return b=a.replace(/.*\?/g,"").split("&"),$.each(b,function(a,b){var d=b.split("=");c[d[0]]=d[1]}),c.productId&&c.page};!function(){var a=$(".error-popup");a.find(".c-popup__close").on("click",function(){a.hide()})}(),c.on("click",".pagination-section a",e),c.on("click",".pagination-section-button a",e),c.on("change",".sort-reviews-by",function(){$("option:selected",this).each(e)})}),mvideo.Module.define("productTileList",function(a,b,c,d){new mvideo.Class.ProductListCollection(a,b,c,d)}),window.mvideo.Module.define("products-popup",function(a){function b(){var b=null;c().show(),j=c().$.template.find(a.popupContentSelector),b=j.find(a.rootSelector),i=$(a.facetsSelector,j),setTimeout(function(){k.show(j.parent(),!0),i.trigger("load-facets")}),i.one("facets-loaded",function(){k.hide(j.parent()),b.removeClass(a.hiddenClass)}),c().getContentCurrentPopup().on("change-cart",function(){l=!0})}function c(){return h||(h=new window.mvideo.Class.Popup("",$.extend(!0,{title:d()},a.popupParams)))}function d(){return f.render({data:a.templateParams})}a=$.extend(!0,{facetsSelector:'[data-init="plp-facet"]',rootSelector:".c-products-selection",hiddenClass:"u-hidden",popupContentSelector:".c-popup__content",submitFormSelector:"[data-submit-form-accessories]",popupSelector:".c-popup",closeOnMobile:!0,templateParams:{delimiter:"&",searchResultsNumber:"",facetHolder:".c-popup__block .o-plp-container__filters",selectProductsParams:{},ajaxTabsParams:{},titleTooltip:null},popupParams:{contentAsHTML:!0,clearContentBeforeHide:!0,namespace:"products-popup",classes:["c-popup_with-title","products-popup","full-screen"],functionClose:function(b){k.hide(j),i.trigger("destroy-instance"),h=null,i=null,null!==a.urlRedirect&&l?window.location.assign(a.urlRedirect):l&&$(b.target).closest(a.popupSelector).find(a.submitFormSelector).submit()}},additionalPopupClasses:null,urlRedirect:null},a),a.additionalPopupClasses&&a.popupParams.classes.push(a.additionalPopupClasses),window.mvideo.helpers.isIE()&&a.popupParams.classes.push("_ie");var e=$(this),f=new window.mvideo.Class.JadeTplLoader("products-popup"),g=f.load(),h=null,i=null,j=null,k=new mvideo.Class.Overlay,l=!1;return e.on("click",function(){"resolved"===g.state()?b():g.then(function(){b()})}),{desktopBehavior:function(){},tabletBehavior:function(){},mobileBehavior:function(){a.closeOnMobile&&h&&h.hide()}}}),mvideo.Module.define("productsViewSwitcher",function(a){new mvideo.Class.ProductViewSwitcher(this,a)}),mvideo.Module.define("profile-type-switcher",function(){function a(a){if(a)return d.addClass("required-field"),c.attr("placeholder",h+g),void e.attr("maxlength",10);d.removeClass("required-field"),c.attr("placeholder",h),e.attr("maxlength",12)}var b=$(this),c=$("input#legal-frm-kpp",b),d=$("label.legal-frm-kpp",b),e=$("#legal-frm-inn",b),f=$('#js-ip-org-switch input[type="radio"]',b),g=" *",h=null;h=c.attr("placeholder").replace(g,""),f.on("change",function(b){a("true"===b.target.value)}),a(f.filter(":checked"))}),mvideo.Module.define("promo-code-timer",function(a){function b(a){d=new mvideo.Class.Timer({selectors:{timer:e.selectors.timerSelect},holder:f,seconds:a}),d.start(c)}function c(){d=!1,i.hide(),h.show()}var d,e=$.extend(!0,{holder:this,selectors:{form:"form",timerSelect:" .timer",linkRequest:".js-request-promo-code",msgDefault:".personal-offer-block-item__msg-default",msgResult:".personal-offer-block-item__msg"},timerSeconds:null},a||{}),f=$(e.holder),g=$(e.selectors.linkRequest,f),h=$(e.selectors.msgDefault,f),i=$(e.selectors.msgResult,f),j=new mvideo.Class.Overlay;e.timerSeconds&&e.timerSeconds>0&&(b(e.timerSeconds),h.hide(),i.show()),g.on("click",function(a){a.preventDefault();var c=$(e.selectors.form,f);$.ajax({url:c.attr("action"),type:c.attr("method"),dataType:"json",data:c.serialize(),beforeSend:function(){j.show(f)},success:function(a){a=a||{},"success"==a.status?(i.html(a.message),b(a.timerSeconds||0),h.hide(),i.show()):h.html('<div class="c-notice"><div class="c-notice-message">'+a.message+"</div></div>")},complete:function(){j.hide(f)}})})}),mvideo.Module.define("promo-text-image-block",function(){function a(a){var b=parseFloat(a.css("min-height"));return(isNaN(b)||a[0].naturalHeight>b)&&(b=a[0].naturalHeight),b}function b(a){var b=(a.parent().width()-a.width())/2;b<0?a.css("margin-left",b):a.css("margin-left","")}function c(a){var b=parseInt(f)/a,c=parseInt(g)/a;e.css("margin-top",b+"px"),e.css("margin-bottom",c+"px")}var d=$(this),e=d.find(".TIBlock-content"),f=e.css("margin-top"),g=e.css("margin-bottom"),h="Microsoft Internet Explorer"===navigator.appName||!(!navigator.userAgent.match(/Trident/)&&!navigator.userAgent.match(/rv:11/)),i=0;return d.addClass("TIBlock_new"),$(window).resize(function(){var c,e=mvideo.device.manager.getType();"mobile"===e&&(e="phone"),c=d.find("img.visible-"+e),c.length&&(i?h&&b(c):c[0].onload=function(){i=a(c),d.find('img[data-original="'+c.attr("data-original")+'"]').css("min-height",i),h&&b(c)})}).resize(),{desktopBehavior:function(){c(1)},tabletBehavior:function(){c(2)},mobileBehavior:function(){c(6)}}}),mvideo.Module.define("promotionCarousel",function(a){var b=$(this),c={auto:!1,onCreate:function(){b.trigger("create")}};$.extend(!0,c,a||{});var d=new mvideo.Class.CommonCarousel(this,{carousel:c});return{desktopBehavior:function(){d.config.carousel.auto=c.auto,d.reinit(d.config.carousel)},tabletBehavior:function(){d.config.carousel.auto=!1,d.reinit(d.config.carousel)},mobileBehavior:function(){d.destroy()}}}),window.mvideo.Module.define("pseudo-form",function(a){function b(a){a.preventDefault();var b=e(a);b.valid&&c(b.data)}function c(b){i.trigger("pseudo-form.submit"),$.ajax({url:i.data("action-url"),data:b,type:i.data("method"),cache:!1,beforeSend:function(a){g||(g=new window.mvideo.Class.Overlay(i)),g.show()},processData:!1,contentType:!1}).fail(function(b,c,d){f(a.msgErr)}).done(function(b,c,e){"success"===b.status?d(b.htmlContent):b.htmlContent?d(b.htmlContent):f(b.msgErr||a.msgErr)}).always(function(){g.hide()})}function d(a){setTimeout(function(){h.html(a),window.mvideo.Class.ReinitContent.reinit(h)})}function e(a){var b=new FormData,c=$('input:not([type="submit"]), textarea',i),d=!0;c.each(function(){var a=$(this);if(!a.hasClass("c-pseudo-form_ignore"))return"hidden"===a.attr("type")?void b.append(a.attr("name"),a.val()):void(!j||a.valid()?"file"!=a.attr("type")?b.append(a.attr("name"),a.val()):a[0].files[0]&&b.append(a.attr("name"),a[0].files[0],a[0].files[0].name):d=!1)});var e=$(a.target);return 0!=e.length&&e.attr("name")&&e.val()&&b.append(e.attr("name"),e.val()),{valid:d,data:b}}function f(a){var b=window.JST[k]({params:{notificationMessages:[{title:a}],iconStyle:"error",iconColor:"red"}});setTimeout(function(){h.html(b)})}a=$.extend(!0,{msgErr:"error",selectTarget:null},a);var g,h,i=$(this),j=!!i.closest("form").length,k="common/jade/tpls/notifications.tpl";!j&&window.console.warn("the form is without validation"),i.find('[type="submit"]').on("click",b),i.find(".c-pseudo-form_cancel").on("click",function(a){a.preventDefault(),i.trigger("pseudo-form.cancel")}),h=null===a.selectTarget?i:$(a.selectTarget)}),mvideo.Module.define("recaptcha",function(a){function b(){window.grecaptcha.reset(k),i.prop("checked",!1).change()}function c(){f.removeClass(e.hiddenClass)}function d(){f.addClass(e.hiddenClass)}var e=$.extend(!0,{holder:this,recaptchaSelector:".recaptcha",recaptchaParams:{sitekey:"",hl:"ru"},hiddenClass:"u-hidden",createId:!1},a||{}),f=$(e.holder),g=f.find(e.recaptchaSelector),h=null,i=null,j=new mvideo.Class.Recaptcha,k=null;e.createId?(g.attr("id")&&g.attr("old-id",g.attr("id"))&&g.attr("id",null),g.uniqueId(),i=f.find(".out-of-screen"),h=g.attr("id"),i.attr("id","recaptcha-"+h+"-checkbox")):(h=g.attr("id"),i=f.find("#"+h+"-checkbox")),j.onLoad(function(){k=window.grecaptcha.render(h,$.extend(!0,e.recaptchaParams,{callback:function(a){i.prop("checked",!!a).change(),f.find(".u-error-text, label.text-error").hide()},"expired-callback":function(){window.grecaptcha.reset(k),i.prop("checked",!1).change()}}))}),i.on("reinit-recaptcha",b).on("show-recaptcha",c).on("hide-recaptcha",d)}),mvideo.Module.define("regionSelectorHandler",function(a){$(a).on("change",function(){$(this).closest("form").find("input[type=submit]").click()})}),window.mvideo.Module.define("relative-affix",function(a){var b=$(this),c=a&&a.eventTarget?$(a.eventTarget):$(window),d=a&&a.relative?$(a.relative):b.parent(),e={ABSOLUTE_TOP:"affix-absolute-top",ABSOLUTE_BOTTOM:"affix-absolute-bottom",FIXED_TOP:"affix-fixed-top",FIXED_BOTTOM:"affix-fixed-bottom",CENTER:"affix-center"},f=[e.ABSOLUTE_TOP,e.ABSOLUTE_BOTTOM,e.FIXED_TOP,e.FIXED_BOTTOM,e.CENTER].join(" "),g=c.scrollTop(),h=e.ABSOLUTE_TOP,i=["scroll","resize","orientationchange",""].join(".relative-affix-"+b.uniqueId().attr("id")+" "),j=function(a){b.addClass("relative-affix");var i,j=$(".sticky-header:visible").outerHeight(),k=c.scrollTop(),l=c.height(),m=d.offset().top,n=d.outerHeight(),o=m+n,p=b.offset().top,q=b.outerHeight(),r=p+q;if(n<=q)return b.css({position:"static"}),void b.removeClass("relative-affix");g<k||!a||"scroll"!=a.type?(i=k+l-12,o<i&&o<k+q+12+j?h=e.ABSOLUTE_BOTTOM:k>=0&&k<m?h=e.ABSOLUTE_TOP:q>l-j?r<i?h=e.FIXED_BOTTOM:r!=i&&o!=i&&(h=e.CENTER):p<k+j+12&&(h=e.FIXED_TOP)):g>k&&(i=k+12,m-j>i?h=e.ABSOLUTE_TOP:p-j>i?h=e.FIXED_TOP:p-j!=i&&m-j!=i&&(h=e.CENTER)),g=k,h==e.CENTER?b.css({position:"absolute",top:p-b.parent().offset().top,bottom:""}):h==e.ABSOLUTE_TOP?b.css({position:"absolute",top:m-b.parent().offset().top,bottom:""}):h==e.ABSOLUTE_BOTTOM?b.css({position:"absolute",top:"",bottom:b.parent().offset().top+b.parent().height()-o}):h==e.FIXED_TOP?k>m&&b.css({position:"fixed",top:12+j,bottom:""}):h==e.FIXED_BOTTOM&&b.css({position:"fixed",top:"",bottom:12}),h==e.CENTER||b.hasClass(h)||(b.removeClass(f),b.addClass(h))};return b.data("relative-affix-instance",{eventsHandler:j}),{desktopBehavior:function(){j(),c.off(i).on(i,j)},tabletBehavior:function(){c.off(i),b.css({position:"",top:"",bottom:""})},mobileBehavior:function(){c.off(i),b.css({position:"",top:"",bottom:""})}}}),window.mvideo.Module.define("relative-width",function(a){function b(){d.css("width",c.css("width"))}a=$.extend(!0,{el:".o-special-offer__timer",evInit:"count-down-init"},a);var c=$(a.el),d=$(this);return c.length>0?(c.one(a.evInit,b),{desktopBehavior:b,tabletBehavior:b,mobileBehavior:$.noop}):{desktopBehavior:$.noop,tabletBehavior:$.noop,mobileBehavior:$.noop}}),mvideo.Module.define("relayout-orders",function(a){function b(){d.find(c.btnSelector).length?d.addClass(c.additionalClass):d.removeClass(c.additionalClass)}var c=$.extend(!0,{btnSelector:".order-info-btn",eventName:"changeBtnCount",additionalClass:"has-buttons"},a),d=$(this);d.on(c.eventName,b),b()}),mvideo.Module.define("required-tc",function(a,b,c){function d(){$(".can-be-removed:visible").length?$(b).attr("disabled","disabled"):e?(c&&$(c).hide(),$(b).removeAttr("disabled")):!1===e&&(c&&$(c).show(),$(b).attr("disabled","disabled"))}var e=$(a).prop("checked");d(),$(a).on("click",function(){e=$(a).prop("checked"),d()})}),mvideo.Module.define("review-ext-modal",function(a){function b(a){a.preventDefault(),c.typeBrowser[mvideo.device.manager.getType()]&&d.modal("show").find(".modal-body").html('<img src="'+$(this).attr("href")+'">')}var c={selectLink:".modal-link",selectModal:"#modalReview",typeBrowser:{desktop:!0,tablet:!0,mobile:!1}};$.extend(!0,c,a||{});var d=$(c.selectModal);d.length&&$(this).on("click",c.selectLink,b)}),mvideo.Module.define("searchResultClusterHeadingMenuSticky",function(){function a(){var a=m.innerWidth();j.hide();for(var b=0,c=!0,d=0,e=i.length;d<e&&!(b+i.eq(d).show().outerWidth()>a);d++)b+=i.eq(d).outerWidth(),c=c&&!i.eq(d).is(o);if(d<e){for(;b+n>a;)d--,b-=i.eq(d).outerWidth(),c=c||i.eq(d).is(o);i.slice(d).hide(),l.slice(0,d).hide(),j.show(),l.slice(d).show(),o.length>0&&c?j.addClass("active"):j.removeClass("active")}}function b(){var a=l.filter(":visible");if(a.length>10){var b=0;a.slice(0,10).each(function(a,c){b+=$(c).outerHeight()}),k.css("max-height",b).parent().addClass("search-results-cluster-heading-menu-subcategory_scroll")}else k.css("max-height","").parent().removeClass("search-results-cluster-heading-menu-subcategory_scroll")}function c(){window.removeEventListener("resize",a),j.hide(),m.css("overflow-x","auto").swipe("disable");var b=0,c=0,d=i.length-2;i.show().each(function(a,e){var f=$(e);f.hasClass("active")&&(c=b),b+=f.outerWidth(),a===d&&(q=-1*b)}),h.width(b+2),m.scrollLeft(c)}function d(){window.addEventListener("resize",a),m.css("overflow","").swipe("disable"),h.css({position:"",left:"",width:"auto"}),a()}var e=$(this),f=e.offset().top+56,g=!0;$(window).load(function(){$(".search-results-cluster-heading-menu-outer").height("auto")}),$(window).scroll(function(){var a=$("footer").offset().top,b=$(window).scrollTop();b>=f&&!0===g?e.addClass("search-results-cluster-heading-menu-container_fixed"):e.removeClass("search-results-cluster-heading-menu-container_fixed"),b>=a&&!0===g?e.addClass("search-results-cluster-heading-menu-container_fixed-scroll-top"):e.removeClass("search-results-cluster-heading-menu-container_fixed-scroll-top")})
;var h=$(".search-results-cluster-heading-menu_first",this),i=h.children(".search-results-cluster-heading-menu__item:not(.search-results-cluster-heading-menu__item_has-submenu)"),j=$(".search-results-cluster-heading-menu__item_has-submenu",this),k=$(".search-results-cluster-heading-menu-subcategory-inner",j),l=k.children(),m=$(".search-results-cluster-heading-menu-inner",this),n=j.outerWidth(),o=i.filter(".active");a();var p=0,q=0;return m.swipe({swipeStatus:function(a,b,c,d,e,f,g,i){switch(b){case"start":p=h.position().left;break;case"move":"left"!==c&&"right"!==c||(d="left"===c?p-d:p+d,d=d>0?0:d<q?q:d,h.css("left",d+"px"))}}}),j.click(function(a){"A"===a.target.tagName.toUpperCase&&"#"===a.target.attributes.href.value&&a.preventDefault(),a.originalEvent._initOpen=!0,j.toggleClass("open"),b()}),$(document.body).click(function(a){if(void 0!==a.originalEvent&&a.originalEvent._initOpen)return!0;j.removeClass("open")}),{desktopBehavior:function(){d(),g=!0},tabletBehavior:function(){d(),g=!0,e.removeClass("fixed")},mobileBehavior:function(){c(),g=!0,e.removeClass("fixed")}}}),window.mvideo.Module.define("select-products",function(a){a=$.extend(!0,{productTileSelector:".c-product-tile",productButtonSelector:".c-add-to-basket .c-btn, .c-product-tile_easy .c-btn_close, [data-add-tocart]",lockedProductClass:"c-product-tile_locked",buttonAddClass:"i-icon-plus",buttonAddedClass:"i-icon-check",addingUrl:"",deletingUrl:"",popupFooterSelector:".c-products-selection-footer",emptyListClass:"c-products-selection-footer_empty",maxProductsInListClass:"c-products-selection_full",productListingSelector:".o-plp-container__product-listing",defaultProductsCount:1,footerVisible:!0,clickBlocker:"u-pointer-none",buttonSubmit:null},a);var b=$(this),c=b.find(a.productListingSelector),d=new mvideo.Class.AsyncDataLoader,e=new mvideo.Class.Overlay(b,!0);d.addModule({container:b,unshiftModule:!0,beforeRequest:function(){e.show(b,!0)},afterRequest:function(){e.hide()},onDataHandler:function(c){c.notification?b.addClass(a.maxProductsInListClass):b.removeClass(a.maxProductsInListClass)},moduleName:"select-products"}),b.on("click",a.productButtonSelector,function(e){function f(d,e){var f=b.find(a.popupFooterSelector),g=c.find("[data-product-id="+i+"]"),h=g.find(a.productButtonSelector);f.find(a.productTileSelector).length-a.defaultProductsCount==0?f.addClass(a.emptyListClass):f.removeClass(a.emptyListClass),k?g.addClass(a.lockedProductClass):g.removeClass(a.lockedProductClass),h.toggleClass(a.buttonAddClass,!k).toggleClass(a.buttonAddedClass,k),b.trigger("change-cart")}var g=$(e.currentTarget),h=g.closest("[data-product-id]"),i=h.data("product-id"),j=g.siblings("form"),k=g.hasClass(a.buttonAddClass),l=k?a.addingUrl:a.deletingUrl;if(!l){if("true"===h.attr("data-product-in-cart"))return;return g.addClass(a.clickBlocker),void j.one("submit",function(c){c.preventDefault(),$.ajax({url:j.attr("action"),type:j.attr("method"),data:j.serialize(),cache:!1}).then(function(c){h.attr("data-product-in-cart","true"),g.removeClass(a.clickBlocker),d.updateData(c),b.trigger("change-cart")})}).trigger("submit")}d.load({url:l,method:j.attr("method"),getParams:j.serialize()}).then(function(a){f(a,!0)})}),a.buttonSubmit&&b.on("click",a.buttonSubmit,function(a){a.preventDefault(),$(this).closest(".c-popup__block").find("[data-close]").trigger("click")})}),mvideo.Module.define("select-radiobutton",function(a,b){function c(){return d.find('input[type="radio"]').each(function(){$(this).prop("checked")&&(i=!0)}),i}var d=$(a),e=d.find(".change-personal-details-radiobutton-list"),f=d.find("label.text-error"),g=$(".change-personal-details-email, .change-personal-details-phone").find(b),h=$(this).data("text-error")||"Пожалуйста, укажите пол.",i=!1,j=new mvideo.Class.SmartFocus;g.on("click",function(a){c()||(a.preventDefault(),e.addClass("error"),f.text(h),j.focusBlock(e))}),d.find("input[type=radio]").on("formElementOnclick",function(){f.empty(),e.removeClass("error"),g.addClass("available")})}),mvideo.Module.define("select-stars-ext",function(a){function b(a,b){a.val(b).trigger("change").focus().blur().focus()}function c(){var a=[];return i.each(function(){var b=$(this).find(g.star+".active").length;a.push(b)}),a}function d(a,b){a.each(function(a){var c=$(this);c[a<b?"addClass":"removeClass"]("active"),c[a<b?"removeClass":"addClass"]("inactive")});var c=e(a.length);j.attr("class",j.attr("class").replace(/\d+/g,c.percentage)),k.text(c.value)}function e(a){var b=c(),d=b.length*a,e=b.reduce(function(a,b){return a+b},0),f=Math.round(e*a*10/d)/10;return{value:f,percentage:Math.round(100*f/a)}}function f(){var a=-1===m.indexOf(0);l.length&&(l.prop("checked",a),a&&l.valid())}var g={holder:this,characteristic:".characteristic",input:".characteristic-value",ratingWrapper:".star-rating-canvas",star:".icon-star",pieChart:".pie-chart",ratingChart:".pie-rating",validationCheckbox:"#rating-count-checkbox"};$.extend(!0,g,a||{});var h=$(g.holder),i=h.find(g.ratingWrapper),j=h.find(g.pieChart),k=j.find(g.ratingChart),l=h.find(g.validationCheckbox),m=c();i.on("click",g.star,function(){var a=$(this),c=a.index()+1;b(a.parents(g.characteristic).find(g.input),c)}).on("mouseenter",g.star,function(){var a=$(this),c=a.index()+1,e=a.parents(g.characteristic);if("ontouchstart"in window)return b(e.find(g.input),c);d(e.find(g.star),c)}).on("mouseleave",g.star,function(){var a=$(this),b=a.parents(g.characteristic),c=b.index();d(b.find(g.star),m[c])}),h.find(g.input).on("change",function(){var a=$(this),b=+a.val(),c=a.parents(g.characteristic),e=c.index();m[e]=b,d(c.find(g.star),b),f()})}),mvideo.Module.define("selectStars",function(a){function b(a,b){for(var c,d=0;a[d];d++)c=new mvideo.Class.StateContainer(a.eq(d),{states:["active","inactive"]}),c.setState(d<=b?"active":"inactive")}function c(a){for(var b=0;a[b];b++)if(a.eq(b).hasClass("inactive"))return b-1;return a.length-1}function d(a){i.val(a).focus().blur().focus(),e.triggerEvent&&i.trigger(e.triggerEvent)}var e,f,g,h,i,j,k={};"object"!=typeof a?f=$(a+" .star-rating-canvas"):(f=$(k.holder||this),k=a),e=$.extend({stars:".font-icon.icon-star",hiddenInput:"#rating-real",triggerEvent:""},k),g=e.stars,h=f.find(g),i=$(e.hiddenInput),j=c(h),f.on("click",g,function(a){var c=$(this).index();a.preventDefault(),b(h,c),j=c,d(c+1)}).on("mouseenter",g,function(a){a.preventDefault(),b(h,$(this).index())}).on("mouseleave",g,function(a){a.preventDefault(),b(h,j)}),i.change(function(){b(h,$(this).val()-1),j=c(h)})}),mvideo.Module.define("setHeightOffer",function(a,b){function c(){$(document).ready(function(){f.each(function(){$(this).is(":visible")&&g.push($(this).height())}),d=Math.max.apply(0,g),f.height(d)})}var d,e=$(this).find($(a)),f=e.find(b),g=[];return{desktopBehavior:function(){c()},tabletBehavior:function(){c()},mobileBehavior:function(){f.height("")}}}),mvideo.Module.define("sg-social-sharing",function(a,b){function c(a){a.find(".c-social-sharing__item").each(function(a,c){var d=$(c).data("network"),e=$(this),g=$(c).attr("data-token");b||f.getShareCount(d,g,function(a){var b=e.find(".c-btn__counter");a=a?parseInt(a,10):0,a>0?(b.removeClass("u-hidden"),b.text(a)):b.addClass("u-hidden")})})}function d(a){a.find(".c-social-sharing__item").each(function(a,b){var c=$(b).data("network");$(this).off("click.SocialSharing").on("click.SocialSharing",function(){return f.openWindow(c,e()),!1})})}function e(){var a="";return a=$(".news-detail-article").length>0?$(".news-detail-article h2").text().trim():$(".product-data-header").length>0?$(".product-data-header h1").text().trim():$(".o-pdp-topic__title").length>0?$(".o-pdp-topic__title").text().trim():$('meta[property="og:title"]').attr("content").trim(),encodeURIComponent(a)}b="true"===b;var f=new mvideo.Class.SocialShare({link:a||$('meta[property="og:url"]').attr("content")||window.location.href,multiple:!1}),g=$(this),h=g.parent().find(".c-social-sharing__content");g.on("click",function(a){a.preventDefault()});var i={title:h,side:"bottom",large:!0,contentAsHTML:!0,functionFormat:function(a){var b=a instanceof jQuery?a:$(a);return c(b),b},functionReady:function(a){var b=a instanceof jQuery?a:$(a);return d(b),b}};new mvideo.Class.Tooltip(g,i)}),mvideo.Module.define("show-hide-hint",function(a){function b(){f.slideUp("slow",function(){k.scrollTop()>i&&mvideo.instance.page.page.goToBlock(e,-l)})}function c(){var a=null;g.each(function(){var b=$(this);"none"!==b.css("display")&&(a=b)}),null!==a?a.slideUp("slow",function(){d()}):d()}function d(){f.slideDown("slow"),f.offset().top+l>k.height()+k.scrollTop()&&mvideo.instance.page.page.goToBlock(f,-l)}a=$.extend({linked:"",hint:".c-hint",hideLinkSelector:".c-hint_hide-link"},a);var e=$(this),f=$(a.linked),g=$(a.hint),h=f.find(a.hideLinkSelector),i=0,j=mvideo.instance.stickyHeader,k=$(window),l=10;h.on("click",function(a){a.preventDefault(),b()}),e.on("click",function(a){a.preventDefault(),"none"===f.css("display")?(i=e.offset().top-(j?j.item.getHeight():0),c()):b()})}),mvideo.Module.define("show-hide-rows",function(a){function b(){d.removeClass(a.openedClass),f.slideUp(500,function(){a.opened=!1})}function c(){d.addClass(a.openedClass),f.slideDown(500,function(){a.opened=!0})}a=$.extend({control:"",rows:"#bc-details-active .c-bc-details__content",opened:!1,openedClass:"chevron_opened"},a);var d=$(this),e=a.control?d.find(a.control):d,f=d.find(a.rows);f=f.length?f:$(a.rows),e.on("click",function(d){d.preventDefault(),a.opened?b():c()})}),mvideo.Module.define("showMoreSimple",function(a){var b=new mvideo.Class.OpenClose(this,$.extend({changeText:"<button class='c-btn c-btn_text c-btn_white c-btn_full-size'>Скрыть</button>",onClose:function(){mvideo.instance.page.page.goToBlock(b.$.holder,-100)}},a));b.initialize()}),mvideo.Module.define("show-password",function(a){function b(){"function"==typeof g.tooltipster&&g.tooltipster("status").open?(g.tooltipster("show"),setTimeout(function(){!c.is(":focus")&&g.tooltipster("hide")},200)):c.removeClass(a.classErrorHide)}a=$.extend(!0,{holder:this,addClass:"c-text-field_show-password",classOpen:"i-icon-eye",classClosed:"i-icon-eye_closed",sel:{show:"tur_link_show",hide:"tur_link_hide"},classErrorHide:"u-error_hide"},a);var c=$(a.holder),d=$('<a class="c-link c-link_no-underline c-show-password__icon i-icon i-icon-eye_closed c-link_gray20" data-sel="'+a.sel.show+'"></a>'),e=$('<div class="c-show-password__wrapper"></div>').html(d),f=c.closest("form"),g=c.data(c.data("tooltipsterNs"));f.on("form-submit",function(){c.removeClass(a.classErrorHide)}),c.addClass(a.addClass).before(e).on("input",function(){c.addClass(a.classErrorHide),0===c.val().length&&c.removeClass(a.classErrorHide)}).on("blur",b),e.on("click",function(){"password"===c.attr("type")?c.attr("type","text")&&d.removeClass(a.classClosed).addClass(a.classOpen).attr("data-sel",a.sel.show):c.attr("type","password")&&d.removeClass(a.classOpen).addClass(a.classClosed).attr("data-sel",a.sel.hide),c.focus()})}),mvideo.Module.define("showQuantityOfLoyaltyRubles",function(a,b){var c=$(a),d=$(b);c.on("click",function(a){a.preventDefault();var b=$(this).data("content-url");return $.ajax({type:"GET",url:b,dataType:"json",cache:!1,success:function(){d.find(".bonus-rubles-hidden").css("display","block"),d.find(".bonus-rubles-info").remove(),d.find(".pseudo-table").remove()}})})}),mvideo.Module.define("sidebarSeeMore",function(a){var b={selectors:{items:".sidebar-category"},itemsShown:7,desktopShown:!1,tabletShown:!1,changeText:"Свернуть"};$.extend(!0,b,a||{});var c=new mvideo.Class.OpenClose(this,b),d=c.$.items,e=c.config;if(d.length>e.itemsShown){var f=new mvideo.Class.DynamicTextElement($(this),"append",{text:{show:'<a href="#" class="expandable-list-link">+ <span class="expandable-list-text">Показать все</span></a>',hide:'<a href="#" class="expandable-list-link">- <span class="expandable-list-text">Скрыть</span></a>'},tag:"li",attributes:{style:"text-align:right;"}});f.changeText("show"),d.filter(":gt("+(+e.itemsShown-1)+")").addClass("hidden"),c.addCollapsedClass(),f.$.el.on("click",function(a){c.$.holder.hasClass(e.classCollapsed)?(f.changeText("hide"),d.removeClass("hidden"),c.removeCollapsedClass()):(f.changeText("show"),d.filter(":gt("+(+e.itemsShown-1)+")").addClass("hidden"),c.addCollapsedClass()),a.preventDefault()})}}),mvideo.Module.define("sidebarStateIcon",function(a){function b(){var b=0;for(var d in a.stateIcons){var e=a.stateIcons[d];e.count>0?(b++,e.$&&e.$.show()):e.$&&e.$.hide(),b>1?(c.removeClass(a.oneChildClass),c.show()):b>0?(c.show(),c.addClass(a.oneChildClass)):c.hide()}}a=mvideo.helpers.paramParser(a,{oneChildClass:"navigation-middle_single"});var c=$(this);if(a.stateIcons)for(var d in a.stateIcons){var e=a.stateIcons[d];if(e.count||(e.count=0),e.selector&&(e.$=$(e.selector,c),e.$.length>0)){var f={};e.counterName&&(f[e.counterName]=function(a,c,d,e){a.count=d,b()}.bind(this,e)),e.listManager=new mvideo.Class.ListStateManager(e.$,{selectors:{productCount:e.productCount},dataChangeLsnr:f,ajaxResponseName:d})}}window.mvideo.Event.subscribe("change-to-wishlist",function(c,d){var e=a.stateIcons.wishlistMenu;e.count=parseInt(d.amount),b(),e.count>0&&e.$.find(".c-amount-indicator").html(e.count)})}),mvideo.Module.define("slick-sidebar",function(a){function b(a){var b=$(a.target);a.preventDefault(),b.hasClass(c.prevSlickClass)?d.slick("slickPrev"):b.hasClass(c.nextSlickClass)&&d.slick("slickNext")}var c={holder:this,prevSlickClass:"js-slick-prev",nextSlickClass:"js-slick-next",slidesSelector:".js-slick-slide",slickParams:{swipe:!1,dots:!1,arrows:!1,infinite:!1,slidesToShow:1,initialSlide:1}};$.extend(!0,c,a||{});var d=$(c.holder),e=$("."+c.prevSlickClass+", ."+c.nextSlickClass);return{desktopBehavior:function(){d.hasClass("slick-initialized")&&d.slick("unslick"),e.off("click",b)},tabletBehavior:function(){d.hasClass("slick-initialized")&&d.slick("unslick"),e.off("click",b)},mobileBehavior:function(){d.slick(c.slickParams),e.on("click",b)}}}),mvideo.Module.define("smart-border-radius",function(a){var b=$(this),c=$.extend({tilesInRow:3,radius:4},a||{}),d=b.find(c.element);!function(){var a=d.first(),b=d.length>=c.tilesInRow?d.eq(2):d.last(),e=d.filter(":nth-child("+c.tilesInRow+"n+1)").last(),f=d.length<c.tilesInRow||d.length%3==0?d.last():null;a.addClass(c.radiusClasses.topLeft),e.addClass(c.radiusClasses.bottomLeft),b.addClass(c.radiusClasses.topRight),f&&f.addClass(c.radiusClasses.bottomRight)}()}),mvideo.Module.define("social-sharing-page",function(a){function b(){f.each(function(){var a=$(this),b=a.data("network"),c=a.attr("data-token");mvideo.Event.publish("count-shares",{network:b,accessToken:c})})}function c(){var a=e.closest(d.twitterShare),b=a.find(d.twitterShareText).text(),c=$('meta[property="og:title"]').attr("content");return encodeURIComponent(b&&b.trim()||c&&c.trim())}var d={holder:this,shareLink:".b-social_link",counter:".b-social_counter",twitterShare:".b-promo-share",twitterShareText:".b-promo-share_description",link:$('meta[property="og:url"]').attr("content")||window.location.href};$.extend(!0,d,a||{});var e=$(d.holder),f=e.find(d.shareLink),g=new mvideo.Class.SocialShare({link:d.link,multiple:!0});b(),f.on("click",function(){var a=$(this).data("network");return g.openWindow(a,"twitter"===a?c():"",function(){setTimeout(b,1e3)}),!1}),mvideo.Event.subscribe("shares-count-updated",function(a,b){f.filter(function(){return $(this).data("network")===b.network}).find(d.counter).text(b.count)})}),mvideo.Module.define("state-check",function(a){function b(){var b=c.val()===a.defaultState;"checked"===c.attr("checked")?c.val(b?a.otherState:a.defaultState):c.val(a.defaultState),c.trigger("change")}var c=$(this);a=$.extend({defaultState:"",otherState:""},a),c.on("change, click",b)}),mvideo.Module.define("sticky-display-trigger",function(a){function b(){function b(){h-e.offset().top+f.scrollTop()>0?g.hide():g.show()}function c(){h=f.height()-e.height(),b()}var d=$.extend(!0,{target:"[data-sticky-target=true]",source:"[data-sticky-source=true]",holder:"[data-sticky-holder=true]"},a||{}),e=$(d.target,d.holder),f=$(window),g=$(d.source,d.holder),h=f.height()-e.height();f.scroll($.throttle(200,b)),f.resize($.throttle(200,c)),b()}var c=!0;return{desktopBehavior:function(){},tabletBehavior:function(){},mobileBehavior:function(){c&&(b(),c=!1)}}}),mvideo.Module.define("stickyHeader",function(a){var b=new mvideo.Class.StickyHeader(this);return mvideo.setObjectPath("mvideo.instance.stickyHeader.item",b),{item:b,desktopBehavior:function(){b.enable().update()},tabletBehavior:function(){},mobileBehavior:function(){}}}),mvideo.Module.define("store-locator",function(a){var b={storeLocatorCtrlClassName:"StoreLocator"};$.extend(!0,b,a||{});var c=new mvideo.Class[b.storeLocatorCtrlClassName](this,b),d={list:mvideo.Class.StoreList,map:mvideo.Class.StoreMap,subway:mvideo.Class.StoreSubway};return $(this).find("[data-locator-module]").each(function(){var a=$(this).data("locatorModule");c.register(new d[a.name](this,a))}),{desktopBehavior:$.noop,tabletBehavior:$.noop,mobileBehavior:function(){c.tabs.setActiveTab("list")},locator:c}}),mvideo.Module.define("store-locator2",function(a){var b={storeLocatorCtrlClassName:"StoreLocatorCheckout",eventOverlayClose:""};$.extend(!0,b,a||{});var c=new mvideo.Class[b.storeLocatorCtrlClassName](this,b),d={list:mvideo.Class.StoreList2,map:mvideo.Class.StoreMap,subway:mvideo.Class.StoreSubway};return $(this).find("[data-locator-module]").each(function(){var a=$(this).data("locatorModule");c.register(new d[a.name](this,a))}),c.tabs.setActiveTab("map"),b.eventOverlayClose&&mvideo.Event.once(b.eventOverlayClose,function(){c.overlayHide()}),{desktopBehavior:$.noop,tabletBehavior:$.noop,mobileBehavior:function(){c.tabs.setActiveTab("list")},locator:c}}),mvideo.Module.define("store-pickup",function(a,b){$(a).on("click",function(a){a.preventDefault();var c=$(this).parents(".store-locator-list-item").attr("data-store-id");$("#js-store-id").val(c),$(b).trigger("click")})}),mvideo.Module.define("submit-click",function(a){$(this).on("click",function(a){a.preventDefault(),$(this).closest("form").find('[type="submit"]').trigger("click")})}),mvideo.Module.define("submit-checkbox",function(){var a=$(this),b=a.find('input[type="checkbox"]');$("#status-in-wish-list").length>0?b.prop("checked",!0):b.prop("checked",!1),b.on("change",function(){a.find('input[type="submit"]').trigger("click")})}),mvideo.Module.define("subnavOnMobile",function(a){var b=new mvideo.Class.OpenClose(this,a);return{desktopBehavior:function(){b.destroy()},tabletBehavior:function(){b.destroy()},mobileBehavior:function(){b.initialize()}}}),mvideo.Module.define("subscribe-preorder",function(a){new mvideo.Class.SubscribePreoderPDP(this,a.messageContainer,a)}),mvideo.Module.define("switchLoginType",function(a,b){var c=$(a),d=new mvideo.Class.StateContainer(a,{states:["login-by-email-phone-state","login-by-bonus-card-state"]});c.on("click",b,function(a){a.preventDefault();var b=$(this).attr("href").substring(1);d.setState(b)})}),mvideo.Module.define("switch-state-radio",function(a){var b={container:"[data-state-container]",states:["o-exchange_method-courier","o-exchange_method-shop"],radio:"",className:"o-exchange_method-",ev:"change"};b=$.extend(!0,b,a||{});var c=$(this),d=new mvideo.Class.StateContainer(b.container||c,{states:b.states});c.on(b.ev,b.radio,function(){var a=b.className+$(this).attr("value");d.setState(a)})}),mvideo.Module.define("symbols-counter",function(a){function b(){e.val().length>a.max?(f.addClass("c-counter_error"),e.addClass("u-error"),i=!0):(f.removeClass("c-counter_error"),i&&e.removeClass("u-error"),i=!1),g.text(e.val().length)}function c(){e[0].scrollHeight>e[0].clientHeight?e.addClass("c-textarea_scroll"):e.removeClass("c-textarea_scroll")}a=$.extend(!0,{maxSelector:"",valueSelector:"",counterSelector:"",textSelector:"",max:0},a);var d=$(this),e=$(a.textSelector,d),f=$(a.counterSelector,d),g=$(a.valueSelector,f),h=$(a.maxSelector,f),i=!1;g.text(e.val().length),h.text(a.max),e.on("input",function(){c(),b()}),e.on("blur",function(){e.val($.trim(e.val())),c(),b()})}),window.mvideo.Module.define("tabs-buttons",function(){new mvideo.Class.TabsButtons(this,this)}),mvideo.Module.define("tabs",function(a){function b(){var a={unsetActiveAll:!0,url:e.tabset.getActiveItem().find("a").attr("href")};d(a),e.initAccordionView().publish("switchTab",a)}function c(){var a=window.document.location.href,b=e.tabset.getActiveItem().find("a").attr("href"),c={withoutScrollToActive:!e.config.activeItem,activeItemId:e.tabset.getActiveTabId(),url:b};e.initTabsetView(),-1!==a.indexOf(b)&&(d(c),e.publish("switchTab",c))}function d(a){f&&(f=!1,a.replaceHistory=!0)}var e=new mvideo.Class.Tabs(".tab-container",a),f=a&&a.firstSwitch||!0;return{desktopBehavior:c,tabletBehavior:c,mobileBehavior:b,tabs:e,getTabsData:e.getTabsData.bind(e)}}),window.mvideo.Module.define("fields",function(){function a(){var a={};return d.each(function(b,c){var d=$(c),e=d.data("fieldsName")||d.attr("name");e&&(a[e]=d.val())}),a}var b=$(this),c=null,d=null;return"object"==typeof b.data("fieldsParam")?(c=b.data("fieldsParam"),d=c.el?$(c.el):null):window.console.warn("fieldsParam: no JSON"),{getParams:function(){return null!==d?a():null}}}),window.mvideo.Module.define("gender-account",function(){var a=$('[name="gender"]');return{getParams:function(){return{gender:a.filter(":checked").val()}}}}),window.mvideo.Module.define("text-autocomplete",function(a){if(a=$.extend(!0,{nameItems:"hints",nameInput:"query",nameValue:"value",preventEnter:!0,additionalModule:null,defaultLength:1,stopPropagation:!1,afterFormSubmit:!1,minLengthShow:1},a),!window.mvideo.instance.textAutocomplete||!window.mvideo.instance.textAutocomplete.initialized){var b=$(this),c=a.additionalModule?window.mvideo.Module.init(a.additionalModule,{},this):null;return a.afterFormSubmit&&b.on("chose-item",function(){$(this).closest("form").trigger("submit")}),new window.mvideo.Class.AutocompleteSG(b,$.extend({transformResponseToItems:function(b){return b&&b[a.nameItems]&&b[a.nameItems].length?b[a.nameItems].map(function(b){return{text:b[a.nameValue],name:b[a.nameValue]}}):[]},getRequestData:function(b){var d={};return null!==c&&Object.assign(d,c.getParams()),d[a.nameInput]=b.val(),d},isEmptyResponse:function(b){return!b[a.nameItems].length}},a)),{initialized:!0}}}),mvideo.Module.define("tips-input-tooltip",function(a){function b(){var a=d.outerWidth();f.closest(".tooltipster-show").css({minWidth:a,maxWidth:a}),d.tooltipster("reposition")}function c(){g&&(d.tooltipster("show"),setTimeout(b))}if(a=$.extend(!0,{tips:[],headerText:"",footerText:"",contentAsHTML:!0,trigger:"custom",title:"",withoutMobilePopup:!0,large:!0,closable:!1,hideDelay:525,scrollToFieldDuration:100,scrollToFieldTopOffset:-20,repositionOnScroll:!1},a),!a.tips||!a.tips.length)return void console.warn("params.tips can be only an array");var d=$(this),e=$('<div class="c-tips-tooltip"><p class="e-p u-mb-8">'+a.headerText+'</p><div class="c-tips-tooltip__content"></div><p class="e-p">'+a.footerText+"</p></div>"),f=$(".c-tips-tooltip__content",e),g=!0,h=new mvideo.Class.Page(".page-content");a.title=e,a.tips.forEach(function(a){a.regexp=new RegExp(a.regexp)},this),a.repositionOnScroll&&$.tooltipster.setDefaults({repositionOnScroll:!0}),function(){for(var b="",c=0;c<a.tips.length;c++)b+='<span class="font-icon pull-left u-color-gray92 i-icon-ok" data-type="'+a.tips[c].type+'"></span><p class="e-p u-mb-8 u-ml-24">'+a.tips[c].text+"</p>";f.append(b)}(),d.on("focus",function(){"mobile"===mvideo.device.manager.getType()?h.goToBlock(d,a.scrollToFieldTopOffset,{duration:a.scrollToFieldDuration,complete:c}):c()}),d.on("blur",function(){d.tooltipster("hide")}),d.on("input",function(){var b=$(this).val(),c=0;a.tips.forEach(function(a){var d=f.find('[data-type="'+a.type+'"]');a.regexp.test(b)?(d.removeClass("u-color-gray92").addClass("u-color-green"),c++):d.hasClass("u-color-green")&&d.removeClass("u-color-green").addClass("u-color-gray92")},this),c===a.tips.length?(g=!1,setTimeout(function(){d.tooltipster("hide")},a.hideDelay)):(g=!0,d.tooltipster("show"))}),new mvideo.Class.Tooltip(d,a)}),mvideo.Module.define("tooltip",function(a,b,c,d){console.warn('MVIDEO WARNING  ======>  You use deprecated module "tooltip", please, use "sg-tooltip"'),"#"+this.id==a&&(console.warn('MVIDEO WARNING  ======>  You use "selector" ('+a+')  equal "this"'),a=!1),(a?$(a):$(this)).each(function(){var a=$(this);new mvideo.Class.Tooltip(a,{contentAsHTML:!0,side:b,title:a.data("title")})})}),window.mvideo.Module.define("touch-zoom",function(){$.support.touch&&new mvideo.Class.ZoomTouchImg(this,{transformer:".c-media-container__image-wrapper",svgSelector:".c-media-container__image",controllerHolder:".subway-controllers",controller:".c-btn",translate:void 0,scale:{min:1,max:2,step:.1}})}),mvideo.Module.define("tradeInBehavour",function(a){var b=$(a);b.change(function(){var a=b.nextAll("a").attr("href");document.location=a})}),mvideo.Module.define("typ-favorite-store",function(a){a=$.extend(!0,{holder:this,form:"#choose-favorite-store",linkFavorites:".js_select_favorite-shop",msgSuccess:"Магазин добавлен в любимые"},a);var b=$(a.holder),c=$(a.linkFavorites),d=$(a.form);if(0===c.length)return void d.remove();b.on("click",a.linkFavorites+" a",function(b){b.preventDefault();var e=$(this),f=e.closest(a.linkFavorites),g=new mvideo.Class.Overlay(c),h=d.find('input[type="submit"]');d.find("#selectedStoreId").val($(this).data("id")),g.show(),$.ajax({url:d.attr("action"),method:d.attr("method"),data:d.serialize()+"&"+encodeURI(h.attr("name"))+"="+encodeURI(h.val())}).done(function(){c.hide(),f.find(".c-line-img__icon").removeClass("i-icon-heart c-line-img_red i-icon-heart-linear").addClass("i-icon-check c-line-img_green"),f.find(".c-link").replaceWith("<span>"+a.msgSuccess+"</span>"),f.show()}).always(function(){g.hide()})})}),mvideo.Module.define("typ-move-priceblock",function(){var a=$(this),b=$(".c-affix-content"),c=$(".js_affix-content",b),d=$(".c-tabs",a),e=$(".o-confirmation__personal-block",d),f=$(".o-confirmation__personal-block-item",d);setTimeout(function(){mvideo.instance.productTabs.tabs.subscribe("switchTab",function(a,g){f.hide(),e.find('[data-id="'+g.activeItemId+'"]').show(),c.html(d.find('[data-id="'+g.activeItemId+'"] .js_price-block').html()),mvideo.Class.ReinitContent.reinit(c),b.data("relative-affix-instance").eventsHandler()})}),c.html(d.find(".active .js_price-block").html()),mvideo.Class.ReinitContent.reinit(c),b.removeClass("ajax-overlay")}),mvideo.Module.define("typ",function(a){function b(){k.removeClass("u-error u-disabled").siblings(".u-error-text").css({display:"none"})}function c(a){h.trigger("form-submit"),h.hasClass(i.WAIT_PASSWORD)&&n.check(k)&&d(),h.hasClass(i.RESULT)||a.preventDefault()}function d(){l.val(k.val()),h.removeClass(j).addClass(i.WAIT_CHECK)}function e(){o.html(g()),h.removeClass(j).addClass(i.WAIT_SMS_CODE)}function f(){h.removeClass(j).addClass(i.RESULT)}function g(){return a.msgPhone+p.phoneInput.getValue()}a=$.extend(!0,{prefix:"c-form-registration_",smsCode:".c-code-check__input",labelPhone:"c-code-check__label-sms-code",msgPhone:"Отправлен на ",passwordConfirmation:"#password-confirmation"},a);var h=$(this),i={WAIT_PASSWORD:a.prefix+"wait-password",WAIT_CHECK:a.prefix+"wait-check",WAIT_SMS_CODE:a.prefix+"wait-sms-code",RESULT:a.prefix+"result"},j=[i.WAIT_PASSWORD,i.WAIT_CHECK,i.WAIT_SMS_CODE,i.RESULT,"disabled-form"].join(" "),k=$('input[type="password"]',h),l=$(a.passwordConfirmation,h),m=$(a.smsCode,h),n=k.validate(),o=$('<label for="" class="'+a.labelPhone+'"></label>'),p={},q=this;h.find('input[type="submit"]').on("click",c.bind(q)),h.find(".c-form-registration__btn button").on("click",c.bind(q)),k.on("blur",function(a){0===k.val().length&&b()}).on("input",function(a){b()}),setTimeout(function(){p=mvideo.instance.phoneVerification.phoneVerification,o.attr("for",p.phoneInput.getId()),m.after(o),p.codeConfirmation.subscribe("confirmation-code-send-before",function(){e()}),p.subscribe("phone-verified",function(){f()})})}),mvideo.Module.define("unsubscriptionMessage",function(){$(document).on("click","#unsubscription-message-close",function(a){$("#unsubscription-message").animate({opacity:0,top:"45%"},400,function(){$(this).removeClass("block"),$("#overlay").fadeOut(400).removeClass("block")})})}),mvideo.Module.define("updateStores",function(a){function b(a){var b=g.find(d.store_select),c="",e=a;b.empty();for(var f=0,h=e.length;f<h;f++)c+='<option value="'+e[f].value+'">'+e[f].text+"</option>";b.html(c),i.reinit(b),g.find("#subsribeStore").val(e[0].value)}function c(a){var c=g.find(d.city_select),e="";c.empty();for(var f=0,h=0;h<a.length;h++)a[h].value==j&&(f=h);0!==f&&(a.splice(0,0,a[f]),a.splice(f+1,1));for(var k=0;k<a.length;k++)e+='<option value="'+a[k].value+'">'+a[k].text+"</option>",a[k].shops&&(b(a[k].shops),g.find("#subsribeCity").val(a[k].value));c.html(e),i.reinit(c)}var d={sku_select:"#skuOption",city_select:"#cityOption",store_select:"#storeOption",url:"/sitebuilder/blocks/preorder/components/subscribe.json.jsp"},e=a&&a.urlCity?a.urlCity:d.url,f=a&&a.urlSku?a.urlSku:"",g=$(this),h=new mvideo.Class.AbstractAjaxController,i=new mvideo.Class.CustomSelect,j="";$.extend(!0,d,a||{}),g.find(d.city_select).on("change",function(){var a={subscribeCityId:$(this).val(),requestType:"storeOption"};$("#prorderId").length>0&&(a.prorderId=$("#prorderId").val()),$("#subsribeSku").length>0&&(a.subscribeSku=$("#subsribeSku").val()),h.get(e,a,b)}),g.find(d.sku_select).on("change",function(){j=g.find(d.city_select).val();var a={subscribeSku:$(this).val(),subscribeCityId:j,requestType:"skuOption"};$("#prorderId").length>0&&(a.prorderId=$("#prorderId").val()),h.get(f,a,c)}),g.find(d.sku_select).on("change",function(){g.find("#subsribeSku").val($(this).val())}),g.find(d.store_select).on("change",function(){g.find("#subsribeStore").val($(this).val())}),g.find(d.city_select).on("change",function(){g.find("#subsribeCity").val($(this).val())})}),window.mvideo.Module.define("utc-transfer-local",function(a){a&&(this.innerHTML=window.moment(a).format("D MMMM [в] HH:mm"),this.classList.contains("u-visibility-hide")&&this.classList.remove("u-visibility-hide"))}),mvideo.Module.define("validationHandler",function(a,b){var c;"object"!=typeof a||a instanceof jQuery||a instanceof HTMLElement||(c=a,a=this);var d=$.extend({formSelector:a||this,errorClasses:"error",validClasses:"success",errorFieldClass:"text-error",ignoreSelectors:".ignore, .dont-validate, :hidden",holderSelector:".input",requireValidateAfterSubmit:!1,flag:!1},c||{}),e=$(d.formSelector),f=e.attr("id"),g=$(this),h=g.data("clear-onfocusout"),i=g.data("clear-keyup");b=b||d.flag;var j={ignore:d.ignoreSelectors,highlight:function(a,b,c){$(a).removeClass(c).addClass(b).closest(d.holderSelector).addClass(d.errorClasses).removeClass(d.validClasses)},unhighlight:function(a,b,c){$(a).removeClass(b).addClass(c).closest(d.holderSelector).removeClass(d.errorClasses).addClass(d.validClasses).trigger("elementUnhighlight")},errorPlacement:function(a,b){if(e.hasClass("header-search-form-section"))e.append(a);else{if(!b.closest(d.holderSelector).length)return b.after(a);b.closest(d.holderSelector).after(a)}},submitHandler:function(a){var b,c=$(a);return mvideo.Event.publish("formValid",a.id),c.trigger("formValid"),c.hasClass("formNotSubmit")?!(b=c.data("selector-submit"))||($(b).trigger("click"),!1):(a.submit(),!1)},invalidHandler:function(a,b){e.trigger("formInvalid"),mvideo.Event.publish("formInvalid",this.id)}};return h&&(j.onfocusout=function(){this.resetForm()}),i&&(j.onkeyup=function(a,b){13!==b.keyCode&&this.resetForm()}),d.requireValidateAfterSubmit&&(j=$.extend(j,{onchange:function(a,b){if("select"===a.nodeName.toLowerCase()){var c=$(a),e=c.hasClass(d.errorFieldClass);if(0===c.val().length&&!e)return!1;this.element(a)}},onfocusout:function(a,b){if("select"!==a.nodeName.toLowerCase()){var c,d=$(a)
;if("masked-input"===d.parent().data("init")&&d.val()===d.attr("placeholder")&&d.val(""),(c=d.val())==d.data("prevVal")||!c&&!d.data("prevVal"))return!1;if(d.data("prevVal",c),!d.val().length)return d.removeClass(this.settings.errorClass).removeData("previousValue").closest("div.input").removeClass("error success").parent().find("label.text-error").empty().hide(),!1;this.element(a)}}})),f in mvideo.instance.page.page.validationForms?b?(e.validate(j),!0):void 0:(mvideo.instance.page.page.validationForms[f]=e.validate(j),!0)}),mvideo.Module.define("verification-code",function(a){function b(){n.addClass("disabled-form")}function c(){n.removeClass("disabled-form")}function d(a){a||(a=r),a.rules("remove","exception-value")}function e(a){var b=$("<div />");b.append(a).insertAfter(m),m.addClass(l.hiddenClass),mvideo.initScripts(b)}function f(a){a.hasClass("disabled")||a.attr("disabled")?(a.removeAttr("disabled"),a.removeClass("disabled")):(a.addClass("disabled"),a.attr("disabled","disabled"))}function g(a){window.location.assign(a)}function h(){n.removeClass("disable-partialy"),x.removeClass("disable-partialy"),z.not(".cancel-disable-partialy").find("input").removeAttr("tabindex")}function i(a){!a.length||a.hasClass("enable-forbidden")||n.find(".birthday-validation").length||(a.find(".disabled").removeClass("disabled"),a.find("[disabled]").removeAttr("disabled"))}function j(a){a&&a.length&&$("#form-register-terms").prop("checked")&&a.removeAttr("disabled")}function k(a){C.replace({type:a.type,text:a.text}),A.removeClass("u-hidden")}var l=$.extend(!0,{timerHolder:".verif-code-timer",timer:".resend-code-timer",input:"#frm-verif-code-",selectorCodeCheck:null,resendLink:".verif-code-resend",verifCodeBtn:".verif-code-btn",checkCodeEvent:"click",timeInSeconds:59,codeFailedMsg:"Неверно указан код",confirmationError:".verif-code-enter .text-error",sendCodeUrl:"/phoneVerification/getCode",checkCodeUrl:"/phoneVerification/sendCode",recaptchaCheckbox:"#recaptcha-sms-checkbox",recaptchaHolder:".verif-code-recaptcha",notification:'[data-notification="true"]',hiddenClass:"hidden",eventBtn:"click",recaptchaInside:!1,hookEnterCodeField:!0,hideOnSuccess:!0},a||{}),m=$(l.blockSelector),n=$(l.formSelector),o=l.formBtnSelector&&$(l.formBtnSelector),p=l.blockSelector.split("-").pop(),q=$("#frm-number-"+p),r=l.selectorCodeCheck?$(l.selectorCodeCheck):$(l.input+p),s=n.find(l.disabledBlocks),t=m.find(".cancel-btn"),u=l.selectorBirthdayField&&$(l.selectorBirthdayField),v=l.hideElement&&n.find(l.hideElement),w=n.hasClass("disable-partialy"),x=$(l.blockSelectorDisablePartialy),y=l.btnEnabledBlockRegistration&&$(l.btnEnabledBlockRegistration),z=$("#register-bc-form .control-group"),A=n.find(l.notification),B=new mvideo.Class.CodeConfirmation(n,{selectors:{timerHolder:l.timerHolder,timer:l.timer,input:l.selectorCodeCheck?l.selectorCodeCheck:l.input+p,resendLink:l.resendLink,checkCodeTrigger:l.selectorCodeCheck?l.selectorCodeCheck:l.verifCodeBtn,error:l.confirmationError},holder:$(this),timeInSeconds:l.timeInSeconds,checkCodeEvent:l.checkCodeEvent,codeFailedMsg:l.codeFailedMsg,sendCodeUrl:l.sendCodeUrl,checkCodeUrl:l.checkCodeUrl,hiddenClass:l.hiddenClass,getRequestData:function(){return{}},bootImmediatelyConfig:l.bootImmediatelyConfig,recaptcha:{checkbox:l.recaptchaCheckbox,holder:l.recaptchaHolder,recaptchaInside:l.recaptchaInside}}),C=new window.mvideo.Class.Notification(A,{errorParams:{textColor:null},successParams:{textColor:null}});return B.subscribe("confirmation-code-check-before",function(a){"card"!==p&&(b(),u&&u.length&&u.rules("remove","exception-value"))}),B.subscribe("confirmation-code-check-success",function(a,b){if(b.redirectUrl)return g(b.redirectUrl),!1;b.status&&"success"===b.status?(l.hideOnSuccess&&m.addClass(l.hiddenClass),o.trigger(l.eventBtn)):b.status&&"success"===b.status&&b.userData?e(b.userData):b.status&&"success"===b.status&&void 0===b.userData&&"error"===b.birthday?(m.addClass(l.hiddenClass),x.length&&h()):b.status&&"success"===b.status&&void 0===b.userData&&(s&&s.length&&s.data("disabled")&&(s.data("disabled",!1),s.attr("data-disabled",!1)),o&&o.length&&f(o),i(n.find(".check-card-basic")),x.length&&h(),m.addClass(l.hiddenClass)),j(y),v&&v.length&&v.hide()}),B.subscribe("confirmation-code-check-complete",function(a){"code"!==p&&c()}),mvideo.Event.subscribe("verification-code-show",function(a,b){B.setEntryCodeState(b)}),B.subscribe("confirmation-code-check-error",function(a,b){"code-blocked"===b.state&&(k(b.notification),o.trigger("code-blocked",$.extend(!0,{savePopup:!0},b)))}),l.hookEnterCodeField&&r.on("keypress",function(a){13==(a.keyCode||a.which)&&(a.preventDefault(),B.checkUserCode())}),t.on("click",function(a){if(a.preventDefault(),"card"==p){$(this).closest(".verif-code").find(".input-verif-code").removeClass("text-error").val(""),$(this).parent().find("label.text-error").html(""),m.addClass(l.hiddenClass),$(".btn-add-new-bonus-card").removeClass(l.hiddenClass)}else d(),m.addClass(l.hiddenClass),h(),q.data("noClearValue")||q.val(""),q.focus();B.cancelConfirmation()}),l.bootImmediatelyConfig&&B.initState(),function(){w&&z.not(".cancel-disable-partialy").find("input").attr("tabindex","-1")}(),{codeConfirmation:B}}),mvideo.Module.define("verification-phone",function(a){function b(){g.removeClass("hidden"),h.val(""),p.setState("sending-code-state"),h.attr("disabled",!1),h.attr("readonly",!1),h.data("verified",!1),f.find(".control-label").text(a.label),h.focus(),k.removeClass("hidden-wrapper")}function c(){p.setState("sending-code-state"),g.addClass("hidden"),h.data("verified",!0),h.attr("disabled",!1),h.attr("readonly",!0),f.find(".control-label").text(a.labelForVerified),p.setState("phone-verified"),k.addClass("hidden-wrapper"),d(!0)}function d(a){n.prop("checked",a||!1),a&&n.siblings(".text-error").css({display:"none"})}function e(){a.submitOnVerified&&(m.length>0?m.trigger("click"):l.trigger("submit")),a.submitAccessChange&&m.length>0&&(m.removeAttr("disabled"),m.removeClass("disabled"))}a=$.extend(!0,{holder:this,confirmBtnSelector:".js-confirm-phone-btn",inputPhoneSelector:"#register-form-phone",changePhoneLinkSelector:".change-phone-link",resendCodeCtrlSelector:".resend-code-link",inputCodeSelector:"#verification-code",states:["sending-code-state","entry-code-state","phone-verified"],timerSelector:".resend-code-timer",timerHolder:".resend-code-timer-holder",codeFormHolder:".entry-code",timeInSeconds:59,getCodeUrl:"",sendCodeUrl:"",codeFailedMsg:"Неверно указан код",labelForVerified:"",label:"Номер телефона*",submitOnVerified:!1,verificationStep:"initial",notificationSelector:".additional-message",submitAccessChange:!1,showVerifiedStep:!0,confirmationError:".entry-code-form .text-error",recaptchaCheckbox:"#recaptcha-sms-checkbox",recaptchaHolder:".verif-code-recaptcha"},a);var f=$(a.holder),g=f.find(a.confirmBtnSelector),h=f.find(a.inputPhoneSelector),i=f.find(a.changePhoneLinkSelector),j=f.find(a.inputCodeSelector),k=f.find(a.notificationSelector),l=$(h[0].form),m=l.find('[type="submit"]'),n=f.find("#code-check-control"),o=h.validate(),p=new mvideo.Class.StateContainer(f,{states:a.states}),q=new mvideo.Class.CodeConfirmation(f,{selectors:{timerHolder:a.timerHolder,timer:a.timerSelector,input:a.inputCodeSelector,resendLink:a.resendCodeCtrlSelector,checkCodeTrigger:a.inputCodeSelector,error:a.confirmationError},holder:f,timeInSeconds:a.timeInSeconds,codeFailedMsg:a.codeFailedMsg,sendCodeUrl:a.getCodeUrl,checkCodeUrl:a.sendCodeUrl,hiddenClass:"hidden",getRequestData:function(){return{phone:h.val()}},recaptcha:{checkbox:a.recaptchaCheckbox,holder:a.recaptchaHolder}}),r=new RegExp(h.data("rule-regexp"));!function(){switch(a.verificationStep){case"verified":c();break;case"need-only-verification":h.attr("readonly",!0),f.addClass("need-only-verification"),g.toggleClass("disabled",!1)}mvideo.Event.subscribe("confirmUserData",function(c,d){d===a.inputPhoneSelector&&b()})}(),q.subscribe("confirmation-code-received",function(a,b){o.resetField(h),o.resetField(j),h.attr("disabled",!0),!b.delay&&i.removeClass("disabled"),p.setState("entry-code-state")}),q.subscribe("confirmation-timer-expired",function(){i.removeClass("disabled")}),q.subscribe("confirmation-code-send-before",function(a){d(!1),i.addClass("disabled")}),q.subscribe("confirmation-code-check-before",function(a){d(!1),i.addClass("disabled")}),q.subscribe("confirmation-code-check-request-error",function(){d(!1)}),q.subscribe("confirmation-code-check-error",function(a,b){d(!0),!b.delay&&i.removeClass("disabled")}),q.subscribe("confirmation-code-check-success",function(){a.showVerifiedStep?c():(h.data("verified",!0),h.attr("disabled",!1),d(!0)),e(),f.trigger("phone-successfully-verified")}),g.on("click",function(a){a.preventDefault(),g.hasClass("disabled")||q.sendCodeToUser()}),h.on("input keyup",function(a){setTimeout(function(){var a=o.check(h),b=h.val();b===h.attr("placeholder")?o.resetField(h):r.test(b)&&h.valid(),g.toggleClass("disabled",!a)})}),h.on("keydown",function(a){if(13===a.keyCode)return h.trigger("focusout"),o.check(h)&&(g.trigger("click"),o.resetField(h)),h.trigger("focus"),!1}),h.on("focus",function(a){h.attr("readonly")&&h.parent().hasClass("error")?h.trigger("blur"):h.data("rule-need-verification",!1)}),h.on("blur",function(a){h.data("rule-need-verification",!0)}),i.on("click",function(a){a.preventDefault(),i.hasClass("disabled")||(g.removeClass("disabled"),p.setState("sending-code-state"),h.attr("disabled",!1),q.cancelConfirmation())})}),mvideo.Module.define("viewAll",function(a){function b(a){var b=a.not(".hidden").find("img.lazy-manual");b.length&&(b.removeClass("lazy-manual"),p.add(a)),p.update()}function c(){d(),m=k.$.holder.find(h.selectors.items),m.removeClass("hidden"),n=o.itemsShown+o.diffShown,e(),o.diffShown&&m.length===o.itemsShown+o.diffShown||(n=o.itemsShown,h.animated?m.filter(i+(+o.itemsShown+j)+")").css("display","none"):m.filter(i+(+o.itemsShown+j)+")").addClass("hidden"),b(m),k.addCollapsedClass(),h.showCount&&g())}function d(){k.removeCollapsedClass(),m.removeClass("hidden"),o.changeText=h.changeText,l.html($.data(l,"initial"))}function e(){l.hasClass("show-hide-btn")&&(m.length>n?l.removeClass("hidden").parent().removeClass("hidden"):l.addClass("hidden").parent().addClass("hidden"))}function f(){var a=window.mvideo.device.manager.getType(),b={tablet:o.tabletShown,desktop:o.desktopShown};d(),n=b[a]+o.diffShown,e(),o.diffShown&&m.length===n||(n=b[a],k.addCollapsedClass(),b[a]&&(h.animated?m.filter(i+(+b[a]+j)+")").css("display","none"):m.filter(i+(+b[a]+j)+")").addClass("hidden")),h.showCount&&g())}function g(){$(k.$.holder.find(".opener-count")).text(m.length-n)}var h={selectors:{items:".product-tile"},itemsShown:3,desktopShown:!1,tabletShown:!1,changeText:"Свернуть",animated:!1,duration:300,diffShown:0,showCount:!1,reverseDirection:!1},i=":gt(",j=-1;$.extend(!0,h,a||{}),h.reverseDirection&&(i=":lt(-",j=0);var k=new mvideo.Class.OpenClose(this,h),l=k.$.opener,m=k.$.items,n=3,o=k.config,p=new mvideo.Class.LazyLoad;return $.data(l,"initial",l.html()),k.$.holder.on("click",k.config.selectors.opener,function(a){l=$(this),m=k.$.holder.find(h.selectors.items),k.$.holder.hasClass(o.classCollapsed)?(k.changeTxt(),h.animated?m.fadeIn(h.duration):m.removeClass("hidden"),k.removeCollapsedClass()):(k.changeTxt(),h.animated?m.filter(i+(+n-1)+")").fadeOut(h.duration):m.filter(i+(+n-1)+")").addClass("hidden"),k.addCollapsedClass()),b(m),a.preventDefault()}),{desktopBehavior:f,tabletBehavior:f,mobileBehavior:c}}),mvideo.Module.define("viewMore",function(a){function b(a,b,c){for(var d,e=a.slice(0,a.lastIndexOf("?")+1),f=a.slice(a.lastIndexOf("?")+1),g=f.split("&"),h=g.length,i=0;i<h;i++)g[i].match(/startFrom=/gi)?g[i]=g[i].replace(/\d/gi,"")+b:g[i].match(/to=/gi)&&(g[i]=g[i].replace(/\d/gi,"")+c);return d=e+g.join("&"),d.match(/to=/gi)||(d+="&to="+c),d}function c(a){var b=a.not(".hidden").find("img.lazy-manual");b.length&&(b.removeClass("lazy-manual"),u.add(a)),u.update()}function d(){e(),j=g.$.holder.find(f.selectors.items),j.removeClass("hidden"),k=l.itemsShown,j.filter(":gt("+(+l.itemsShown-1)+")").addClass("hidden"),c(j),g.addCollapsedClass()}function e(){g.removeCollapsedClass(),j.removeClass("hidden"),l.changeText=f.changeText,i.html($.data(i,"initial"))}var f={selectors:{items:".product-tile, .c-product-tile"},itemsShown:3,desktopShown:!1,tabletShown:!1,numToShow:4,changeText:"Свернуть"};$.extend(!0,f,a||{});var g=new mvideo.Class.OpenClose(this,f),h=$(this),i=g.$.opener,j=g.$.items,k=3,l=g.config,m=!1,n=j.parents("ul"),o=n.data("init-param"),p=n.children().length,q=!!o&&o.hasOwnProperty("ajaxContentLoad"),r=q?o.ajaxContentLoad.total?o.ajaxContentLoad.total:"nonepagination"===o.ajaxContentLoad.type?n.children().length+1:o.ajaxContentLoad.dataIds.length:p,s=!q||p>4,t=q?o.ajaxContentLoad.total?"common":"nonepagination"===o.ajaxContentLoad.type?"nonepagination":"improved":"withoutajax",u=new mvideo.Class.LazyLoad,v=new mvideo.Class.Overlay;return $.data(i,"initial",i.html()),i.on("click",function(a){if(m)return!1;if("nonepagination"===t&&(r=n.children().filter('[rel="'+(n.children().length-1)+'"]').data("id-next")?n.children().length+1:n.children().length),s=!q||(n.children().length>p?n.children().length>=r:s),j=g.$.holder.find(f.selectors.items),o&&q&&!s){var d=o.ajaxContentLoad.contentUrl,e=n.children().length+1,i=j.filter(".hidden").length,w=n.children().length+l.numToShow-i<r?l.numToShow-i:r-n.children().length,x="common"===t?b(d,e,e+w-1):d,y=o.ajaxContentLoad.dataIds?o.ajaxContentLoad.dataIds.slice(e-1,e-1+w):[],z="common"===t?"":{productIds:y.join("|")},A=[];if("nonepagination"===t){var B=n.children(),C=B.filter('[rel="'+(B.length-1)+'"]').data("id-next");B.each(function(){A.push($(this).data("id"))}),z={loadedIds:A.toString(),nextId:C,countItems:l.numToShow-i}}m=!0,v.show(h),$.ajax({url:x,type:"common"===t?"get":"post",data:z}).done(function(a){var b=$(a).filter(function(){return 3!=this.nodeType});b.each(function(a){$(this).attr("rel",e+a-1)}),n.append(b),j.removeClass("hidden"),u.add(b).update(),m=!1,v.hide(h),"nonepagination"===t&&b.last().attr("data-id-next")&&(r=n.children().length+1),r&&n.children().length>=r&&(g.changeTxt(),g.removeCollapsedClass(),s=!0)})}else g.$.holder.hasClass(l.classCollapsed)?(j.filter(".hidden").filter(":lt("+l.numToShow+")").removeClass("hidden"),j.filter(":visible").length>=j.length&&(g.changeTxt(),g.removeCollapsedClass())):(g.changeTxt(),j.filter(":gt("+(+k-1)+")").addClass("hidden"),g.addCollapsedClass(),u.update());c(j),a.preventDefault()}),{desktopBehavior:e,tabletBehavior:e,mobileBehavior:d}}),window.mvideo.Module.define("watch-input",function(a){a=$.extend(!0,{el:"[name='orderNumber']",reg:"^9\\d{7}$",classHidden:"u-hidden",events:"input"},a);var b=$(this),c=new RegExp(a.reg,"i");$(a.el).on(a.events,function(d){if(c.test(d.target.value))return b.addClass(a.classHidden);b.removeClass(a.classHidden)})}),mvideo.Module.define("windowOpenClose",function(a,b){var c=$(a).attr("href");$(a).on("click",function(a){window.open(c,"_blank"),a.preventDefault()}),$(b).on("click",function(){window.close()})}),mvideo.Module.define("wishlistComment",function(a){a=$.extend(!0,{selector:"",settings:{}},a);var b=new mvideo.Class.WishlistAddComment(a.selector,a.settings);return $(a.selector).each(function(){var a=$(this);a.find(".wishlist-delete-btn").on("click",function(b){b.preventDefault(),a.find(".wishlist-delete-product-btn").trigger("click")})}),{desktopBehavior:function(){b.reinit()},tabletBehavior:function(){b.reinit()},mobileBehavior:function(){b.reinit()}}}),mvideo.Module.define("wizard-feedback-ajax-submit",function(a){function b(){return f.validate().checkForm()&&(g.show(),$(this).find(c.emptyFileInput).remove(),$.ajax({type:f.attr("method"),url:f.attr("action"),data:new FormData(this),dataType:"json",cache:!1,processData:!1,contentType:!f.attr("enctype")}).done(function(a){a&&(a.hideBlock&&d.find(a.hideBlock).hide(),a.content&&(e.html(a.content),$(window).scrollTop(0),mvideo.Class.ReinitContent.reinit(e)))}).always(function(){g.hide()})),!1}var c=$.extend(!0,{mainHolder:".c-wizard__card",holder:".c-wizard__recommendation-block",form:"#recommendation-feedback-form",emptyFileInput:".c-file-loader__input:not([data-file-id])"},a||{}),d=$(c.mainHolder),e=d.find(c.holder),f=e.find(c.form),g=new mvideo.Class.Overlay(d);f.submit(b)}),mvideo.Module.define("wizard",function(a){new mvideo.Class.Wizard(this,a)}),mvideo.Module.define("ya-advisor-ga",function(a){if(window.MutationObserver){var b,c=new window.MutationObserver(function(a){a.forEach(function(a){$(a.addedNodes).each(function(a,e){if(b=$(e).filter(function(){var a=$(this);if("#text"!==a[0].nodeName&&"#comment"!==a[0].nodeName)return a.has('button[title="О программе"]').length&&a.has('a[title="Перейти на Яндекс.Маркет"]')}),b.length&&window.dataLayer){window.dataLayer.push({event:"OWOX",eventAction:"show",eventCategory:"Non-Interactions",eventLabel:"yandexSovetnik",eventNoninteraction:"1"}),b.find('[title="Перейти в магазин"]').parent().parent().each(function(a,b){b.addEventListener("click",d,!0)});var f=b.find(".model__rating");f.length?f.parents().eq(2).find("a").on("click",d):b.find("h1").parents().eq(2).find("a").on("click",d),b.find('[title="Все цены на Яндекс.Маркете"]').parents().eq(1).find("a").on("click",d),c.disconnect()}})})}),d=function(a){var b=$(a.target),c={event:"OWOX",eventAction:"click",eventCategory:"Interactions",eventLabel:"yandexSovetnik"};b.attr("title")&&(c.eventContent=b.attr("title")),"yandexSovetnik"!==window.dataLayer[window.dataLayer.length-1].eventLabel&&window.dataLayer&&window.dataLayer.push(c)};c.observe(document.body,{childList:!0})}}),function(){var a=mvideo.Module.init("page");mvideo.Module.deviceController(a),mvideo.instance.page=a,mvideo.initScripts(),mvideo.removeDisabledJSClass(),mvideo.device.manager.changeState()}();